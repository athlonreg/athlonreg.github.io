<!DOCTYPE HTML><html lang="zh-CN"><head><meta charset="utf-8"><meta name="keywords" content="SonarQube,sonar-scanner"><meta name="description" content=""><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="renderer" content="webkit|ie-stand|ie-comp"><meta name="mobile-web-app-capable" content="yes"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><title>SonarQube安装部署 | 套陆的博客</title><link rel="icon" type="image/x-icon, image/vnd.microsoft.icon" href="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/favicon.ico"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/libs/awesome/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/libs/materialize/materialize.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/libs/aos/aos.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/libs/animate/animate.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/libs/lightGallery/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/css/matery.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/css/my.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css"><script src="https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/autoload.js"></script><script src="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/libs/jquery/jquery.min.js"></script><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="套陆的博客" type="application/atom+xml"><link rel="stylesheet" href="/css/prism-tomorrow.css"><link rel="stylesheet" href="/css/prism-line-numbers.css"></head><body><header class="navbar-fixed"><script data-ad-client="ca-pub-7406269002228687" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><nav id="headNav" class="bg-color nav-transparent"><div id="navContainer" class="nav-wrapper container"><div class="brand-logo"><a href="/" class="waves-effect waves-light"><img src="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/favicon.ico" class="logo-img" alt="LOGO"> <span class="logo-span">套陆的博客</span></a></div><a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a><ul class="right nav-menu"><li class="hide-on-med-and-down nav-item"><a href="/" class="waves-effect waves-light"><i class="fas fa-home" style="zoom:.6"></i> <span>首页</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/tags" class="waves-effect waves-light"><i class="fas fa-tags" style="zoom:.6"></i> <span>标签</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/categories" class="waves-effect waves-light"><i class="fas fa-bookmark" style="zoom:.6"></i> <span>分类</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/archives" class="waves-effect waves-light"><i class="fas fa-archive" style="zoom:.6"></i> <span>归档</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/about" class="waves-effect waves-light"><i class="fas fa-user-circle" style="zoom:.6"></i> <span>关于</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/contact" class="waves-effect waves-light"><i class="fas fa-comments" style="zoom:.6"></i> <span>留言板</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/friends" class="waves-effect waves-light"><i class="fas fa-address-book" style="zoom:.6"></i> <span>友情链接</span></a></li><li><a href="#searchModal" class="modal-trigger waves-effect waves-light"><i id="searchIcon" class="fas fa-search" title="搜索" style="zoom:.85"></i></a></li></ul><div id="mobile-nav" class="side-nav sidenav"><div class="mobile-head bg-color"><img src="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/favicon.ico" class="logo-img circle responsive-img"><div class="logo-name">套陆的博客</div><div class="logo-desc">Never really desperate, only the lost of the soul.</div></div><ul class="menu-list mobile-menu-list"><li class="m-nav-item"><a href="/" class="waves-effect waves-light"><i class="fa-fw fas fa-home"></i> 首页</a></li><li class="m-nav-item"><a href="/tags" class="waves-effect waves-light"><i class="fa-fw fas fa-tags"></i> 标签</a></li><li class="m-nav-item"><a href="/categories" class="waves-effect waves-light"><i class="fa-fw fas fa-bookmark"></i> 分类</a></li><li class="m-nav-item"><a href="/archives" class="waves-effect waves-light"><i class="fa-fw fas fa-archive"></i> 归档</a></li><li class="m-nav-item"><a href="/about" class="waves-effect waves-light"><i class="fa-fw fas fa-user-circle"></i> 关于</a></li><li class="m-nav-item"><a href="/contact" class="waves-effect waves-light"><i class="fa-fw fas fa-comments"></i> 留言板</a></li><li class="m-nav-item"><a href="/friends" class="waves-effect waves-light"><i class="fa-fw fas fa-address-book"></i> 友情链接</a></li><li><div class="divider"></div></li><li><a href="https://github.com/athlonreg" class="waves-effect waves-light" target="_blank"><i class="fab fa-github-square fa-fw"></i> Fork Me</a></li></ul></div></div><style>.nav-transparent .github-corner{display:none!important}.github-corner{position:absolute;z-index:10;top:0;right:0;border:0;transform:scale(1.1)}.github-corner svg{color:#0f9d58;fill:#fff;height:64px;width:64px}.github-corner:hover .octo-arm{animation:a .56s ease-in-out}.github-corner .octo-arm{animation:none}@keyframes a{0%,to{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}</style><a href="https://github.com/athlonreg" class="github-corner tooltipped hide-on-med-and-down" target="_blank" data-tooltip="Fork Me" data-position="left" data-delay="50"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a></nav></header><script src="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/libs/cryptojs/crypto-js.min.js"></script><script>(function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex)) {
                alert('密码错误，将返回主页！');
                location.href = '/';
            }
        }
    })();</script><div class="bg-cover pd-header post-cover" style="background-image:url(https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/medias/featureimages/16.jpg)"><div class="container" style="right:0;left:0"><div class="row"><div class="col s12 m12 l12"><div class="brand"><h1 class="description center-align post-title">SonarQube安装部署</h1></div></div></div></div></div><main class="post-container content"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/libs/tocbot/tocbot.css"><style>#articleContent h1::before,#articleContent h2::before,#articleContent h3::before,#articleContent h4::before,#articleContent h5::before,#articleContent h6::before{display:block;content:" ";height:100px;margin-top:-100px;visibility:hidden}#articleContent :focus{outline:0}.toc-fixed{position:fixed;top:64px}.toc-widget{width:345px;padding-left:20px}.toc-widget .toc-title{margin:35px 0 15px 0;padding-left:17px;font-size:1.5rem;font-weight:700;line-height:1.5rem}.toc-widget ol{padding:0;list-style:none}#toc-content{height:calc(100vh - 250px);overflow:auto}#toc-content ol{padding-left:10px}#toc-content ol li{padding-left:10px}#toc-content .toc-link:hover{color:#42b983;font-weight:700;text-decoration:underline}#toc-content .toc-link::before{background-color:transparent;max-height:25px;position:absolute;right:23.5vw;display:block}.toc-fixed .toc-link::before{position:fixed!important}#toc-content .is-active-link{color:#42b983}#floating-toc-btn{position:fixed;right:15px;bottom:76px;padding-top:15px;margin-bottom:0;z-index:998}#floating-toc-btn .btn-floating{width:48px;height:48px}#floating-toc-btn .btn-floating i{line-height:48px;font-size:1.4rem}</style><div class="row"><div id="main-content" class="col s12 m12 l9"><div id="artDetail"><div class="card"><div class="card-content article-info"><div class="row tag-cate"><div class="col s7"><div class="article-tag"><a href="/tags/SonarQube/"><span class="chip bg-color">SonarQube</span></a> <a href="/tags/sonar-scanner/"><span class="chip bg-color">sonar-scanner</span></a></div></div><div class="col s5 right-align"><div class="post-cate"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/CI/" class="post-category">CI</a></div></div></div><div class="post-info"><div class="post-date info-break-policy"><i class="far fa-calendar-minus fa-fw"></i> 发布日期:&nbsp;&nbsp; 2018-08-20</div><div class="post-date info-break-policy"><i class="far fa-calendar-check fa-fw"></i> 更新日期:&nbsp;&nbsp; 2020-04-15</div><div class="info-break-policy"><i class="far fa-file-word fa-fw"></i> 文章字数:&nbsp;&nbsp; 1.5k</div><div class="info-break-policy"><i class="far fa-clock fa-fw"></i> 阅读时长:&nbsp;&nbsp; 6 分</div><div id="busuanzi_container_page_pv" class="info-break-policy"><i class="far fa-eye fa-fw"></i> 阅读次数:&nbsp;&nbsp;<span id="busuanzi_value_page_pv"></span></div></div></div><hr class="clearfix"><div class="card-content article-card-content"><div id="articleContent"><h1 id="SonarQube安装部署"><a href="#SonarQube安装部署" class="headerlink" title="SonarQube安装部署"></a><center>SonarQube安装部署</center></h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>SonarQube是一个管理代码质量的开放平台，可以从七个维度检测代码质量：</p><ul><li>复杂度分布（complexity）：代码复杂度过高将难以理解、难以维护；</li><li>重复代码（duplications）：程序中包含大量复制粘度的代码是质量低下的表现；</li><li>单元测试（unit tests）：统计并展示单元测试覆盖率；</li><li>编码规范（coding rules）：通过Findbugs、PMD、CheckStyle等规范代码编写；</li><li>注释（commments）：少了可读性差，多了看起来费劲；</li><li>潜在的Bug（potential bugs）：通过Findbugs、PMD、CheckStyle等检测潜在bug；</li><li>结构与设计（architecture &amp; design）：依赖、耦合等。</li></ul><p>SonarQube 可以集成不同的测试工具（CppCheck、CheckStyle、Junit、CppUnit等），代码分析工具、持续集成工具（Jenkins）、IDE（VisualStudio）。</p><p>Sonar通过对代码质量分析结果数据进行在加工处理，通过量化的方式来度量代码的质量变化，从而可以方便的对工程进行代码质量管理。</p><p>支持语言：JAVA PHP C# C COBOL PL/SQL FLEX等20余种。</p><h2 id="组成"><a href="#组成" class="headerlink" title="组成"></a>组成</h2><p>SonarQube平台的组成：</p><ul><li>数据库：存放SonarQube的配置数据、代码质量的快照数据。</li><li>Web服务：用于查看SonarQube的配置数据、代码质量的快照数据。</li><li>分析器：对项目代码进行分析、生成质量结果数据并存入数据库中（分析器有多中，此处选择SonarQube Maven Plugin）。</li></ul><h2 id="安装环境"><a href="#安装环境" class="headerlink" title="安装环境"></a>安装环境</h2><h3 id="安装JDK"><a href="#安装JDK" class="headerlink" title="安装JDK"></a>安装JDK</h3><p>去官网下载<code>JDK</code>：<a href="http://www.oracle.com/technetwork/java/javase/downloads/java-archive-javase8-2177648.html" target="_blank" rel="noopener">http://www.oracle.com/technetwork/java/javase/downloads/java-archive-javase8-2177648.html</a></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/81/1b33b7e9dbe92a1515154d0193194f.jpg" alt=""></p><p>安装<code>JDK</code><br>将下载得到的<code>jdk-8u161-linux-x64.rpm</code>包保存到<code>Linux</code>主机</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># rpm -ivh jdk-8u161-linux-x64.rpm</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>设置环境变量，编辑<code>~/.bashrc</code>，</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vim ~/.bashrc</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>在文件的末尾添加以下行</p><pre><code>export JAVA_HOME=/usr/java/jdk1.8.0_161
export JRE_HOME=$JAVA_HOME/jre
export CLASSPATH=$JAVA_HOME/lib
export PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin:$CLASSPATH</code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/49/6ac74e90a641e355b29b9c4d17deb9.jpg" alt=""></p><p>使环境配置生效</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># source ~/.bashrc</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>测试<code>Java</code>环境，在终端输入：<code>java -version</code>查看是否正常显示版本信息，若显示则安装成功</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/2f/49c7d622b298ae690db3c13754c1b1.jpg" alt=""></p><p><strong>Note:</strong><br>如果已经预装了openjdk，请先卸载</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># yum list installed | grep openjdk # 根据执行结果进行卸载</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="安装MySQL"><a href="#安装MySQL" class="headerlink" title="安装MySQL"></a>安装MySQL</h3><p>MySQL的Server在CentOS 7上从默认软件列表中被移除了，用MariaDB来代替，所以这导致我们必须要去官网上进行下载，找到链接，用wget打开，然后再安装：</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># wget http://dev.mysql.com/get/mysql57-community-release-el7-9.noarch.rpm</span>
<span class="token comment" spellcheck="true"># rpm -ivh mysql57-community-release-el7-9.noarch.rpm</span>
<span class="token comment" spellcheck="true"># yum -y install mysql mysql-server mysql-devel</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>启动MySQL服务</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># systemctl start mysqld</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>获取安装MySQL时的初始密码并登录MySQL</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># grep 'temporary password' /var/log/mysqld.log</span>
<span class="token comment" spellcheck="true"># mysql -u root -p</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/4a/a001ae2bae5a494c7329cd78a477a3.jpg" alt=""></p><p>登录成功后修改密码，首先修改安全策略为0，然后将密码长度限制修改为1，最后修改密码</p><pre class="line-numbers language-mysql"><code class="language-mysql">mysql> set global validate_password_policy=0;
mysql> set global validate_password_length=1;
mysql> set password for root@localhost=password('root');<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/a2/0f74ed53f3a426d1fe005228478d8f.jpg" alt=""></p><p>设置sonar的用户名和数据库</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># adduser sonar</span>
<span class="token comment" spellcheck="true"># passwd sonar # 修改sonar用户密码</span>
<span class="token comment" spellcheck="true"># su sonar # 切换为sonar用户安装</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-mysql"><code class="language-mysql">mysql> create user 'sonar'@'%' identified by 'sonar';
mysql> CREATE DATABASE sonar CHARACTER SET utf8 COLLATE utf8_general_ci;
mysql> grant all privileges on sonar.* to 'sonar'@'%';
mysql> flush privileges;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="安装SonarQube"><a href="#安装SonarQube" class="headerlink" title="安装SonarQube"></a>安装SonarQube</h3><pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">wget</span> https://binaries.sonarsource.com/Distribution/sonarqube/sonarqube-7.3.zip
$ unzip sonarqube-7.3.zip  //若提示unzip命令找不到，用yum -y <span class="token function">install</span> unzip安装即可
$ <span class="token function">mv</span> sonarqube-7.3 sonarqube 
$ <span class="token function">mv</span> sonarqube /usr/local/
<span class="token comment" spellcheck="true"># chown -R sonar:sonar /usr/local/sonarqube</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="配置sonar"><a href="#配置sonar" class="headerlink" title="配置sonar"></a>配置sonar</h2><pre class="line-numbers language-bash"><code class="language-bash">$ vim /usr/local/sonarqube/conf/sonar.properties<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>如图设置以下选项</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/46/56cfe2c33866ab48ab8c9bdd402acc.jpg" alt=""></p><h2 id="启动sonar"><a href="#启动sonar" class="headerlink" title="启动sonar"></a>启动sonar</h2><pre class="line-numbers language-bash"><code class="language-bash">$ /usr/local/sonarqube/bin/linux-x86-64/sonar.sh start<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>成功启动后，访问本地 <a href="http://IP:9000，SonarQube">http://IP:9000，SonarQube</a> 初始管理员账号为 admin，默认密码为 admin，登录后可修改密码。</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/25/5b9f14a21cdaf024ea8b3ce551dd7a.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/83/71e7da548917e52b08eb37f385e000.jpg" alt=""></p><p><strong>Note:</strong><br>如果遇到Sonar启动不起来，查看日志自动关闭的问题，可以采用以下方法解决</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># echo -e "vm.max_map_count=262144" >> /etc/sysctl.conf</span>
<span class="token comment" spellcheck="true"># sysctl -p</span>
<span class="token comment" spellcheck="true"># echo -e "sonar hard nofile 65536" >> /etc/security/limits.conf </span>
<span class="token comment" spellcheck="true"># echo -e "sonar soft nofile 65536" >> /etc/security/limits.conf </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>然后注销sonar用户重新以sonar身份登录后再次启动:</p><pre class="line-numbers language-bash"><code class="language-bash">$ /usr/local/sonarqube/bin/linux-x86-64/sonar.sh start<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>插件安装：如果需要下载插件的话，各个版本不一样，如图所示，先点击Administration,再打开Marketplace就可以看到Plugins各种插件了。</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/c6/cef3a943ab5d4347d4af8f3332a196.jpg" alt=""></p><p>SonarQube 支持分析的语言有很多，像Java、Python、Php、C/C++、C#、HTML、JavaScript、PL/SQL、Objective C等20+语言，当我们需要支持分析什么语言时，只需要去插件中心安装对应语言的插件即可，非常方便，可扩展性强，根据自己的需要去选择插件。</p><h2 id="实验验证"><a href="#实验验证" class="headerlink" title="实验验证"></a>实验验证</h2><blockquote><p>本次实验验证以Java工程为例</p></blockquote><h3 id="安装配置sonar-scanner"><a href="#安装配置sonar-scanner" class="headerlink" title="安装配置sonar-scanner"></a>安装配置sonar-scanner</h3><ul><li>获取sonar-scanner</li></ul><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># wget https://sonarsource.bintray.com/Distribution/sonar-scanner-cli/sonar-scanner-cli-3.2.0.1227-linux.zip</span>
<span class="token comment" spellcheck="true"># unzip sonar-scanner-cli-3.2.0.1227-linux.zip</span>
<span class="token comment" spellcheck="true"># mv sonar-scanner-3.2.0.1227-linux sonar-scanner</span>
<span class="token comment" spellcheck="true"># mv sonar-scanner /usr/local/</span>
<span class="token comment" spellcheck="true"># chown -R sonar:sonar sonar-scanner</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>配置sonar-scanner环境变量</li></ul><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vim ~/.bashrc</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/40/6ea5e9c0aee37c056f4583b32c048d.jpg" alt=""></p><ul><li>使配置生效</li></ul><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># source ~/.bashrc</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/70/524b2333bbfb3e6a50b77f92eb201d.jpg" alt=""></p><ul><li>检查环境配置是否成功</li></ul><pre class="line-numbers language-bash"><code class="language-bash">$ sonar-scanner -version<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>配置sonar-scanner.properties文件</li></ul><pre class="line-numbers language-bash"><code class="language-bash">$ vim /usr/local/sonar-scanner/conf/sonar-scanner.properties<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/46/849b0c5cac635e91e9efcf07ba5fbd.jpg" alt=""></p><h3 id="验证过程"><a href="#验证过程" class="headerlink" title="验证过程"></a>验证过程</h3><ul><li>添加Java Maven测试工程</li></ul><p>编写测试工程</p><ul><li>添加sonar-project.properties文件</li></ul><p>在工程根目录中添加sonar-project.properties文件，格式如下</p><pre><code>sonar.projectKey=com.geovis         //项目的唯一标识
sonar.projectName=helloworld        //项目的名字
sonar.projectVersion=1.0            //项目的版本
sonar.sources=/root/helloworld/src  //项目的源码目录，多目录以英文逗号分隔</code></pre><p>例如我的项目结构如下</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/6a/e62e31b74ec65b783f21f4d8cda98e.jpg" alt=""></p><p>那么此项目配置文件应为</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/98/4f0aa2e69db09a846cfd6da4a3442f.jpg" alt=""></p><ul><li>代码质量检查<br>设置完后，终端运行<code>sonar-scanner</code>命令，开始项目源代码的分析</li></ul><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/77/64ffb2ce43fdba046811cce438845c.jpg" alt=""></p><ul><li>查看结果<br>命令运行完成之后，访问<a href="http://localhost:9000，输入账号密码即可查看分析结果，如下图">http://localhost:9000，输入账号密码即可查看分析结果，如下图</a></li></ul><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/b4/92864641223d1537b6f4dfa27a6358.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/97/221636aa330d56dea8bb870957f29a.jpg" alt=""></p><h2 id="SonarQube-整合-LDAP-和-CAS-单点登录"><a href="#SonarQube-整合-LDAP-和-CAS-单点登录" class="headerlink" title="SonarQube 整合 LDAP 和 CAS 单点登录"></a>SonarQube 整合 LDAP 和 CAS 单点登录</h2><p><code>SonarQube</code>整合<code>LDAP</code>和<code>CAS</code>单点登录的过程请参考我的另一篇博客<a href="https://blog.iamzhl.top/SonarQube-integrate-with-ldap-and-CAS.html" target="_blank" rel="noopener">SonarQube 整合 LDAP 和 CAS 单点登录</a></p><script>document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });</script></div><hr><div class="reprint" id="reprint-statement"><div class="reprint__author"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-user">文章作者:</i></span> <span class="reprint-info"><a href="https://blog.cloudops.ml" rel="external nofollow noreferrer">套陆</a></span></div><div class="reprint__type"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-link">文章链接:</i></span> <span class="reprint-info"><a href="https://blog.cloudops.ml/posts/3db59fdb/">https://blog.cloudops.ml/posts/3db59fdb/</a></span></div><div class="reprint__notice"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-copyright">版权声明:</i></span> <span class="reprint-info">本博客所有文章除特別声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://blog.cloudops.ml" target="_blank">套陆</a> !</span></div></div><script async defer>document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }</script><div class="tag_share" style="display:block"><div class="post-meta__tag-list" style="display:inline-block"><div class="article-tag"><a href="/tags/SonarQube/"><span class="chip bg-color">SonarQube</span></a> <a href="/tags/sonar-scanner/"><span class="chip bg-color">sonar-scanner</span></a></div></div><div class="post_share" style="zoom:80%;width:fit-content;display:inline-block;float:right;margin:-.15rem 0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/libs/share/css/share.min.css"><div id="article-share"><div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div><script src="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/libs/share/js/social-share.min.js"></script></div></div></div><style>#reward{margin:40px 0;text-align:center}#reward .reward-link{font-size:1.4rem;line-height:38px}#reward .btn-floating:hover{box-shadow:0 6px 12px rgba(0,0,0,.2),0 5px 15px rgba(0,0,0,.2)}#rewardModal{width:320px;height:350px}#rewardModal .reward-title{margin:15px auto;padding-bottom:5px}#rewardModal .modal-content{padding:10px}#rewardModal .close{position:absolute;right:15px;top:15px;color:rgba(0,0,0,.5);font-size:1.3rem;line-height:20px;cursor:pointer}#rewardModal .close:hover{color:#ef5350;transform:scale(1.3);-moz-transform:scale(1.3);-webkit-transform:scale(1.3);-o-transform:scale(1.3)}#rewardModal .reward-tabs{margin:0 auto;width:210px}.reward-tabs .tabs{height:38px;margin:10px auto;padding-left:0}.reward-content ul{padding-left:0!important}.reward-tabs .tabs .tab{height:38px;line-height:38px}.reward-tabs .tab a{color:#fff;background-color:#ccc}.reward-tabs .tab a:hover{background-color:#ccc;color:#fff}.reward-tabs .wechat-tab .active{color:#fff!important;background-color:#22ab38!important}.reward-tabs .alipay-tab .active{color:#fff!important;background-color:#019fe8!important}.reward-tabs .reward-img{width:210px;height:210px}</style><div id="reward"><a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a><div id="rewardModal" class="modal"><div class="modal-content"><a class="close modal-close"><i class="fas fa-times"></i></a><h4 class="reward-title">你的赏识是我前进的动力</h4><div class="reward-content"><div class="reward-tabs"><ul class="tabs row"><li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li><li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li></ul><div id="alipay"><img src="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码"></div><div id="wechat"><img src="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/medias/reward/wechatpay.jpg" class="reward-img" alt="微信打赏二维码"></div></div></div></div></div></div><script>$(function(){$(".tabs").tabs()})</script></div></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/libs/gitalk/gitalk.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/css/my-gitalk.css"><div class="card gitalk-card" data-aos="fade-up"><div class="comment_headling" style="font-size:20px;font-weight:700;position:relative;padding-left:20px;top:15px;padding-bottom:5px"><i class="fas fa-comments fa-fw" aria-hidden="true"></i> <span>评论</span></div><div id="gitalk-container" class="card-content"></div></div><script src="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/libs/gitalk/gitalk.min.js"></script><script>let gitalk = new Gitalk({
        clientID: 'ae84231acb9f9d755d64',
        clientSecret: '999406dd97c504a700abe350a711868e1000fcec',
        repo: 'gittalk',
        owner: 'athlonreg',
        admin: "athlonreg",
        id: '2018-08-20T16-10-59',
        distractionFreeMode: false  // Facebook-like distraction free mode
    });

    gitalk.render('gitalk-container');</script><article id="prenext-posts" class="prev-next articles"><div class="row article-row"><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge left-badge text-color"><i class="fas fa-chevron-left"></i> &nbsp;上一篇</div><div class="card"><a href="/posts/3d8ac6aa/"><div class="card-image"><img src="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/medias/featureimages/13.jpg" class="responsive-img" alt="Jenkins 配置部署"> <span class="card-title">Jenkins 配置部署</span></div></a><div class="card-content article-content"><div class="summary block-with-text">Jenkins 配置部署简介Jenkins是一个开源的、提供友好操作界面的持续集成(CI)工具，起源于Hudson（Hudson是商用的），主要用于持续、自动的构建/测试软件项目、监控外部任务的运行。Jenkins用Java语言编写，可在T</div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i> 2018-08-22</span><span class="publish-author"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/CI/" class="post-category">CI</a></span></div></div><div class="card-action article-tags"><a href="/tags/Jenkins/"><span class="chip bg-color">Jenkins</span></a> <a href="/tags/%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90/"><span class="chip bg-color">持续集成</span></a></div></div></div><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge right-badge text-color">下一篇&nbsp;<i class="fas fa-chevron-right"></i></div><div class="card"><a href="/posts/80c45260/"><div class="card-image"><img src="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/medias/featureimages/20.jpg" class="responsive-img" alt="MantisBT 安装部署过程"> <span class="card-title">MantisBT 安装部署过程</span></div></a><div class="card-content article-content"><div class="summary block-with-text">MantisBT软件安装部署过程简介&nbsp;&nbsp;&nbsp;&nbsp;Mantis是一个基于PHP技术的轻量级的开源缺陷跟踪系统，以Web操作的形式提供项目管理及缺陷跟踪服务。在功能上、实用性上足以满足中小型项目的管理及跟踪。</div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i> 2018-08-18</span><span class="publish-author"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/CI/" class="post-category">CI</a></span></div></div><div class="card-action article-tags"><a href="/tags/MantisBT/"><span class="chip bg-color">MantisBT</span></a> <a href="/tags/Bug%E8%BF%BD%E8%B8%AA/"><span class="chip bg-color">Bug追踪</span></a></div></div></div></div></article></div><script>$("#articleContent").on("copy",function(e){if(void 0!==window.getSelection){var n=window.getSelection();if(!((""+n).length<Number.parseInt("120"))){var t=document.getElementsByTagName("body")[0],o=document.createElement("div");o.style.position="absolute",o.style.left="-99999px",t.appendChild(o),o.appendChild(n.getRangeAt(0).cloneContents()),"PRE"===n.getRangeAt(0).commonAncestorContainer.nodeName&&(o.innerHTML="<pre>"+o.innerHTML+"</pre>");var i=document.location.href;o.innerHTML+='<br />来源: 套陆的博客<br />文章作者: 套陆<br />文章链接: <a href="'+i+'">'+i+"</a><br />本文章著作权归作者所有，任何形式的转载都请注明出处。",n.selectAllChildren(o),window.setTimeout(function(){t.removeChild(o)},200)}}})</script><script src="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/libs/codeBlock/codeBlockFuction.js"></script><script src="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/libs/codeBlock/codeLang.js"></script><script src="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/libs/codeBlock/codeCopy.js"></script><style>code[class*=language-],pre[class*=language-]{white-space:pre!important}</style></div><div id="toc-aside" class="expanded col l3 hide-on-med-and-down"><div class="toc-widget"><div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div><div id="toc-content"></div></div></div></div><div id="floating-toc-btn" class="hide-on-med-and-down"><a class="btn-floating btn-large bg-color"><i class="fas fa-list-ul"></i></a></div><script src="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/libs/tocbot/tocbot.min.js"></script><script>$(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });</script></main><footer class="page-footer bg-color"><div class="container row center-align" style="margin-bottom:0!important"><div class="col s12 m8 l8 copy-right">Copyright&nbsp;&copy; <span id="year">2017</span> <a href="https://blog.cloudops.ml" target="_blank">套陆</a><br>&nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span class="white-color">68.9k</span>&nbsp;字 <span id="busuanzi_container_site_pv" style="display:none">|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv" class="white-color"></span>&nbsp;次</span> <span id="busuanzi_container_site_uv" style="display:none">|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv" class="white-color"></span>&nbsp;人</span><br><br></div><div class="col s12 m4 l4 social-link social-statis"><a href="https://github.com/athlonreg" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50"><i class="fab fa-github"></i></a><a href="mailto:1143991340@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50"><i class="fas fa-envelope-open"></i></a><a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1143991340" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1143991340" data-position="top" data-delay="50"><i class="fab fa-qq"></i></a><a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50"><i class="fas fa-rss"></i></a></div></div></footer><div class="progress-bar"></div><script>$(document).ready(function () { var int = setInterval(fixCount, 50); // 50ms周期检测函数 var pvcountOffset = 193807; // 初始化首次数据 var uvcountOffset = 13776; function fixCount() { if (document.getElementById("busuanzi_container_site_pv").style.display != "none") { $("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html()) + pvcountOffset); clearInterval(int); } if ($("#busuanzi_container_site_pv").css("display") != "none") { $("#busuanzi_value_site_uv").html(parseInt($("#busuanzi_value_site_uv").html()) + uvcountOffset); // 加上初始数据 clearInterval(int); // 停止检测 } } });</script><div id="searchModal" class="modal"><div class="modal-content"><div class="search-header"><span class="title"><i class="fas fa-search"></i> &nbsp;&nbsp;搜索</span> <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字" class="search-input"></div><div id="searchResult"></div></div></div><script src="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/js/search.js"></script><script>$(function(){searchFunc("https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/search.xml","searchInput","searchResult")})</script><div id="backTop" class="top-scroll"><a class="btn-floating btn-large waves-effect waves-light" href="#!"><i class="fas fa-arrow-up"></i></a></div><script src="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/libs/materialize/materialize.min.js"></script><script src="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/libs/masonry/masonry.pkgd.min.js"></script><script src="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/libs/aos/aos.js"></script><script src="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/libs/scrollprogress/scrollProgress.min.js"></script><script src="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/libs/lightGallery/js/lightgallery-all.min.js"></script><script src="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/js/matery.js"></script><script data-ad-client="ca-pub-7406269002228687" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script src="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/libs/others/clicklove.js" async></script><script async src="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/libs/others/busuanzi.pure.mini.js"></script><script color="0,0,255" pointcolor="0,0,255" opacity="0.7" zindex="-1" count="99" src="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/libs/background/canvas-nest.js"></script><script src="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/libs/background/ribbon-dynamic.js" async></script><script src="https://cdn.jsdelivr.net/gh/athlonreg/athlonreg.github.io/libs/instantpage/instantpage.js" type="module"></script></body></html>