<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Openldap æ•°æ®è¿ç§»</title>
      <link href="/posts/f2ee8d2/"/>
      <url>/posts/f2ee8d2/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># slapcat > ldapbak.ldif            // å¯¼å‡º</span><span class="token comment" spellcheck="true"># systemctl stop slapd              // åœæ­¢æœåŠ¡</span><span class="token comment" spellcheck="true"># rm -rf /var/lib/ldap/*            // åˆ é™¤åŸæœ‰æ•°æ®</span><span class="token comment" spellcheck="true"># slapadd -l ldapbak.ldif           // å¯¼å…¥æ•°æ®</span><span class="token comment" spellcheck="true"># chown -R ldap:ldap /var/lib/ldap  // ä¿®å¤æƒé™</span><span class="token comment" spellcheck="true"># systemctl start slapd             // å¯åŠ¨æœåŠ¡</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> openldap </tag>
            
            <tag> æ•°æ®è¿ç§» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CentOS7 Docker é•œåƒä½¿ç”¨ systemd æœåŠ¡</title>
      <link href="/posts/2e815177/"/>
      <url>/posts/2e815177/</url>
      
        <content type="html"><![CDATA[<h1 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h1><pre class="line-numbers language-bash"><code class="language-bash">FROM centos:7ENV container dockerRUN <span class="token punctuation">(</span>cd /lib/systemd/system/sysinit.target.wants/<span class="token punctuation">;</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> *<span class="token punctuation">;</span> <span class="token keyword">do</span> <span class="token punctuation">[</span> <span class="token variable">$i</span> <span class="token operator">==</span> \systemd-tmpfiles-setup.service <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token function">rm</span> -f <span class="token variable">$i</span><span class="token punctuation">;</span> done<span class="token punctuation">)</span><span class="token punctuation">;</span> \<span class="token function">rm</span> -f /lib/systemd/system/multi-user.target.wants/*<span class="token punctuation">;</span>\<span class="token function">rm</span> -f /etc/systemd/system/*.wants/*<span class="token punctuation">;</span>\<span class="token function">rm</span> -f /lib/systemd/system/local-fs.target.wants/*<span class="token punctuation">;</span> \<span class="token function">rm</span> -f /lib/systemd/system/sockets.target.wants/*udev*<span class="token punctuation">;</span> \<span class="token function">rm</span> -f /lib/systemd/system/sockets.target.wants/*initctl*<span class="token punctuation">;</span> \<span class="token function">rm</span> -f /lib/systemd/system/basic.target.wants/*<span class="token punctuation">;</span>\<span class="token function">rm</span> -f /lib/systemd/system/anaconda.target.wants/*<span class="token punctuation">;</span>VOLUME <span class="token punctuation">[</span> <span class="token string">"/sys/fs/cgroup"</span> <span class="token punctuation">]</span>CMD <span class="token punctuation">[</span><span class="token string">"/usr/sbin/init"</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="Build-Command"><a href="#Build-Command" class="headerlink" title="Build Command"></a>Build Command</h1><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># docker build --rm -t zhanghl/centos7.6.1810 /path/of/Dockerfile</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="Example-Apache-Systemd-Service-To-Run"><a href="#Example-Apache-Systemd-Service-To-Run" class="headerlink" title="Example Apache Systemd Service To Run"></a>Example Apache Systemd Service To Run</h1><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># docker run -it -d --privileged -v /sys/fs/cgroup:/sys/fs/cgroup --name centos7 -p 80:80 centos7.6.1810:latest /usr/sbin/init</span><span class="token comment" spellcheck="true"># docker exec -it centos /bin/bash</span>docker<span class="token comment" spellcheck="true"># yum -y install httpd</span>docker<span class="token comment" spellcheck="true"># systemctl start httpd</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
            <tag> centos </tag>
            
            <tag> systemd </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Tomcat SonarQube Gerrit è®¾ç½® systemd æœåŠ¡</title>
      <link href="/posts/e99da1ce/"/>
      <url>/posts/e99da1ce/</url>
      
        <content type="html"><![CDATA[<h2 id="Tomcat"><a href="#Tomcat" class="headerlink" title="Tomcat"></a>Tomcat</h2><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># /usr/lib/systemd/system/tomcat.service</span><span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>Description<span class="token operator">=</span>TomcatAfter<span class="token operator">=</span>network.target<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>Type<span class="token operator">=</span>oneshotExecStart<span class="token operator">=</span>/usr/local/tomcat/bin/startup.shExecStop<span class="token operator">=</span>/usr/local/tomcat/bin/shutdown.shExecReload<span class="token operator">=</span>/bin/kill -s HUP <span class="token variable">$MAINPID</span>RemainAfterExit<span class="token operator">=</span>yes<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>WantedBy<span class="token operator">=</span>multi-user.target<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="SonarQube"><a href="#SonarQube" class="headerlink" title="SonarQube"></a>SonarQube</h2><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># /usr/lib/systemd/system/sonar.service</span><span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>Description<span class="token operator">=</span>SonarQubeAfter<span class="token operator">=</span>network.target<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>Type<span class="token operator">=</span>forkingExecStart<span class="token operator">=</span>/usr/local/sonarqube-7.5/bin/linux-x86-64/sonar.sh startExecStop<span class="token operator">=</span>/usr/local/sonarqube-7.5/bin/linux-x86-64/sonar.sh stopExecReload<span class="token operator">=</span>/usr/local/sonarqube-7.5/bin/linux-x86-64/sonar.sh restartUser<span class="token operator">=</span>sonarGroup<span class="token operator">=</span>sonar<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>WantedBy<span class="token operator">=</span>multi-user.targetAlias<span class="token operator">=</span>sonarqube<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Gerrit-Code-Review"><a href="#Gerrit-Code-Review" class="headerlink" title="Gerrit Code Review"></a>Gerrit Code Review</h2><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># /usr/lib/systemd/system/gerrit.service</span><span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>Description<span class="token operator">=</span>Gerrit Code ReviewAfter<span class="token operator">=</span>network.target httpd.service<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>Type<span class="token operator">=</span>oneshotRemainAfterExit<span class="token operator">=</span>yesExecStart<span class="token operator">=</span>/usr/local/review_site/bin/gerrit.sh startExecStop<span class="token operator">=</span>/usr/local/review_site/bin/gerrit.sh stopExecReload<span class="token operator">=</span>/usr/local/review_site/bin/gerrit.sh restart<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>WantedBy<span class="token operator">=</span>multi-user.target<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> systemd </tag>
            
            <tag> tomcat </tag>
            
            <tag> sonar </tag>
            
            <tag> sonarqube </tag>
            
            <tag> gerrit </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nginx å¼€å¯ç›®å½•æµè§ˆåŠŸèƒ½</title>
      <link href="/posts/76e49441/"/>
      <url>/posts/76e49441/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ç¼–è¾‘ nginx é…ç½®æ–‡ä»¶</p></blockquote><pre class="line-numbers language-bash"><code class="language-bash">vim /etc/nginx/nginx.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>åœ¨ http ä¸‹é¢åŠ å…¥ä»¥ä¸‹é…ç½®</p></blockquote><pre class="line-numbers language-properties"><code class="language-properties"><span class="token attr-name">autoindex</span> <span class="token attr-value">on;</span><span class="token attr-name">autoindex_exact_size</span> <span class="token attr-value">off;</span><span class="token attr-name">autoindex_localtime</span> <span class="token attr-value">on;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><blockquote><p>å®Œæ•´é…ç½®å®ä¾‹</p></blockquote><pre class="line-numbers language-properties"><code class="language-properties"><span class="token comment" spellcheck="true"># For more information on configuration, see:</span><span class="token comment" spellcheck="true">#   * Official English Documentation: http://nginx.org/en/docs/</span><span class="token comment" spellcheck="true">#   * Official Russian Documentation: http://nginx.org/ru/docs/</span><span class="token attr-name">user</span> <span class="token attr-value">nginx;</span><span class="token attr-name">worker_processes</span> <span class="token attr-value">auto;</span><span class="token attr-name">error_log</span> <span class="token attr-value">/var/log/nginx/error.log;</span><span class="token attr-name">pid</span> <span class="token attr-value">/run/nginx.pid;</span><span class="token comment" spellcheck="true"># Load dynamic modules. See /usr/share/nginx/README.dynamic.</span><span class="token attr-name">include</span> <span class="token attr-value">/usr/share/nginx/modules/*.conf;</span><span class="token attr-name">events</span> <span class="token attr-value">{</span><span class="token attr-name">    worker_connections</span> <span class="token attr-value">1024;</span>}<span class="token attr-name">http</span> <span class="token attr-value">{</span><span class="token attr-name">    autoindex</span> <span class="token attr-value">on;</span><span class="token attr-name">    autoindex_exact_size</span> <span class="token attr-value">off;</span><span class="token attr-name">    autoindex_localtime</span> <span class="token attr-value">on;</span><span class="token attr-name">    log_format</span> <span class="token attr-value"> main  '$remote_addr - $remote_user [$time_local] "$request" '</span><span class="token attr-name">                      '$status</span> <span class="token attr-value">$body_bytes_sent "$http_referer" '</span><span class="token attr-name">                      '"$http_user_agent"</span> <span class="token attr-value">"$http_x_forwarded_for"';</span><span class="token attr-name">    access_log</span> <span class="token attr-value"> /var/log/nginx/access.log  main;</span><span class="token attr-name">    sendfile</span> <span class="token attr-value">           on;</span><span class="token attr-name">    tcp_nopush</span> <span class="token attr-value">         on;</span><span class="token attr-name">    tcp_nodelay</span> <span class="token attr-value">        on;</span><span class="token attr-name">    keepalive_timeout</span> <span class="token attr-value">  65;</span><span class="token attr-name">    types_hash_max_size</span> <span class="token attr-value">2048;</span><span class="token attr-name">    include</span> <span class="token attr-value">            /etc/nginx/mime.types;</span><span class="token attr-name">    default_type</span> <span class="token attr-value">       application/octet-stream;</span><span class="token comment" spellcheck="true">    # Load modular configuration files from the /etc/nginx/conf.d directory.</span><span class="token comment" spellcheck="true">    # See http://nginx.org/en/docs/ngx_core_module.html#include</span><span class="token comment" spellcheck="true">    # for more information.</span><span class="token attr-name">    include</span> <span class="token attr-value">/etc/nginx/conf.d/*.conf;</span><span class="token attr-name">    server</span> <span class="token attr-value">{</span><span class="token attr-name">        listen</span> <span class="token attr-value">      81 default_server;</span><span class="token attr-name">        listen</span> <span class="token attr-value">      [::]:81 default_server;</span><span class="token attr-name">        server_name</span> <span class="token attr-value"> _;</span><span class="token attr-name">        root</span> <span class="token attr-value">        /usr/share/nginx/html;</span><span class="token comment" spellcheck="true">        # Load configuration files for the default server block.</span><span class="token attr-name">        include</span> <span class="token attr-value">/etc/nginx/default.d/*.conf;</span><span class="token attr-name">        location</span> <span class="token attr-value">/ {</span>        }<span class="token attr-name">        error_page</span> <span class="token attr-value">404 /404.html;</span><span class="token attr-name">            location</span> <span class="token punctuation">=</span> <span class="token attr-value">/40x.html {</span>        }<span class="token attr-name">        error_page</span> <span class="token attr-value">500 502 503 504 /50x.html;</span><span class="token attr-name">            location</span> <span class="token punctuation">=</span> <span class="token attr-value">/50x.html {</span>        }    }<span class="token comment" spellcheck="true"># Settings for a TLS enabled server.</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true">#    server {</span><span class="token comment" spellcheck="true">#        listen       443 ssl http2 default_server;</span><span class="token comment" spellcheck="true">#        listen       [::]:443 ssl http2 default_server;</span><span class="token comment" spellcheck="true">#        server_name  _;</span><span class="token comment" spellcheck="true">#        root         /usr/share/nginx/html;</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true">#        ssl_certificate "/etc/pki/nginx/server.crt";</span><span class="token comment" spellcheck="true">#        ssl_certificate_key "/etc/pki/nginx/private/server.key";</span><span class="token comment" spellcheck="true">#        ssl_session_cache shared:SSL:1m;</span><span class="token comment" spellcheck="true">#        ssl_session_timeout  10m;</span><span class="token comment" spellcheck="true">#        ssl_ciphers HIGH:!aNULL:!MD5;</span><span class="token comment" spellcheck="true">#        ssl_prefer_server_ciphers on;</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true">#        # Load configuration files for the default server block.</span><span class="token comment" spellcheck="true">#        include /etc/nginx/default.d/*.conf;</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true">#        location / {</span><span class="token comment" spellcheck="true">#        }</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true">#        error_page 404 /404.html;</span><span class="token comment" spellcheck="true">#            location = /40x.html {</span><span class="token comment" spellcheck="true">#        }</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true">#        error_page 500 502 503 504 /50x.html;</span><span class="token comment" spellcheck="true">#            location = /50x.html {</span><span class="token comment" spellcheck="true">#        }</span><span class="token comment" spellcheck="true">#    }</span>}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> nginx </tag>
            
            <tag> ç›®å½•æµè§ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¿®å¤ Hexo å¾®åšå›¾åºŠå›¾ç‰‡é“¾æ¥å¤±æ•ˆé—®é¢˜</title>
      <link href="/posts/5b49af5f/"/>
      <url>/posts/5b49af5f/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ä¿®æ”¹ä¸»é¢˜ head æ–‡ä»¶</p></blockquote><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vim /Users/canvas/athlonreg/themes/next/layout/_partials/head/head.swig</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>æ·»åŠ å¦‚ä¸‹è¡Œ</p></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>referrer<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>no-referrer<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>å¦‚å›¾æ‰€ç¤º</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006yd6wMly1g4dszk5a0mj31eo0gegq3.jpg" alt=""></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Hackintosh </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å›¾åºŠ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æŸ¥çœ‹å½“å‰ç³»ç»Ÿæ˜¯è™šæ‹Ÿæœºè¿˜æ˜¯å®ä½“æœº</title>
      <link href="/posts/87e03a7e/"/>
      <url>/posts/87e03a7e/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash"><code class="language-bash">dmidecode -s system-product-name<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>è®¾ç½® postgresql é€šè¿‡å¯†ç ç™»å½•</title>
      <link href="/posts/370d1eee/"/>
      <url>/posts/370d1eee/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ä¿®æ”¹æ–‡ä»¶ pg_hba.conf</p></blockquote><pre class="line-numbers language-properties"><code class="language-properties"><span class="token attr-name">local</span> <span class="token attr-value">all all md5</span><span class="token attr-name">host</span> <span class="token attr-value"> all all 127.0.0.1/32 md5</span><span class="token attr-name">host</span> <span class="token attr-value">all all 192.168.45.0/32 md5</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> postgresql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CentOS éƒ¨ç½²é…ç½® Redmine</title>
      <link href="/posts/3dd29769/"/>
      <url>/posts/3dd29769/</url>
      
        <content type="html"><![CDATA[<h2 id="å®‰è£…-Ruby-2-4"><a href="#å®‰è£…-Ruby-2-4" class="headerlink" title="å®‰è£… Ruby 2.4"></a>å®‰è£… Ruby 2.4</h2><pre class="line-numbers language-bash"><code class="language-bash">yum <span class="token function">install</span> -y gcc-c++ patch readline readline-devel zlib zlib-devel libyaml-devel libffi-devel openssl-devel <span class="token function">make</span> <span class="token function">bzip2</span> autoconf automake libtool bison ImageMagick-devel  ImageMagickyum -y <span class="token function">install</span> centos-release-scl-rhyum -y <span class="token function">install</span> rh-ruby24 scl <span class="token function">enable</span> rh-ruby24 <span class="token function">bash</span>ruby -v yum -y <span class="token function">install</span> rh-ruby24-rubygems rh-ruby24-ruby-develgem <span class="token function">source</span> -lgem sources -a http://mirrors.aliyun.com/rubygems/gem sources --remove  https://rubygems.org/gem <span class="token function">source</span> -ugem <span class="token function">source</span> -l <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="è®¾ç½®æ•°æ®åº“"><a href="#è®¾ç½®æ•°æ®åº“" class="headerlink" title="è®¾ç½®æ•°æ®åº“"></a>è®¾ç½®æ•°æ®åº“</h2><blockquote><p>å»ºç«‹ç›¸åº”æ•°æ®åº“</p></blockquote><pre class="line-numbers language-mysql"><code class="language-mysql">mysql> create user 'redmine'@'%' identified by '123456' ;mysql> create database redmine;mysql> grant all on redmine.* to 'redmine'@'%';mysql> flush privileges;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å®‰è£…-redmine"><a href="#å®‰è£…-redmine" class="headerlink" title="å®‰è£… redmine"></a>å®‰è£… redmine</h2><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">cd</span> /usr/local<span class="token function">wget</span> https://www.redmine.org/releases/redmine-4.0.4.tar.gz<span class="token function">tar</span> zxvf redmine-4.0.4.tar.gz<span class="token function">mv</span> redmine-4.0.4 redmine<span class="token keyword">echo</span> <span class="token string">"export REDMINE=/usr/local/redmine"</span> <span class="token operator">>></span> /etc/profile<span class="token function">source</span> /etc/profile<span class="token function">cd</span> <span class="token variable">$REDMINE</span><span class="token function">cp</span> config/database.yml.example config/database.yml<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>é…ç½® redmineï¼Œä¿®æ”¹ $REDMINE/config/database.yml</p></blockquote><pre class="line-numbers language-yaml"><code class="language-yaml"><span class="token key atrule">production</span><span class="token punctuation">:</span>  <span class="token key atrule">adapter</span><span class="token punctuation">:</span> mysql2  <span class="token key atrule">database</span><span class="token punctuation">:</span> redmine  <span class="token key atrule">host</span><span class="token punctuation">:</span> localhost  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">3306</span>  <span class="token key atrule">username</span><span class="token punctuation">:</span> redmine  <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token string">"123456"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å®‰è£…-GEMS-ä¾èµ–"><a href="#å®‰è£…-GEMS-ä¾èµ–" class="headerlink" title="å®‰è£… GEMS ä¾èµ–"></a>å®‰è£… GEMS ä¾èµ–</h2><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">cd</span> <span class="token variable">$REDMINE</span>gem <span class="token function">install</span> bundlerbundle <span class="token function">install</span> --without development <span class="token function">test</span> production <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="ç”Ÿæˆä¼šè¯å­˜å‚¨ç§˜é’¥ä»¤ç‰Œ"><a href="#ç”Ÿæˆä¼šè¯å­˜å‚¨ç§˜é’¥ä»¤ç‰Œ" class="headerlink" title="ç”Ÿæˆä¼šè¯å­˜å‚¨ç§˜é’¥ä»¤ç‰Œ"></a>ç”Ÿæˆä¼šè¯å­˜å‚¨ç§˜é’¥ä»¤ç‰Œ</h2><pre class="line-numbers language-bash"><code class="language-bash">bundle <span class="token function">exec</span> rake generate_secret_token<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç”Ÿæˆæ•°æ®åº“ç»“æ„"><a href="#ç”Ÿæˆæ•°æ®åº“ç»“æ„" class="headerlink" title="ç”Ÿæˆæ•°æ®åº“ç»“æ„"></a>ç”Ÿæˆæ•°æ®åº“ç»“æ„</h2><pre class="line-numbers language-bash"><code class="language-bash">RAILS_ENV<span class="token operator">=</span>production REDMINE_LANG<span class="token operator">=</span>zh bundle <span class="token function">exec</span> rake db:migrate<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="æ•°æ®åº“æ’å…¥é»˜è®¤æ•°æ®"><a href="#æ•°æ®åº“æ’å…¥é»˜è®¤æ•°æ®" class="headerlink" title="æ•°æ®åº“æ’å…¥é»˜è®¤æ•°æ®"></a>æ•°æ®åº“æ’å…¥é»˜è®¤æ•°æ®</h2><pre class="line-numbers language-bash"><code class="language-bash">RAILS_ENV<span class="token operator">=</span>production REDMINE_LANG<span class="token operator">=</span>zh bundle <span class="token function">exec</span> rake redmine:load_default_data<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="å¯åŠ¨-redmine"><a href="#å¯åŠ¨-redmine" class="headerlink" title="å¯åŠ¨ redmine"></a>å¯åŠ¨ redmine</h2><pre class="line-numbers language-bash"><code class="language-bash">bundle <span class="token function">exec</span> rails server webrick -e production -b 127.0.0.1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="é…ç½®-LDAP-è®¤è¯"><a href="#é…ç½®-LDAP-è®¤è¯" class="headerlink" title="é…ç½® LDAP è®¤è¯"></a>é…ç½® LDAP è®¤è¯</h2><blockquote><p>ä¾æ¬¡æ‰“å¼€ ç®¡ç† -&gt; LDAP è®¤è¯ -&gt; æ–°å»ºè®¤è¯æ¨¡å¼</p></blockquote><p>é…ç½®ä¸€ä¸ª ou=admin çš„é…ç½®å¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/20190705161009.png" alt=""></p><p>åŒæ ·çš„æ–¹æ³•é…ç½®æ‰€éœ€è¦çš„æ‰€æœ‰ ouï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/20190705161320.png" alt=""></p><h2 id="é…ç½®-CAS-SSO"><a href="#é…ç½®-CAS-SSO" class="headerlink" title="é…ç½® CAS SSO"></a>é…ç½® CAS SSO</h2><blockquote><p>å®‰è£…æ’ä»¶</p></blockquote><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">cd</span> <span class="token variable">$REDMINE</span>/plugins<span class="token function">git</span> clone https://github.com/athlonreg/redmine_omniauth_cas<span class="token function">cd</span> redmine_omniauth_casbundle <span class="token function">install</span><span class="token function">cd</span> <span class="token variable">$REDMINE</span>bundle <span class="token function">install</span>RAILS_ENV<span class="token operator">=</span>production rake redmine:pluginsbundle <span class="token function">exec</span> rails server webrick -e production -b 127.0.0.1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>ä¾æ¬¡æ‰“å¼€ ç®¡ç† -&gt; æ’ä»¶ï¼Œç‚¹å‡»æ’ä»¶ Redmine Omniauth plugin åçš„é…ç½®</p></blockquote><p>é…ç½®å¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/20190705162003.png" alt=""></p><blockquote><p>å„å­—æ®µå«ä¹‰å¯¹ç…§è¡¨</p></blockquote><table><thead><tr><th>å­—æ®µåç§°</th><th>å­—æ®µå«ä¹‰</th></tr></thead><tbody><tr><td>Enable CAS authentication</td><td>æ˜¯å¦å¯ç”¨ CAS è®¤è¯</td></tr><tr><td>CAS server URL</td><td>CAS æœåŠ¡å™¨åœ°å€</td></tr><tr><td>CAS validation URL (if different)</td><td>CAS æœåŠ¡å™¨èº«ä»½éªŒè¯æ¥å£åœ°å€</td></tr><tr><td>Login page text</td><td>ç™»é™†é¡µé¢æ ‡é¢˜</td></tr><tr><td>Replace Redmine login page</td><td>æ˜¯å¦ä½¿ç”¨ CAS æœåŠ¡å™¨çš„ç™»é™†ç•Œé¢æ›¿æ¢æ’ä»¶æä¾›çš„ç™»å½•ç•Œé¢</td></tr></tbody></table><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redmine </tag>
            
            <tag> é¡¹ç›®ç®¡ç† </tag>
            
            <tag> æ•æ·å¼€å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CentOS å®‰è£…é…ç½® GitLab</title>
      <link href="/posts/35bb9d15/"/>
      <url>/posts/35bb9d15/</url>
      
        <content type="html"><![CDATA[<h2 id="CentOS-å®‰è£…-GitLab"><a href="#CentOS-å®‰è£…-GitLab" class="headerlink" title="CentOS å®‰è£… GitLab"></a>CentOS å®‰è£… GitLab</h2><h2 id="å®‰è£…ä¾èµ–"><a href="#å®‰è£…ä¾èµ–" class="headerlink" title="å®‰è£…ä¾èµ–"></a>å®‰è£…ä¾èµ–</h2><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># yum -y install curl</span><span class="token comment" spellcheck="true"># yum -y install postfix</span><span class="token comment" spellcheck="true"># systemctl start postfix</span><span class="token comment" spellcheck="true"># systemctl enable postfix</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä¸‹è½½-GitLab-çš„-RPM-åŒ…"><a href="#ä¸‹è½½-GitLab-çš„-RPM-åŒ…" class="headerlink" title="ä¸‹è½½ GitLab çš„ RPM åŒ…"></a>ä¸‹è½½ GitLab çš„ RPM åŒ…</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># wget https://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/yum/el7/gitlab-ce-11.7.0-ce.0.el7.x86_64.rpm</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨<a href="https://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/yum/el7/" target="_blank" rel="noopener">https://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/yum/el7/</a>æ‰¾è‡ªå·±éœ€è¦çš„ç‰ˆæœ¬ï¼Œä¸‹è½½åˆ°æœ¬åœ°ï¼Œç„¶åå®‰è£…å³å¯</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># rpm -ivh  gitlab-ce-11.7.0-ce.0.el7.x86_64.rpm</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¹Ÿå¯ä»¥è¿™æ ·</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># yum localinstall gitlab-ce-11.7.0-ce.0.el7.x86_64.rpm</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="é…ç½®-gitlab-repo"><a href="#é…ç½®-gitlab-repo" class="headerlink" title="é…ç½® gitlab repo"></a>é…ç½® gitlab repo</h2><p>ä¸ºäº†åç»­å‡çº§æ–¹ä¾¿ï¼Œå»ºè®®æ·»åŠ <code>gitlab</code>çš„<code>repo</code>æº</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># curl -sS https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.rpm.sh | sh</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç«¯å£ä¿®æ”¹"><a href="#ç«¯å£ä¿®æ”¹" class="headerlink" title="ç«¯å£ä¿®æ”¹"></a>ç«¯å£ä¿®æ”¹</h2><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi /etc/gitlab/gitlab.rb</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¿®æ”¹ä¸‹é¢çš„å±æ€§</p><pre class="line-numbers language-properties"><code class="language-properties"><span class="token attr-name">external_url</span> <span class="token attr-value">'http://devops.iamzhl.top:8090'</span><span class="token attr-name">unicorn['port']</span> <span class="token punctuation">=</span> <span class="token attr-value">8070</span><span class="token attr-name">nginx['listen_port']</span> <span class="token punctuation">=</span> <span class="token attr-value">8090</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><em>è¯·æ ¹æ®ä¸ªäººéœ€è¦è¿›è¡Œå®šåˆ¶</em></p><h2 id="é‡æ–°éƒ¨ç½²å¹¶é‡å¯"><a href="#é‡æ–°éƒ¨ç½²å¹¶é‡å¯" class="headerlink" title="é‡æ–°éƒ¨ç½²å¹¶é‡å¯"></a>é‡æ–°éƒ¨ç½²å¹¶é‡å¯</h2><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># gitlab-ctl reconfigure</span><span class="token comment" spellcheck="true"># gitlab-ctl restart</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="è®¾ç½®é¡µé¢åµŒå¥—æ”¯æŒ"><a href="#è®¾ç½®é¡µé¢åµŒå¥—æ”¯æŒ" class="headerlink" title="è®¾ç½®é¡µé¢åµŒå¥—æ”¯æŒ"></a>è®¾ç½®é¡µé¢åµŒå¥—æ”¯æŒ</h2><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi /var/opt/gitlab/nginx/conf/gitlab-http.conf</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fzqr3dsb7gj31p818kgzc.jpg" alt=""></p><p>å¦‚å›¾ï¼Œæ·»åŠ æ ‡æ³¨çš„å±æ€§è®¾ç½®åé‡å¯<code>GitLab</code></p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># gitlab-ctl restart</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GitLab </tag>
            
            <tag> frame </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é«˜æ•ˆåˆ©ç”¨æœ‰é“äº‘ç¬”è®°</title>
      <link href="/posts/e7c2bc73/"/>
      <url>/posts/e7c2bc73/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…ˆè¯´å‡ ä¸ªåšä¸»å’Œå…¶ä»–çš„ç å­—å†œæ°‘å·¥æ¯”è¾ƒå¤´ç–¼çš„é—®é¢˜</p><ul><li>äº‘åŒæ­¥</li></ul><p>ç°åœ¨æ˜¯äº‘çš„æ—¶ä»£ï¼Œæ²¡æœ‰äº‘åŒæ­¥çš„ç æ–‡ç¯å¢ƒä¸æ˜¯ä¸€ä¸ªå¥½çš„ç¯å¢ƒï¼Œå¯èƒ½æ¯ä¸ªäººéƒ½æœ‰ä¸æ­¢ä¸€ä¸ªç æ–‡å¹³å°ï¼Œæ¯”å¦‚å·¥ä½œé…çš„æœºå™¨å’Œç§äººçš„æœºå™¨ï¼Œæˆ‘åœ¨å…¶ä¸­ä¸€å°æœºå™¨å†™å¥½çš„æ–‡ç« è¿˜è¦å†å†™ä¸€ä»½åˆ°å¦å¤–çš„æœºå™¨ã€‚ã€‚ã€‚ç®€ç›´ä¸è¦å¤ªlowerã€‚å¯èƒ½æœ‰äººè¯´æˆ‘ä»¬ç”¨æŸåº¦ç½‘ç›˜ã€‚ã€‚ã€‚Whatâ€™s thatï¼Ÿå·²ç»æ”¾å¼ƒå¥½ä¹…ï¼Œæœ¬æ–‡ä¸åšèµ˜è¿°ï¼Œæƒ³ç”¨çš„å°±ç”¨å§ã€‚ã€‚ã€‚</p><ul><li>è·¨å¹³å°</li></ul><p>è¿™é‡Œå‡è®¾ä¸Šé¢çš„ç¯å¢ƒæˆç«‹ï¼Œä½ æœ‰ä¸¤å°æœºå™¨ï¼Œç§äººçš„æ˜¯Macç¯å¢ƒï¼Œå·¥ä½œæœºå™¨æ˜¯Windowsï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œä¹‹å‰æˆ‘åœ¨Macéå¸¸å–œæ¬¢MWebï¼Œå› ä¸ºå®ƒçš„å›¾åºŠé›†æˆè®©æˆ‘ç€è¿· ï¼Œæˆªå›¾ç²˜è´´ä¸€å¼ å¼•ç”¨å¤–é“¾çš„å›¾ç‰‡å°±è¿™ä¹ˆå®Œæˆäº†ï¼Œå°±æ˜¯è¿™ä¹ˆå¿«ï¼Œä½†æ˜¯ç°åœ¨ä¹Ÿå·²ç»æ”¾å¼ƒäº†ï¼Œå› ä¸ºWindowså¹³å°äººå®¶ä¸åšï¼Œä¸è¦é—®æˆ‘ä¸ºä»€ä¹ˆï¼Œæˆ‘ä¸æƒ³å–·Windowså¤ªåƒåœ¾ğŸŒğŸŒä½†æ˜¯æ— å¥ˆå•ä½åªæœ‰Windowsï¼Œäºæ˜¯æˆ‘è¦ç”¨ä¸¤å¥—ç¯å¢ƒã€‚ã€‚ã€‚è®°ä½ä¸¤å¥—å¿«æ·é”®ã€‚ã€‚ã€‚</p><ul><li>MarkDown</li></ul><p>å…³äºMarkDownçš„ä»‹ç»è¿™é‡Œä¸èµ˜è¿°ã€‚äºæˆ‘è€Œè¨€ï¼Œä¸æ”¯æŒMarkDownè§£æçš„ç¼–è¾‘å™¨ï¼Œæˆ‘æ˜¯ç»å¯¹ä¸ä¼šç”¨çš„ï¼ŒWordå°±å·¥ä½œç”¨ç”¨ã€‚ã€‚ã€‚ä¸ºä½•å‘¢ï¼Ÿå› ä¸ºMarkDownå¤ªä¼˜é›…äº†ï¼Œåœ¨æˆ‘çœ‹æ¥ï¼ŒWordå’ŒMarkDownå°±åƒ50å²çš„å¤§å¦ˆå’Œ20å²çš„å¦™é¾„å°‘å¥³ï¼Œå†™æ–‡æ¡£å‘åšæ–‡ç”¨Wordç®€ç›´æ˜¯é­ç½ªï¼Œç”¨MarkDownç®€ç›´æ˜¯äº«å—ï¼Œå½“ç„¶å•¦ï¼Œçº¯å±ä¸ªäººçœ‹æ³•ï¼Œä¸å–œå‹¿å–·ã€‚ã€‚ã€‚</p><ul><li>å›¾åºŠ</li></ul><p>è¯´å®Œäº†MarkDownå’Œäº‘çš„é—®é¢˜ï¼Œæœ‰ä¸€ä¸ªé—®é¢˜å¾ˆæ˜æ˜¾ï¼Œäº‘ä¸Šçš„æ•°æ®æ–‡å­—å¯ä»¥ï¼Œå›¾ç‰‡ç”šè‡³è§†é¢‘æ€ä¹ˆåŠï¼Ÿéš¾é“æˆ‘è¿˜è¦ä¹°ä¸ªäº‘å­˜å‚¨ç”šè‡³æ˜¯äº‘æœåŠ¡å™¨ï¼Ÿå½“ç„¶ä¸ç”¨å•¦ï¼å›½å†…æœ‰äº›å¤§å…¬å¸è¿˜æ˜¯ç›¸å½“è‰¯å¿ƒçš„ï¼Œå…ˆç¥ç§˜ä¸€ä¸‹ï¼Œå…·ä½“ç”¨ä»€ä¹ˆï¼Œä¸‹é¢è¯¦ç»†è¯´ğŸ˜„</p><h2 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h2><ul><li>ç¼–è¾‘å™¨<ul><li><a href="https://www.typora.io" target="_blank" rel="noopener">Typora</a></li></ul></li><li>æˆªå›¾å·¥å…·<ul><li>Windowsï¼š<a href="https://snip.qq.com" target="_blank" rel="noopener">Snip</a></li><li>macOSï¼š<a href="https://zh.xnipapp.com" target="_blank" rel="noopener">Xnip</a></li></ul></li><li>å›¾åºŠ<ul><li>Sina Weoboè´¦å·(Sinaçš„å¾®åšå¹³å°æä¾›äº†ä¸€ä¸ªå›¾åºŠæœåŠ¡ï¼Œè‡ªå¸¦cdn)</li><li><a href="https://github.com/Molunerfinn/PicGo/releases" target="_blank" rel="noopener">PicGo</a></li></ul></li><li>äº‘åŒæ­¥<ul><li><a href="http://note.youdao.com" target="_blank" rel="noopener">æœ‰é“äº‘ç¬”è®°</a></li></ul></li></ul><h2 id="é…ç½®PicGo"><a href="#é…ç½®PicGo" class="headerlink" title="é…ç½®PicGo"></a>é…ç½®PicGo</h2><p>å…¶ä»–çš„éƒ½æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œè¯´ä¸€ä¸‹PicGoçš„é…ç½®å§ï¼é¦–å…ˆåœ¨æ–°æµªå¾®åšå®˜ç½‘ç™»å½•å¾®åšè´¦å·ï¼Œç„¶åæ‰“å¼€<a href="https://weibo.com/minipublish" target="_blank" rel="noopener">minipublish</a>é¡µé¢ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fzde3dq3hvj326w1e047w.jpg" alt=""></p><p>ç„¶åæ‰“å¼€è°ƒè¯•çª—å£ï¼Œ<code>Chrome</code>å¿«æ·é”®ä¸º<code>F12</code>ï¼Œç„¶åè°ƒåˆ°ç½‘ç»œé€‰é¡¹å¡ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fzde59wlkyj326w1e0gzx.jpg" alt=""></p><p>ç‚¹å‡»<code>minipublish</code>ï¼ŒæŸ¥çœ‹ä¸€ä¸‹Cookieå€¼å¦‚ä¸‹å›¾æ‰€ç¤º</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fzde6i4je7j326w1e0tpj.jpg" alt=""></p><p>é€‰ä¸­Cookieåé¢é‚£ä¸€ä¸²å­—ç¬¦ï¼Œæ‹·è´ä¸€ä¸‹ï¼Œæ‰“å¼€<code>PicGo</code>çª—å£ï¼Œæ‰¾åˆ°å›¾åºŠè®¾ç½® -&gt; æ–°æµªå›¾åºŠï¼Œåœ¨Cookieåé¢çš„è¾“å…¥æ¡†ç²˜è´´åˆšæ‰çš„å­—ç¬¦ä¸²ï¼Œå‹¾é€‰cookieæ¨¡å¼ï¼Œç‚¹å‡»ç¡®å®š -&gt; è®¾ä¸ºé»˜è®¤å›¾åºŠï¼Œå¦‚ä¸‹å›¾</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fzde7rnurvj31eo0v847r.jpg" alt=""></p><p>è¿™æ—¶å€™ï¼Œç”¨å‰æ–‡æ‰€è¯´çš„æˆªå›¾å·¥å…·æˆ–è€…è‡ªå·±å–œæ¬¢çš„å·¥å…·æˆªå›¾ï¼Œç„¶åæŒ‰ä¸‹åˆšåˆšè®¾ç½®çš„å¿«æ·é”®ï¼Œå›¾ç‰‡å°±ä¼šä¸Šä¼ åˆ°æ–°æµªå¾®åšçš„å›¾åºŠæœåŠ¡å™¨ï¼Œç„¶åå°†å›¾ç‰‡çš„å¤–é“¾è¿”å›ç»™å‰ªè´´æ¿äº†ã€‚</p><p>åœ¨æœ‰é“äº‘éšä¾¿å»ºä¸€ä¸ªMarkDownæ–‡æ¡£ï¼Œç²˜è´´ä¸€ä¸‹ï¼Œå¦‚å›¾</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fzdem32mcej320w1e0nep.jpg" alt=""></p><p>æ–‡æ¡£ä¿å­˜åï¼Œæœ‰é“äº‘ç¬”è®°ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬è¿›è¡Œäº‘åŒæ­¥ï¼Œä»æ­¤ä¸å¿…æ‹…å¿ƒå…¶3Gçš„ç©ºé—´ä¸å¤Ÿç”¨äº†ã€‚</p><p>å½“ç„¶å•¦ï¼Œå¿«æ·é”®æ ¹æ®ä¸ªäººä¹ æƒ¯åœ¨PicGoè®¾ç½®é‡Œé¢è‡ªè¡Œå®šä¹‰å§ã€‚</p><p><strong><em>æ–°æµªå›¾åºŠåŠ å…¥äº†é˜²ç›—é“¾ï¼Œè§£å†³æ–¹æ³•å°±æ˜¯åœ¨ header å¤„åŠ å…¥ä¸‹é¢çš„æ ‡ç­¾ï¼Œä½†æ˜¯å¯èƒ½ä¼šå½±å“å…¶ä»–çš„ç»„ä»¶ï¼Œæ¯”å¦‚çœ‹æ¿å¨˜ï¼Œå› æ­¤å¯ä»¥é€‰æ‹©å…¶ä»–å¹³å°ï¼Œæ¯”å¦‚ GitHubï¼Œé…åˆ delivr çš„ cdn åŠ é€Ÿï¼Œæ•ˆæœä¹Ÿæ˜¯éå¸¸ä¸é”™ã€‚</em></strong></p><pre class="line-numbers language-css"><code class="language-css">&lt;meta name=â€referrerâ€ content=â€no-referrerâ€œ><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Study </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å›¾åºŠ </tag>
            
            <tag> æœ‰é“äº‘ç¬”è®° </tag>
            
            <tag> Picbed </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TestLink æ•´åˆ LDAP å’Œ CAS å•ç‚¹ç™»å½•</title>
      <link href="/posts/7873bd56/"/>
      <url>/posts/7873bd56/</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯ä»‹ç»"><a href="#èƒŒæ™¯ä»‹ç»" class="headerlink" title="èƒŒæ™¯ä»‹ç»"></a>èƒŒæ™¯ä»‹ç»</h2><ul><li>TestLink ç‰ˆæœ¬ï¼š2.18</li><li>TestLink URLï¼š<a href="http://devops.iamzhl.top/testlink" target="_blank" rel="noopener">http://devops.iamzhl.top/testlink</a></li><li>openLDAP æœåŠ¡ï¼šldap://devops.iamzhl.top:389</li><li>CAS æœåŠ¡ï¼š<a href="http://devops.iamzhl.top:8080/cas" target="_blank" rel="noopener">http://devops.iamzhl.top:8080/cas</a></li></ul><h2 id="æ•´åˆ-LDAP"><a href="#æ•´åˆ-LDAP" class="headerlink" title="æ•´åˆ LDAP"></a>æ•´åˆ LDAP</h2><h3 id="ä¿®æ”¹TestLinké…ç½®æ–‡ä»¶"><a href="#ä¿®æ”¹TestLinké…ç½®æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹TestLinké…ç½®æ–‡ä»¶"></a>ä¿®æ”¹<code>TestLink</code>é…ç½®æ–‡ä»¶</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi /var/www/html/testlink/custom_config.inc.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>æ·»åŠ <code>LDAP</code>é…ç½®æ–‡ä»¶</p></blockquote><pre class="line-numbers language-php"><code class="language-php"><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'method'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'LDAP'</span><span class="token punctuation">;</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'ldap'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'ldap'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'ldap_server'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'devops.iamzhl.top'</span><span class="token punctuation">;</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'ldap'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'ldap_port'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'389'</span><span class="token punctuation">;</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'ldap'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'ldap_version'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'3'</span><span class="token punctuation">;</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'ldap'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'ldap_root_dn'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'dc=iamzhl,dc=top'</span><span class="token punctuation">;</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'ldap'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'ldap_bind_dn'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'cn=Manager,dc=iamzhl,dc=top'</span><span class="token punctuation">;</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'ldap'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'ldap_bind_passwd'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'123456'</span><span class="token punctuation">;</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'ldap'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'ldap_tls'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'ldap'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'ldap_organization'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'ldap'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'ldap_uid_field'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'uid'</span><span class="token punctuation">;</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'ldap'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'ldap_email_field'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'mail'</span><span class="token punctuation">;</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'ldap'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'ldap_firstname_field'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'givenname'</span><span class="token punctuation">;</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'ldap'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'ldap_surname_field'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'sn'</span><span class="token punctuation">;</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'ldap_automatic_user_creation'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'ldap_email_field'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'mail'</span><span class="token punctuation">;</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'ldap_firstname_field'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'givenname'</span><span class="token punctuation">;</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'ldap_surname_field'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'sn'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><blockquote><p>æ‰“å¼€<code>TestLink</code>ç½‘å€<code>http://devops.iamzhl.top/testlink</code></p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fxvp6j1abej328s1f8qb2.jpg" alt=""></p><p>å¦‚å›¾ï¼Œæ­£å¸¸è·³è½¬åˆ°<code>TestLink</code>ç™»å½•ç•Œé¢ï¼Œè¾“å…¥<code>LDAP</code>æœåŠ¡å™¨ä¸­çš„ç”¨æˆ·åå¯†ç åç‚¹å‡»<code>Log in</code></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fxvuh6h46uj328s1f8k01.jpg" alt=""></p><p>å¦‚å›¾æ‰€ç¤ºï¼Œç™»é™†æˆåŠŸåæ­£å¸¸çš„è·å–åˆ°äº†ç”¨æˆ·åï¼Œç‚¹å‡»å·¦ä¸Šè§’çš„ç™»å‡ºæŒ‰é’®ï¼Œæ­£å¸¸é€€å‡ºåè·³è½¬åˆ°äº†<code>TestLink</code>çš„ç™»å½•ç•Œé¢</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fxvuj3kqkjj328s1f8gtv.jpg" alt=""></p><p>è‡³æ­¤ï¼Œ<code>TestLink</code>æ•´åˆ<code>LDAP</code>å®Œæˆã€‚</p><h2 id="æ•´åˆCASå•ç‚¹ç™»å½•"><a href="#æ•´åˆCASå•ç‚¹ç™»å½•" class="headerlink" title="æ•´åˆCASå•ç‚¹ç™»å½•"></a>æ•´åˆ<code>CAS</code>å•ç‚¹ç™»å½•</h2><h3 id="æ·»åŠ ä¾èµ–çš„phpCASåº“æ–‡ä»¶"><a href="#æ·»åŠ ä¾èµ–çš„phpCASåº“æ–‡ä»¶" class="headerlink" title="æ·»åŠ ä¾èµ–çš„phpCASåº“æ–‡ä»¶"></a>æ·»åŠ ä¾èµ–çš„<code>phpCAS</code>åº“æ–‡ä»¶</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># wget https://github.com/apereo/phpCAS/archive/1.3.6.tar.gz</span><span class="token comment" spellcheck="true"># mv 1.3.6.tar.gz phpCAS-1.3.6.tar.gz</span><span class="token comment" spellcheck="true"># tar zxvf phpCAS-1.3.6.tar.gz</span><span class="token comment" spellcheck="true"># chown -R apache:apache phpCAS-1.3.6</span><span class="token comment" spellcheck="true"># cp -arf phpCAS-1.3.6/source/CAS.php /var/www/html/testlink/lib/functions/</span><span class="token comment" spellcheck="true"># cp -arf phpCAS-1.3.6/source/CAS /var/www/html/testlink/lib/functions/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä¿®æ”¹TestLinké…ç½®æ–‡ä»¶-1"><a href="#ä¿®æ”¹TestLinké…ç½®æ–‡ä»¶-1" class="headerlink" title="ä¿®æ”¹TestLinké…ç½®æ–‡ä»¶"></a>ä¿®æ”¹<code>TestLink</code>é…ç½®æ–‡ä»¶</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi /var/www/html/testlink/custom_config.inc.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>æ·»åŠ <code>CAS</code>é…ç½®é¡¹</p></blockquote><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">/** CAS server parameters */</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'cas_enable'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'cas_server_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'devops.iamzhl.top'</span><span class="token punctuation">;</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'cas_server_port'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">8080</span><span class="token punctuation">;</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'cas_server_path'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'cas'</span><span class="token punctuation">;</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'cas_debug_enable'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'cas_debug_file'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'/var/logs/testlink/phpCAS.log'</span><span class="token punctuation">;</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'cas_server_protocol'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'2.0'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä¿®æ”¹ç™»å½•ç•Œé¢"><a href="#ä¿®æ”¹ç™»å½•ç•Œé¢" class="headerlink" title="ä¿®æ”¹ç™»å½•ç•Œé¢"></a>ä¿®æ”¹ç™»å½•ç•Œé¢</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi /var/www/html/testlink/login.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>åœ¨<code>switch($args-&gt;action)</code>åˆ†æ”¯é€‰æ‹©è¯­å¥æ®µå†…æ‰¾åˆ°<code>case 'loginform'</code>éƒ¨åˆ†ï¼Œæ·»åŠ <code>CAS</code>çš„è®¤è¯</p></blockquote><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">switch</span><span class="token punctuation">(</span><span class="token variable">$args</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">case</span> <span class="token string">'doLogin'</span><span class="token punctuation">:</span>  <span class="token keyword">case</span> <span class="token string">'ajaxlogin'</span><span class="token punctuation">:</span>    <span class="token function">doSessionStart</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// When doing ajax login we need to skip control regarding session already open</span>    <span class="token comment" spellcheck="true">// that we use when doing normal login.</span>    <span class="token comment" spellcheck="true">// If we do not proceed this way we will enter an infinite loop</span>    <span class="token variable">$options</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">'doSessionExistsCheck'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span><span class="token variable">$args</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">action</span><span class="token operator">==</span><span class="token string">'doLogin'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$op</span> <span class="token operator">=</span> <span class="token function">doAuthorize</span><span class="token punctuation">(</span><span class="token variable">$db</span><span class="token punctuation">,</span><span class="token variable">$args</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">login</span><span class="token punctuation">,</span><span class="token variable">$args</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">pwd</span><span class="token punctuation">,</span><span class="token variable">$options</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$doAuthPostProcess</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token variable">$gui</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">draw</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>  <span class="token keyword">break</span><span class="token punctuation">;</span>  <span class="token keyword">case</span> <span class="token string">'ajaxcheck'</span><span class="token punctuation">:</span>    <span class="token function">processAjaxCheck</span><span class="token punctuation">(</span><span class="token variable">$db</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">break</span><span class="token punctuation">;</span>  <span class="token keyword">case</span> <span class="token string">'oauth'</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true">//If code is empty then break</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">renderLoginScreen</span><span class="token punctuation">(</span><span class="token variable">$gui</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//Switch between oauth providers</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">include_once</span><span class="token punctuation">(</span><span class="token string">'lib/functions/oauth_providers/'</span><span class="token punctuation">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'oauth'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token string">'.php'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"Oauth client doesn't exist"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token variable">$oau</span> <span class="token operator">=</span> <span class="token function">config_get</span><span class="token punctuation">(</span><span class="token string">'OAuthServers'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$oau</span> <span class="token keyword">as</span> <span class="token variable">$oprov</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span><span class="token variable">$oprov</span><span class="token punctuation">[</span><span class="token string">'oauth_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'oauth'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$oauth_params</span> <span class="token operator">=</span> <span class="token variable">$oprov</span><span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token variable">$user_token</span> <span class="token operator">=</span> <span class="token function">oauth_get_token</span><span class="token punctuation">(</span><span class="token variable">$oauth_params</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user_token</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">status</span><span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span> <span class="token operator">==</span> tl<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">OK</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token function">doSessionStart</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token variable">$op</span> <span class="token operator">=</span> <span class="token function">doAuthorize</span><span class="token punctuation">(</span><span class="token variable">$db</span><span class="token punctuation">,</span><span class="token variable">$user_token</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">options</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">user</span><span class="token punctuation">,</span><span class="token string">'oauth'</span><span class="token punctuation">,</span><span class="token variable">$user_token</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">options</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token variable">$doAuthPostProcess</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token variable">$gui</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">note</span> <span class="token operator">=</span> <span class="token variable">$user_token</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">status</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token function">renderLoginScreen</span><span class="token punctuation">(</span><span class="token variable">$gui</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token keyword">break</span><span class="token punctuation">;</span>  <span class="token keyword">case</span> <span class="token string">'loginform'</span><span class="token punctuation">:</span>      <span class="token comment" spellcheck="true">//zhanghl start</span>      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$authCfg</span><span class="token punctuation">[</span><span class="token string">'cas_enable'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>           <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$authCfg</span><span class="token punctuation">[</span><span class="token string">'cas_debug_enable'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>       <span class="token punctuation">{</span>          phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">setDebug</span><span class="token punctuation">(</span><span class="token variable">$authCfg</span><span class="token punctuation">[</span><span class="token string">'cas_debug_file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">}</span>       <span class="token comment" spellcheck="true">// Initialize phpCAS</span>       phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">client</span><span class="token punctuation">(</span><span class="token variable">$authCfg</span><span class="token punctuation">[</span><span class="token string">'cas_server_protocol'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$authCfg</span><span class="token punctuation">[</span><span class="token string">'cas_server_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$authCfg</span><span class="token punctuation">[</span><span class="token string">'cas_server_port'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$authCfg</span><span class="token punctuation">[</span><span class="token string">'cas_server_path'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true">// For production use set the CA certificate that is the issuer of the cert</span>       <span class="token comment" spellcheck="true">// on the CAS server and uncomment the line below</span>       <span class="token comment" spellcheck="true">// phpCAS::setCasServerCACert($cas_server_ca_cert_path);</span>       <span class="token comment" spellcheck="true">// For quick testing you can disable SSL validation of the CAS server.</span>       <span class="token comment" spellcheck="true">// THIS SETTING IS NOT RECOMMENDED FOR PRODUCTION.</span>       <span class="token comment" spellcheck="true">// VALIDATING THE CAS SERVER IS CRUCIAL TO THE SECURITY OF THE CAS PROTOCOL!</span>       phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">setNoCasServerValidation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true">// Override the validation url for any (ST and PT) CAS 2.0 validation</span>       <span class="token comment" spellcheck="true">//phpCAS::setServerProxyValidateURL('http://devops.iamzhl.top:8080/cas/proxyValidate');</span>       <span class="token comment" spellcheck="true">// Override the validation url for any CAS 1.0 validation</span>       <span class="token comment" spellcheck="true">//phpCAS::setServerServiceValidateURL('http://devops.iamzhl.top:8080/cas/serviceValidate');</span>       phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">handleLogoutRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">forceAuthentication</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token variable">$options</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">'doSessionExistsCheck'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span><span class="token variable">$args</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">action</span><span class="token operator">==</span><span class="token string">'doLogin'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token variable">$op</span> <span class="token operator">=</span> <span class="token function">doCASAuthorize</span><span class="token punctuation">(</span><span class="token variable">$db</span><span class="token punctuation">,</span><span class="token variable">$options</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token variable">$doAuthPostProcess</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span> <span class="token punctuation">{</span>      <span class="token comment" spellcheck="true">//zhanghl end</span>        <span class="token variable">$doRenderLoginScreen</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token variable">$gui</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">draw</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token variable">$op</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// unfortunatelly we use $args->note in order to do some logic.</span>        <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token variable">$args</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">note</span><span class="token operator">=</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$args</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">note</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">""</span> <span class="token punctuation">)</span>        <span class="token punctuation">{</span>          <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token variable">$gui</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authCfg</span><span class="token punctuation">[</span><span class="token string">'SSO_enabled'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span>          <span class="token punctuation">{</span>            <span class="token function">doSessionStart</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$doAuthPostProcess</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token variable">$gui</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authCfg</span><span class="token punctuation">[</span><span class="token string">'SSO_method'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>             <span class="token punctuation">{</span>              <span class="token keyword">case</span> <span class="token string">'CLIENT_CERTIFICATE'</span><span class="token punctuation">:</span>                <span class="token variable">$op</span> <span class="token operator">=</span> <span class="token function">doSSOClientCertificate</span><span class="token punctuation">(</span><span class="token variable">$db</span><span class="token punctuation">,</span><span class="token variable">$_SERVER</span><span class="token punctuation">,</span><span class="token variable">$gui</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authCfg</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token keyword">break</span><span class="token punctuation">;</span>              <span class="token keyword">case</span> <span class="token string">'WEBSERVER_VAR'</span><span class="token punctuation">:</span>                <span class="token comment" spellcheck="true">//DEBUGsyslogOnCloud('Trying to execute SSO using SAML');</span>                <span class="token variable">$op</span> <span class="token operator">=</span> <span class="token function">doSSOWebServerVar</span><span class="token punctuation">(</span><span class="token variable">$db</span><span class="token punctuation">,</span><span class="token variable">$gui</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authCfg</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>          <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//zhanghl start</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//zhanghl end</span>  <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>åœ¨<code>init_gui</code>å‡½æ•°å†…æ‰¾åˆ°<code>switch($args-&gt;note)</code>åˆ†æ”¯è¯­å¥ï¼Œåœ¨<code>expired</code>åˆ†æ”¯ä¸‹æ·»åŠ ä¸€è¡Œé‡å®šå‘è°ƒç”¨</p></blockquote><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">switch</span><span class="token punctuation">(</span><span class="token variable">$args</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">note</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">case</span> <span class="token string">'expired'</span><span class="token punctuation">:</span>      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>      <span class="token function">session_unset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">session_destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token variable">$gui</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">note</span> <span class="token operator">=</span> <span class="token function">lang_get</span><span class="token punctuation">(</span><span class="token string">'session_expired'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token variable">$gui</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">reqURI</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">// æ·»åŠ é‡å®šå‘è°ƒç”¨</span>      <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token constant">TL_BASE_HREF</span> <span class="token punctuation">.</span><span class="token string">"login.php?destination="</span><span class="token punctuation">.</span><span class="token variable">$args</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">destination</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token keyword">case</span> <span class="token string">'first'</span><span class="token punctuation">:</span>      <span class="token variable">$gui</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">note</span> <span class="token operator">=</span> <span class="token function">lang_get</span><span class="token punctuation">(</span><span class="token string">'your_first_login'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token variable">$gui</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">reqURI</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token keyword">case</span> <span class="token string">'lost'</span><span class="token punctuation">:</span>      <span class="token variable">$gui</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">note</span> <span class="token operator">=</span> <span class="token function">lang_get</span><span class="token punctuation">(</span><span class="token string">'passwd_lost'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token variable">$gui</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">reqURI</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token keyword">default</span><span class="token punctuation">:</span>      <span class="token variable">$gui</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">note</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>    <span class="token keyword">break</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä¿®æ”¹ç™»å‡ºç•Œé¢"><a href="#ä¿®æ”¹ç™»å‡ºç•Œé¢" class="headerlink" title="ä¿®æ”¹ç™»å‡ºç•Œé¢"></a>ä¿®æ”¹ç™»å‡ºç•Œé¢</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># /var/www/html/testlink/logout.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>åœ¨<code>$authCfg = config_get('authentication');</code>è¯­å¥ä¹‹åæ·»åŠ <code>CAS</code>çš„ç™»å‡ºå¤„ç†</p></blockquote><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$authCfg</span><span class="token punctuation">[</span><span class="token string">'cas_enable'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$authCfg</span><span class="token punctuation">[</span><span class="token string">'cas_debug_enable'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>   <span class="token punctuation">{</span>      phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">setDebug</span><span class="token punctuation">(</span><span class="token variable">$authCfg</span><span class="token punctuation">[</span><span class="token string">'cas_debug_file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">}</span>   <span class="token comment" spellcheck="true">// Initialize phpCAS</span>   phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">client</span><span class="token punctuation">(</span><span class="token variable">$authCfg</span><span class="token punctuation">[</span><span class="token string">'cas_server_protocol'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$authCfg</span><span class="token punctuation">[</span><span class="token string">'cas_server_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$authCfg</span><span class="token punctuation">[</span><span class="token string">'cas_server_port'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$authCfg</span><span class="token punctuation">[</span><span class="token string">'cas_server_path'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">"login.php?note=logout"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä¿®æ”¹common-phpå…¨å±€å¼•ç”¨æ–‡ä»¶"><a href="#ä¿®æ”¹common-phpå…¨å±€å¼•ç”¨æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹common.phpå…¨å±€å¼•ç”¨æ–‡ä»¶"></a>ä¿®æ”¹<code>common.php</code>å…¨å±€å¼•ç”¨æ–‡ä»¶</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi /var/www/html/testlink/lib/functions/common.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>åœ¨<code>require_once('tlsmarty.inc.php');</code>å¼•ç”¨çš„å‰é¢å¢åŠ å¯¹<code>CAS</code>çš„å¼•ç”¨</p></blockquote><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">/** TestLink CAS Authentication Ref */</span><span class="token variable">$authCfg</span> <span class="token operator">=</span> <span class="token function">config_get</span><span class="token punctuation">(</span><span class="token string">'authentication'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$authCfg</span><span class="token punctuation">[</span><span class="token string">'cas_enable'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   <span class="token comment" spellcheck="true">// Load the CAS lib</span>   <span class="token keyword">require_once</span> <span class="token string">'CAS.php'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fxvnthnmyaj31p818kn8o.jpg" alt=""></p><h3 id="ä¿®æ”¹è®¤è¯å‡½æ•°"><a href="#ä¿®æ”¹è®¤è¯å‡½æ•°" class="headerlink" title="ä¿®æ”¹è®¤è¯å‡½æ•°"></a>ä¿®æ”¹è®¤è¯å‡½æ•°</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi /var/www/html/testlink/lib/functions/doAuthorize.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>åœ¨å¼€å¤´<code>require_once</code>è¯­å¥çš„åé¢æ·»åŠ <code>CAS</code>è®¤è¯å‡½æ•°</p></blockquote><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">// zhanghl start</span><span class="token keyword">function</span> <span class="token function">doCASAuthorize</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$db</span><span class="token punctuation">,</span><span class="token variable">$options</span><span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   <span class="token keyword">global</span> <span class="token variable">$g_tlLogger</span><span class="token punctuation">;</span>   <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">'status'</span> <span class="token operator">=</span><span class="token operator">></span> tl<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">ERROR</span><span class="token punctuation">,</span> <span class="token string">'msg'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">tlUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">login</span> <span class="token operator">=</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'phpCAS'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token variable">$login_exists</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">readFromDB</span><span class="token punctuation">(</span><span class="token variable">$db</span><span class="token punctuation">,</span>tlUser<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">USER_O_SEARCH_BYLOGIN</span><span class="token punctuation">)</span> <span class="token operator">>=</span> tl<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">OK</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$login_exists</span><span class="token punctuation">)</span>   <span class="token punctuation">{</span>      <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">tlUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">login</span> <span class="token operator">=</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'phpCAS'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">isActive</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>      <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span> <span class="token operator">=</span> <span class="token string">'LDAP'</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// force for auth_does_password_match</span>      <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">login</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// write password on DB anyway</span>   <span class="token punctuation">}</span>   <span class="token comment" spellcheck="true">//$user->emailAddress = $_SESSION['phpCAS']['attributes']['mail'];</span>   <span class="token comment" spellcheck="true">//$user->firstName = $_SESSION['phpCAS']['attributes']['sn'];</span>   <span class="token comment" spellcheck="true">//$user->lastName = $_SESSION['phpCAS']['attributes']['givenName'];</span>   <span class="token variable">$doLogin</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">writeToDB</span><span class="token punctuation">(</span><span class="token variable">$db</span><span class="token punctuation">)</span> <span class="token operator">==</span> tl<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">OK</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token variable">$doLogin</span> <span class="token punctuation">)</span>   <span class="token punctuation">{</span>      <span class="token comment" spellcheck="true">// Need to do set COOKIE following Mantis model</span>      <span class="token variable">$auth_cookie_name</span> <span class="token operator">=</span> <span class="token function">config_get</span><span class="token punctuation">(</span><span class="token string">'auth_cookie'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token variable">$expireOnBrowserClose</span><span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>      <span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token variable">$auth_cookie_name</span><span class="token punctuation">,</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">getSecurityCookie</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token variable">$expireOnBrowserClose</span><span class="token punctuation">,</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">// Disallow two sessions within one browser</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'currentUser'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">is_null</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'currentUser'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>      <span class="token punctuation">{</span>         <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">lang_get</span><span class="token punctuation">(</span><span class="token string">'login_msg_session_exists1'</span><span class="token punctuation">)</span> <span class="token punctuation">.</span>            <span class="token string">' &lt;a style="color:white;" href="logout.php">'</span> <span class="token punctuation">.</span>            <span class="token function">lang_get</span><span class="token punctuation">(</span><span class="token string">'logout_link'</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token string">'&lt;/a>'</span> <span class="token punctuation">.</span> <span class="token function">lang_get</span><span class="token punctuation">(</span><span class="token string">'login_msg_session_exists2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>      <span class="token keyword">else</span>      <span class="token punctuation">{</span>         <span class="token comment" spellcheck="true">// Setting user's session information</span>         <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'currentUser'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$user</span><span class="token punctuation">;</span>         <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'lastActivity'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token variable">$g_tlLogger</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">endTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token variable">$g_tlLogger</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">startTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token function">setUserSession</span><span class="token punctuation">(</span><span class="token variable">$db</span><span class="token punctuation">,</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">login</span><span class="token punctuation">,</span> <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">dbID</span><span class="token punctuation">,</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">globalRoleID</span><span class="token punctuation">,</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">emailAddress</span><span class="token punctuation">,</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">locale</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span> <span class="token operator">=</span> tl<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">OK</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>   <span class="token punctuation">}</span>   <span class="token keyword">return</span> <span class="token variable">$result</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// zhanghl end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä¿®æ”¹å…¨å±€é…ç½®æ–‡ä»¶-å¯é€‰"><a href="#ä¿®æ”¹å…¨å±€é…ç½®æ–‡ä»¶-å¯é€‰" class="headerlink" title="ä¿®æ”¹å…¨å±€é…ç½®æ–‡ä»¶ (å¯é€‰)"></a>ä¿®æ”¹å…¨å±€é…ç½®æ–‡ä»¶ (å¯é€‰)</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi /var/www/html/testlink/config.inc.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>å¢åŠ <code>CAS</code>è®¤è¯å±æ€§</p></blockquote><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">/** CAS server properties */</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'cas_enable'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'cas_server_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'cas_server_port'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">8080</span><span class="token punctuation">;</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'cas_server_path'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'cas'</span><span class="token punctuation">;</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'cas_debug_enable'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'cas_debug_file'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span><span class="token variable">$tlCfg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">authentication</span><span class="token punctuation">[</span><span class="token string">'cas_server_protocol'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong><em>Noteï¼šæ­¤é€‰é¡¹ç”¨ä»¥è®¾ç½®é»˜è®¤å±æ€§å€¼ï¼Œä¸»è¦ç”¨æ¥æ—¥åæŸ¥é˜…ï¼Œå¯ä»¥ä¸å†™ï¼Œ<code>/var/www/html/testlink/custom_config.inc.php</code>æ–‡ä»¶ç›¸åŒçš„å±æ€§é…ç½®ä¼šè¦†ç›–ç”Ÿæ•ˆã€‚</em></strong></p><h3 id="ä¿®æ”¹CASçš„Client-phpå¯ç”¨httpè¿æ¥-æ ¹æ®ä¸ªäººCASæœåŠ¡å™¨æ¥å®š"><a href="#ä¿®æ”¹CASçš„Client-phpå¯ç”¨httpè¿æ¥-æ ¹æ®ä¸ªäººCASæœåŠ¡å™¨æ¥å®š" class="headerlink" title="ä¿®æ”¹CASçš„Client.phpå¯ç”¨httpè¿æ¥(æ ¹æ®ä¸ªäººCASæœåŠ¡å™¨æ¥å®š)"></a>ä¿®æ”¹<code>CAS</code>çš„<code>Client.php</code>å¯ç”¨<code>http</code>è¿æ¥(æ ¹æ®ä¸ªäºº<code>CAS</code>æœåŠ¡å™¨æ¥å®š)</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi /var/www/html/testlink/lib/functions/CAS/Client.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>å°†å¦‚ä¸‹å‡ ä¸ªå‡½æ•°ä¸­çš„<code>https</code>æ”¹ä¸º<code>http</code>å³å¯</p></blockquote><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">_getServerBaseURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// the URL is build only when needed</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_server</span><span class="token punctuation">[</span><span class="token string">'base_url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// $this->_server['base_url'] = 'https://' . $this->_getServerHostname();</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_server</span><span class="token punctuation">[</span><span class="token string">'base_url'</span><span class="token punctuation">]</span> <span class="token operator">=</span> 'http<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//' . $this->_getServerHostname();</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">_getServerPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">443</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_server</span><span class="token punctuation">[</span><span class="token string">'base_url'</span><span class="token punctuation">]</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token string">':'</span>                <span class="token punctuation">.</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">_getServerPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_server</span><span class="token punctuation">[</span><span class="token string">'base_url'</span><span class="token punctuation">]</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">_getServerURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_server</span><span class="token punctuation">[</span><span class="token string">'base_url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">_getCallbackURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// the URL is built when needed only</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_callback_url</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$final_uri</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// remove the ticket if present in the URL</span>        <span class="token comment" spellcheck="true">// $final_uri = 'https://';</span>        <span class="token variable">$final_uri</span> <span class="token operator">=</span> 'http<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//';</span>        <span class="token variable">$final_uri</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">_getClientUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$request_uri</span> <span class="token operator">=</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'REQUEST_URI'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$request_uri</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string">'/\?.*$/'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token variable">$request_uri</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$final_uri</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token variable">$request_uri</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_callback_url</span> <span class="token operator">=</span> <span class="token variable">$final_uri</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_callback_url</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">traceBegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// the URL is built when needed only</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_url</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$final_uri</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// remove the ticket if present in the URL</span>        <span class="token comment" spellcheck="true">// $final_uri = ($this->_isHttps()) ? 'https' : 'http';</span>        <span class="token variable">$final_uri</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">_isHttps</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">'http'</span> <span class="token punctuation">:</span> <span class="token string">'http'</span><span class="token punctuation">;</span>        <span class="token variable">$final_uri</span> <span class="token punctuation">.</span><span class="token operator">=</span> '<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//';</span>        <span class="token variable">$final_uri</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">_getClientUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$request_uri</span>    <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string">'?'</span><span class="token punctuation">,</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'REQUEST_URI'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$final_uri</span>        <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token variable">$request_uri</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$request_uri</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$request_uri</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$query_string</span><span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">_removeParameterFromQueryString</span><span class="token punctuation">(</span><span class="token string">'ticket'</span><span class="token punctuation">,</span> <span class="token variable">$request_uri</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// If the query string still has anything left,</span>            <span class="token comment" spellcheck="true">// append it to the final URI</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$query_string</span> <span class="token operator">!==</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token variable">$final_uri</span>    <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token string">"?$query_string"</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">trace</span><span class="token punctuation">(</span><span class="token string">"Final URI: $final_uri"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">setURL</span><span class="token punctuation">(</span><span class="token variable">$final_uri</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">traceEnd</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_url</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æµ‹è¯•-1"><a href="#æµ‹è¯•-1" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><blockquote><p>æ–°å»º<code>debug</code>è°ƒè¯•ç›®å½•</p></blockquote><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># mkdir /var/log/testlink</span><span class="token comment" spellcheck="true"># chown -R apache:apache /var/log/testlink</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p>æ‰“å¼€<code>TestLink</code>ç½‘å€<code>http://devops.iamzhl.top/testlink</code></p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fxvougi1woj32221fcdv4.jpg" alt=""></p><p>å¦‚å›¾æ‰€ç¤ºï¼Œæ­£å¸¸è·³è½¬åˆ°<code>CAS</code>çš„ç™»å½•ç•Œé¢ï¼Œåœ°å€å˜æˆäº†<code>http://devops.iamzhl.top:8080/cas/login?service=http%3A%2F%2Fdevops.iamzhl.top%2Ftestlink%2Flogin.php</code>ï¼Œè¾“å…¥ç”¨æˆ·åå¯†ç åç‚¹å‡»ç™»å½•</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fxvuh6h46uj328s1f8k01.jpg" alt=""></p><p>å¦‚å›¾ç™»é™†æˆåŠŸåæ­£å¸¸è·å–ç”¨æˆ·åï¼Œç‚¹å‡»å·¦ä¸Šè§’çš„ç™»å‡ºæŒ‰é’®åï¼Œæ­£å¸¸é€€å‡ºåˆ°<code>CAS</code>ç™»å‡ºé¡µé¢</p><p>![image-20181205173735167](/Users/canvas/Library/Application Support/typora-user-images/image-20181205173735167.png)</p><p>è‡³æ­¤ï¼Œ<code>TestLink</code>æ•´åˆ<code>CAS</code>å•ç‚¹ç™»å½•å®Œæˆã€‚</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> CI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CAS </tag>
            
            <tag> LDAP </tag>
            
            <tag> TestLink </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MantisBT æ•´åˆ LDAP å’Œ CAS å•ç‚¹ç™»å½•</title>
      <link href="/posts/4b6afd89/"/>
      <url>/posts/4b6afd89/</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯ä»‹ç»"><a href="#èƒŒæ™¯ä»‹ç»" class="headerlink" title="èƒŒæ™¯ä»‹ç»"></a>èƒŒæ™¯ä»‹ç»</h2><ul><li>MantisBT ç‰ˆæœ¬ï¼š2.18</li><li>Mantis URLï¼š<a href="http://devops.iamzhl.top/mantis" target="_blank" rel="noopener">http://devops.iamzhl.top/mantis</a></li><li>openLDAP æœåŠ¡ï¼šldap://devops.iamzhl.top:389</li><li>CAS æœåŠ¡ï¼š<a href="http://devops.iamzhl.top:8080/cas" target="_blank" rel="noopener">http://devops.iamzhl.top:8080/cas</a></li></ul><h2 id="æ•´åˆ-LDAP"><a href="#æ•´åˆ-LDAP" class="headerlink" title="æ•´åˆ LDAP"></a>æ•´åˆ LDAP</h2><h3 id="ä¿®æ”¹MantisBTé…ç½®æ–‡ä»¶"><a href="#ä¿®æ”¹MantisBTé…ç½®æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹MantisBTé…ç½®æ–‡ä»¶"></a>ä¿®æ”¹<code>MantisBT</code>é…ç½®æ–‡ä»¶</h3><blockquote><p>æ·»åŠ ä»¥ä¸‹é…ç½®é¡¹</p></blockquote><pre class="line-numbers language-php"><code class="language-php"><span class="token shell-comment comment"># MantisBT Authentication and LDAP Settings #</span><span class="token variable">$g_login_method</span> <span class="token operator">=</span> <span class="token constant">LDAP</span><span class="token punctuation">;</span><span class="token variable">$g_reauthentication</span> <span class="token operator">=</span> <span class="token constant">ON</span><span class="token punctuation">;</span><span class="token variable">$g_reauthentication_expiry</span> <span class="token operator">=</span> <span class="token constant">TOKEN_EXPIRY_AUTHENTICATED</span><span class="token punctuation">;</span><span class="token variable">$g_ldap_server</span> <span class="token operator">=</span> 'ldap<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//devops.iamzhl.top:389';</span><span class="token variable">$g_ldap_root_dn</span> <span class="token operator">=</span> <span class="token string">'ou=People,dc=iamzhl,dc=top'</span><span class="token punctuation">;</span><span class="token variable">$g_ldap_protocol_version</span> <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span><span class="token variable">$g_ldap_organization</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span><span class="token variable">$g_ldap_bind_dn</span> <span class="token operator">=</span> <span class="token string">'cn=Manager,dc=iamzhl,dc=top'</span><span class="token punctuation">;</span><span class="token variable">$g_ldap_bind_passwd</span> <span class="token operator">=</span> <span class="token string">'123456'</span><span class="token punctuation">;</span><span class="token variable">$g_ldap_uid_field</span> <span class="token operator">=</span> <span class="token string">'uid'</span><span class="token punctuation">;</span><span class="token variable">$g_ldap_realname_field</span> <span class="token operator">=</span> <span class="token string">'cn'</span><span class="token punctuation">;</span><span class="token variable">$g_use_ldap_realname</span> <span class="token operator">=</span> <span class="token constant">ON</span><span class="token punctuation">;</span><span class="token variable">$g_use_ldap_email</span> <span class="token operator">=</span> <span class="token constant">ON</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰“å¼€<code>MantisBT</code>ç½‘å€ï¼Œè¾“å…¥ç”¨æˆ·åå¯†ç ç‚¹å‡»ç™»å½•</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/dd/a754582a7218fd2860d31fb543c667.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/07/158dfd797dce0fa01335dd8d9b5085.jpg" alt=""></p><p>ç™»é™†æˆåŠŸåï¼Œæ­£å¸¸è·å–ç”¨æˆ·å</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/5d/e2fd0f937861208615ce61fae90423.jpg" alt=""></p><p>ç‚¹å‡»å³ä¸Šè§’çš„ç”¨æˆ·å -&gt; æ³¨é”€ï¼Œä¼šæ­£å¸¸é€€å‡ºå¹¶è·³è½¬åˆ°ç™»å½•ç•Œé¢</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/5e/e198803ba7693b67b5e6c5fc075ab5.jpg" alt=""></p><p>è‡³æ­¤ï¼Œ<code>MantisBT</code>æ•´åˆ<code>LDAP</code>å®Œæˆã€‚</p><h2 id="æ•´åˆ-CAS-å•ç‚¹ç™»å½•"><a href="#æ•´åˆ-CAS-å•ç‚¹ç™»å½•" class="headerlink" title="æ•´åˆ CAS å•ç‚¹ç™»å½•"></a>æ•´åˆ CAS å•ç‚¹ç™»å½•</h2><h3 id="ä¸‹è½½phpCASæ”¾åˆ°MantisBTä¸‹"><a href="#ä¸‹è½½phpCASæ”¾åˆ°MantisBTä¸‹" class="headerlink" title="ä¸‹è½½phpCASæ”¾åˆ°MantisBTä¸‹"></a>ä¸‹è½½<code>phpCAS</code>æ”¾åˆ°<code>MantisBT</code>ä¸‹</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># wget https://github.com/apereo/phpCAS/archive/1.3.6.tar.gz</span><span class="token comment" spellcheck="true"># mv 1.3.6.tar.gz phpCAS-1.3.6.tar.gz</span><span class="token comment" spellcheck="true"># tar zxvf phpCAS-1.3.6.tar.gz</span><span class="token comment" spellcheck="true"># chown -R apache:apache phpCAS-1.3.6</span><span class="token comment" spellcheck="true"># cp -arf phpCAS-1.3.6 /var/www/html/mantis/phpCAS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä¿®æ”¹MantisBTé…ç½®æ–‡ä»¶-1"><a href="#ä¿®æ”¹MantisBTé…ç½®æ–‡ä»¶-1" class="headerlink" title="ä¿®æ”¹MantisBTé…ç½®æ–‡ä»¶"></a>ä¿®æ”¹<code>MantisBT</code>é…ç½®æ–‡ä»¶</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi /var/www/html/mantis/config/config_inc.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>æ·»åŠ <code>CAS</code>è®¤è¯éœ€è¦çš„å˜é‡(è¯·æŒ‰ç…§è‡ªå·±çš„<code>LDAP</code>æœåŠ¡å™¨è¿›è¡Œä¿®æ”¹)</p></blockquote><pre class="line-numbers language-php"><code class="language-php"><span class="token shell-comment comment"># MantisBT Authentication With CAS Settings #</span><span class="token variable">$g_login_method</span> <span class="token operator">=</span> <span class="token constant">CAS</span><span class="token punctuation">;</span><span class="token variable">$g_cas_server</span> <span class="token operator">=</span> <span class="token string">'devops.iamzhl.top'</span><span class="token punctuation">;</span><span class="token variable">$g_cas_port</span> <span class="token operator">=</span> <span class="token number">8080</span><span class="token punctuation">;</span><span class="token variable">$g_cas_uri</span> <span class="token operator">=</span> <span class="token string">'/cas'</span><span class="token punctuation">;</span><span class="token variable">$g_cas_validate</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span><span class="token variable">$g_cas_version</span> <span class="token operator">=</span> <span class="token string">'2.0'</span><span class="token punctuation">;</span><span class="token variable">$g_cas_debug</span> <span class="token operator">=</span> <span class="token string">'/var/www/html/mantis/cas.log'</span><span class="token punctuation">;</span><span class="token variable">$g_cas_saml_attributes</span> <span class="token operator">=</span> <span class="token constant">OFF</span><span class="token punctuation">;</span><span class="token variable">$g_cas_saml_map</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span> <span class="token string">'name'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token string">'mail'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token string">''</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$g_cas_use_ldap</span> <span class="token operator">=</span> <span class="token constant">ON</span><span class="token punctuation">;</span><span class="token variable">$g_ldap_mantis_uid</span>  <span class="token operator">=</span> <span class="token string">'uid'</span><span class="token punctuation">;</span><span class="token variable">$g_cas_ldap_update</span>  <span class="token operator">=</span> <span class="token constant">OFF</span><span class="token punctuation">;</span><span class="token variable">$g_cas_ldap_update_fields</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span><span class="token variable">$g_cas_ldap_update_map</span>    <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span><span class="token variable">$g_ldap_language_field</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span><span class="token variable">$g_ldap_language_keys</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä¿®æ”¹ç™»å½•é¡µé¢"><a href="#ä¿®æ”¹ç™»å½•é¡µé¢" class="headerlink" title="ä¿®æ”¹ç™»å½•é¡µé¢"></a>ä¿®æ”¹ç™»å½•é¡µé¢</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi /var/www/html/mantis/login_page.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">// åœ¨æ–‡ä»¶å¼€å¤´çš„ require_once éƒ¨åˆ†å¢åŠ å¯¹ phpCAS çš„å¼•å…¥</span><span class="token keyword">require_once</span><span class="token punctuation">(</span> <span class="token string">'/var/www/html/mantis/phpCAS/login_cas.php'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// åœ¨ $f_username å˜é‡çš„å®šä¹‰ä¹‹å‰æ·»åŠ åˆ¤æ–­è¯­å¥ï¼Œå½“æ£€æµ‹åˆ°ç”¨æˆ·å·²ç»è®¤è¯æ—¶ï¼Œè·³è½¬åˆ°ä¸»é¡µ</span><span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token function">auth_is_user_authenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">current_user_is_anonymous</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token function">print_header_redirect</span><span class="token punctuation">(</span> <span class="token function">config_get</span><span class="token punctuation">(</span> <span class="token string">'default_home_page'</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi /var/www/html/mantis/login.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">// åœ¨åˆ¤æ–­å˜é‡ f_install çš„åˆ¤æ–­è¯­å¥ä¹‹åæ·»åŠ ä¸‹é¢çš„åˆ¤æ–­è¯­å¥æ¥åˆ¤æ–­éªŒè¯æ–¹å¼ï¼Œè‹¥ä¸º CAS ï¼Œåˆ™åˆ©ç”¨ auth_cas_get_name å‡½æ•°æ¥å¤„ç†</span><span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token constant">CAS</span> <span class="token operator">==</span> <span class="token function">config_get</span><span class="token punctuation">(</span> <span class="token string">'login_method'</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token shell-comment comment"># This will detour to the CAS login page if needed</span>    <span class="token variable">$f_password</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>    <span class="token variable">$f_username</span> <span class="token operator">=</span> <span class="token function">auth_cas_get_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token shell-comment comment"># User is always authenticated by this point</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi /var/www/html/mantis/login_password_page.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">// åœ¨ $f_username å˜é‡çš„å®šä¹‰ä¹‹å‰æ·»åŠ åˆ¤æ–­è¯­å¥ï¼Œå½“æ£€æµ‹åˆ°ç”¨æˆ·å·²ç»è®¤è¯æ—¶ï¼Œè·³è½¬åˆ°ä¸»é¡µ</span><span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token function">auth_is_user_authenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">current_user_is_anonymous</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token function">print_header_redirect</span><span class="token punctuation">(</span> <span class="token function">config_get</span><span class="token punctuation">(</span> <span class="token string">'default_home_page'</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$f_username</span>              <span class="token operator">=</span> <span class="token function">gpc_get_string</span><span class="token punctuation">(</span> <span class="token string">'username'</span><span class="token punctuation">,</span> <span class="token string">''</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token shell-comment comment"># zhanghl start</span><span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token variable">$f_username</span> <span class="token operator">==</span> <span class="token string">''</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$f_username</span> <span class="token operator">=</span> <span class="token variable">$staffid</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token shell-comment comment"># zhanghl end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä¿®æ”¹ç™»å‡ºé¡µé¢"><a href="#ä¿®æ”¹ç™»å‡ºé¡µé¢" class="headerlink" title="ä¿®æ”¹ç™»å‡ºé¡µé¢"></a>ä¿®æ”¹ç™»å‡ºé¡µé¢</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi /var/www/html/mantis/logout_page.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">// åœ¨æ–‡ä»¶å¼€å¤´çš„ require_once éƒ¨åˆ†å¢åŠ å¯¹ phpCAS çš„å¼•å…¥</span><span class="token keyword">require_once</span><span class="token punctuation">(</span> <span class="token string">'/var/www/html/mantis/phpCAS/login_cas.php'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token shell-comment comment"># Cache the current logout redirect page as it will be cleared by auth_logout()</span><span class="token comment" spellcheck="true">//$t_logout_redirect = auth_logout_redirect_page();</span><span class="token comment" spellcheck="true">//auth_logout();</span>phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">setDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">setVerbose</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">handleLogoutRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//print_header_redirect( $t_logout_redirect, true, false );</span><span class="token function">print_header_redirect</span><span class="token punctuation">(</span> <span class="token function">config_get</span><span class="token punctuation">(</span> <span class="token string">'logout_redirect_page'</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä¿®æ”¹éªŒè¯é€»è¾‘"><a href="#ä¿®æ”¹éªŒè¯é€»è¾‘" class="headerlink" title="ä¿®æ”¹éªŒè¯é€»è¾‘"></a>ä¿®æ”¹éªŒè¯é€»è¾‘</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi /var/www/html/mantis/core/authentication_api.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">// åœ¨å˜é‡ g_cache_current_user_id çš„å®šä¹‰åé¢æ·»åŠ ä»¥ä¸‹å‡½æ•°ï¼Œå®šä¹‰ CAS çš„ç™»å½•é€»è¾‘</span><span class="token comment" spellcheck="true">/*** Initialize phpCAS.*/</span><span class="token keyword">function</span> <span class="token function">auth_cas_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>       <span class="token shell-comment comment"># phpCAS must be installed in the include path</span>       <span class="token shell-comment comment"># or in the Mantis directory.</span>       <span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token string">'/var/www/html/mantis/phpCAS/CAS.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">static</span> <span class="token variable">$s_initialized</span><span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>       <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span> <span class="token variable">$s_initialized</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>               phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">setDebug</span><span class="token punctuation">(</span> <span class="token function">config_get</span><span class="token punctuation">(</span> <span class="token string">'cas_debug'</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token shell-comment comment">## These should be set in config_inc.php</span>               <span class="token variable">$t_server_version</span> <span class="token operator">=</span> <span class="token function">config_get</span><span class="token punctuation">(</span> <span class="token string">'cas_version'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token variable">$t_server_cas_server</span> <span class="token operator">=</span> <span class="token function">config_get</span><span class="token punctuation">(</span> <span class="token string">'cas_server'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token variable">$t_server_port</span> <span class="token operator">=</span> <span class="token function">config_get</span><span class="token punctuation">(</span> <span class="token string">'cas_port'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token variable">$t_server_uri</span> <span class="token operator">=</span> <span class="token function">config_get</span><span class="token punctuation">(</span> <span class="token string">'cas_uri'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token variable">$t_start_session</span> <span class="token operator">=</span> <span class="token punctuation">(</span>boolean<span class="token punctuation">)</span><span class="token constant">FALSE</span><span class="token punctuation">;</span> <span class="token shell-comment comment"># Mantis takes care of its own session</span>               phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">client</span><span class="token punctuation">(</span><span class="token variable">$t_server_version</span><span class="token punctuation">,</span> <span class="token variable">$t_server_cas_server</span><span class="token punctuation">,</span> <span class="token variable">$t_server_port</span><span class="token punctuation">,</span> <span class="token variable">$t_server_uri</span><span class="token punctuation">,</span> <span class="token variable">$t_start_session</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$t_server_version</span> <span class="token operator">==</span> <span class="token string">"S1"</span><span class="token punctuation">)</span>                       phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">setServerSamlValidateURL</span><span class="token punctuation">(</span> <span class="token function">config_get</span><span class="token punctuation">(</span> <span class="token string">'cas_validate'</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token keyword">else</span>                       phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">setServerProxyValidateURL</span><span class="token punctuation">(</span> <span class="token function">config_get</span><span class="token punctuation">(</span> <span class="token string">'cas_validate'</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">method_exists</span><span class="token punctuation">(</span><span class="token string">'phpCAS'</span><span class="token punctuation">,</span> <span class="token string">'setNoCasServerValidation'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                       <span class="token comment" spellcheck="true">// no SSL validation for the CAS server</span>                       phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">setNoCasServerValidation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token punctuation">}</span>               <span class="token variable">$s_initialized</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>       <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">/*** Fetches the user's CAS name, authenticating if needed.* Can translate CAS login name to Mantis username through LDAP.*/</span><span class="token keyword">function</span> <span class="token function">auth_cas_get_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>       <span class="token shell-comment comment"># Get CAS username from phpCAS</span>       <span class="token function">auth_cas_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">forceAuthentication</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token variable">$t_cas_id</span> <span class="token operator">=</span> phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">getUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token variable">$t_cas_attribs</span> <span class="token operator">=</span> phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">getAttributes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token shell-comment comment"># If needed, translate the CAS username through LDAP</span>       <span class="token variable">$t_username</span> <span class="token operator">=</span> <span class="token variable">$t_cas_id</span><span class="token punctuation">;</span>       <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">config_get</span><span class="token punctuation">(</span> <span class="token string">'cas_use_ldap'</span><span class="token punctuation">,</span> <span class="token boolean">false</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>               <span class="token variable">$t_username</span> <span class="token operator">=</span> <span class="token function">auth_cas_ldap_translate</span><span class="token punctuation">(</span> <span class="token variable">$t_cas_id</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">}</span>       <span class="token keyword">elseif</span> <span class="token punctuation">(</span><span class="token function">config_get</span><span class="token punctuation">(</span> <span class="token string">'cas_saml_attributes'</span><span class="token punctuation">,</span> <span class="token boolean">false</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>               <span class="token variable">$t_cas_attribmap</span> <span class="token operator">=</span> <span class="token function">config_get</span><span class="token punctuation">(</span> <span class="token string">'cas_saml_map'</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token variable">$t_cas_attrib_name</span> <span class="token operator">=</span> <span class="token variable">$t_cas_attribs</span><span class="token punctuation">[</span><span class="token variable">$t_cas_attribmap</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>               <span class="token variable">$t_cas_attrib_mail</span> <span class="token operator">=</span> <span class="token variable">$t_cas_attribs</span><span class="token punctuation">[</span><span class="token variable">$t_cas_attribmap</span><span class="token punctuation">[</span><span class="token string">'mail'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>               <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">user_get_id_by_name</span><span class="token punctuation">(</span><span class="token variable">$t_cas_id</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">false</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>                       <span class="token function">user_create</span><span class="token punctuation">(</span> <span class="token variable">$t_cas_id</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token variable">$t_cas_attrib_mail</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token variable">$t_cas_attrib_name</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">}</span>       <span class="token punctuation">}</span>       <span class="token keyword">return</span> <span class="token variable">$t_username</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">/*** Takes an ID string, and looks up the LDAP directory to find* the matching username for Mantis.** Optionally, also update the user information in the Mantis user* table.** @param $p_cas_id string Typically, the username given by phpCAS.* @param $p_update_user bool Whether or not to update user details from LDAP.*/</span><span class="token keyword">function</span> <span class="token function">auth_cas_ldap_translate</span><span class="token punctuation">(</span> <span class="token variable">$p_cas_id</span><span class="token punctuation">,</span> <span class="token variable">$p_update_user</span><span class="token operator">=</span><span class="token string">''</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>       <span class="token shell-comment comment"># Please make sure the Mantis CAS and LDAP settings are set in config_inc.php</span>       <span class="token variable">$t_ldap_organization</span>    <span class="token operator">=</span> <span class="token function">config_get</span><span class="token punctuation">(</span> <span class="token string">'ldap_organization'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token variable">$t_ldap_root_dn</span>         <span class="token operator">=</span> <span class="token function">config_get</span><span class="token punctuation">(</span> <span class="token string">'ldap_root_dn'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token shell-comment comment"># Required fields in LDAP for CAS</span>       <span class="token variable">$t_ldap_language_field</span> <span class="token operator">=</span> <span class="token function">config_get</span><span class="token punctuation">(</span> <span class="token string">'ldap_language_field'</span><span class="token punctuation">,</span> <span class="token string">''</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token variable">$t_ldap_uid_field</span> <span class="token operator">=</span> <span class="token function">config_get</span><span class="token punctuation">(</span> <span class="token string">'ldap_uid_field'</span><span class="token punctuation">,</span> <span class="token string">'uid'</span> <span class="token punctuation">)</span> <span class="token punctuation">;</span>       <span class="token variable">$t_ldap_mantis_uid</span> <span class="token operator">=</span> <span class="token function">config_get</span><span class="token punctuation">(</span> <span class="token string">'ldap_mantis_uid'</span><span class="token punctuation">,</span> <span class="token string">'uid'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token variable">$t_ldap_required</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span> <span class="token variable">$t_ldap_uid_field</span><span class="token punctuation">,</span> <span class="token variable">$t_ldap_mantis_uid</span><span class="token punctuation">,</span> <span class="token string">'dn'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$t_ldap_language_field</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>               <span class="token comment" spellcheck="true">// Add language field to attributes list only if it is configured.</span>               <span class="token variable">$t_ldap_required</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$t_ldap_language_field</span><span class="token punctuation">;</span>       <span class="token punctuation">}</span>       <span class="token variable">$t_ldap_required</span> <span class="token operator">=</span> <span class="token function">array_combine</span><span class="token punctuation">(</span> <span class="token variable">$t_ldap_required</span><span class="token punctuation">,</span> <span class="token variable">$t_ldap_required</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token shell-comment comment"># User-defined fields to fetch from LDAP...</span>       <span class="token variable">$t_ldap_fields</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span> <span class="token string">','</span><span class="token punctuation">,</span> <span class="token function">config_get</span><span class="token punctuation">(</span> <span class="token string">'cas_ldap_update_fields'</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token variable">$t_ldap_fields</span> <span class="token operator">=</span> <span class="token function">array_combine</span><span class="token punctuation">(</span> <span class="token variable">$t_ldap_fields</span><span class="token punctuation">,</span> <span class="token variable">$t_ldap_fields</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token shell-comment comment"># ...which are mapped to Mantis user fields</span>       <span class="token variable">$t_ldap_map</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span> <span class="token string">','</span><span class="token punctuation">,</span> <span class="token function">config_get</span><span class="token punctuation">(</span> <span class="token string">'cas_ldap_update_map'</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token variable">$t_ldap_map</span> <span class="token operator">=</span> <span class="token function">array_combine</span><span class="token punctuation">(</span> <span class="token variable">$t_ldap_map</span><span class="token punctuation">,</span> <span class="token variable">$t_ldap_map</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token shell-comment comment"># Build LDAP search filter, attribute list from CAS ID</span>       <span class="token variable">$t_search_filter</span> <span class="token operator">=</span> <span class="token string">"(&amp;$t_ldap_organization($t_ldap_uid_field=$p_cas_id))"</span><span class="token punctuation">;</span>       <span class="token variable">$t_search_attrs</span> <span class="token operator">=</span> <span class="token function">array_values</span><span class="token punctuation">(</span><span class="token variable">$t_ldap_required</span> <span class="token operator">+</span> <span class="token variable">$t_ldap_fields</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token shell-comment comment"># array union</span>       <span class="token shell-comment comment"># Use Mantis ldap_api to connect to LDAP</span>       <span class="token variable">$t_ds</span> <span class="token operator">=</span> <span class="token function">ldap_connect_bind</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token variable">$t_sr</span>   <span class="token operator">=</span> <span class="token function">ldap_search</span><span class="token punctuation">(</span> <span class="token variable">$t_ds</span><span class="token punctuation">,</span> <span class="token variable">$t_ldap_root_dn</span><span class="token punctuation">,</span> <span class="token variable">$t_search_filter</span><span class="token punctuation">,</span> <span class="token variable">$t_search_attrs</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token variable">$t_info</span> <span class="token operator">=</span> <span class="token function">ldap_get_entries</span><span class="token punctuation">(</span> <span class="token variable">$t_ds</span><span class="token punctuation">,</span> <span class="token variable">$t_sr</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token shell-comment comment"># Parse the LDAP entry to find the Mantis username</span>       <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token variable">$t_info</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>               <span class="token shell-comment comment"># Get Mantis username</span>               <span class="token variable">$t_username</span> <span class="token operator">=</span> <span class="token variable">$t_info</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$t_ldap_mantis_uid</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>               <span class="token shell-comment comment"># @@@ The fact that we got here means the user is authenticated</span>               <span class="token shell-comment comment"># @@@ by CAS, and has an LDAP entry.</span>               <span class="token shell-comment comment"># @@@ We might as well update other user details since we are here.</span>               <span class="token shell-comment comment"># If no argument given, check settings</span>               <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token string">''</span> <span class="token operator">==</span> <span class="token variable">$p_update_user</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>                       <span class="token variable">$p_update_user</span> <span class="token operator">=</span> <span class="token function">config_get</span><span class="token punctuation">(</span> <span class="token string">'cas_ldap_update'</span><span class="token punctuation">,</span> <span class="token constant">FALSE</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token punctuation">}</span>               <span class="token shell-comment comment"># If there's a user record, then update it</span>               <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token variable">$p_update_user</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>                       <span class="token shell-comment comment"># Only proceed if the field map arrays are the same length</span>                       <span class="token variable">$t_field_map</span> <span class="token operator">=</span> <span class="token function">array_combine</span><span class="token punctuation">(</span> <span class="token variable">$t_ldap_fields</span><span class="token punctuation">,</span> <span class="token variable">$t_ldap_map</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>                       <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$t_field_map</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                               <span class="token shell-comment comment"># If user is new, then we must create their account before updating it</span>                               <span class="token shell-comment comment"># @@@ ( make sure $g_allow_blank_email == ON )</span>                               <span class="token variable">$t_userid</span> <span class="token operator">=</span> <span class="token function">user_get_id_by_name</span><span class="token punctuation">(</span><span class="token variable">$t_username</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                               <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token boolean">false</span> <span class="token operator">==</span> <span class="token variable">$t_userid</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>                                       <span class="token function">user_create</span><span class="token punctuation">(</span> <span class="token variable">$t_username</span><span class="token punctuation">,</span> <span class="token string">''</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>                                       <span class="token shell-comment comment"># @@@ Wow, this is pretty lame</span>                                       <span class="token variable">$t_userid</span> <span class="token operator">=</span> <span class="token function">user_get_id_by_name</span><span class="token punctuation">(</span><span class="token variable">$t_username</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                               <span class="token punctuation">}</span>                               <span class="token shell-comment comment"># @@@ maybe we can optimize this to write all fields at once?</span>                             <span class="token keyword">foreach</span> <span class="token punctuation">(</span> <span class="token variable">$t_field_map</span> <span class="token keyword">as</span> <span class="token variable">$key</span><span class="token operator">=</span><span class="token operator">></span><span class="token variable">$t_userfield</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>                                     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$t_info</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                                             <span class="token function">user_set_field</span><span class="token punctuation">(</span> <span class="token variable">$t_userid</span><span class="token punctuation">,</span> <span class="token variable">$t_userfield</span><span class="token punctuation">,</span> <span class="token variable">$t_info</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>                                     <span class="token punctuation">}</span>                             <span class="token punctuation">}</span>                       <span class="token punctuation">}</span>                       <span class="token comment" spellcheck="true">// Update user's overall language preference</span>                       <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$t_ldap_language_field</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                               <span class="token variable">$t_language</span> <span class="token operator">=</span> <span class="token variable">$t_info</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$t_ldap_language_field</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                               <span class="token comment" spellcheck="true">// Map the LDAP language field to Mantis' language field if needed</span>                               <span class="token variable">$t_language_keys</span> <span class="token operator">=</span> <span class="token function">config_get</span><span class="token punctuation">(</span> <span class="token string">'ldap_language_keys'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                               <span class="token variable">$t_language_values</span> <span class="token operator">=</span> <span class="token function">config_get</span><span class="token punctuation">(</span> <span class="token string">'ldap_language_values'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                               <span class="token variable">$t_language_map</span> <span class="token operator">=</span> <span class="token function">array_combine</span><span class="token punctuation">(</span>                                       <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">,</span> <span class="token variable">$t_language_keys</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                                       <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">,</span> <span class="token variable">$t_language_values</span><span class="token punctuation">)</span>                               <span class="token punctuation">)</span><span class="token punctuation">;</span>                               <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$t_language_map</span><span class="token punctuation">[</span><span class="token variable">$t_language</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                                       <span class="token variable">$t_language</span> <span class="token operator">=</span> <span class="token variable">$t_language_map</span><span class="token punctuation">[</span><span class="token variable">$t_language</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                               <span class="token punctuation">}</span>                               <span class="token function">user_pref_set_pref</span><span class="token punctuation">(</span><span class="token variable">$t_userid</span><span class="token punctuation">,</span> <span class="token string">'language'</span><span class="token punctuation">,</span> <span class="token variable">$t_language</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                       <span class="token punctuation">}</span>               <span class="token punctuation">}</span>       <span class="token punctuation">}</span>       <span class="token function">ldap_free_result</span><span class="token punctuation">(</span> <span class="token variable">$t_sr</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token function">ldap_unbind</span><span class="token punctuation">(</span> <span class="token variable">$t_ds</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">return</span> <span class="token variable">$t_username</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">/*** Logs out of CAS, redirecting to Mantis on re-login.* User should already be logged out of Mantis by the time this is called.* @see auth_logout()*/</span><span class="token keyword">function</span> <span class="token function">auth_cas_logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>       <span class="token variable">$t_path</span> <span class="token operator">=</span> <span class="token function">config_get</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token function">auth_cas_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">method_Exists</span><span class="token punctuation">(</span><span class="token string">'phpCAS'</span><span class="token punctuation">,</span> <span class="token string">'logoutWithUrl'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>               phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">logoutWithUrl</span><span class="token punctuation">(</span><span class="token variable">$t_path</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>               phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">logout</span><span class="token punctuation">(</span><span class="token variable">$t_path</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// zhanghl end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">// ä¿®æ”¹ auth_auto_create_user å‡½æ•°å®ç° CAS è‡ªåŠ¨åˆ›å»ºç”¨æˆ·</span><span class="token keyword">function</span> <span class="token function">auth_auto_create_user</span><span class="token punctuation">(</span> <span class="token variable">$p_username</span><span class="token punctuation">,</span> <span class="token variable">$p_password</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token variable">$t_login_method</span> <span class="token operator">=</span> <span class="token function">config_get_global</span><span class="token punctuation">(</span> <span class="token string">'login_method'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// if( $t_login_method == BASIC_AUTH ) {</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">in_array</span><span class="token punctuation">(</span> <span class="token variable">$t_login_method</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span> <span class="token constant">BASIC_AUTH</span><span class="token punctuation">,</span> <span class="token constant">CAS</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token shell-comment comment"># attempt to create the user if using BASIC_AUTH or CAS</span>        <span class="token variable">$t_auto_create</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token variable">$t_login_method</span> <span class="token operator">==</span> <span class="token constant">LDAP</span> <span class="token operator">&amp;&amp;</span> <span class="token function">ldap_authenticate_by_username</span><span class="token punctuation">(</span> <span class="token variable">$p_username</span><span class="token punctuation">,</span> <span class="token variable">$p_password</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$t_auto_create</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token variable">$t_auto_create</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token constant">CAS</span> <span class="token operator">==</span> <span class="token function">config_get</span><span class="token punctuation">(</span> <span class="token string">'login_method'</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token shell-comment comment"># Redirect to CAS page to logout</span>        <span class="token function">auth_cas_logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token variable">$t_auto_create</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token shell-comment comment"># attempt to create the user</span>        <span class="token variable">$t_cookie_string</span> <span class="token operator">=</span> <span class="token function">user_create</span><span class="token punctuation">(</span> <span class="token variable">$p_username</span><span class="token punctuation">,</span> <span class="token function">md5</span><span class="token punctuation">(</span> <span class="token variable">$p_password</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token variable">$t_cookie_string</span> <span class="token operator">===</span> <span class="token boolean">false</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token shell-comment comment"># it didn't work</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token shell-comment comment"># ok, we created the user, get the row again</span>        <span class="token keyword">return</span> <span class="token function">user_get_id_by_name</span><span class="token punctuation">(</span> <span class="token variable">$p_username</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">session_clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">auth_attempt_login</span><span class="token punctuation">(</span> <span class="token variable">$p_username</span><span class="token punctuation">,</span> <span class="token variable">$p_password</span><span class="token punctuation">,</span> <span class="token variable">$p_perm_login</span> <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token variable">$t_user_id</span> <span class="token operator">=</span> <span class="token function">auth_get_user_id_from_login_name</span><span class="token punctuation">(</span> <span class="token variable">$p_username</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$t_login_method</span> <span class="token operator">=</span> <span class="token function">config_get</span><span class="token punctuation">(</span> <span class="token string">'login_method'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token variable">$t_user_id</span> <span class="token operator">===</span> <span class="token boolean">false</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">in_array</span><span class="token punctuation">(</span> <span class="token variable">$t_login_method</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span> <span class="token constant">BASIC_AUTH</span><span class="token punctuation">,</span> <span class="token constant">CAS</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token shell-comment comment"># attempt to create the user if using BASIC_AUTH or CAS</span>            <span class="token shell-comment comment"># ( note: CAS must have $g_allow_blank_email == ON )</span>             <span class="token variable">$t_auto_create</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token variable">$t_user_id</span> <span class="token operator">=</span> <span class="token function">auth_auto_create_user</span><span class="token punctuation">(</span> <span class="token variable">$p_username</span><span class="token punctuation">,</span> <span class="token variable">$p_password</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token variable">$t_user_id</span> <span class="token operator">===</span> <span class="token boolean">false</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token shell-comment comment"># max. failed login attempts achieved...</span>    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">user_is_login_request_allowed</span><span class="token punctuation">(</span> <span class="token variable">$t_user_id</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token shell-comment comment"># check for anonymous login</span>    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">user_is_anonymous</span><span class="token punctuation">(</span> <span class="token variable">$t_user_id</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token shell-comment comment"># anonymous login didn't work, so check the password</span>        <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">auth_does_password_match</span><span class="token punctuation">(</span> <span class="token variable">$t_user_id</span><span class="token punctuation">,</span> <span class="token variable">$p_password</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">user_increment_failed_login_count</span><span class="token punctuation">(</span> <span class="token variable">$t_user_id</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token function">auth_login_user</span><span class="token punctuation">(</span> <span class="token variable">$t_user_id</span><span class="token punctuation">,</span> <span class="token variable">$p_perm_login</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">auth_logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">global</span> <span class="token variable">$g_cache_current_user_id</span><span class="token punctuation">,</span> <span class="token variable">$g_cache_cookie_valid</span><span class="token punctuation">;</span>    <span class="token shell-comment comment"># clear cached userid</span>    <span class="token function">user_clear_cache</span><span class="token punctuation">(</span> <span class="token variable">$g_cache_current_user_id</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">current_user_set</span><span class="token punctuation">(</span> <span class="token keyword">null</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$g_cache_cookie_valid</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token shell-comment comment"># clear cookies, if they were set</span>    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token function">auth_clear_cookies</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">helper_clear_pref_cookies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token constant">HTTP_AUTH</span> <span class="token operator">==</span> <span class="token function">config_get_global</span><span class="token punctuation">(</span> <span class="token string">'login_method'</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">auth_http_set_logout_pending</span><span class="token punctuation">(</span> <span class="token boolean">true</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">elseif</span> <span class="token punctuation">(</span> <span class="token constant">CAS</span> <span class="token operator">==</span> <span class="token function">config_get</span><span class="token punctuation">(</span> <span class="token string">'login_method'</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token shell-comment comment"># Redirect to CAS page to logout</span>            <span class="token function">auth_cas_logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">session_clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">auth_automatic_logon_bypass_form</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">switch</span><span class="token punctuation">(</span> <span class="token function">config_get</span><span class="token punctuation">(</span> <span class="token string">'login_method'</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">case</span> <span class="token constant">HTTP_AUTH</span><span class="token punctuation">:</span>                        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>                <span class="token keyword">case</span> <span class="token constant">CAS</span><span class="token punctuation">:</span>                        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//return config_get_global( 'login_method' ) == HTTP_AUTH;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">auth_does_password_match</span><span class="token punctuation">(</span> <span class="token variable">$p_user_id</span><span class="token punctuation">,</span> <span class="token variable">$p_test_password</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token variable">$t_configured_login_method</span> <span class="token operator">=</span> <span class="token function">config_get_global</span><span class="token punctuation">(</span> <span class="token string">'login_method'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token constant">LDAP</span> <span class="token operator">==</span> <span class="token variable">$t_configured_login_method</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token function">ldap_authenticate</span><span class="token punctuation">(</span> <span class="token variable">$p_user_id</span><span class="token punctuation">,</span> <span class="token variable">$p_test_password</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">elseif</span> <span class="token punctuation">(</span> <span class="token constant">CAS</span> <span class="token operator">==</span> <span class="token variable">$t_configured_login_method</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">auth_can_use_standard_login</span><span class="token punctuation">(</span> <span class="token variable">$p_user_id</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token variable">$t_password</span> <span class="token operator">=</span> <span class="token function">user_get_field</span><span class="token punctuation">(</span> <span class="token variable">$p_user_id</span><span class="token punctuation">,</span> <span class="token string">'password'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$t_login_methods</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span>        <span class="token constant">MD5</span><span class="token punctuation">,</span>        <span class="token constant">CRYPT</span><span class="token punctuation">,</span>        <span class="token constant">PLAIN</span><span class="token punctuation">,</span>        <span class="token constant">BASIC_AUTH</span><span class="token punctuation">,</span>        <span class="token constant">CAS</span><span class="token punctuation">,</span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">foreach</span><span class="token punctuation">(</span> <span class="token variable">$t_login_methods</span> <span class="token keyword">as</span> <span class="token variable">$t_login_method</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token shell-comment comment"># pass the stored password in as the salt</span>        <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token function">auth_process_plain_password</span><span class="token punctuation">(</span> <span class="token variable">$p_test_password</span><span class="token punctuation">,</span> <span class="token variable">$t_password</span><span class="token punctuation">,</span> <span class="token variable">$t_login_method</span> <span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token variable">$t_password</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token shell-comment comment"># Do not support migration to PLAIN, since this would be a crazy thing to do.</span>            <span class="token shell-comment comment"># Also if we do, then a user will be able to login by providing the MD5 value</span>            <span class="token shell-comment comment"># that is copied from the database.  See #8467 for more details.</span>            <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token punctuation">(</span> <span class="token variable">$t_configured_login_method</span> <span class="token operator">!=</span> <span class="token constant">PLAIN</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$t_login_method</span> <span class="token operator">==</span> <span class="token constant">PLAIN</span> <span class="token punctuation">)</span> <span class="token operator">||</span>                <span class="token punctuation">(</span> <span class="token variable">$t_configured_login_method</span> <span class="token operator">!=</span> <span class="token constant">BASIC_AUTH</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$t_login_method</span> <span class="token operator">==</span> <span class="token constant">BASIC_AUTH</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token shell-comment comment"># Check for migration to another login method and test whether the password was encrypted</span>            <span class="token shell-comment comment"># with our previously insecure implementation of the CRYPT method</span>            <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token punctuation">(</span> <span class="token variable">$t_login_method</span> <span class="token operator">!=</span> <span class="token variable">$t_configured_login_method</span> <span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token constant">CRYPT</span> <span class="token operator">==</span> <span class="token variable">$t_configured_login_method</span> <span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">mb_substr</span><span class="token punctuation">(</span> <span class="token variable">$t_password</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">mb_substr</span><span class="token punctuation">(</span> <span class="token variable">$p_test_password</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token function">user_set_password</span><span class="token punctuation">(</span> <span class="token variable">$p_user_id</span><span class="token punctuation">,</span> <span class="token variable">$p_test_password</span><span class="token punctuation">,</span> <span class="token boolean">true</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">auth_reauthenticate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//if( !auth_reauthentication_enabled() || BASIC_AUTH == config_get_global( 'login_method' ) || HTTP_AUTH == config_get_global( 'login_method' ) ) {</span>    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">auth_reauthentication_enabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">in_array</span><span class="token punctuation">(</span><span class="token function">config_get</span><span class="token punctuation">(</span><span class="token string">'login_method'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token constant">BASIC_AUTH</span><span class="token punctuation">,</span> <span class="token constant">HTTP_AUTH</span><span class="token punctuation">,</span> <span class="token constant">CAS</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token variable">$t_auth_token</span> <span class="token operator">=</span> <span class="token function">token_get</span><span class="token punctuation">(</span> <span class="token constant">TOKEN_AUTHENTICATED</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token keyword">null</span> <span class="token operator">!=</span> <span class="token variable">$t_auth_token</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">token_touch</span><span class="token punctuation">(</span> <span class="token variable">$t_auth_token</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">auth_reauthentication_expiry</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token variable">$t_anon_account</span> <span class="token operator">=</span> <span class="token function">auth_anonymous_account</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$t_anon_allowed</span> <span class="token operator">=</span> <span class="token function">auth_anonymous_enabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$t_user_id</span> <span class="token operator">=</span> <span class="token function">auth_get_current_user_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$t_username</span> <span class="token operator">=</span> <span class="token function">user_get_username</span><span class="token punctuation">(</span> <span class="token variable">$t_user_id</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token shell-comment comment"># check for anonymous login</span>        <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token constant">ON</span> <span class="token operator">==</span> <span class="token variable">$t_anon_allowed</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$t_anon_account</span> <span class="token operator">==</span> <span class="token variable">$t_username</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token variable">$t_request_uri</span> <span class="token operator">=</span> <span class="token function">string_url</span><span class="token punctuation">(</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'REQUEST_URI'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$t_query_params</span> <span class="token operator">=</span> <span class="token function">http_build_query</span><span class="token punctuation">(</span>            <span class="token keyword">array</span><span class="token punctuation">(</span>                <span class="token string">'reauthenticate'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">,</span>                <span class="token string">'username'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$t_username</span><span class="token punctuation">,</span>                <span class="token string">'return'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$t_request_uri</span><span class="token punctuation">,</span>            <span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token string">''</span><span class="token punctuation">,</span> <span class="token string">'&amp;'</span>        <span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token shell-comment comment"># redirect to login page</span>        <span class="token function">print_header_redirect</span><span class="token punctuation">(</span> <span class="token function">auth_credential_page</span><span class="token punctuation">(</span> <span class="token variable">$t_query_params</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ–°å»ºlogin-cas-phpå¤„ç†æ‹¦æˆªåˆ©ç”¨CASè®¤è¯ç™»å½•"><a href="#æ–°å»ºlogin-cas-phpå¤„ç†æ‹¦æˆªåˆ©ç”¨CASè®¤è¯ç™»å½•" class="headerlink" title="æ–°å»ºlogin_cas.phpå¤„ç†æ‹¦æˆªåˆ©ç”¨CASè®¤è¯ç™»å½•"></a>æ–°å»º<code>login_cas.php</code>å¤„ç†æ‹¦æˆªåˆ©ç”¨<code>CAS</code>è®¤è¯ç™»å½•</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#  vi /var/www/html/mantis/phpCAS/login_cas.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">require_once</span><span class="token punctuation">(</span> <span class="token string">'CAS.php'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'CAS_ENABLE'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$cas_host</span> <span class="token operator">=</span> <span class="token string">'devops.iamzhl.top'</span><span class="token punctuation">;</span><span class="token variable">$cas_context</span> <span class="token operator">=</span> <span class="token string">'/cas'</span><span class="token punctuation">;</span><span class="token variable">$cas_port</span> <span class="token operator">=</span> <span class="token number">8080</span><span class="token punctuation">;</span><span class="token variable">$cas_real_hosts</span> <span class="token operator">=</span> <span class="token keyword">array</span> <span class="token punctuation">(</span>    <span class="token string">'devops.iamzhl.top'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">setDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">setVerbose</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">client</span><span class="token punctuation">(</span><span class="token constant">CAS_VERSION_2_0</span><span class="token punctuation">,</span> <span class="token variable">$cas_host</span><span class="token punctuation">,</span> <span class="token variable">$cas_port</span><span class="token punctuation">,</span> <span class="token variable">$cas_context</span><span class="token punctuation">)</span><span class="token punctuation">;</span>phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">setNoCasServerValidation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">handleLogoutRequests</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token variable">$cas_real_hosts</span><span class="token punctuation">)</span><span class="token punctuation">;</span>phpCAS<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">forceAuthentication</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä¿®æ”¹CASçš„Client-phpå¯ç”¨httpè¿æ¥-æ ¹æ®ä¸ªäººCASæœåŠ¡å™¨æ¥å®š"><a href="#ä¿®æ”¹CASçš„Client-phpå¯ç”¨httpè¿æ¥-æ ¹æ®ä¸ªäººCASæœåŠ¡å™¨æ¥å®š" class="headerlink" title="ä¿®æ”¹CASçš„Client.phpå¯ç”¨httpè¿æ¥(æ ¹æ®ä¸ªäººCASæœåŠ¡å™¨æ¥å®š)"></a>ä¿®æ”¹<code>CAS</code>çš„<code>Client.php</code>å¯ç”¨<code>http</code>è¿æ¥(æ ¹æ®ä¸ªäºº<code>CAS</code>æœåŠ¡å™¨æ¥å®š)</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi /var/www/html/mantis/phpCAS/source/CAS/Client.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>å°†å¦‚ä¸‹å‡ ä¸ªå‡½æ•°ä¸­çš„httpsæ”¹ä¸ºhttpå³å¯</p></blockquote><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">_getServerBaseURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// the URL is build only when needed</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_server</span><span class="token punctuation">[</span><span class="token string">'base_url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//$this->_server['base_url'] = 'https://' . $this->_getServerHostname();</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_server</span><span class="token punctuation">[</span><span class="token string">'base_url'</span><span class="token punctuation">]</span> <span class="token operator">=</span> 'http<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//' . $this->_getServerHostname();</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">_getServerPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">443</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_server</span><span class="token punctuation">[</span><span class="token string">'base_url'</span><span class="token punctuation">]</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token string">':'</span>                <span class="token punctuation">.</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">_getServerPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_server</span><span class="token punctuation">[</span><span class="token string">'base_url'</span><span class="token punctuation">]</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">_getServerURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_server</span><span class="token punctuation">[</span><span class="token string">'base_url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">_getCallbackURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// the URL is built when needed only</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_callback_url</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$final_uri</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// remove the ticket if present in the URL</span>            <span class="token comment" spellcheck="true">//$final_uri = 'https://';</span>            <span class="token variable">$final_uri</span> <span class="token operator">=</span> 'http<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//';</span>            <span class="token variable">$final_uri</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">_getClientUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$request_uri</span> <span class="token operator">=</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'REQUEST_URI'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token variable">$request_uri</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string">'/\?.*$/'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token variable">$request_uri</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$final_uri</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token variable">$request_uri</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_callback_url</span> <span class="token operator">=</span> <span class="token variable">$final_uri</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_callback_url</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>public function getURL()    {        phpCAS::traceBegin();        // the URL is built when needed only        if ( empty($this-&gt;_url) ) {            $final_uri = '';            // remove the ticket if present in the URL            //$final_uri = ($this-&gt;_isHttps()) ? 'https' : 'http';            $final_uri = ($this-&gt;_isHttps()) ? 'http' : 'http';            $final_uri .= '://';            $final_uri .= $this-&gt;_getClientUrl();            $request_uri        = explode('?', $_SERVER['REQUEST_URI'], 2);            $final_uri          .= $request_uri[0];            if (isset($request_uri[1]) &amp;&amp; $request_uri[1]) {                $query_string= $this-&gt;_removeParameterFromQueryString('ticket', $request_uri[1]);                // If the query string still has anything left,                // append it to the final URI                if ($query_string !== '') {                    $final_uri  .= "?$query_string";                }            }            phpCAS::trace("Final URI: $final_uri");            $this-&gt;setURL($final_uri);        }        phpCAS::traceEnd($this-&gt;_url);        return $this-&gt;_url;    }</code></pre><h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><blockquote><p>æ–°å»º<code>log</code>ç›®å½•</p></blockquote><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># mkdir /var/log/mantis</span><span class="token comment" spellcheck="true"># chown -R apache:apache /var/log/mantis</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ‰“å¼€<code>MantisBT</code>ç½‘å€ï¼Œæ­£å¸¸è·³è½¬è‡³<code>CAS</code>ç™»å½•ç•Œé¢ï¼Œç½‘å€æ˜¯<code>http://devops.iamzhl.top:8080/cas/login?service=http%3A%2F%2Fdevops.iamzhl.top%2Fmantis%2Flogin_page.php</code></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/fa/f707556ce41d95b71052d07834f5d8.jpg" alt=""></p><p>å¦‚å›¾ï¼Œè¾“å…¥ç”¨æˆ·åå¯†ç åç‚¹å‡»ç™»å½•ï¼Œæ­£å¸¸ç™»é™†åè·³è½¬è‡³<code>MantisBT</code>ä¸»é¡µï¼Œå¹¶ä¸”æ­£å¸¸è·å–ç”¨æˆ·å</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/49/1365298ec15c90fbf95612a38606ed.jpg" alt=""></p><p>ç‚¹å‡»å³ä¸Šè§’çš„ç”¨æˆ·å -&gt; æ³¨é”€ï¼Œä¼šæ­£å¸¸é€€å‡ºå¹¶è·³è½¬åˆ°<code>CAS</code>çš„ç™»å‡ºç•Œé¢</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/85/2d25e40bdf97b6f06dad6239cf3167.jpg" alt=""></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> CI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CAS </tag>
            
            <tag> LDAP </tag>
            
            <tag> MantisBT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Gerrit æ•´åˆ ldap å’Œ CAS å•ç‚¹ç™»å½•</title>
      <link href="/posts/16f4a18f/"/>
      <url>/posts/16f4a18f/</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯ä»‹ç»"><a href="#èƒŒæ™¯ä»‹ç»" class="headerlink" title="èƒŒæ™¯ä»‹ç»"></a>èƒŒæ™¯ä»‹ç»</h2><ul><li>Gerrit ç‰ˆæœ¬ï¼š2.16</li><li>Gerrit URLï¼š<a href="http://devops.iamzhl.top:82" target="_blank" rel="noopener">http://devops.iamzhl.top:82</a></li><li>openLDAP æœåŠ¡ï¼šldap://devops.iamzhl.top:389</li><li>CAS æœåŠ¡ï¼š<a href="http://devops.iamzhl.top:8080/cas" target="_blank" rel="noopener">http://devops.iamzhl.top:8080/cas</a></li></ul><h2 id="æ•´åˆ-LDAP"><a href="#æ•´åˆ-LDAP" class="headerlink" title="æ•´åˆ LDAP"></a>æ•´åˆ LDAP</h2><h3 id="ä¿®æ”¹-gerrit-config"><a href="#ä¿®æ”¹-gerrit-config" class="headerlink" title="ä¿®æ”¹ gerrit.config"></a>ä¿®æ”¹ gerrit.config</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi /usr/local/review_site/etc/gerrit.config</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>è¯·æ ¹æ®è‡ªå·±çš„<code>LDAP</code>æœåŠ¡å™¨ä¿¡æ¯è¿›è¡Œå®šåˆ¶</p></blockquote><pre class="line-numbers language-properties"><code class="language-properties">[auth]<span class="token attr-name">        type</span> <span class="token punctuation">=</span> <span class="token attr-value">LDAP</span>[ldap]<span class="token attr-name">        server</span> <span class="token punctuation">=</span> <span class="token attr-value">ldap://devops.iamzhl.top:389</span><span class="token attr-name">        username</span> <span class="token punctuation">=</span> <span class="token attr-value">cn=Manager,dc=iamzhl,dc=top</span><span class="token attr-name">        password</span> <span class="token punctuation">=</span> <span class="token attr-value">passwd</span><span class="token attr-name">        accountBase</span> <span class="token punctuation">=</span> <span class="token attr-value">ou=People,dc=iamzhl,dc=top</span><span class="token attr-name">        groupBase</span> <span class="token punctuation">=</span> <span class="token attr-value">ou=People,dc=iamzhl,dc=top</span><span class="token attr-name">        accountFullName</span> <span class="token punctuation">=</span> <span class="token attr-value">uid</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="é‡å¯æœåŠ¡"><a href="#é‡å¯æœåŠ¡" class="headerlink" title="é‡å¯æœåŠ¡"></a>é‡å¯æœåŠ¡</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># gerrit restart</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p>æ‰“å¼€ç½‘å€<code>http://devops.iamzhl.top:8081</code>ï¼Œè¿›å…¥åˆ°<code>Gerrit</code>ä¸»é¡µé¢</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/4d/42f6d16ca0cd469d5b5bd9cfb9f471.jpg" alt=""></p><p>ç‚¹å‡»å³ä¸Šè§’<code>Sign in</code>ï¼Œè¿›å…¥ç™»å½•ç•Œé¢ï¼Œè¾“å…¥<code>LDAP</code>æœåŠ¡å™¨ä¸­çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œç„¶åç‚¹å‡»<code>Sign in</code></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/5e/3a439fb1bcfae0116018eaca7dd987.jpg" alt=""></p><p>ç™»å½•æˆåŠŸåè·³è½¬åˆ°ç”¨æˆ·ä¸»é¡µé¢ï¼Œæ­£å¸¸è·å–ç”¨æˆ·å</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/3d/ea561210f011755f97aec7c4a90b59.jpg" alt=""></p><p>ç‚¹å‡»ç”¨æˆ·å -&gt; Sign Outï¼Œæ­£å¸¸é€€å‡º</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/4d/42f6d16ca0cd469d5b5bd9cfb9f471.jpg" alt=""></p><p>è‡³æ­¤ï¼Œ<code>Gerrit</code>æ•´åˆ<code>LDAP</code>å®Œæˆã€‚</p><h2 id="æ•´åˆ-CAS"><a href="#æ•´åˆ-CAS" class="headerlink" title="æ•´åˆ CAS"></a>æ•´åˆ CAS</h2><h3 id="ä¿®æ”¹-gerrit-config-1"><a href="#ä¿®æ”¹-gerrit-config-1" class="headerlink" title="ä¿®æ”¹ gerrit.config"></a>ä¿®æ”¹ gerrit.config</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi /usr/local/review_site/etc/gerrit.config</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¿®æ”¹<code>[auth]</code>éƒ¨åˆ†</p><pre class="line-numbers language-properties"><code class="language-properties">[auth]<span class="token attr-name">        type</span> <span class="token punctuation">=</span> <span class="token attr-value">HTTP</span><span class="token attr-name">        httpHeader</span> <span class="token punctuation">=</span> <span class="token attr-value">X-Forwarded-Gerrit</span><span class="token attr-name">        logoutUrl</span> <span class="token punctuation">=</span> <span class="token attr-value">http://devops.iamzhl.top:8080/cas/logout</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="mod-auth-casä¿®æ”¹"><a href="#mod-auth-casä¿®æ”¹" class="headerlink" title="mod_auth_casä¿®æ”¹"></a><code>mod_auth_cas</code>ä¿®æ”¹</h3><p>ç„¶åå®‰è£…<code>mod_auth_cas</code></p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># yum -y install mod_auth_cas</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é…ç½®<code>mod_auth_cas</code></p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi /etc/httpd/conf.d/auth_cas.conf</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¿®æ”¹<code>CAS</code>çš„<code>Cookie</code>å­˜å‚¨ä½ç½®ä»¥åŠç™»å½•åœ°å€å’ŒéªŒè¯åœ°å€ç­‰å‚æ•°å¦‚ä¸‹</p><pre class="line-numbers language-properties"><code class="language-properties"><span class="token attr-name">LogLevel</span> <span class="token attr-value">Debug</span><span class="token attr-name">CASDebug</span> <span class="token attr-value">On</span><span class="token attr-name">CASVersion</span> <span class="token attr-value">2</span><span class="token attr-name">CASTimeout</span> <span class="token attr-value">1740</span><span class="token attr-name">CASIdleTimeout</span> <span class="token attr-value">1740</span><span class="token attr-name">CASSSOEnabled</span> <span class="token attr-value">On</span><span class="token attr-name">CASCookiePath</span> <span class="token attr-value">/var/cache/httpd/mod_auth_cas/</span><span class="token attr-name">CASLoginURL</span> <span class="token attr-value">http://devops.iamzhl.top:8080/cas/login</span><span class="token attr-name">CASValidateURL</span> <span class="token attr-value">http://devops.iamzhl.top:8080/cas/serviceValidate</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä¿®æ”¹-apache-é…ç½®æ–‡ä»¶"><a href="#ä¿®æ”¹-apache-é…ç½®æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹ apache é…ç½®æ–‡ä»¶"></a>ä¿®æ”¹ apache é…ç½®æ–‡ä»¶</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi /etc/httpd/conf/httpd.conf</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>æ·»åŠ åå‘ä»£ç†</p></blockquote><pre class="line-numbers language-properties"><code class="language-properties"><span class="token comment" spellcheck="true"># æ·»åŠ ä¸€ä¸ªç›‘å¬ç«¯å£ 82 ç”¨ä½œ Gerrit çš„ä»£ç†ä¸»æœº</span><span class="token attr-name">Listen</span> <span class="token attr-value">82</span><span class="token comment" spellcheck="true"># åŠ è½½ mod_auth_cas æ¨¡å—ï¼Œå¦‚æœå·²ç»åŠ è½½è¯·å¿½ç•¥</span><span class="token attr-name">LoadModule</span> <span class="token attr-value">auth_cas_module modules/mod_auth_cas.so</span><span class="token comment" spellcheck="true"># è®¾ç½® Gerrit çš„è™šæ‹Ÿä¸»æœº</span><span class="token attr-name">&lt;VirtualHost</span> <span class="token attr-value">*:82></span><span class="token attr-name">    ServerName</span> <span class="token attr-value">devops.iamzhl.top</span><span class="token attr-name">    ServerAdmin</span> <span class="token attr-value">15563836030@163.com</span><span class="token attr-name">    CASRootProxiedAs</span> <span class="token attr-value">http://devops.iamzhl.top:82</span><span class="token attr-name">    ProxyRequests</span> <span class="token attr-value">Off</span><span class="token attr-name">    ProxyVia</span> <span class="token attr-value">Off</span><span class="token attr-name">    ProxyPreserveHost</span> <span class="token attr-value">On</span><span class="token attr-name">    &lt;Proxy</span> <span class="token attr-value">*></span><span class="token attr-name">          Order</span> <span class="token attr-value">deny,allow</span><span class="token attr-name">          Allow</span> <span class="token attr-value">from all</span>    &lt;/Proxy><span class="token attr-name">    &lt;Location</span> <span class="token attr-value">"/login/"></span><span class="token attr-name">        AuthType</span> <span class="token attr-value">CAS</span><span class="token attr-name">        AuthName</span> <span class="token attr-value">"Welcome To Gerrit Code Review"</span><span class="token attr-name">        Require</span> <span class="token attr-value">valid-user</span><span class="token attr-name">        CASAuthNHeader</span> <span class="token attr-value">X-Forwarded-Gerrit</span>    &lt;/Location><span class="token attr-name">    AllowEncodedSlashes</span> <span class="token attr-value">On</span><span class="token attr-name">    ProxyPass</span> <span class="token attr-value">/ http://devops.iamzhl.top:8081/</span><span class="token attr-name">    ProxyPassReverse</span> <span class="token attr-value">/ http://devops.iamzhl.top:8081</span><span class="token attr-name">    ErrorLog</span> <span class="token attr-value">/var/log/gerrit/error.log</span><span class="token attr-name">    CustomLog</span> <span class="token attr-value">/var/log/gerrit/access.log common</span>&lt;/VirtualHost><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="é‡å¯æœåŠ¡-1"><a href="#é‡å¯æœåŠ¡-1" class="headerlink" title="é‡å¯æœåŠ¡"></a>é‡å¯æœåŠ¡</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># mkdir /var/log/gerrit</span><span class="token comment" spellcheck="true"># gerrit restart</span><span class="token comment" spellcheck="true"># systemctl restart httpd</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="æµ‹è¯•-1"><a href="#æµ‹è¯•-1" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p>æ‰“å¼€ç½‘å€<code>http://devops.iamzhl.top:82</code>ï¼Œå‘ç°è‡ªåŠ¨è·³è½¬åˆ°äº†<code>CAS</code>çš„ç™»å½•ç•Œé¢ï¼Œç½‘å€æ˜¯<a href="http://devops.iamzhl.top:8080/cas/login?service=http%3a%2f%2fdevops.iamzhl.top%3a82%2f" target="_blank" rel="noopener">http://devops.iamzhl.top:8080/cas/login?service=http%3a%2f%2fdevops.iamzhl.top%3a82%2f</a></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/dc/a298cbb27df3f031b6a75d41b8ae3b.jpg" alt=""></p><p>è¾“å…¥ç”¨æˆ·åå¯†ç åï¼Œç‚¹å‡»ç™»å½•ï¼Œç™»é™†æˆåŠŸï¼Œåœ°å€æ˜¯<code>http://devops.iamzhl.top:82//#/dashboard/self</code></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/6b/7e1c3e774f6d188f2a2a7203776be1.jpg" alt=""></p><p>ç‚¹å‡»ç”¨æˆ·å -&gt; Sign Outï¼Œå°±ä¼šç™»å‡º</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/a2/726b245663641d5b6aaf1eef3e17bf.jpg" alt=""></p><p>ç™»å‡ºç•Œé¢å¦‚ä¸‹ï¼Œåœ°å€æ˜¯<code>http://devops.iamzhl.top:8080/cas/logout</code></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/e9/a067be6a85ec888bc9ab25bcf0d0e7.jpg" alt=""></p><p>è‡³æ­¤ï¼Œ<code>Gerrit</code>æ•´åˆ<code>CAS</code>å•ç‚¹ç™»å½•å®Œæˆã€‚</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CAS </tag>
            
            <tag> Gerrit </tag>
            
            <tag> ldap </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SonarQube æ•´åˆ LDAP å’Œ CAS å•ç‚¹ç™»å½•</title>
      <link href="/posts/4ee518bd/"/>
      <url>/posts/4ee518bd/</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯ä»‹ç»"><a href="#èƒŒæ™¯ä»‹ç»" class="headerlink" title="èƒŒæ™¯ä»‹ç»"></a>èƒŒæ™¯ä»‹ç»</h2><ul><li><code>SonarQube</code>ç‰ˆæœ¬ï¼š7.4</li><li><code>SonarQube</code> URL: <a href="http://devops.iamzhl.top:9000" target="_blank" rel="noopener">http://devops.iamzhl.top:9000</a></li><li>openLDAP æœåŠ¡ï¼šldap://devops.iamzhl.top:389</li><li>CAS æœåŠ¡ï¼š<a href="http://devops.iamzhl.top:8080/cas" target="_blank" rel="noopener">http://devops.iamzhl.top:8080/cas</a></li></ul><h2 id="æ•´åˆLDAP"><a href="#æ•´åˆLDAP" class="headerlink" title="æ•´åˆLDAP"></a>æ•´åˆ<code>LDAP</code></h2><p>ä¿®æ”¹<code>sonar</code>é…ç½®æ–‡ä»¶<code>sonar.properties</code></p><pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">vi</span> /usr/local/sonarqube-7.4/conf/sonar.properties<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‰¾åˆ°ä¸‹é¢çš„éƒ¨åˆ†ä¿®æ”¹<code>LDAP</code>é…ç½®</p><pre class="line-numbers language-properties"><code class="language-properties"><span class="token comment" spellcheck="true">#--------------------------------------------------------------------------------------------------</span><span class="token comment" spellcheck="true"># LDAP CONFIGURATION</span><span class="token comment" spellcheck="true"># Enable the LDAP feature</span><span class="token comment" spellcheck="true"># sonar.security.realm=LDAP</span><span class="token comment" spellcheck="true"># Set to true when connecting to a LDAP server using a case-insensitive setup.</span><span class="token comment" spellcheck="true"># sonar.authenticator.downcase=true</span><span class="token comment" spellcheck="true"># URL of the LDAP server. Note that if you are using ldaps, then you should install the server certificate into the Java truststore.</span><span class="token comment" spellcheck="true"># ldap.url=ldap://localhost:10389</span><span class="token comment" spellcheck="true"># Bind DN is the username of an LDAP user to connect (or bind) with. Leave this blank for anonymous access to the LDAP directory (optional)</span><span class="token comment" spellcheck="true"># ldap.bindDn=cn=sonar,ou=users,o=mycompany</span><span class="token comment" spellcheck="true"># Bind Password is the password of the user to connect with. Leave this blank for anonymous access to the LDAP directory (optional)</span><span class="token comment" spellcheck="true"># ldap.bindPassword=secret</span><span class="token comment" spellcheck="true"># Possible values: simple | CRAM-MD5 | DIGEST-MD5 | GSSAPI See http://java.sun.com/products/jndi/tutorial/ldap/security/auth.html (default: simple)</span><span class="token comment" spellcheck="true"># ldap.authentication=simple</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¿®æ”¹å¦‚ä¸‹(è¯·å°†å…·ä½“ä¿¡æ¯æŒ‰ç…§è‡ªå·±çš„<code>LDAP</code>æœåŠ¡å™¨ä¿¡æ¯è¿›è¡Œä¿®æ”¹):</p><pre class="line-numbers language-properties"><code class="language-properties"><span class="token comment" spellcheck="true">#--------------------------------------------------------------------------------------------------</span><span class="token comment" spellcheck="true"># LDAP CONFIGURATION</span><span class="token comment" spellcheck="true"># Enable the LDAP feature</span><span class="token attr-name">sonar.security.realm</span><span class="token punctuation">=</span><span class="token attr-value">LDAP</span><span class="token comment" spellcheck="true"># Set to true when connecting to a LDAP server using a case-insensitive setup.</span><span class="token comment" spellcheck="true"># sonar.authenticator.downcase=true</span><span class="token comment" spellcheck="true"># URL of the LDAP server. Note that if you are using ldaps, then you should install the server certificate into the Java truststore.</span><span class="token attr-name">ldap.url</span><span class="token punctuation">=</span><span class="token attr-value">ldap://devops.iamzhl.top:389</span><span class="token comment" spellcheck="true"># Bind DN is the username of an LDAP user to connect (or bind) with. Leave this blank for anonymous access to the LDAP directory (optional)</span><span class="token attr-name">ldap.bindDn</span><span class="token punctuation">=</span><span class="token attr-value">cn=Manager,dc=iamzhl,dc=top</span><span class="token comment" spellcheck="true"># Bind Password is the password of the user to connect with. Leave this blank for anonymous access to the LDAP directory (optional)</span><span class="token attr-name">ldap.bindPassword</span><span class="token punctuation">=</span><span class="token attr-value">passwd</span><span class="token comment" spellcheck="true"># Possible values: simple | CRAM-MD5 | DIGEST-MD5 | GSSAPI See http://java.sun.com/products/jndi/tutorial/ldap/security/auth.html (default: simple)</span><span class="token attr-name">ldap.authentication</span><span class="token punctuation">=</span><span class="token attr-value">simple</span><span class="token comment" spellcheck="true"># See :</span><span class="token comment" spellcheck="true">#   * http://java.sun.com/products/jndi/tutorial/ldap/security/digest.html</span><span class="token comment" spellcheck="true">#   * http://java.sun.com/products/jndi/tutorial/ldap/security/crammd5.html</span><span class="token comment" spellcheck="true"># (optional)</span><span class="token comment" spellcheck="true"># ldap.realm=example.org</span><span class="token comment" spellcheck="true"># Context factory class (optional)</span><span class="token comment" spellcheck="true"># ldap.contextFactoryClass=com.sun.jndi.ldap.LdapCtxFactory</span><span class="token comment" spellcheck="true"># Enable usage of StartTLS (default : false)</span><span class="token comment" spellcheck="true"># ldap.StartTLS=true</span><span class="token comment" spellcheck="true"># Follow or not referrals. See http://docs.oracle.com/javase/jndi/tutorial/ldap/referral/jndi.html (default: true)</span><span class="token comment" spellcheck="true"># ldap.followReferrals=false</span><span class="token comment" spellcheck="true"># USER MAPPING</span><span class="token comment" spellcheck="true"># Distinguished Name (DN) of the root node in LDAP from which to search for users (mandatory)</span><span class="token attr-name">ldap.user.baseDn</span><span class="token punctuation">=</span><span class="token attr-value">ou=People,dc=iamzhl,dc=top</span><span class="token comment" spellcheck="true"># LDAP user request. (default: (&amp;(objectClass=inetOrgPerson)(uid={login})) )</span><span class="token comment" spellcheck="true"># ldap.user.request=(&amp;(objectClass=user)(sAMAccountName={login}))</span><span class="token attr-name">ldap.user.request</span><span class="token punctuation">=</span><span class="token attr-value">(&amp;(objectClass=inetOrgPerson)(uid={login}))</span><span class="token comment" spellcheck="true"># Attribute in LDAP defining the userâ€™s real name. (default: cn)</span><span class="token comment" spellcheck="true"># ldap.user.realNameAttribute=name</span><span class="token attr-name">ldap.user.realNameAttribute</span><span class="token punctuation">=</span><span class="token attr-value">cn</span><span class="token comment" spellcheck="true"># Attribute in LDAP defining the userâ€™s email. (default: mail)</span><span class="token comment" spellcheck="true"># ldap.user.emailAttribute=email</span><span class="token attr-name">ldap.user.emailAttribute</span><span class="token punctuation">=</span><span class="token attr-value">mail</span><span class="token comment" spellcheck="true"># GROUP MAPPING</span><span class="token comment" spellcheck="true"># Distinguished Name (DN) of the root node in LDAP from which to search for groups. (optional, default: empty)</span><span class="token comment" spellcheck="true"># ldap.group.baseDn=cn=groups,dc=example,dc=org</span><span class="token attr-name">ldap.group.baseDn</span><span class="token punctuation">=</span><span class="token attr-value">ou=People,dc=iamzhl,dc=top</span><span class="token comment" spellcheck="true"># LDAP group request (default: (&amp;(objectClass=groupOfUniqueNames)(uniqueMember={dn})) )</span><span class="token comment" spellcheck="true"># ldap.group.request=(&amp;(objectClass=group)(member={dn}))</span><span class="token attr-name">ldap.group.request</span><span class="token punctuation">=</span><span class="token attr-value">(&amp;(objectClass=posixGroup)(memberUid={uid}))</span><span class="token comment" spellcheck="true"># Property used to specifiy the attribute to be used for returning the list of user groups in the compatibility mode. (default: cn)</span><span class="token comment" spellcheck="true"># ldap.group.idAttribute=sAMAccountName</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¿®æ”¹å®Œæˆåï¼Œé‡å¯<code>sonar</code></p><pre class="line-numbers language-bash"><code class="language-bash">$ sonar restart<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‰“å¼€<code>sonar</code>ç½‘å€ï¼Œè¾“å…¥<code>LDAP</code>ä¸­çš„ç”¨æˆ·åå’Œå¯†ç åç‚¹å‡»ç™»å½•</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/89/7728c5a52a96a6841a426155062a56.jpg" alt=""></p><p>ç™»é™†æˆåŠŸåï¼Œæ­£å¸¸è·å–ç”¨æˆ·å</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/dd/53d39dc0858679e2a4949419417678.jpg" alt=""></p><p>è‡³æ­¤ï¼Œ<code>SonarQube</code>æ•´åˆ<code>LDAP</code>å®Œæˆ</p><h2 id="æ•´åˆCASå•ç‚¹ç™»å½•"><a href="#æ•´åˆCASå•ç‚¹ç™»å½•" class="headerlink" title="æ•´åˆCASå•ç‚¹ç™»å½•"></a>æ•´åˆ<code>CAS</code>å•ç‚¹ç™»å½•</h2><h3 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h3><p><code>SonarQube</code>æä¾›äº†ä¸€ç§<code>SSO</code>æœºåˆ¶ï¼Œå¯ä»¥ç”¨æ¥ä½œä¸ºå•ç‚¹ç™»å½•çš„å®ç°æ–¹å¼ï¼Œå°±æ˜¯ä½¿ç”¨<code>HTTP header</code>çš„æ–¹å¼ï¼Œè€Œ<code>CAS</code>ä¹Ÿæä¾›äº†ä¸€ç§ç”¨äº<code>apache</code>æœåŠ¡çš„è®¤è¯æ–¹å¼ï¼Œè¿™å°±æ˜¯<code>mod_auth_cas</code>ï¼Œæ€è·¯å¾ˆç®€å•ï¼Œæˆ‘ä»¬åˆ©ç”¨<code>apache</code>åå‘ä»£ç†ï¼Œåšä¸€ä¸ªç«¯å£ç”¨äºè™šæ‹Ÿä¸»æœºæ¥è½¬å‘<code>SonarQube</code>æœåŠ¡ï¼Œç„¶ååœ¨è¿™ä¸ªè™šæ‹Ÿä¸»æœºå†…éƒ¨åŠ å…¥<code>mod_auth_cas</code>æä¾›çš„è®¤è¯æ‹¦æˆªï¼ŒåŒæ—¶åœ¨é‡Œé¢æŒ‡å®šä¸€ä¸ª<code>HTTP header</code>ç”¨äºå‘é€è®¤è¯åçš„è¯·æ±‚åˆ°<code>SonarQube</code>ï¼Œç„¶åï¼Œ<code>SonarQube</code>æ¥æ”¶åˆ°è¿™ä¸ªè¯·æ±‚åï¼Œå‘ç°æ­£æ˜¯è‡ªå·±è®¾å®šçš„<code>HTTP header</code>ï¼Œäºæ˜¯äºˆä»¥é€šè¿‡è®¤è¯ã€‚è¿™å°±æ˜¯æ•´ä¸ªè®¤è¯æµç¨‹ï¼Œä¸‹é¢å¼€å§‹ä»‹ç»æ•´åˆæ–¹æ³•ã€‚</p><h3 id="SonarQubeä¿®æ”¹"><a href="#SonarQubeä¿®æ”¹" class="headerlink" title="SonarQubeä¿®æ”¹"></a><code>SonarQube</code>ä¿®æ”¹</h3><pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">vi</span> /usr/local/sonarqube-7.4/conf/sonar.properties<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¿®æ”¹å¦‚ä¸‹éƒ¨åˆ†(å°±æ˜¯å°†<code>SSO AUTHENTICATION</code>éƒ¨åˆ†çš„å‚æ•°å–æ¶ˆæ³¨é‡Šï¼Œä»¤å…¶ç”Ÿæ•ˆ)</p><pre class="line-numbers language-properties"><code class="language-properties"><span class="token comment" spellcheck="true">#--------------------------------------------------------------------------------------------------</span><span class="token comment" spellcheck="true"># SSO AUTHENTICATION</span><span class="token comment" spellcheck="true"># Enable authentication using HTTP headers</span><span class="token attr-name">sonar.web.sso.enable</span><span class="token punctuation">=</span><span class="token attr-value">true</span><span class="token comment" spellcheck="true"># Name of the header to get the user login.</span><span class="token comment" spellcheck="true"># Only alphanumeric, '.' and '@' characters are allowed</span><span class="token attr-name">sonar.web.sso.loginHeader</span><span class="token punctuation">=</span><span class="token attr-value">X-Forwarded-Login</span><span class="token comment" spellcheck="true"># Name of the header to get the user name</span><span class="token attr-name">sonar.web.sso.nameHeader</span><span class="token punctuation">=</span><span class="token attr-value">X-Forwarded-Name</span><span class="token comment" spellcheck="true"># Name of the header to get the user email (optional)</span><span class="token attr-name">sonar.web.sso.emailHeader</span><span class="token punctuation">=</span><span class="token attr-value">X-Forwarded-Email</span><span class="token comment" spellcheck="true"># Name of the header to get the list of user groups, separated by comma (optional).</span><span class="token comment" spellcheck="true"># If the sonar.sso.groupsHeader is set, the user will belong to those groups if groups exist in SonarQube.</span><span class="token comment" spellcheck="true"># If none of the provided groups exists in SonarQube, the user will only belong to the default group.</span><span class="token comment" spellcheck="true"># Note that the default group will always be set.</span><span class="token attr-name">sonar.web.sso.groupsHeader</span><span class="token punctuation">=</span><span class="token attr-value">X-Forwarded-Groups</span><span class="token comment" spellcheck="true"># Interval used to know when to refresh name, email and groups.</span><span class="token comment" spellcheck="true"># During this interval, if for instance the name of the user is changed in the header, it will only be updated after X minutes.</span><span class="token attr-name">sonar.web.sso.refreshIntervalInMinutes</span><span class="token punctuation">=</span><span class="token attr-value">5</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¿®æ”¹<code>app.d5dba530.chunk.js</code>ï¼Œè§£å†³ç™»å‡ºé—®é¢˜ï¼Œä¸åŒçš„ç‰ˆæœ¬ä¸åŒï¼Œ<code>7.2.1</code>çš„åœ¨<code>main</code>å¼€å¤´çš„ä¸€ä¸ª<code>js</code>æ–‡ä»¶ä¸­ã€‚</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi /usr/local/sonarqube-7.4/web/js/app.d5dba530.chunk.js</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¿®æ”¹å¦‚ä¸‹</p><pre class="line-numbers language-js"><code class="language-js">t<span class="token punctuation">.</span>handleLogout <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// e.preventDefault(), t.context.router.push("/sessions/logout") </span>    t<span class="token punctuation">.</span>context<span class="token punctuation">.</span>router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">"/sessions/logout"</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">//å»æ‰e.preventDefault()æ–¹æ³•</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-js"><code class="language-js">r<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"li"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> r<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//href: "#",</span>    href<span class="token punctuation">:</span> <span class="token string">"http://192.168.6.99:8080/cas/logout"</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">//å°†æ­¤æ³¨é”€æŒ‰é’®çš„hrefæ”¹ä¸ºCASæœåŠ¡å™¨çš„ç™»å‡ºé¡µé¢</span>    onClick<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleLogout<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="mod-auth-casä¿®æ”¹"><a href="#mod-auth-casä¿®æ”¹" class="headerlink" title="mod_auth_casä¿®æ”¹"></a><code>mod_auth_cas</code>ä¿®æ”¹</h3><p>ç„¶åå®‰è£…<code>mod_auth_cas</code></p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># yum -y install mod_auth_cas</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é…ç½®<code>mod_auth_cas</code></p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi /etc/httpd/conf.d/auth_cas.conf</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¿®æ”¹<code>CAS</code>çš„<code>Cookie</code>å­˜å‚¨ä½ç½®ä»¥åŠç™»å½•åœ°å€å’ŒéªŒè¯åœ°å€ç­‰å‚æ•°å¦‚ä¸‹</p><pre class="line-numbers language-properties"><code class="language-properties"><span class="token attr-name">LogLevel</span> <span class="token attr-value">Debug</span><span class="token attr-name">CASDebug</span> <span class="token attr-value">On</span><span class="token attr-name">CASVersion</span> <span class="token attr-value">2</span><span class="token attr-name">CASTimeout</span> <span class="token attr-value">1740</span><span class="token attr-name">CASIdleTimeout</span> <span class="token attr-value">1740</span><span class="token attr-name">CASSSOEnabled</span> <span class="token attr-value">On</span><span class="token attr-name">CASCookiePath</span> <span class="token attr-value">/var/cache/httpd/mod_auth_cas/</span><span class="token attr-name">CASLoginURL</span> <span class="token attr-value">http://devops.iamzhl.top:8080/cas/login</span><span class="token attr-name">CASValidateURL</span> <span class="token attr-value">http://devops.iamzhl.top:8080/cas/serviceValidate</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="apacheä¿®æ”¹"><a href="#apacheä¿®æ”¹" class="headerlink" title="apacheä¿®æ”¹"></a><code>apache</code>ä¿®æ”¹</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi /etc/httpd/conf/httpd.conf</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ·»åŠ è™šæ‹Ÿä¸»æœº</p><pre class="line-numbers language-properties"><code class="language-properties"><span class="token comment" spellcheck="true"># æ·»åŠ ä¸€ä¸ªç›‘å¬ç«¯å£ 83 ç”¨ä½œ SonarQube çš„ä»£ç†ä¸»æœº</span><span class="token attr-name">Listen</span> <span class="token attr-value">83</span><span class="token comment" spellcheck="true"># åŠ è½½ mod_auth_cas æ¨¡å—ï¼Œå¦‚æœå·²ç»åŠ è½½è¯·å¿½ç•¥</span><span class="token attr-name">LoadModule</span> <span class="token attr-value">auth_cas_module modules/mod_auth_cas.so</span><span class="token comment" spellcheck="true"># è®¾ç½® SonarQube çš„è™šæ‹Ÿä¸»æœº</span><span class="token attr-name">&lt;VirtualHost</span> <span class="token attr-value">*:83></span><span class="token attr-name">        ServerName</span> <span class="token attr-value">devops.iamzhl.top</span><span class="token attr-name">        ServerAdmin</span> <span class="token attr-value">15563836030@163.com</span><span class="token attr-name">        CASRootProxiedAs</span> <span class="token attr-value">http://devops.iamzhl.top:83</span><span class="token attr-name">        ProxyPreserveHost</span> <span class="token attr-value">On</span><span class="token attr-name">        ProxyPass</span> <span class="token attr-value">/ http://devops.iamzhl.top:9000/</span><span class="token attr-name">        ProxyPassReverse</span> <span class="token attr-value">/ http://devops.iamzhl.top:9000/</span><span class="token attr-name">        ProxyPass</span> <span class="token attr-value">/sessions/logout http://devops.iamzhl.top:8080/cas/logout</span><span class="token attr-name">        ProxyPassReverse</span> <span class="token attr-value">/sessions/logout http://devops.iamzhl.top:8080/cas/logout</span><span class="token attr-name">        ProxyPass</span> <span class="token attr-value">/api/authentication/logout http://devops.iamzhl.top:8080/cas/logout</span><span class="token attr-name">        ProxyPassReverse</span> <span class="token attr-value">/api/authentication/logout http://devops.iamzhl.top:8080/cas/logout</span><span class="token attr-name">        ErrorLog</span> <span class="token attr-value">/var/log/sonar/error.log</span><span class="token attr-name">        CustomLog</span> <span class="token attr-value">/var/log/sonar/access.log common</span><span class="token attr-name">        &lt;Location</span> <span class="token attr-value">/></span><span class="token attr-name">                AuthName</span> <span class="token attr-value">"Welcome to devops sonar"</span><span class="token attr-name">                CASAuthNHeader</span> <span class="token attr-value">X-Forwarded-Login</span><span class="token attr-name">                Authtype</span> <span class="token attr-value">CAS</span><span class="token attr-name">                require</span> <span class="token attr-value">valid-user</span>        &lt;/Location><span class="token attr-name">        &lt;Proxy</span> <span class="token attr-value">*></span><span class="token attr-name">                Order</span> <span class="token attr-value">deny,allow</span><span class="token attr-name">                Allow</span> <span class="token attr-value">from all</span>        &lt;/Proxy>&lt;/VirtualHost><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="é‡å¯æœåŠ¡"><a href="#é‡å¯æœåŠ¡" class="headerlink" title="é‡å¯æœåŠ¡"></a>é‡å¯æœåŠ¡</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># mkdir /var/log/sonar</span><span class="token comment" spellcheck="true"># chown -R apache:apache /var/log/sonar</span><span class="token comment" spellcheck="true"># su sonar</span>$ sonar restart<span class="token comment" spellcheck="true"># su </span><span class="token comment" spellcheck="true"># systemctl restart httpd</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p>æ‰“å¼€ç½‘å€<code>http://devops.iamzhl.top:83</code>ï¼Œå‘ç°è‡ªåŠ¨è·³è½¬åˆ°äº†<code>CAS</code>çš„ç™»å½•ç•Œé¢ï¼Œç½‘å€æ˜¯<code>http://devops.iamzhl.top:8080/cas/login?service=http%3a%2f%2fdevops.iamzhl.top%3a83%2f</code></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/0b/b05aa63a31ffc624e42290d71c68e8.jpg" alt=""></p><p>è¾“å…¥ç”¨æˆ·åå¯†ç åç‚¹å‡»ç™»å½•</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/6d/548f70b5aba6e4399e06ae288adfa9.jpg" alt=""></p><p>å¦‚å›¾æ‰€ç¤ºï¼Œç™»é™†æˆåŠŸï¼Œåœ°å€æ˜¯<code>http://devops.iamzhl.top:83/projects</code></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/e1/463c767ddd0147ed54fba65d91a0f7.jpg" alt=""></p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç‚¹å‡»æ³¨é”€ï¼Œå°±ä¼šç™»å‡ºå¹¶è·³è½¬è‡³<code>CAS</code>çš„ç™»å‡ºç•Œé¢</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/e9/a067be6a85ec888bc9ab25bcf0d0e7.jpg" alt=""></p><p>è‡³æ­¤ï¼Œ<code>SonarQube</code>æ•´åˆ<code>CAS</code>å•ç‚¹ç™»å½•å®Œæˆã€‚</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> CI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CAS </tag>
            
            <tag> LDAP </tag>
            
            <tag> SonarQube </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Jenkins æ•´åˆ LDAP ä»¥åŠ CAS å•ç‚¹ç™»å½•</title>
      <link href="/posts/7a8d1bd5/"/>
      <url>/posts/7a8d1bd5/</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯ä»‹ç»"><a href="#èƒŒæ™¯ä»‹ç»" class="headerlink" title="èƒŒæ™¯ä»‹ç»"></a>èƒŒæ™¯ä»‹ç»</h2><ul><li>Jenkins ç‰ˆæœ¬ï¼š2.138.3</li><li>Jenkins å®‰è£…æ–¹å¼ï¼š Tomcat å®¹å™¨éƒ¨ç½² war åŒ…</li><li>Jenkins åœ°å€ï¼š<a href="http://devops.iamzhl.top:8080/jenkins" target="_blank" rel="noopener">http://devops.iamzhl.top:8080/jenkins</a></li><li>openLDAP æœåŠ¡ï¼šldap://devops.iamzhl.top:389</li><li>CAS æœåŠ¡ï¼š<a href="http://devops.iamzhl.top:8080/cas" target="_blank" rel="noopener">http://devops.iamzhl.top:8080/cas</a></li></ul><h2 id="æ•´åˆ-openLDAP"><a href="#æ•´åˆ-openLDAP" class="headerlink" title="æ•´åˆ openLDAP"></a>æ•´åˆ openLDAP</h2><p>é¦–å…ˆå» Jenkins æ’ä»¶å®˜ç½‘ä¸‹è½½ LDAP å’Œ CAS æ’ä»¶</p><ul><li>LDAPï¼š<a href="https://updates.jenkins.io/download/plugins/ldap/" target="_blank" rel="noopener">https://updates.jenkins.io/download/plugins/ldap/</a></li><li>CASï¼š<a href="https://updates.jenkins.io/download/plugins/cas-plugin/" target="_blank" rel="noopener">https://updates.jenkins.io/download/plugins/cas-plugin/</a></li></ul><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/46/53fb1f3e3cfa00c055965bc99c7fbd.jpg" alt=""></p><p>å¦‚å›¾ï¼Œç‚¹å‡»<code>ç³»ç»Ÿç®¡ç†</code></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/86/4f0c2ebaef58a3c719397b0adfbc5b.jpg" alt=""></p><p>ç‚¹å‡»æ’ä»¶ç®¡ç† -&gt; é«˜çº§ -&gt; ä¸Šä¼ æ’ä»¶(é€‰æ‹©æ–‡ä»¶)</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/65/bfd2b91d856ca8132434b2da51de6e.jpg" alt=""></p><p>å¼¹å‡ºé€‰æ‹©æ–‡ä»¶çš„å¯¹è¯æ¡†åï¼Œé¦–å…ˆé€‰æ‹©æˆ‘ä»¬ä¸‹è½½å¥½çš„ LDAP æ’ä»¶ï¼Œç„¶åç‚¹å‡»ä¸Šä¼ ï¼Œç„¶åå°±ä¼šè·³è½¬åˆ°å®‰è£…ç•Œé¢ï¼Œæˆ‘ä»¬å‹¾é€‰<code>å®‰è£…å®Œæˆåé‡å¯Jenkins(ç©ºé—²æ—¶)</code>ï¼Œç­‰å¾…ä¸€ä¼šJenkinså®‰è£…æ’ä»¶å®Œæˆåå°±ä¼šé‡å¯</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/c5/7cf7ef11ecd49b19b07ea7333cc26a.jpg" alt=""></p><p>è¾“å…¥ç”¨æˆ·åå¯†ç ç™»å½•åï¼Œä¾æ¬¡æ‰“å¼€<code>ç³»ç»Ÿç®¡ç†</code> -&gt; <code>å…¨å±€å®‰å…¨é…ç½®</code>ï¼Œåœ¨å®‰å…¨åŸŸå‹¾é€‰ LDAPï¼Œç‚¹å‡»<code>Advanced Server Configuration</code>,å¼€å§‹é…ç½® LDAP æœåŠ¡å™¨çš„ç»‘å®šä¿¡æ¯</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/12/adf30303385802ce2fc45d175a7d16.jpg" alt=""></p><p>ç‚¹å‡»<code>Test LDAP settings</code>ï¼Œæµ‹è¯•<code>LDAP</code>é…ç½®æ˜¯å¦å¯ç”¨ï¼Œå¦‚ä¸‹å›¾ï¼Œè¾“å…¥ä¸€ä¸ª<code>LDAP</code>æœåŠ¡å™¨ä¸­å­˜åœ¨çš„ç”¨æˆ·è´¦å·å’Œå¯†ç ï¼Œç‚¹å‡»<code>Test</code></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/93/bca0bd8c0ac21d1b2c4cffd7cea3bc.jpg" alt=""></p><p>å¦‚æœæµ‹è¯•æˆåŠŸï¼Œä¼šæ‰“å°å‡ºç±»ä¼¼å¦‚ä¸‹çš„ä¿¡æ¯</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/f5/7453c8051a55d9622dbe1e461d1b25.jpg" alt=""></p><p>ç‚¹å‡»<code>åº”ç”¨</code>ï¼Œç„¶åç‚¹å‡»<code>ä¿å­˜</code>ã€‚</p><p>æµ‹è¯•ä¸€ä¸‹ï¼Œç”¨<code>LDAP</code>ä¸­çš„ç”¨æˆ·è¿›è¡Œç™»å½•</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/1e/46a5ac15c7611eff4ade4830966565.jpg" alt=""></p><p>ç™»é™†æˆåŠŸï¼Œé…ç½®å®Œæˆï¼Œåˆ°è¿™é‡Œï¼Œ<code>Jenkins</code>æ•´åˆ<code>LDAP</code>è®¤è¯å°±å®Œæˆäº†ã€‚</p><h2 id="æ•´åˆ-CAS-å•ç‚¹ç™»å½•"><a href="#æ•´åˆ-CAS-å•ç‚¹ç™»å½•" class="headerlink" title="æ•´åˆ CAS å•ç‚¹ç™»å½•"></a>æ•´åˆ CAS å•ç‚¹ç™»å½•</h2><p>é¦–å…ˆå®‰è£…<code>CAS</code>æ’ä»¶ï¼Œå’Œä¸Šé¢å®‰è£…<code>LDAP</code>æ’ä»¶æ­¥éª¤ä¸€æ ·ï¼Œå®‰è£…å®Œ<code>CAS</code>æ‰“å¼€<code>ç³»ç»Ÿç®¡ç†</code> -&gt; <code>å…¨å±€å®‰å…¨é…ç½®</code>ï¼Œåœ¨å®‰å…¨åŸŸå‹¾é€‰<code>CAS (Central Authentication Service)</code>ï¼Œå¦‚å›¾æ‰€ç¤ºï¼Œé…ç½®å¥½<code>CAS</code>çš„<code>URL</code>å’Œ<code>CAS åè®®</code></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/b7/99ca653df5281634fed8a6dcc4f3c2.jpg" alt=""></p><p>ç„¶åç‚¹å‡»<code>åº”ç”¨</code>-&gt;<code>ä¿å­˜</code>ï¼Œæ³¨é”€ï¼Œç„¶åé‡æ–°ç™»å½•</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/ce/bf7939fceebf45806037fd759179f4.jpg" alt=""></p><p>è¿™æ—¶å°±å¯ä»¥è·³è½¬åˆ°<code>CAS</code>çš„ç™»å½•ç•Œé¢äº†ï¼Œè¾“å…¥ç”¨æˆ·åå¯†ç ç‚¹å‡»ç™»å½•ï¼Œå°±å¯ä»¥æ­£å¸¸çš„ç™»å½•è¿›å…¥<code>Jenkins</code>ç³»ç»Ÿäº†ã€‚</p><p>è‡³æ­¤ï¼Œ<code>Jenkins</code>æ•´åˆ<code>CAS</code>å®Œæˆã€‚</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> CI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CAS </tag>
            
            <tag> Jenkins </tag>
            
            <tag> LDAP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CentOSå®‰è£…éƒ¨ç½² openLDAP</title>
      <link href="/posts/ba648987/"/>
      <url>/posts/ba648987/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>OpenLDAP æ˜¯è½»å‹ç›®å½•è®¿é—®åè®®<code>Lightweight Directory Access Protocol</code> - <code>LDAP</code>çš„è‡ªç”±å’Œå¼€æºçš„å®ç°ï¼Œåœ¨å…¶<code>OpenLDAP</code>è®¸å¯è¯ä¸‹å‘è¡Œï¼Œå¹¶å·²ç»è¢«åŒ…å«åœ¨ä¼—å¤šæµè¡Œçš„<code>Linux</code>å‘è¡Œç‰ˆä¸­ã€‚</p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># cd ~</span><span class="token comment" spellcheck="true"># yum -y install openldap-servers openldap-clients</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/1c/02ad1e703c7187295361dbff3fad9c.jpg" alt=""></p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># cp /usr/share/openldap-servers/DB_CONFIG.example /var/lib/ldap/DB_CONFIG</span><span class="token comment" spellcheck="true"># chown ldap:ldap /var/lib/ldap/DB_CONFIG</span><span class="token comment" spellcheck="true"># systemctl start slapd</span><span class="token comment" spellcheck="true"># systemctl enable slapd</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># slappasswd</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/75/c5c970bd59e02ac7434f217a5f27a6.jpg" alt=""></p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi chrootpw.ldif</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-properties"><code class="language-properties"><span class="token comment" spellcheck="true"># specify the password generated above for "olcRootPW" section</span><span class="token attr-name">dn</span><span class="token punctuation">:</span> <span class="token attr-value">olcDatabase={0}config,cn=config</span><span class="token attr-name">changetype</span><span class="token punctuation">:</span> <span class="token attr-value">modify</span><span class="token attr-name">add</span><span class="token punctuation">:</span> <span class="token attr-value">olcRootPW</span><span class="token attr-name">olcRootPW</span><span class="token punctuation">:</span> <span class="token attr-value">{SSHA}xxxxxxxxxxxxxxxxxxxxxxxx</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># ldapadd -Y EXTERNAL -H ldapi:/// -f chrootpw.ldif </span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="å¯¼å…¥åŸºæœ¬æ¨¡å¼"><a href="#å¯¼å…¥åŸºæœ¬æ¨¡å¼" class="headerlink" title="å¯¼å…¥åŸºæœ¬æ¨¡å¼"></a>å¯¼å…¥åŸºæœ¬æ¨¡å¼</h2><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># ldapadd -Y EXTERNAL -H ldapi:/// -f /etc/openldap/schema/cosine.ldif </span><span class="token comment" spellcheck="true"># ldapadd -Y EXTERNAL -H ldapi:/// -f /etc/openldap/schema/nis.ldif </span><span class="token comment" spellcheck="true"># ldapadd -Y EXTERNAL -H ldapi:/// -f /etc/openldap/schema/inetorgperson.ldif </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="åœ¨ldapçš„DBä¸­è®¾ç½®åŸŸå"><a href="#åœ¨ldapçš„DBä¸­è®¾ç½®åŸŸå" class="headerlink" title="åœ¨ldapçš„DBä¸­è®¾ç½®åŸŸå"></a>åœ¨ldapçš„DBä¸­è®¾ç½®åŸŸå</h2><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># slappasswd </span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/de/9a4502a39d572493b8ae8d723a08ef.jpg" alt=""></p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi chdomain.ldif</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-properties"><code class="language-properties"><span class="token comment" spellcheck="true"># replace to your own domain name for "dc=***,dc=***" section</span><span class="token comment" spellcheck="true"># specify the password generated above for "olcRootPW" section</span><span class="token attr-name">dn</span><span class="token punctuation">:</span> <span class="token attr-value">olcDatabase={1}monitor,cn=config</span><span class="token attr-name">changetype</span><span class="token punctuation">:</span> <span class="token attr-value">modify</span><span class="token attr-name">replace</span><span class="token punctuation">:</span> <span class="token attr-value">olcAccess</span><span class="token attr-name">olcAccess</span><span class="token punctuation">:</span> <span class="token attr-value">{0}to * by dn.base="gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth"</span><span class="token attr-name">  read</span> <span class="token attr-value">by dn.base="cn=Manager,dc=iamzhl,dc=top" read by * none</span><span class="token attr-name">dn</span><span class="token punctuation">:</span> <span class="token attr-value">olcDatabase={2}hdb,cn=config</span><span class="token attr-name">changetype</span><span class="token punctuation">:</span> <span class="token attr-value">modify</span><span class="token attr-name">replace</span><span class="token punctuation">:</span> <span class="token attr-value">olcSuffix</span><span class="token attr-name">olcSuffix</span><span class="token punctuation">:</span> <span class="token attr-value">dc=iamzhl,dc=top</span><span class="token attr-name">dn</span><span class="token punctuation">:</span> <span class="token attr-value">olcDatabase={2}hdb,cn=config</span><span class="token attr-name">changetype</span><span class="token punctuation">:</span> <span class="token attr-value">modify</span><span class="token attr-name">replace</span><span class="token punctuation">:</span> <span class="token attr-value">olcRootDN</span><span class="token attr-name">olcRootDN</span><span class="token punctuation">:</span> <span class="token attr-value">cn=Manager,dc=iamzhl,dc=top</span><span class="token attr-name">dn</span><span class="token punctuation">:</span> <span class="token attr-value">olcDatabase={2}hdb,cn=config</span><span class="token attr-name">changetype</span><span class="token punctuation">:</span> <span class="token attr-value">modify</span><span class="token attr-name">add</span><span class="token punctuation">:</span> <span class="token attr-value">olcRootPW</span><span class="token attr-name">olcRootPW</span><span class="token punctuation">:</span> <span class="token attr-value">{SSHA}xxxxxxxxxxxxxxxxxxxxxxxx</span><span class="token attr-name">dn</span><span class="token punctuation">:</span> <span class="token attr-value">olcDatabase={2}hdb,cn=config</span><span class="token attr-name">changetype</span><span class="token punctuation">:</span> <span class="token attr-value">modify</span><span class="token attr-name">add</span><span class="token punctuation">:</span> <span class="token attr-value">olcAccess</span><span class="token attr-name">olcAccess</span><span class="token punctuation">:</span> <span class="token attr-value">{0}to attrs=userPassword,shadowLastChange by</span><span class="token attr-name">  dn</span><span class="token punctuation">=</span><span class="token attr-value">"cn=Manager,dc=iamzhl,dc=top" write by anonymous auth by self write by * none</span><span class="token attr-name">olcAccess</span><span class="token punctuation">:</span> <span class="token attr-value">{1}to dn.base="" by * read</span><span class="token attr-name">olcAccess</span><span class="token punctuation">:</span> <span class="token attr-value">{2}to * by dn="cn=Manager,dc=iamzhl,dc=top" write by * read</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># ldapmodify -Y EXTERNAL -H ldapi:/// -f chdomain.ldif </span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi basedomain.ldif</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-properties"><code class="language-properties"><span class="token comment" spellcheck="true"># replace to your own domain name for "dc=***,dc=***" section</span><span class="token attr-name">dn</span><span class="token punctuation">:</span> <span class="token attr-value">dc=iamzhl,dc=top</span><span class="token attr-name">objectClass</span><span class="token punctuation">:</span> <span class="token attr-value">top</span><span class="token attr-name">objectClass</span><span class="token punctuation">:</span> <span class="token attr-value">dcObject</span><span class="token attr-name">objectclass</span><span class="token punctuation">:</span> <span class="token attr-value">organization</span><span class="token attr-name">o</span><span class="token punctuation">:</span> <span class="token attr-value">iamzhl</span><span class="token attr-name">dc</span><span class="token punctuation">:</span> <span class="token attr-value">iamzhl</span><span class="token attr-name">dn</span><span class="token punctuation">:</span> <span class="token attr-value">cn=Manager,dc=iamzhl,dc=top</span><span class="token attr-name">objectClass</span><span class="token punctuation">:</span> <span class="token attr-value">organizationalRole</span><span class="token attr-name">cn</span><span class="token punctuation">:</span> <span class="token attr-value">Manager</span><span class="token attr-name">description</span><span class="token punctuation">:</span> <span class="token attr-value">Directory Manager</span><span class="token attr-name">dn</span><span class="token punctuation">:</span> <span class="token attr-value">ou=People,dc=iamzhl,dc=top</span><span class="token attr-name">objectClass</span><span class="token punctuation">:</span> <span class="token attr-value">organizationalUnit</span><span class="token attr-name">ou</span><span class="token punctuation">:</span> <span class="token attr-value">People</span><span class="token attr-name">dn</span><span class="token punctuation">:</span> <span class="token attr-value">ou=Group,dc=iamzhl,dc=top</span><span class="token attr-name">objectClass</span><span class="token punctuation">:</span> <span class="token attr-value">organizationalUnit</span><span class="token attr-name">ou</span><span class="token punctuation">:</span> <span class="token attr-value">Group</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># ldapadd -x -D cn=Manager,dc=iamzhl,dc=top -W -f basedomain.ldif </span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/d1/46842e7f601199c0f78da4d97d30ad.jpg" alt=""></p><h2 id="æ·»åŠ ä¸€ä¸ªç”¨æˆ·"><a href="#æ·»åŠ ä¸€ä¸ªç”¨æˆ·" class="headerlink" title="æ·»åŠ ä¸€ä¸ªç”¨æˆ·"></a>æ·»åŠ ä¸€ä¸ªç”¨æˆ·</h2><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># slappasswd </span><span class="token comment" spellcheck="true"># vi ldapuser.ldif</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-properties"><code class="language-properties"><span class="token comment" spellcheck="true"># create new</span><span class="token comment" spellcheck="true"># replace to your own domain name for "dc=***,dc=***" section</span><span class="token attr-name">dn</span><span class="token punctuation">:</span> <span class="token attr-value">uid=cent,ou=People,dc=iamzhl,dc=top</span><span class="token attr-name">objectClass</span><span class="token punctuation">:</span> <span class="token attr-value">inetOrgPerson</span><span class="token attr-name">objectClass</span><span class="token punctuation">:</span> <span class="token attr-value">posixAccount</span><span class="token attr-name">objectClass</span><span class="token punctuation">:</span> <span class="token attr-value">shadowAccount</span><span class="token attr-name">cn</span><span class="token punctuation">:</span> <span class="token attr-value">Cent</span><span class="token attr-name">sn</span><span class="token punctuation">:</span> <span class="token attr-value">Linux</span><span class="token attr-name">userPassword</span><span class="token punctuation">:</span> <span class="token attr-value">{SSHA}xxxxxxxxxxxxxxxxx</span><span class="token attr-name">loginShell</span><span class="token punctuation">:</span> <span class="token attr-value">/bin/bash</span><span class="token attr-name">uidNumber</span><span class="token punctuation">:</span> <span class="token attr-value">1000</span><span class="token attr-name">gidNumber</span><span class="token punctuation">:</span> <span class="token attr-value">1000</span><span class="token attr-name">homeDirectory</span><span class="token punctuation">:</span> <span class="token attr-value">/home/cent</span><span class="token attr-name">dn</span><span class="token punctuation">:</span> <span class="token attr-value">cn=cent,ou=Group,dc=iamzhl,dc=top</span><span class="token attr-name">objectClass</span><span class="token punctuation">:</span> <span class="token attr-value">posixGroup</span><span class="token attr-name">cn</span><span class="token punctuation">:</span> <span class="token attr-value">Cent</span><span class="token attr-name">gidNumber</span><span class="token punctuation">:</span> <span class="token attr-value">1000</span><span class="token attr-name">memberUid</span><span class="token punctuation">:</span> <span class="token attr-value">cent</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># ldapadd -x -D cn=Manager,dc=iamzhl,dc=top -W -f ldapuser.ldif </span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="æ·»åŠ æœ¬æœºçš„ç”¨æˆ·å’Œç¾¤ç»„åˆ°ldapç›®å½•"><a href="#æ·»åŠ æœ¬æœºçš„ç”¨æˆ·å’Œç¾¤ç»„åˆ°ldapç›®å½•" class="headerlink" title="æ·»åŠ æœ¬æœºçš„ç”¨æˆ·å’Œç¾¤ç»„åˆ°ldapç›®å½•"></a>æ·»åŠ æœ¬æœºçš„ç”¨æˆ·å’Œç¾¤ç»„åˆ°ldapç›®å½•</h2><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi ldapuser.sh</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-shell"><code class="language-shell"># extract local users and groups who have 1000-9999 digit UID# replace "SUFFIX=***" to your own domain name# this is an example#!/bin/bashSUFFIX='dc=iamzhl,dc=top'LDIF='ldapuser.ldif'echo -n > $LDIFGROUP_IDS=()grep "x:[1-9][0-9][0-9][0-9]:" /etc/passwd | (while read TARGET_USERdo    USER_ID="$(echo "$TARGET_USER" | cut -d':' -f1)"    USER_NAME="$(echo "$TARGET_USER" | cut -d':' -f5 | cut -d' ' -f1,2)"    [ ! "$USER_NAME" ] && USER_NAME="$USER_ID"    LDAP_SN="$(echo "$USER_NAME" | cut -d' ' -f2)"    [ ! "$LDAP_SN" ] && LDAP_SN="$USER_NAME"    LASTCHANGE_FLAG="$(grep "${USER_ID}:" /etc/shadow | cut -d':' -f3)"    [ ! "$LASTCHANGE_FLAG" ] && LASTCHANGE_FLAG="0"    SHADOW_FLAG="$(grep "${USER_ID}:" /etc/shadow | cut -d':' -f9)"    [ ! "$SHADOW_FLAG" ] && SHADOW_FLAG="0"    GROUP_ID="$(echo "$TARGET_USER" | cut -d':' -f4)"    [ ! "$(echo "${GROUP_IDS[@]}" | grep "$GROUP_ID")" ] && GROUP_IDS=("${GROUP_IDS[@]}" "$GROUP_ID")    echo "dn: uid=$USER_ID,ou=People,$SUFFIX" >> $LDIF    echo "objectClass: inetOrgPerson" >> $LDIF    echo "objectClass: posixAccount" >> $LDIF    echo "objectClass: shadowAccount" >> $LDIF    echo "sn: $LDAP_SN" >> $LDIF    echo "givenName: $(echo "$USER_NAME" | awk '{print $1}')" >> $LDIF    echo "cn: $USER_NAME" >> $LDIF    echo "displayName: $USER_NAME" >> $LDIF    echo "uidNumber: $(echo "$TARGET_USER" | cut -d':' -f3)" >> $LDIF    echo "gidNumber: $(echo "$TARGET_USER" | cut -d':' -f4)" >> $LDIF    echo "userPassword: {crypt}$(grep "${USER_ID}:" /etc/shadow | cut -d':' -f2)" >> $LDIF    echo "gecos: $USER_NAME" >> $LDIF    echo "loginShell: $(echo "$TARGET_USER" | cut -d':' -f7)" >> $LDIF    echo "homeDirectory: $(echo "$TARGET_USER" | cut -d':' -f6)" >> $LDIF    echo "shadowExpire: $(passwd -S "$USER_ID" | awk '{print $7}')" >> $LDIF    echo "shadowFlag: $SHADOW_FLAG" >> $LDIF    echo "shadowWarning: $(passwd -S "$USER_ID" | awk '{print $6}')" >> $LDIF    echo "shadowMin: $(passwd -S "$USER_ID" | awk '{print $4}')" >> $LDIF    echo "shadowMax: $(passwd -S "$USER_ID" | awk '{print $5}')" >> $LDIF    echo "shadowLastChange: $LASTCHANGE_FLAG" >> $LDIF    echo >> $LDIFdonefor TARGET_GROUP_ID in "${GROUP_IDS[@]}"do    LDAP_CN="$(grep ":${TARGET_GROUP_ID}:" /etc/group | cut -d':' -f1)"    echo "dn: cn=$LDAP_CN,ou=Group,$SUFFIX" >> $LDIF    echo "objectClass: posixGroup" >> $LDIF    echo "cn: $LDAP_CN" >> $LDIF    echo "gidNumber: $TARGET_GROUP_ID" >> $LDIF    for MEMBER_UID in $(grep ":${TARGET_GROUP_ID}:" /etc/passwd | cut -d':' -f1,3)    do        UID_NUM=$(echo "$MEMBER_UID" | cut -d':' -f2)        [ $UID_NUM -ge 1000 -a $UID_NUM -le 9999 ] && echo "memberUid: $(echo "$MEMBER_UID" | cut -d':' -f1)" >> $LDIF    done    echo >> $LDIFdone)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># sh ldapuser.sh </span><span class="token comment" spellcheck="true"># ldapadd -x -D cn=Manager,dc=iamzhl,dc=top -W -f ldapuser.ldif </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/d5/aaa70f4f22ad6ee40fa74bf027bd4b.jpg" alt=""></p><h2 id="åˆ©ç”¨Apache-Directory-Studioè¿›è¡Œç®¡ç†"><a href="#åˆ©ç”¨Apache-Directory-Studioè¿›è¡Œç®¡ç†" class="headerlink" title="åˆ©ç”¨Apache Directory Studioè¿›è¡Œç®¡ç†"></a>åˆ©ç”¨Apache Directory Studioè¿›è¡Œç®¡ç†</h2><p>Apache Directory Studio æ˜¯ä¸€ä¸ª LDAP çš„å·¥å…·å¹³å°ï¼Œç”¨æ¥è¿æ¥åˆ°ä»»ä½• LDAP æœåŠ¡å™¨å¹¶è¿›è¡Œç®¡ç†å’Œå¼€å‘å·¥ä½œã€‚å…¶å¯ä»¥å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š</p><ul><li>LDAPæµè§ˆå™¨</li><li>LDIFç¼–è¾‘å™¨</li><li>åµŒå…¥å¼ ApacheDS</li><li>ACIç¼–è¾‘å™¨</li><li>å±æ€§ç®¡ç†</li></ul><p>ä¸‹é¢ä»¥æ–°å»ºè¿æ¥å’Œæ–°å¢ç”¨æˆ·ä¸ºä¾‹è¿›è¡Œæ¼”ç¤º</p><p>å¦‚å›¾ï¼Œç‚¹å‡» New Connection æ–°å»ºä¸€ä¸ª ldap è¿æ¥</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/12/d782ef026127039c48173727402ae1.jpg" alt=""></p><p>ä¾æ¬¡è¾“å…¥è¿æ¥åã€ä¸»æœºåä»¥åŠç«¯å£å·åç‚¹å‡»<code>Next</code></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/b4/8238cc5d14bd32906fb1bf4d2fb726.jpg" alt=""></p><p>å†ä¾æ¬¡è¾“å…¥ç»‘å®šçš„<code>DN</code>å’Œå¯†ç åç‚¹å‡»<code>Finish</code></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/6d/33932a9dccd444922051239295a40e.jpg" alt=""></p><p>æ–°å»ºä¸€ä¸ª openLDAP ç”¨æˆ· test / 123456</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/0e/e69bb807212cc32a80cb28c4b927e1.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/01/ab9d40ac8d216e3e2b99a287082fa7.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/14/de8c6a3b3854b28bca29d84e338f9f.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/53/287f9a9a0cfe1c25c3c66d775fb214.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/af/af3a63b732070ac51f27b10f6e2dca.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/b3/da28177e70ab2cb77421d6ae16ca95.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/70/749184f3907b06951093fc2a944e42.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/c0/5ddca5f311e7f8b2ba598480c3636e.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/e7/8a989532254213ac72efc235676a2a.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/2e/ebca96c81bd780e9b90d9bdbd3415a.jpg" alt=""></p><h2 id="Credits"><a href="#Credits" class="headerlink" title="Credits"></a>Credits</h2><p>æœ¬æ–‡å¤šå¤„å‚è€ƒ<a href="https://blog.csdn.net/wenwenxiong/article/details/76855047" target="_blank" rel="noopener">centos7ä¸‹ldapæœåŠ¡æ­å»º</a>ï¼Œæ„Ÿè°¢<a href="https://blog.csdn.net/wenwenxiong" target="_blank" rel="noopener">wenwenxiong</a>çš„åˆ†äº«ã€‚</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> openLDAP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CAS 5.3.4 å®‰è£…éƒ¨ç½²</title>
      <link href="/posts/a9996dc0/"/>
      <url>/posts/a9996dc0/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><code>CAS</code>å…¨ç§°<code>Central Authentication Service</code>ï¼Œä¸­å¤®è®¤è¯æœåŠ¡ï¼Œä¸€ç§ç‹¬ç«‹å¼€æ”¾æŒ‡ä»¤åè®®ã€‚CAS æ˜¯ Yale å¤§å­¦å‘èµ·çš„ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œæ—¨åœ¨ä¸º Web åº”ç”¨ç³»ç»Ÿæä¾›ä¸€ç§å¯é çš„å•ç‚¹ç™»å½•æ–¹æ³•ï¼ŒCAS åœ¨ 2004 å¹´ 12 æœˆæ­£å¼æˆä¸º JA-SIG çš„ä¸€ä¸ªé¡¹ç›®ï¼Œç›®å‰æ˜¯ä¸€ç§ä¼ä¸šçº§çš„å•ç‚¹ç™»å½•è§£å†³æ–¹æ¡ˆã€‚</p><h2 id="åè®®ä»‹ç»"><a href="#åè®®ä»‹ç»" class="headerlink" title="åè®®ä»‹ç»"></a>åè®®ä»‹ç»</h2><p>å…³äº oauth2.0 çš„åŸç†åŠä»‹ç»å¯ä»¥å‚è€ƒ<a href="http://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html" target="_blank" rel="noopener">ç†è§£OAuth 2.0 - é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿—</a>ï¼Œè¿™é‡Œä¸åšèµ˜è¿°ã€‚</p><h2 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h2><p><code>CAS</code>æ˜¯åŸºäºSpringå†™çš„ï¼Œå› æ­¤éœ€è¦å‡†å¤‡Javaç¯å¢ƒï¼Œå®˜æ–¹æä¾›äº†ä¸€ç§éå¸¸å¥½ç”¨çš„ç¼–è¯‘æ–¹æ³•ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨æ—¶å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚æ¥å†³å®šä¾èµ–çš„é€‰æ‹©ï¼Œæœ¬æ–‡ä¸»è¦ä»¥openLDAPå’Œoauthä¸ºä¾‹ã€‚ç¼–è¯‘æ—¶éœ€è¦mavenç¯å¢ƒã€‚è¿è¡Œæ—¶éœ€è¦ Tomcat å®¹å™¨ï¼Œå› æ­¤éœ€è¦æå‰å‡†å¤‡å¥½ Tomcat ç¯å¢ƒã€‚åç»­æˆ‘ä»¬ä¼šæ•´åˆ openLDAP åšç»Ÿä¸€ç”¨æˆ·ç®¡ç†ï¼Œå› æ­¤è¯·å…ˆå®‰è£…å¥½ openLDAPã€‚</p><h2 id="ç¼–è¯‘"><a href="#ç¼–è¯‘" class="headerlink" title="ç¼–è¯‘"></a>ç¼–è¯‘</h2><p>é¦–å…ˆå»é¡¹ç›®åœ°å€ä¸‹è½½ç¼–è¯‘æ¨¡æ¿</p><pre class="line-numbers language-url"><code class="language-url">https://github.com/apereo/cas-overlay-template<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># git clone https://github.com/apereo/cas-overlay-template</span><span class="token comment" spellcheck="true"># cd cas-overlay-template</span><span class="token comment" spellcheck="true"># vi pom.xml</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ‰¾åˆ°ä¸‹é¢çš„éƒ¨åˆ†</p><pre class="line-numbers language-properties"><code class="language-properties">&lt;dependencies>    &lt;dependency>        &lt;groupId>org.apereo.cas&lt;/groupId>        &lt;artifactId>cas-server-webapp${app.server}&lt;/artifactId>        &lt;version>${cas.version}&lt;/version>        &lt;type>war&lt;/type>        &lt;scope>runtime&lt;/scope>    &lt;/dependency>    &lt;!--<span class="token attr-name">    ...Additional</span> <span class="token attr-value">dependencies may be placed here...</span>    -->    &lt;/dependencies><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å°†æ³¨é‡Šçš„éƒ¨åˆ†æ›¿æ¢ä¸ºæˆ‘ä»¬éœ€è¦çš„æ¨¡å—</p><pre class="line-numbers language-properties"><code class="language-properties">&lt;dependencies>    &lt;dependency>        &lt;groupId>org.apereo.cas&lt;/groupId>        &lt;artifactId>cas-server-webapp${app.server}&lt;/artifactId>        &lt;version>${cas.version}&lt;/version>        &lt;type>war&lt;/type>        &lt;scope>runtime&lt;/scope>    &lt;/dependency>    &lt;dependency>        &lt;groupId>org.apereo.cas&lt;/groupId>        &lt;artifactId>cas-server-support-oauth-webflow&lt;/artifactId>        &lt;version>${cas.version}&lt;/version>    &lt;/dependency>    &lt;dependency>        &lt;groupId>mysql&lt;/groupId>        &lt;artifactId>mysql-connector-java&lt;/artifactId>        &lt;version>${mysql.driver.version}&lt;/version>        &lt;scope>runtime&lt;/scope>    &lt;/dependency>    &lt;dependency>        &lt;groupId>org.apereo.cas&lt;/groupId>        &lt;artifactId>cas-server-support-jdbc&lt;/artifactId>        &lt;version>${cas.version}&lt;/version>    &lt;/dependency>    &lt;dependency>        &lt;groupId>org.apereo.cas&lt;/groupId>        &lt;artifactId>cas-server-support-jdbc-drivers&lt;/artifactId>        &lt;version>${cas.version}&lt;/version>    &lt;/dependency>    &lt;!--    &lt;dependency>        &lt;groupId>org.apereo.cas&lt;/groupId>        &lt;artifactId>cas-server-support-rest&lt;/artifactId>        &lt;version>${cas.version}&lt;/version>        &lt;scope>runtime&lt;/scope>    &lt;/dependency>    -->    &lt;dependency>        &lt;groupId>org.apereo.cas&lt;/groupId>        &lt;artifactId>cas-server-support-ldap&lt;/artifactId>        &lt;version>${cas.version}&lt;/version>    &lt;/dependency>    &lt;!--    &lt;dependency>        &lt;groupId>org.apereo.cas&lt;/groupId>        &lt;artifactId>cas-server-support-jpa-ticket-registry&lt;/artifactId>        &lt;version>${cas.version}&lt;/version>    &lt;/dependency>    &lt;dependency>        &lt;groupId>org.apereo.cas&lt;/groupId>        &lt;artifactId>cas-server-support-jpa-service-registry&lt;/artifactId>        &lt;version>${cas.version}&lt;/version>    &lt;/dependency>    &lt;dependency>        &lt;groupId>org.apereo.cas&lt;/groupId>        &lt;artifactId>cas-server-support-rest-services&lt;/artifactId>        &lt;version>${cas.version}&lt;/version>        &lt;scope>runtime&lt;/scope>    &lt;/dependency>    &lt;dependency>        &lt;groupId>org.apereo.cas&lt;/groupId>        &lt;artifactId>cas-server-support-json-service-registry&lt;/artifactId>        &lt;version>${cas.version}&lt;/version>    &lt;/dependency>    -->&lt;/dependencies><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸Šé¢ä¾‹å­ä¸­æˆ‘æ·»åŠ äº†openLDAP oauth2.0 mysqlçš„ä¾èµ–ï¼Œå…·ä½“è¯·æŒ‰ç…§è‡ªå·±éœ€æ±‚é€‰æ‹©ã€‚</p><blockquote><p>æ·»åŠ  MySQL éœ€è¦æŒ‡å®š connector-java è¿æ¥å™¨çš„ç‰ˆæœ¬</p></blockquote><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mysql.driver.version</span><span class="token punctuation">></span></span>5.1.47<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mysql.driver.version</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¼–è¾‘å¥½pomæ–‡ä»¶åï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å¼€å§‹ç¼–è¯‘</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># mvn clean package</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/42/20e1a20a856b8d98083544240e949b.jpg" alt=""></p><p>è¿‡ç¨‹å¾ˆé•¿ï¼Œéœ€è¦è”ç½‘ã€‚å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç¼–è¯‘å®Œæˆåï¼Œä¼šåœ¨æ­¤ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ª target ç›®å½•ï¼Œæˆ‘ä»¬éœ€è¦çš„ war åŒ…å°±åœ¨é‡Œé¢ã€‚</p><h2 id="å®‰è£…æµ‹è¯•"><a href="#å®‰è£…æµ‹è¯•" class="headerlink" title="å®‰è£…æµ‹è¯•"></a>å®‰è£…æµ‹è¯•</h2><p>å®‰è£…è¿‡ç¨‹å°±æ¯”è¾ƒç®€å•äº†ï¼Œå°† war åŒ…ä¿å­˜è‡³ Tomcat ä¸‹ webapps ç›®å½•ä¸‹ï¼Œç„¶åè¿è¡Œ Tomcat å³å¯ã€‚</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># startup.sh</span><span class="token comment" spellcheck="true"># tail -f /usr/local/tomcat/logs/catalina.out</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/b7/bfb043dc833a972751ad396ccc63c5.jpg" alt=""></p><p>è¿è¡Œå®Œæˆåæ—¥å¿—å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç„¶åæˆ‘ä»¬æ‰“å¼€ <a href="http://localhost:8080/cas" target="_blank" rel="noopener">http://localhost:8080/cas</a> </p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/91/6097314bc496dd2404ecc7ccac8a28.jpg" alt=""></p><p>é»˜è®¤çš„ç”¨æˆ·åå¯†ç ä¸º casuser / Mellonï¼Œè¾“å…¥ç”¨æˆ·åå¯†ç ç‚¹å‡»ç™»å½•ï¼Œç™»å½•æˆåŠŸåå¦‚å›¾è·³è½¬è‡³ç™»å½•æˆåŠŸé¡µé¢</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/41/4c9e1c4a3a9632ffd3475df7798005.jpg" alt=""></p><p>å®‰è£…è‡³æ­¤å®Œæˆ</p><h2 id="å¼€å¯-oauth-2-0-æˆæƒ"><a href="#å¼€å¯-oauth-2-0-æˆæƒ" class="headerlink" title="å¼€å¯ oauth 2.0 æˆæƒ"></a>å¼€å¯ oauth 2.0 æˆæƒ</h2><blockquote><p>application.properties å¢åŠ é…ç½®æ–‡ä»¶å¦‚ä¸‹</p></blockquote><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi /usr/local/tomcat/webapps/cas/WEB-INF/classes/application.properties</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-properties"><code class="language-properties"><span class="token attr-name">cas.authn.oauth.refreshToken.timeToKillInSeconds</span><span class="token punctuation">=</span><span class="token attr-value">2592000</span><span class="token attr-name">cas.authn.oauth.code.timeToKillInSeconds</span><span class="token punctuation">=</span><span class="token attr-value">30</span><span class="token attr-name">cas.authn.oauth.code.numberOfUses</span><span class="token punctuation">=</span><span class="token attr-value">1</span><span class="token attr-name">cas.authn.oauth.accessToken.releaseProtocolAttributes</span><span class="token punctuation">=</span><span class="token attr-value">true</span><span class="token attr-name">cas.authn.oauth.accessToken.timeToKillInSeconds</span><span class="token punctuation">=</span><span class="token attr-value">7200</span><span class="token attr-name">cas.authn.oauth.accessToken.maxTimeToLiveInSeconds</span><span class="token punctuation">=</span><span class="token attr-value">28800</span><span class="token attr-name">cas.authn.oauth.grants.resourceOwner.requireServiceHeader</span><span class="token punctuation">=</span><span class="token attr-value">true</span><span class="token attr-name">cas.authn.oauth.userProfileViewType</span><span class="token punctuation">=</span><span class="token attr-value">NESTED</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>å¢åŠ  OAUTH-1002.json service æ³¨å†Œæ–‡ä»¶</p></blockquote><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi /usr/local/tomcat/webapps/cas/WEB-INF/classes/servies/OAUTH-1002.json</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-properties"><code class="language-properties">{<span class="token attr-name">  "@class"</span> <span class="token punctuation">:</span> <span class="token attr-value">"org.apereo.cas.support.oauth.services.OAuthRegisteredService",</span><span class="token attr-name">  "clientId"</span><span class="token punctuation">:</span> <span class="token attr-value">"20181124",</span><span class="token attr-name">  "clientSecret"</span><span class="token punctuation">:</span> <span class="token attr-value">"123456",</span><span class="token attr-name">  "serviceId"</span> <span class="token punctuation">:</span> <span class="token attr-value">"^(https|http|imaps)://.*",</span><span class="token attr-name">  "name"</span> <span class="token punctuation">:</span> <span class="token attr-value">"OAuthService",</span><span class="token attr-name">  "id"</span> <span class="token punctuation">:</span> <span class="token attr-value">1002</span>}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>é‡å¯ Tomcat æµ‹è¯•</p></blockquote><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># shutdown.sh                   </span>Using CATALINA_BASE:   /usr/local/tomcatUsing CATALINA_HOME:   /usr/local/tomcatUsing CATALINA_TMPDIR: /usr/local/tomcat/tempUsing JRE_HOME:        /usrUsing CLASSPATH:       /usr/local/tomcat/bin/bootstrap.jar:/usr/local/tomcat/bin/tomcat-juli.jar<span class="token comment" spellcheck="true"># startup.sh </span>Using CATALINA_BASE:   /usr/local/tomcatUsing CATALINA_HOME:   /usr/local/tomcatUsing CATALINA_TMPDIR: /usr/local/tomcat/tempUsing JRE_HOME:        /usrUsing CLASSPATH:       /usr/local/tomcat/bin/bootstrap.jar:/usr/local/tomcat/bin/tomcat-juli.jarTomcat started.<span class="token comment" spellcheck="true"># </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é‡å¯å®Œæˆåï¼Œæˆ‘ä»¬åˆ©ç”¨æœ¬åšå®¢ä½œä¸ºç›®æ ‡è®¿é—®ç½‘å€è¿›è¡Œæµ‹è¯•ï¼Œæµè§ˆå™¨æ‰“å¼€ <a href="http://localhost:8080/cas/oauth2.0/authorize?response_type=code&amp;client_id=20181124&amp;redirect_uri=https://blog.iamzhl.top" target="_blank" rel="noopener">http://localhost:8080/cas/oauth2.0/authorize?response_type=code&amp;client_id=20181124&amp;redirect_uri=https://blog.iamzhl.top</a></p><p>å‘ç°è·³è½¬äº†ä¸€ä¸ªç¤ºä¾‹ç½‘å€</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/b1/603980e19d03912f2c01b3a7c94b80.jpg" alt=""></p><p>è¿™æ—¶æˆ‘ä»¬éœ€è¦è®¾ç½®ä¸€ä¸‹ä¸¤ä¸ªå˜é‡</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi /usr/local/tomcat/webapps/cas/WEB-INF/classes/application.properties</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åŠ å…¥ä¸‹é¢ä¸¤è¡Œ</p><pre class="line-numbers language-properties"><code class="language-properties"><span class="token attr-name">cas.server.name</span><span class="token punctuation">=</span><span class="token attr-value">http://devops.iamzhl.top:8080/cas</span><span class="token attr-name">cas.server.prefix</span><span class="token punctuation">=</span><span class="token attr-value">${cas.server.name}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è¯·å°† devops.iamzhl.top æ”¹ä¸ºä½ çš„ ipï¼Œç„¶åé‡å¯ Tomcat å†æ¬¡æµ‹è¯•</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/66/574e93fdcc2b8ab686a46ec772627d.jpg" alt=""></p><p>è¿™æ¬¡èƒ½æ­£å¸¸è·³è½¬äº†ï¼Œä½†æ˜¯å‡ºç°äº†<code>æœªè®¤è¯æˆæƒçš„æœåŠ¡</code>ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬æ²¡æœ‰å¼€å¯ http åè®®æ”¯æŒï¼Œå› æ­¤åªè¦å†è®©æˆ‘ä»¬çš„ CAS Server æ”¯æŒ http è®¤è¯å°±è¡Œäº†</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi /usr/local/tomcat/webapps/cas/WEB-INF/classes/application.properties</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ·»åŠ ä¸‹é¢ä¸¤è¡Œ</p><pre class="line-numbers language-properties"><code class="language-properties"><span class="token attr-name">cas.tgc.secure</span><span class="token punctuation">=</span><span class="token attr-value">false</span><span class="token attr-name">cas.serviceRegistry.initFromJson</span><span class="token punctuation">=</span><span class="token attr-value">true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi /usr/local/tomcat/webapps/cas/WEB-INF/classes/services/HTTPSandIMAPS-10000001.json</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å°†<code>"serviceId" : "^(https|imaps)://.*",</code>æ”¹ä¸º<code>"serviceId" : "^(https|http|imaps)://.*",</code>ï¼Œå¦‚å›¾</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/2b/cca4a5df53dd47b94e73664bdc8ff3.jpg" alt=""></p><p>å†æ¬¡ç™»å½•æµ‹è¯•</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/f5/c1a598cd7ecd0a96df200f38659aec.jpg" alt=""></p><p>è¿™æ¬¡ç»ˆäºæ­£å¸¸äº†ï¼Œè¾“å…¥ç”¨æˆ·åå¯†ç ç‚¹å‡»ç™»å½•ï¼Œå°±ä¼šè·³è½¬åˆ°æˆæƒé¡µé¢</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/ae/c40e776bfcecf0ca8b48c4e9582dbc.jpg" alt=""></p><p>ç‚¹å‡» Allow å³å¯æˆåŠŸæˆæƒè·³è½¬è‡³æœ¬åšå®¢ï¼Œæˆ‘ä»¬ä¼šæ³¨æ„åˆ° uri ä¼šæºå¸¦ä¸€ä¸ª codeï¼Œè¿™å°±æ˜¯ CAS ç›®å‰åœ¨ oauth2.0 æˆæƒä¸­æœ€ä¸ºå®Œå–„çš„ code æˆæƒæ¨¡å¼äº†ã€‚</p><p>è‡³æ­¤ï¼Œ CAS 5.3 é›†æˆ oauth2.0 çš„æˆæƒå·²ç»æ­å»ºå®Œæ¯•</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/13/f1a8df13c6ee93210a970833c5059a.jpg" alt=""></p><h2 id="æ•´åˆ-openLDAP"><a href="#æ•´åˆ-openLDAP" class="headerlink" title="æ•´åˆ openLDAP"></a>æ•´åˆ openLDAP</h2><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi /usr/local/tomcat/webapps/cas/WEB-INF/classes/application.properties</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ³¨é‡Šæ‰é»˜è®¤çš„ <code>cas.authn.accept.users</code> è®¤è¯æ–¹å¼å¹¶æ·»åŠ ä¸<code>LDAP Server</code>è¿æ¥çš„é…ç½®(è¯·æ ¹æ®è‡ªå·±çš„<code>LDAP</code>æœåŠ¡å™¨ä¿¡æ¯è¿›è¡Œä¿®æ”¹)</p><pre class="line-numbers language-properties"><code class="language-properties"><span class="token comment" spellcheck="true">##</span><span class="token comment" spellcheck="true"># CAS Authentication Credentials</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true"># cas.authn.accept.users=casuser::Mellon</span><span class="token attr-name">cas.authn.ldap[0].principalAttributeList</span><span class="token punctuation">=</span><span class="token attr-value">sn,cn:commonName,givenName,eduPersonTargettedId:SOME_IDENTIFIER</span><span class="token attr-name">cas.authn.ldap[0].collectDnAttribute</span><span class="token punctuation">=</span><span class="token attr-value">false</span><span class="token attr-name">cas.authn.ldap[0].principalDnAttributeName</span><span class="token punctuation">=</span><span class="token attr-value">principalLdapDn</span><span class="token attr-name">cas.authn.ldap[0].allowMultiplePrincipalAttributeValues</span><span class="token punctuation">=</span><span class="token attr-value">true</span><span class="token attr-name">cas.authn.ldap[0].allowMissingPrincipalAttributeValue</span><span class="token punctuation">=</span><span class="token attr-value">true</span><span class="token attr-name">cas.authn.ldap[0].credentialCriteria</span><span class="token punctuation">=</span><span class="token attr-name">cas.authn.attributeRepository.ldap[0].attributes.uid</span><span class="token punctuation">=</span><span class="token attr-value">uid</span><span class="token attr-name">cas.authn.attributeRepository.ldap[0].attributes.displayName</span><span class="token punctuation">=</span><span class="token attr-value">displayName</span><span class="token attr-name">cas.authn.attributeRepository.ldap[0].attributes.cn</span><span class="token punctuation">=</span><span class="token attr-value">commonName</span><span class="token attr-name">cas.authn.attributeRepository.ldap[0].attributes.affiliation</span><span class="token punctuation">=</span><span class="token attr-value">groupMembership</span><span class="token attr-name">cas.authn.ldap[0].ldapUrl</span><span class="token punctuation">=</span><span class="token attr-value">ldap://devops.iamzhl.top:389</span><span class="token attr-name">cas.authn.ldap[0].bindDn</span><span class="token punctuation">=</span><span class="token attr-value">cn=Manager,dc=iamzhl,dc=top</span><span class="token attr-name">cas.authn.ldap[0].bindCredential</span><span class="token punctuation">=</span><span class="token attr-value">passwd</span><span class="token attr-name">cas.authn.ldap[0].poolPassivator</span><span class="token punctuation">=</span><span class="token attr-value">BIND</span><span class="token attr-name">cas.authn.ldap[0].connectionStrategy</span><span class="token punctuation">=</span><span class="token attr-name">cas.authn.ldap[0].providerClass</span><span class="token punctuation">=</span><span class="token attr-value">org.ldaptive.provider.unboundid.UnboundIDProvider</span><span class="token attr-name">cas.authn.ldap[0].connectTimeout</span><span class="token punctuation">=</span><span class="token attr-value">5000</span><span class="token attr-name">cas.authn.ldap[0].trustCertificates</span><span class="token punctuation">=</span><span class="token attr-name">cas.authn.ldap[0].keystore</span><span class="token punctuation">=</span><span class="token attr-name">cas.authn.ldap[0].keystorePassword</span><span class="token punctuation">=</span><span class="token attr-name">cas.authn.ldap[0].keystoreType</span><span class="token punctuation">=</span><span class="token attr-value">PKCS12</span><span class="token attr-name">cas.authn.ldap[0].minPoolSize</span><span class="token punctuation">=</span><span class="token attr-value">3</span><span class="token attr-name">cas.authn.ldap[0].maxPoolSize</span><span class="token punctuation">=</span><span class="token attr-value">10</span><span class="token attr-name">cas.authn.ldap[0].validateOnCheckout</span><span class="token punctuation">=</span><span class="token attr-value">true</span><span class="token attr-name">cas.authn.ldap[0].validatePeriodically</span><span class="token punctuation">=</span><span class="token attr-value">true</span><span class="token attr-name">cas.authn.ldap[0].validatePeriod</span><span class="token punctuation">=</span><span class="token attr-value">500</span><span class="token attr-name">cas.authn.ldap[0].validateTimeout</span><span class="token punctuation">=</span><span class="token attr-value">5000</span><span class="token attr-name">cas.authn.ldap[0].failFast</span><span class="token punctuation">=</span><span class="token attr-value">true</span><span class="token attr-name">cas.authn.ldap[0].idleTime</span><span class="token punctuation">=</span><span class="token attr-value">500</span><span class="token attr-name">cas.authn.ldap[0].prunePeriod</span><span class="token punctuation">=</span><span class="token attr-value">24</span><span class="token attr-name">cas.authn.ldap[0].blockWaitTime</span><span class="token punctuation">=</span><span class="token attr-value">5000</span><span class="token attr-name">cas.authn.ldap[0].useSsl</span><span class="token punctuation">=</span><span class="token attr-value">false</span><span class="token attr-name">cas.authn.ldap[0].useStartTls</span><span class="token punctuation">=</span><span class="token attr-value">false</span><span class="token attr-name">cas.authn.ldap[0].responseTimeout</span><span class="token punctuation">=</span><span class="token attr-value">8000</span><span class="token attr-name">cas.authn.ldap[0].allowMultipleDns</span><span class="token punctuation">=</span><span class="token attr-value">false</span><span class="token attr-name">cas.authn.ldap[0].name</span><span class="token punctuation">=</span><span class="token attr-name">cas.authn.ldap[0].type</span><span class="token punctuation">=</span><span class="token attr-value">AUTHENTICATED</span><span class="token attr-name">cas.authn.ldap[0].searchFilter</span><span class="token punctuation">=</span><span class="token attr-value">uid={user}</span><span class="token comment" spellcheck="true">#cas.authn.ldap[0].enhanceWithEntryResolver=true</span><span class="token attr-name">cas.authn.ldap[0].derefAliases</span><span class="token punctuation">=</span><span class="token attr-value">NEVER</span><span class="token attr-name">cas.authn.ldap[0].dnFormat</span><span class="token punctuation">=</span><span class="token attr-value">uid=%s,ou=People,dc=iamzhl,dc=top</span><span class="token attr-name">cas.authn.ldap[0].baseDn</span><span class="token punctuation">=</span><span class="token attr-value">ou=People,dc=iamzhl,dc=top</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é‡å¯ Tomcat æŸ¥çœ‹æ—¥å¿—</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># shutdown.sh</span><span class="token comment" spellcheck="true"># startup.sh</span><span class="token comment" spellcheck="true"># tail -f /usr/local/tomcat/logs/catalina.out</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/f2/308f5dc1de191625e6087c1d040824.jpg" alt=""></p><p>æ–°å»ºä¸€ä¸ª openLDAP ç”¨æˆ· test / 123456</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/0e/e69bb807212cc32a80cb28c4b927e1.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/01/ab9d40ac8d216e3e2b99a287082fa7.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/14/de8c6a3b3854b28bca29d84e338f9f.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/53/287f9a9a0cfe1c25c3c66d775fb214.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/af/af3a63b732070ac51f27b10f6e2dca.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/b3/da28177e70ab2cb77421d6ae16ca95.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/70/749184f3907b06951093fc2a944e42.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/c0/5ddca5f311e7f8b2ba598480c3636e.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/e7/8a989532254213ac72efc235676a2a.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/2e/ebca96c81bd780e9b90d9bdbd3415a.jpg" alt=""></p><p>æ‰“å¼€ CAS ç½‘å€æµ‹è¯• <code>http://devops.iamzhl.top:8080/cas/login</code></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/48/9f8dc131728eda81cd522d5db954d4.jpg" alt=""></p><p>è¾“å…¥ç”¨æˆ·åå¯†ç ç™»é™†æˆåŠŸ</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/89/2e8366b3accc1248a4043079a958a3.jpg" alt=""></p><p>æ—¥å¿—è¾“å‡ºå¦‚ä¸‹</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/c3/cf45af8f7ab6b3aa80267f95cb6a42.jpg" alt=""></p><p>è‡³æ­¤ï¼ŒCAS 5.3 æ•´åˆ openLDAP ç»“æŸã€‚</p><h2 id="æ•´åˆ-MySQL-è®¤è¯"><a href="#æ•´åˆ-MySQL-è®¤è¯" class="headerlink" title="æ•´åˆ MySQL è®¤è¯"></a>æ•´åˆ MySQL è®¤è¯</h2><h3 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><blockquote><p>ä¿®æ”¹é…ç½®æ–‡ä»¶</p></blockquote><pre class="line-numbers language-bash"><code class="language-bash">vim /usr/local/tomcat/webapps/cas/WEB-INF/classes/application.properties<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>æœ€åæ·»åŠ å¦‚ä¸‹å†…å®¹ (éœ€è¦å°†é™æ€è®¤è¯å…³é—­ï¼Œå³ cas.authn.accept.users é…ç½®é¡¹æ³¨é‡Šæ‰å³å¯)</p></blockquote><pre class="line-numbers language-properties"><code class="language-properties"><span class="token comment" spellcheck="true">##</span><span class="token comment" spellcheck="true"># MySQL Authentication Credentials</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true"># å®šä¹‰æŸ¥è¯¢ç”¨æˆ·åçš„ sql è¯­å¥</span><span class="token attr-name">cas.authn.jdbc.query[0].sql</span><span class="token punctuation">=</span><span class="token attr-value">select * from sys_user where username=?</span><span class="token comment" spellcheck="true"># å®šä¹‰ç”¨æˆ·å¯†ç å­—æ®µ</span><span class="token attr-name">cas.authn.jdbc.query[0].fieldPassword</span><span class="token punctuation">=</span><span class="token attr-value">password</span><span class="token comment" spellcheck="true"># å®šä¹‰æç¤ºä¿®æ”¹å¯†ç å­—æ®µ</span><span class="token attr-name">cas.authn.jdbc.query[0].fieldExpired</span><span class="token punctuation">=</span><span class="token attr-value">expired</span><span class="token comment" spellcheck="true"># å®šä¹‰ç¦ç”¨ç”¨æˆ·çš„å­—æ®µ</span><span class="token attr-name">cas.authn.jdbc.query[0].fieldDisabled</span><span class="token punctuation">=</span><span class="token attr-value">disabled</span><span class="token comment" spellcheck="true"># ä½¿ç”¨çš„æ•°æ®åº“æ–¹è¨€</span><span class="token attr-name">cas.authn.jdbc.query[0].dialect</span><span class="token punctuation">=</span><span class="token attr-value">org.hibernate.dialect.MySQLDialect</span><span class="token comment" spellcheck="true"># å®šä¹‰æ•°æ®åº“ç±»</span><span class="token attr-name">cas.authn.jdbc.query[0].driverClass</span><span class="token punctuation">=</span><span class="token attr-value">com.mysql.jdbc.Driver</span><span class="token comment" spellcheck="true"># ä½¿ç”¨çš„æ•°æ®åº“</span><span class="token attr-name">cas.authn.jdbc.query[0].url</span><span class="token punctuation">=</span><span class="token attr-value">jdbc:mysql://localhost:3306/cas?useUnicode=true&amp;characterEncoding=UTF-8&amp;autoReconnect=true&amp;useSSL=false</span><span class="token comment" spellcheck="true"># ä½¿ç”¨çš„æ•°æ®åº“ç”¨æˆ·</span><span class="token attr-name">cas.authn.jdbc.query[0].user</span><span class="token punctuation">=</span><span class="token attr-value">root</span><span class="token comment" spellcheck="true"># æ•°æ®åº“ root ç”¨æˆ·å¯†ç </span><span class="token attr-name">cas.authn.jdbc.query[0].password</span><span class="token punctuation">=</span><span class="token attr-value">123456</span><span class="token comment" spellcheck="true">#é»˜è®¤åŠ å¯†ç­–ç•¥ï¼Œé€šè¿‡encodingAlgorithmæ¥æŒ‡å®šç®—æ³•ï¼Œé»˜è®¤NONEä¸åŠ å¯†</span><span class="token attr-name">cas.authn.jdbc.query[0].passwordEncoder.type</span><span class="token punctuation">=</span><span class="token attr-value">DEFAULT</span><span class="token attr-name">cas.authn.jdbc.query[0].passwordEncoder.characterEncoding</span><span class="token punctuation">=</span><span class="token attr-value">UTF-8</span><span class="token attr-name">cas.authn.jdbc.query[0].passwordEncoder.encodingAlgorithm</span><span class="token punctuation">=</span><span class="token attr-value">MD5</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ•°æ®åº“é…ç½®"><a href="#æ•°æ®åº“é…ç½®" class="headerlink" title="æ•°æ®åº“é…ç½®"></a>æ•°æ®åº“é…ç½®</h3><blockquote><p>åˆ›å»ºæ•°æ®åº“</p></blockquote><pre class="line-numbers language-mysql"><code class="language-mysql">mysql> create database cas;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>åˆ›å»ºè¡¨</p></blockquote><pre class="line-numbers language-mysql"><code class="language-mysql">mysql> use casmysql> create table sys_user ( `id` int(11) not null auto_increment, `username` varchar(30) not null, `password` varchar(64) not null, `email`    varchar(50), `address`  varchar(100), `age`      int, `expired` int, `disabled` int, `locked` int,  primary key (`id`)) engine=innodb auto_increment=1 default charset=utf8;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>æ•°æ®è¡¨å­—æ®µè¯´æ˜:</p></blockquote><p><strong><em>id ä¸ºè‡ªå¢å­—æ®µï¼Œusername ä¸ºç”¨æˆ·åï¼Œpassword ä¸ºè´¦å·å¯†ç ï¼Œemail ä¸ºé‚®ä»¶åœ°å€ï¼Œaddress ä¸ºè”ç³»åœ°å€ï¼Œage ä¸ºç”¨æˆ·å¹´é¾„ï¼Œexpired ä¸ºæ˜¯å¦ç™»å½•åæç¤ºä¿®æ”¹å¯†ç ï¼Œdisabled ä¸ºæ˜¯å¦ç¦ç”¨è´¦å·ï¼Œlocked ä¸ºæ˜¯å¦é”å®šè´¦å·ï¼Œå…¶ä¸­ id ä¸ºä¸»é”®è‡ªå¢ã€‚</em></strong></p><blockquote><p>é…ç½®å®Œæˆååœ¨æ•°æ®è¡¨æ·»åŠ ç”¨æˆ·å¯åŠ¨ Tomcat è¿›è¡Œæµ‹è¯•å³å¯ã€‚</p></blockquote><pre class="line-numbers language-mysql"><code class="language-mysql">mysql> insert into sys_user values ('1', 'admin', 'e10adc3949ba59abbe56e057f20f883e', 'admin@example.com', 'åŒ—äº¬é¡ºä¹‰', 20, 0, 0, 0);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong><em>éœ€è¦æ³¨æ„çš„æ˜¯æ’å…¥æ•°æ®æ—¶ï¼Œéœ€è¦ç”¨å¯†ç çš„ MD5 å€¼</em></strong></p><h2 id="è‡ªå®šä¹‰ç™»å‡ºè·³è½¬ç•Œé¢"><a href="#è‡ªå®šä¹‰ç™»å‡ºè·³è½¬ç•Œé¢" class="headerlink" title="è‡ªå®šä¹‰ç™»å‡ºè·³è½¬ç•Œé¢"></a>è‡ªå®šä¹‰ç™»å‡ºè·³è½¬ç•Œé¢</h2><p>æŸäº›æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦å¯¹ç™»å‡ºè¿›è¡Œå®šåˆ¶ï¼Œæ¯”å¦‚ç­‰å‡ºåè·³è½¬åˆ°ç­‰å‡ºç•Œé¢ï¼Œåœ¨<code>CAS 5.3</code>ä»¥åçš„ç‰ˆæœ¬ä¸­ï¼Œç›´æ¥ä¿®æ”¹å‰ç«¯çš„<code>HTML</code>é¡µé¢æ— æ³•å®Œæˆç™»å‡ºçš„å®šåˆ¶è·³è½¬ï¼Œä¸è¿‡å®˜æ–¹æä¾›äº†æ›´ä¸ºæ–¹ä¾¿çš„è®¾ç½®æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶<code>application.properties</code>æ¥å®ç°ï¼Œåœ¨æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹</p><pre class="line-numbers language-properties"><code class="language-properties"><span class="token attr-name">cas.logout.followServiceRedirects</span><span class="token punctuation">=</span><span class="token attr-value">true</span><span class="token attr-name">cas.logout.redirectParameter</span><span class="token punctuation">=</span><span class="token attr-value">service</span><span class="token attr-name">cas.logout.redirectUrl</span><span class="token punctuation">=</span><span class="token attr-value">https://default.cas.com</span><span class="token attr-name">cas.logout.confirmLogout</span><span class="token punctuation">=</span><span class="token attr-value">false</span><span class="token attr-name">cas.logout.removeDescendantTickets</span><span class="token punctuation">=</span><span class="token attr-value">true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><em>è¯·æ ¹æ®éœ€è¦å°†å…¶ä¸­çš„<code>redirectUrl</code>æ”¹ä¸ºè¦å®šåˆ¶çš„ç™»å‡ºè·³è½¬é“¾æ¥</em></p><h2 id="è‡ªå®šä¹‰é»˜è®¤çš„ç™»å½•è·³è½¬ç•Œé¢"><a href="#è‡ªå®šä¹‰é»˜è®¤çš„ç™»å½•è·³è½¬ç•Œé¢" class="headerlink" title="è‡ªå®šä¹‰é»˜è®¤çš„ç™»å½•è·³è½¬ç•Œé¢"></a>è‡ªå®šä¹‰é»˜è®¤çš„ç™»å½•è·³è½¬ç•Œé¢</h2><p>ç™»å‡ºè·³è½¬å¯ä»¥å®šåˆ¶ï¼Œç™»å½•çš„ä¹Ÿå¯ä»¥ï¼Œæœ‰äº›æ—¶å€™ï¼Œå¯èƒ½éœ€è¦åœ¨ç›´æ¥è®¿é—®çš„<code>CAS</code>çš„æ—¶å€™ï¼Œç™»é™†æˆåŠŸåç›´æ¥è·³è½¬åˆ°æŒ‡å®šçš„ç•Œé¢ï¼Œæ¯”å¦‚ç›´æ¥è®¿é—®<code>http://devops.iamzhl.top:8080/cas</code>ï¼Œéœ€è¦è·³è½¬åˆ°<code>http://devops.iamzhl.top/index.html</code>ï¼Œé‚£ä¹ˆå°±å¯ä»¥åœ¨<code>application.properties</code>ä¸­æ·»åŠ ä»¥ä¸‹å±æ€§</p><pre class="line-numbers language-properties"><code class="language-properties"><span class="token attr-name">cas.view.defaultRedirectUrl</span><span class="token punctuation">=</span><span class="token attr-value">http://devops.iamzhl.top/index.html</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="è‡ªå®šä¹‰ç™»å½•ç•Œé¢ä¸»é¢˜"><a href="#è‡ªå®šä¹‰ç™»å½•ç•Œé¢ä¸»é¢˜" class="headerlink" title="è‡ªå®šä¹‰ç™»å½•ç•Œé¢ä¸»é¢˜"></a>è‡ªå®šä¹‰ç™»å½•ç•Œé¢ä¸»é¢˜</h2><p>åœ¨<code>cas/WEB-INF/classes/static/themes</code>ä¸­æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ä»¥è¦è®¾ç½®çš„ä¸»é¢˜åå‘½åï¼Œæ¯”å¦‚<code>devops</code>ï¼Œåœ¨æ­¤ç›®å½•ä¸‹å»ºç«‹<code>js</code>ã€<code>css</code>ä»¥åŠ<code>images</code>ç­‰é™æ€èµ„æºæ–‡ä»¶å¤¹ï¼Œå°†å®šåˆ¶çš„é™æ€èµ„æºä¿å­˜å¥½ï¼Œç»“æ„å¦‚ä¸‹</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fzqqbpvu1cj31p818k4au.jpg" alt=""></p><p>ç„¶ååœ¨<code>application.properties</code>æ·»åŠ ä»¥ä¸‹å±æ€§</p><pre class="line-numbers language-properties"><code class="language-properties"><span class="token attr-name"> cas.theme.defaultThemeName</span><span class="token punctuation">=</span><span class="token attr-value">devops</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> CI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CAS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CentOS 7 å®‰è£…éƒ¨ç½²é‚®ä»¶æœåŠ¡å™¨</title>
      <link href="/posts/41575d45/"/>
      <url>/posts/41575d45/</url>
      
        <content type="html"><![CDATA[<h1 id="æœ¬æ–‡ç¯å¢ƒ"><a href="#æœ¬æ–‡ç¯å¢ƒ" class="headerlink" title="æœ¬æ–‡ç¯å¢ƒ"></a>æœ¬æ–‡ç¯å¢ƒ</h1><p>CentOS 7.2 1511</p><h1 id="å¼€å§‹å®‰è£…"><a href="#å¼€å§‹å®‰è£…" class="headerlink" title="å¼€å§‹å®‰è£…"></a>å¼€å§‹å®‰è£…</h1><h2 id="å®‰è£…postfix"><a href="#å®‰è£…postfix" class="headerlink" title="å®‰è£…postfix"></a>å®‰è£…postfix</h2><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># yum -y install postfix</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚æœæœºå™¨å·²ç»å®‰è£…äº†sendmailï¼Œéœ€è¦å°†å…¶å¸è½½ï¼Œä¸‹é¢ä¸¤æ¡å‘½ä»¤å‡å¯</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># yum -y remove sendmail</span><span class="token comment" spellcheck="true"># rpm -e sendmail</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä¿®æ”¹MTA(é»˜è®¤é‚®ä»¶ä»£ç†)</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># alternatives --config mta</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ£€æŸ¥æ˜¯å¦é…ç½®æˆåŠŸ</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># alternatives --display mta</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/14/519a03d59c7bc4ff363f66a8620736.jpg" alt=""></p><p>è¿™é‡Œæˆ‘å·²ç»å®‰è£…è¿‡postfixäº†</p><h2 id="å®‰è£…dovecot"><a href="#å®‰è£…dovecot" class="headerlink" title="å®‰è£…dovecot"></a>å®‰è£…dovecot</h2><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># yum -y install dovecot</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/fd/d041b10136a8aea22008556cba508a.jpg" alt=""></p><h2 id="é…ç½®postfix"><a href="#é…ç½®postfix" class="headerlink" title="é…ç½®postfix"></a>é…ç½®postfix</h2><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vi /etc/postfix/main.cf</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¿®æ”¹ä»¥ä¸‹å‚æ•°</p><pre><code>myhostname = mail.zhanghl.cn  # å–æ¶ˆæ³¨é‡Šï¼Œè®¾ç½®hostnamemydomain = zhanghl.cn  # å–æ¶ˆæ³¨é‡Šï¼Œè®¾ç½®åŸŸåmyorigin = $mydomain  # å–æ¶ˆæ³¨é‡Šinet_interfaces = all  # ä¿®æ”¹ä¸ºallinet_protocols = ipv4  # ä¿®æ”¹ipv4ï¼Œå¦‚æœæ”¯æŒipv6ï¼Œåˆ™å¯ä»¥ä¸ºallmydestination = $myhostname, localhost.$mydomain, localhost, $mydomain # ä¿®æ”¹åœ¨æœ€åæ·»åŠ $mydomainmynetworks = 127.0.0.0/8, 10.0.0.0/24  # å–æ¶ˆæ³¨é‡Šï¼ŒæŒ‡å®šå†…ç½‘å’Œæœ¬åœ°çš„IPåœ°å€èŒƒå›´home_mailbox = Maildir/  # å–æ¶ˆæ³¨é‡Šï¼Œé‚®ä»¶ä¿å­˜ç›®å½•smtpd_banner = $myhostname ESMTP $mail_name ($mail_version)  # å–æ¶ˆæ³¨é‡Šï¼Œé‚®ä»¶æœåŠ¡å™¨æ¬¢è¿ä¿¡æ¯</code></pre><p>æ–‡ä»¶æœ€åæ·»åŠ ä»¥ä¸‹å†…å®¹</p><pre><code># Setup max mail attachment to 10Mmessage_size_limit = 10485760# Setup max capacity of Inbox to 1Gmailbox_size_limit = 1073741824# SMTP Authenticationsmtpd_sasl_type = dovecotsmtpd_sasl_path = private/authsmtpd_sasl_auth_enable = yessmtpd_sasl_security_options = noanonymoussmtpd_sasl_local_domain = $myhostnamesmtpd_recipient_restrictions = permit_mynetworks,permit_auth_destination,permit_sasl_authenticated,reject</code></pre><p>å¯åŠ¨å¹¶è®¾ç½®è‡ªå¯åŠ¨</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># systemctl start postfix  //å¯åŠ¨</span><span class="token comment" spellcheck="true"># systemctl enable postfix  //è‡ªå¯åŠ¨</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="é…ç½®dovecot"><a href="#é…ç½®dovecot" class="headerlink" title="é…ç½®dovecot"></a>é…ç½®dovecot</h2><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vim /etc/dovecot/dovecot.conf</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>listen = *  //å–æ¶ˆæ³¨é‡Šå¹¶ä¿®æ”¹</code></pre><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vim /etc/dovecot/conf.d/10-auth.conf</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>disable_plaintext_auth = no  //å–æ¶ˆæ³¨é‡Šå¹¶ä¿®æ”¹auth_mechanisms = plain login  //ä¿®æ”¹æ·»åŠ login</code></pre><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vim /etc/dovecot/conf.d/10-mail.conf</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>mail_location = maildir:~/Maildir  //ä¿®æ”¹è®¾ç½®é‚®ä»¶å­˜å‚¨ä½ç½®</code></pre><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vim /etc/dovecot/conf.d/10-master.conf</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å–æ¶ˆæ³¨é‡Šå¹¶æ·»åŠ userå’Œgroupå±æ€§</p><pre><code>unix_listener /var/spool/postfix/private/auth {    mode = 0666    user = postfix    group = postfix}</code></pre><p>å¯åŠ¨å¹¶è®¾ç½®è‡ªå¯åŠ¨</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># systemctl start dovecot  //å¯åŠ¨</span><span class="token comment" spellcheck="true"># systemctl enable dovecot  //è‡ªå¯åŠ¨</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="åŸŸåè§£æ"><a href="#åŸŸåè§£æ" class="headerlink" title="åŸŸåè§£æ"></a>åŸŸåè§£æ</h2><p>æ·»åŠ ä¸€ä¸ªå­åŸŸåmailï¼ŒAè®°å½•è§£æåˆ°æœåŠ¡å™¨IPã€‚</p><p>å†æ·»åŠ ä¸€ä¸ªMXè®°å½•ï¼Œä¸»æœºè®°å½•ä¸ºç©ºï¼Œè®°å½•å€¼ä¸ºä¸Šé¢è§£æçš„äºŒçº§åŸŸåmail.zhanghl.cnï¼Œä¼˜å…ˆçº§10ã€‚</p><p>æ³¨æ„ï¼šè§£æç”Ÿæ•ˆå¯èƒ½éœ€è¦ä¸€æ®µæ—¶é—´ã€‚</p><p>ä¹Ÿå¯ä»¥ä¿®æ”¹/etc/hostsæ·»åŠ é‚®ä»¶æœåŠ¡å™¨åŸŸåå®ç°ã€‚</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vim /etc/hosts</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/e2/0e95d3345f60b59bffdf377e55fc3b.jpg" alt=""></p><h2 id="æµ‹è¯•é‚®ç®±"><a href="#æµ‹è¯•é‚®ç®±" class="headerlink" title="æµ‹è¯•é‚®ç®±"></a>æµ‹è¯•é‚®ç®±</h2><p>é¦–å…ˆå®‰è£…telnetï¼Œç”±äºCentOS 7å·²ç»é»˜è®¤æ²¡æœ‰äº†xinetdå’Œtelnetï¼Œå› æ­¤éœ€è¦å®‰è£…</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># yum -y install xinetd telnet telnet-server</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è®¾ç½®xinetdå¯åŠ¨å¹¶è‡ªå¯åŠ¨</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># systemctl start xinetd</span><span class="token comment" spellcheck="true"># systemctl enable xinetd</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>åˆ©ç”¨telnetæµ‹è¯•é‚®ä»¶æœåŠ¡å™¨</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token punctuation">[</span>zhanghl@centos-7 ~<span class="token punctuation">]</span>$ telnet zhanghl.cn 25Trying 127.0.0.1<span class="token punctuation">..</span>.Connected to zhanghl.cn.Escape character is <span class="token string">'^]'</span><span class="token keyword">.</span>220 mail.zhanghl.cn ESMTP Postfix <span class="token punctuation">(</span>2.10.1<span class="token punctuation">)</span>mail from:zhanghl250 2.1.0 Okrcpt to:root250 2.1.5 Okdata354 End data with <span class="token operator">&lt;</span>CR<span class="token operator">></span><span class="token operator">&lt;</span>LF<span class="token operator">></span>.<span class="token operator">&lt;</span>CR<span class="token operator">></span><span class="token operator">&lt;</span>LF<span class="token operator">></span>Hello, i<span class="token string">'m zhanghl!.250 2.0.0 Ok: queued as 731144191B7Fquit221 2.0.0 ByeConnection closed by foreign host.[zhanghl@centos-7 ~]$ telnet zhanghl.cn 110Trying 127.0.0.1...Connected to zhanghl.cn.Escape character is '</span>^<span class="token punctuation">]</span><span class="token string">'.+OK Dovecot ready.user zhanghl+OKpass 123456+OK Logged in.list+OK 1 messages:1 2381.retr 1+OK 2381 octetsReturn-Path: &lt;>X-Original-To: zhanghl@zhanghl.cnDelivered-To: zhanghl@zhanghl.cnReceived: by mail.zhanghl.cn (Postfix)    id 61E594191B92; Fri, 19 Oct 2018 22:44:27 +0800 (CST)Date: Fri, 19 Oct 2018 22:44:27 +0800 (CST)From: MAILER-DAEMON@zhanghl.cn (Mail Delivery System)Subject: Undelivered Mail Returned to SenderTo: zhanghl@zhanghl.cnAuto-Submitted: auto-repliedMIME-Version: 1.0Content-Type: multipart/report; report-type=delivery-status;    boundary="731144191B7F.1539960267/mail.zhanghl.cn"Message-Id: &lt;20181019144427.61E594191B92@mail.zhanghl.cn>This is a MIME-encapsulated message.--731144191B7F.1539960267/mail.zhanghl.cnContent-Description: NotificationContent-Type: text/plain; charset=us-asciiThis is the mail system at host mail.zhanghl.cn.I'</span>m sorry to have to inform you that your message could notbe delivered to one or <span class="token function">more</span> recipients. It<span class="token string">'s attached below.For further assistance, please send mail to postmaster.If you do so, please include this problem report. You candelete your own text from the attached returned message.                   The mail system&lt;root@zhanghl.cn> (expanded from &lt;root>): maildir delivery failed: create    maildir file /root/Maildir/tmp/1539960267.P14995.centos-7.shared:    Permission denied--731144191B7F.1539960267/mail.zhanghl.cnContent-Description: Delivery reportContent-Type: message/delivery-statusReporting-MTA: dns; mail.zhanghl.cnX-Postfix-Queue-ID: 731144191B7FX-Postfix-Sender: rfc822; zhanghl@zhanghl.cnArrival-Date: Fri, 19 Oct 2018 22:43:58 +0800 (CST)Final-Recipient: rfc822; root@zhanghl.cnOriginal-Recipient: rfc822;rootAction: failedStatus: 5.2.0Diagnostic-Code: X-Postfix; maildir delivery failed: create maildir file    /root/Maildir/tmp/1539960267.P14995.centos-7.shared: Permission denied--731144191B7F.1539960267/mail.zhanghl.cnContent-Description: Undelivered MessageContent-Type: message/rfc822Return-Path: &lt;zhanghl@zhanghl.cn>Received: from mail.zhanghl.cn (mail.zhanghl.cn [127.0.0.1])    by mail.zhanghl.cn (Postfix) with SMTP id 731144191B7F    for &lt;root>; Fri, 19 Oct 2018 22:43:58 +0800 (CST)Message-Id: &lt;20181019144410.731144191B7F@mail.zhanghl.cn>Date: Fri, 19 Oct 2018 22:43:58 +0800 (CST)From: zhanghl@zhanghl.cnHello, i'</span>m zhanghl<span class="token operator">!</span>--731144191B7F.1539960267/mail.zhanghl.cn--<span class="token keyword">.</span>quit+OK Logging out.Connection closed by foreign host.<span class="token punctuation">[</span>zhanghl@centos-7 ~<span class="token punctuation">]</span>$ <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ä½¿ç”¨é‚®ç®±"><a href="#ä½¿ç”¨é‚®ç®±" class="headerlink" title="ä½¿ç”¨é‚®ç®±"></a>ä½¿ç”¨é‚®ç®±</h2><p>ä¸€åˆ‡éƒ½å¼„å¥½ä»¥åï¼Œå°±å¯ä»¥ä½¿ç”¨Foxmailç­‰ç¬¬ä¸‰æ–¹è½¯ä»¶æ¥æ”¶å‘é‚®ä»¶äº†ã€‚åœ¨è¿™é‡Œéœ€è¦è¯´ä¸€ä¸‹ï¼Œç³»ç»Ÿç”¨æˆ·å°±æ˜¯é‚®ä»¶çš„ç”¨æˆ·ï¼Œä¾‹å¦‚rootï¼Œå°±æ˜¯ä¸€ä¸ªé‚®ç®±ç”¨æˆ·ï¼Œé‚®ç®±æ˜¯<a href="mailto:root@zhanghl.cn">root@zhanghl.cn</a>ï¼Œå¯†ç å°±æ˜¯rootçš„å¯†ç ï¼Œæ‰€ä»¥éœ€è¦åˆ›å»ºç”¨æˆ·ï¼Œåªè¦ä½¿ç”¨useraddåˆ›å»ºç”¨æˆ·ï¼Œå†ä½¿ç”¨passwdè®¾ç½®å¯†ç ã€‚</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è¿ç»´ </tag>
            
            <tag> Linux </tag>
            
            <tag> SMTP </tag>
            
            <tag> Mail Server </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TestLinkå®‰è£…éƒ¨ç½²</title>
      <link href="/posts/676ab03b/"/>
      <url>/posts/676ab03b/</url>
      
        <content type="html"><![CDATA[<h1 id="TestLinkå®‰è£…éƒ¨ç½²"><a href="#TestLinkå®‰è£…éƒ¨ç½²" class="headerlink" title="TestLinkå®‰è£…éƒ¨ç½²"></a><center>TestLinkå®‰è£…éƒ¨ç½²</center></h1><h2 id="å®‰è£…MySQL"><a href="#å®‰è£…MySQL" class="headerlink" title="å®‰è£…MySQL"></a>å®‰è£…MySQL</h2><p>MySQLçš„Serveråœ¨CentOS 7ä¸Šä»é»˜è®¤è½¯ä»¶åˆ—è¡¨ä¸­è¢«ç§»é™¤äº†ï¼Œç”¨MariaDBæ¥ä»£æ›¿ï¼Œæ‰€ä»¥è¿™å¯¼è‡´æˆ‘ä»¬å¿…é¡»è¦å»å®˜ç½‘ä¸Šè¿›è¡Œä¸‹è½½ï¼Œæ‰¾åˆ°é“¾æ¥ï¼Œç”¨wgetæ‰“å¼€ï¼Œç„¶åå†å®‰è£…ï¼š</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># wget http://dev.mysql.com/get/mysql57-community-release-el7-9.noarch.rpm</span><span class="token comment" spellcheck="true"># rpm -ivh mysql57-community-release-el7-9.noarch.rpm</span><span class="token comment" spellcheck="true"># yum -y install mysql mysql-server mysql-devel</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¯åŠ¨MySQLæœåŠ¡</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># systemctl start mysqld</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è·å–å®‰è£…MySQLæ—¶çš„åˆå§‹å¯†ç å¹¶ç™»å½•MySQL</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># grep 'temporary password' /var/log/mysqld.log</span><span class="token comment" spellcheck="true"># mysql -u root -p</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/4a/a001ae2bae5a494c7329cd78a477a3.jpg" alt=""></p><p>ç™»å½•æˆåŠŸåä¿®æ”¹å¯†ç ï¼Œé¦–å…ˆä¿®æ”¹å®‰å…¨ç­–ç•¥ä¸º0ï¼Œç„¶åå°†å¯†ç é•¿åº¦é™åˆ¶ä¿®æ”¹ä¸º1ï¼Œæœ€åä¿®æ”¹å¯†ç </p><pre class="line-numbers language-mysql"><code class="language-mysql">mysql> set global validate_password_policy=0;mysql> set global validate_password_length=1;mysql> set password for root@localhost=password('root');<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/a2/0f74ed53f3a426d1fe005228478d8f.jpg" alt=""></p><p>åˆ›å»ºtestlinkç”¨æˆ·å¹¶åˆ›å»ºtestlinkè¦ç”¨çš„æ•°æ®åº“å¹¶æŠŠtestlinkæ•°æ®åº“çš„æ‰€æœ‰æƒé™èµ‹ç»™testlinkç”¨æˆ·</p><pre class="line-numbers language-mysql"><code class="language-mysql">mysql> CREATE USER 'testlink'@'%' IDENTIFIED BY 'root';mysql> CREATE DATABASE testlink; mysql> GRANT ALL ON testlink.* TO 'testlink'@'%'; mysql> flush privileges;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è®¾ç½®MySQLå¯åŠ¨ä¸è‡ªå¯åŠ¨</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># systemctl enable mysqld    //è‡ªå¯åŠ¨</span><span class="token comment" spellcheck="true"># systemctl start mysqld     //å¯åŠ¨</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="å®‰è£…httpd"><a href="#å®‰è£…httpd" class="headerlink" title="å®‰è£…httpd"></a>å®‰è£…httpd</h2><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># yum -y install httpd</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="å¯åŠ¨è‡ªå¯åŠ¨"><a href="#å¯åŠ¨è‡ªå¯åŠ¨" class="headerlink" title="å¯åŠ¨è‡ªå¯åŠ¨"></a>å¯åŠ¨è‡ªå¯åŠ¨</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># systemctl enable httpd  //è‡ªå¯åŠ¨</span><span class="token comment" spellcheck="true"># systemctl start httpd   //å¯åŠ¨</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="å®‰è£…PHP"><a href="#å®‰è£…PHP" class="headerlink" title="å®‰è£…PHP"></a>å®‰è£…PHP</h2><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># rpm -Uvh https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm</span><span class="token comment" spellcheck="true"># rpm -Uvh https://mirror.webtatic.com/yum/el7/webtatic-release.rpm</span><span class="token comment" spellcheck="true"># yum -y install `yum search php | grep php56w | grep -v "===" | grep -v mysqlnd | awk -F '.' '{print $1}'`</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="æµ‹è¯•ä¸€ä¸‹PHPç¯å¢ƒ"><a href="#æµ‹è¯•ä¸€ä¸‹PHPç¯å¢ƒ" class="headerlink" title="æµ‹è¯•ä¸€ä¸‹PHPç¯å¢ƒ"></a>æµ‹è¯•ä¸€ä¸‹PHPç¯å¢ƒ</h3><p>å†™ä¸€ä¸ªphpinfoæµ‹è¯•phpç¯å¢ƒæ˜¯å¦æ­£å¸¸</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vim /var/www/html/info.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>    <span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æµè§ˆå™¨æ‰“å¼€<code>http://IP:httpdç«¯å£/info.php</code></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/bf/a51c4fe3482af30d3b54a102c5a844.jpg" alt=""></p><p>å¦‚å›¾ï¼ŒPHPç¯å¢ƒå®‰è£…å®Œæˆã€‚</p><p>*<em>Note: *</em><br>PHPæ— æ³•æ­£ç¡®è§£æï¼Œç½‘é¡µæ˜¾ç¤ºæºç çš„è§£å†³æ–¹æ³•ï¼š</p><pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">vi</span> /etc/php.ini <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å°†short_open_tag = Offä¿®æ”¹ä¸ºshort_open_tag = Onï¼Œç„¶åé‡å¯httpdæœåŠ¡å³å¯</p><h2 id="å®‰è£…TestLink"><a href="#å®‰è£…TestLink" class="headerlink" title="å®‰è£…TestLink"></a>å®‰è£…TestLink</h2><h3 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># wget https://jaist.dl.sourceforge.net/project/testlink/TestLink%201.9/TestLink%201.9.18/testlink-1.9.18.tar.gz</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="è§£å‹é‡å‘½å"><a href="#è§£å‹é‡å‘½å" class="headerlink" title="è§£å‹é‡å‘½å"></a>è§£å‹é‡å‘½å</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># tar zxvf testlink-1.9.18.tar.gz</span><span class="token comment" spellcheck="true"># mv testlink-1.9.18 testlink</span><span class="token comment" spellcheck="true"># mv testlink /var/www/html/</span><span class="token comment" spellcheck="true"># chown -R apache:apache /var/www/html/testlink</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä¿®æ”¹é…ç½®æ–‡ä»¶"><a href="#ä¿®æ”¹é…ç½®æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹é…ç½®æ–‡ä»¶"></a>ä¿®æ”¹é…ç½®æ–‡ä»¶</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># sed -i -e "s/AllowOverride None/AllowOverride All/g" /etc/httpd/conf/httpd.conf</span><span class="token comment" spellcheck="true"># sed -i -e "s/DirectoryIndex index.html/DirectoryIndex index.html index.php index.shtm/g" /etc/httpd/conf/httpd.conf</span><span class="token comment" spellcheck="true"># sed -i -e "s/session.gc_maxlifetime = 1440/session.gc_maxlifetime = 2400/g" /etc/php.ini</span><span class="token comment" spellcheck="true"># sed -i -e "s/max_execution_time = 30/max_execution_time = 120/g" /etc/php.ini</span><span class="token comment" spellcheck="true"># service httpd restart</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/49/3c7f4c9291a6c276e5dad2200d5571.jpg" alt=""></p><h3 id="æ–°å»ºä¸€äº›PHPç¯å¢ƒè¦æ±‚å¿…å¤‡çš„æ–‡ä»¶å¤¹å¹¶èµ‹äºˆé€‚å½“æƒé™"><a href="#æ–°å»ºä¸€äº›PHPç¯å¢ƒè¦æ±‚å¿…å¤‡çš„æ–‡ä»¶å¤¹å¹¶èµ‹äºˆé€‚å½“æƒé™" class="headerlink" title="æ–°å»ºä¸€äº›PHPç¯å¢ƒè¦æ±‚å¿…å¤‡çš„æ–‡ä»¶å¤¹å¹¶èµ‹äºˆé€‚å½“æƒé™"></a>æ–°å»ºä¸€äº›PHPç¯å¢ƒè¦æ±‚å¿…å¤‡çš„æ–‡ä»¶å¤¹å¹¶èµ‹äºˆé€‚å½“æƒé™</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># mkdir -p /var/www/html/testlink/gui/templates_c</span><span class="token comment" spellcheck="true"># mkdir -p /var/testlink/logs/</span><span class="token comment" spellcheck="true"># mkdir -p /var/testlink/upload_area/</span><span class="token comment" spellcheck="true"># chmod 777 /var/www/html/testlink/gui/templates_c</span><span class="token comment" spellcheck="true"># chmod 777 /var/testlink/logs/</span><span class="token comment" spellcheck="true"># chmod 777 /var/testlink/upload_area/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/23/c132221e0b416226f6f7df1e63b12c.jpg" alt=""></p><h3 id="å®‰è£…-1"><a href="#å®‰è£…-1" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>æµè§ˆå™¨æ‰“å¼€<code>http://IP:port/testlink/install</code>(å°†IPæ¢æˆè‡ªå·±ä¸»æœºIPï¼Œç«¯å£å·æ¢ä¸ºè‡ªå·±ä¸»æœºçš„ApacheæœåŠ¡ç«¯å£å·)ã€‚å¦‚å›¾ï¼Œç‚¹å‡»New installationå¼€å§‹å®‰è£…</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/14/da839143e11bec790a2a77f7247529.jpg" alt=""></p><p>é€‰ä¸­åŒæ„åè®®ï¼Œcontinue</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/7c/b33fa4f939e6447fa43f36b5577b43.jpg" alt=""></p><p>è¿›å…¥ç³»ç»Ÿç¯å¢ƒæ£€æµ‹é˜¶æ®µï¼Œè¿™ä¸€æ­¥éœ€è¦æ ¹æ®é”™è¯¯æç¤ºè¿›è¡Œé…ç½®ï¼Œå‰é¢å·²ç»åœ¨å®‰è£…phpå’Œtestlinkæ—¶è§£å†³äº†ï¼Œæ‰€ä»¥ç°åœ¨å·²ç»æ²¡æœ‰é”™è¯¯äº†ï¼Œå›¾ä¸­æ©™è‰²çš„æç¤ºå¯ä»¥å¿½ç•¥ï¼Œç‚¹å‡»continue</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/8c/84dad1406d9a22e95913b060326730.jpg" alt=""></p><p>å¦‚å›¾ï¼Œè®¾å®šæ•°æ®åº“ç®¡ç†å‘˜ç™»å½•è´¦æˆ·å¯†ç ï¼Œè‡ªå®šä¹‰TestLinkçš„æ•°æ®åº“ç™»å½•è´¦æˆ·å¯†ç ï¼Œå…¶ä½™å‡ä¿æŒé»˜è®¤ï¼Œç‚¹å‡»Process TestLink Setup</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/58/736d782618beafcda69918ffca7749.jpg" alt=""></p><p><strong>è¿™é‡Œæœ‰ä¸€ç‚¹æç¤ºï¼Œå¦‚ä¸Šå›¾ä¸­é»‘ä½“æ‰€è¯´ ï¼Œéœ€è¦æ‰‹åŠ¨å¯¼å…¥<code>udf0</code>ç»“å°¾çš„<code>sql</code>æ–‡ä»¶ï¼Œåªéœ€åœ¨<code>mysql</code>å‘½ä»¤è¡Œä¸­æ‰§è¡Œ<code>source /var/www/html/testlink/install/sql/mysql/testlink_create_udf0.sql</code>å³å¯ï¼Œéœ€è¦è¯´æ˜çš„æ˜¯ï¼Œéœ€è¦æ‰‹åŠ¨ä¿®æ”¹å…¶ä¸­çš„<code>use</code>å­—æ®µï¼Œå¦‚ä¸‹å›¾ï¼Œä¿®æ”¹ä¸º<code>mysql</code>æ–°å»ºçš„<code>testlink</code>æ•°æ®åº“å</strong></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fytosr0ucnj31p818kk2a.jpg" alt=""></p><p><em>å¦‚æœå®‰è£…åˆ°æœ€åå‡ºç°äº†æ‰“å°æ•°æ®åº“è°ƒè¯•ä¿¡æ¯ï¼Œè¯·æ£€æŸ¥<code>php</code>çš„<code>mysql</code>æ¨¡å—ï¼Œå‘½ä»¤æ˜¯<code>php -m | grep mysql</code>ï¼Œå¦‚ä¸‹å›¾åˆ™æ˜¯æ­£å¸¸çš„</em></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fytouqtrwgj31p818k7a4.jpg" alt=""></p><p><em>å¦‚æœæç¤ºåŠ¨æ€åº“æ— æ³•åŠ è½½ä¹‹ç±»çš„é”™è¯¯ï¼Œåªéœ€é‡æ–°å®‰è£…<code>php-mysql</code>ï¼Œç„¶åé‡å¯<code>php-fpm</code>å’Œ<code>httpd</code>å³å¯</em></p><h2 id="ç™»å½•"><a href="#ç™»å½•" class="headerlink" title="ç™»å½•"></a>ç™»å½•</h2><p>å®‰è£…å®Œæˆç½‘å€è¾“å…¥<a href="http://IP/testlinkå³å¯è‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µé¢ï¼Œé»˜è®¤ç”¨æˆ·admin/admin" target="_blank" rel="noopener">http://IP/testlinkå³å¯è‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µé¢ï¼Œé»˜è®¤ç”¨æˆ·admin/admin</a></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> CI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> TestLink </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CentOS å®‰è£…éƒ¨ç½² Gerrit</title>
      <link href="/posts/f43a7a1a/"/>
      <url>/posts/f43a7a1a/</url>
      
        <content type="html"><![CDATA[<h2 id="Gerrit-å®‰è£…é…ç½®è¿‡ç¨‹"><a href="#Gerrit-å®‰è£…é…ç½®è¿‡ç¨‹" class="headerlink" title="Gerrit å®‰è£…é…ç½®è¿‡ç¨‹"></a><cneter><code>Gerrit</code> å®‰è£…é…ç½®è¿‡ç¨‹</cneter></h2><h1 id="å®‰è£…è¿‡ç¨‹å¦‚ä¸‹"><a href="#å®‰è£…è¿‡ç¨‹å¦‚ä¸‹" class="headerlink" title="å®‰è£…è¿‡ç¨‹å¦‚ä¸‹"></a>å®‰è£…è¿‡ç¨‹å¦‚ä¸‹</h1><h2 id="æ­¥éª¤ä¸€ï¼šåˆ›å»ºä¸“ç”¨è´¦æˆ·å’Œå·¥ä½œç›®å½•"><a href="#æ­¥éª¤ä¸€ï¼šåˆ›å»ºä¸“ç”¨è´¦æˆ·å’Œå·¥ä½œç›®å½•" class="headerlink" title="æ­¥éª¤ä¸€ï¼šåˆ›å»ºä¸“ç”¨è´¦æˆ·å’Œå·¥ä½œç›®å½•"></a>æ­¥éª¤ä¸€ï¼šåˆ›å»ºä¸“ç”¨è´¦æˆ·å’Œå·¥ä½œç›®å½•</h2><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># adduser gerrit  // åˆ›å»ºä¸“ç”¨è´¦æˆ·</span><span class="token comment" spellcheck="true"># passwd gerrit  //ä¸ºä¸“æœ‰è´¦æˆ·è®¾ç½®å¯†ç </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="æ­¥éª¤äºŒï¼šé…ç½®Javaç¯å¢ƒ"><a href="#æ­¥éª¤äºŒï¼šé…ç½®Javaç¯å¢ƒ" class="headerlink" title="æ­¥éª¤äºŒï¼šé…ç½®Javaç¯å¢ƒ"></a>æ­¥éª¤äºŒï¼šé…ç½®<code>Java</code>ç¯å¢ƒ</h2><ul><li>å»å®˜ç½‘ä¸‹è½½<code>JDK</code>ï¼š<a href="http://www.oracle.com/technetwork/java/javase/downloads/java-archive-javase8-2177648.html" target="_blank" rel="noopener">http://www.oracle.com/technetwork/java/javase/downloads/java-archive-javase8-2177648.html</a></li></ul><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/81/1b33b7e9dbe92a1515154d0193194f.jpg" alt=""></p><ul><li>å®‰è£…<code>JDK</code><br>å°†ä¸‹è½½å¾—åˆ°çš„<code>jdk-8u161-linux-x64.rpm</code>åŒ…ä¿å­˜åˆ°<code>Linux</code>ä¸»æœº</li></ul><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># rpm -ivh jdk-8u161-linux-x64.rpm</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œç¼–è¾‘<code>~/.bashrc</code>ï¼Œ</li></ul><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vim ~/.bashrc</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨æ–‡ä»¶çš„æœ«å°¾æ·»åŠ ä»¥ä¸‹è¡Œ</p><pre><code>export JAVA_HOME=/usr/java/jdk1.8.0_161export JRE_HOME=$JAVA_HOME/jreexport CLASSPATH=$JAVA_HOME/libexport PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin:$CLASSPATH</code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/49/6ac74e90a641e355b29b9c4d17deb9.jpg" alt=""></p><p>ä½¿ç¯å¢ƒé…ç½®ç”Ÿæ•ˆ</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># source ~/.bashrc</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>æµ‹è¯•<code>Java</code>ç¯å¢ƒï¼Œåœ¨ç»ˆç«¯è¾“å…¥ï¼š<code>java -version</code>æŸ¥çœ‹æ˜¯å¦æ­£å¸¸æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ï¼Œè‹¥æ˜¾ç¤ºåˆ™å®‰è£…æˆåŠŸ</li></ul><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/2f/49c7d622b298ae690db3c13754c1b1.jpg" alt=""></p><h2 id="æ­¥éª¤ä¸‰ï¼šå®‰è£…MySQL"><a href="#æ­¥éª¤ä¸‰ï¼šå®‰è£…MySQL" class="headerlink" title="æ­¥éª¤ä¸‰ï¼šå®‰è£…MySQL"></a>æ­¥éª¤ä¸‰ï¼šå®‰è£…MySQL</h2><p>MySQLçš„Serveråœ¨CentOS 7ä¸Šä»é»˜è®¤è½¯ä»¶åˆ—è¡¨ä¸­è¢«ç§»é™¤äº†ï¼Œç”¨MariaDBæ¥ä»£æ›¿ï¼Œæ‰€ä»¥è¿™å¯¼è‡´æˆ‘ä»¬å¿…é¡»è¦å»å®˜ç½‘ä¸Šè¿›è¡Œä¸‹è½½ï¼Œæ‰¾åˆ°é“¾æ¥ï¼Œç”¨wgetæ‰“å¼€ï¼Œç„¶åå†å®‰è£…ï¼š</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># wget http://dev.mysql.com/get/mysql57-community-release-el7-9.noarch.rpm</span><span class="token comment" spellcheck="true"># rpm -ivh mysql57-community-release-el7-9.noarch.rpm</span><span class="token comment" spellcheck="true"># yum -y install mysql mysql-server mysql-devel</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¯åŠ¨MySQLæœåŠ¡</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># systemctl start mysqld</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è·å–å®‰è£…MySQLæ—¶çš„åˆå§‹å¯†ç å¹¶ç™»å½•MySQL</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># grep 'temporary password' /var/log/mysqld.log</span><span class="token comment" spellcheck="true"># mysql -u root -p</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/4a/a001ae2bae5a494c7329cd78a477a3.jpg" alt=""></p><p>ç™»å½•æˆåŠŸåä¿®æ”¹å¯†ç ï¼Œé¦–å…ˆä¿®æ”¹å®‰å…¨ç­–ç•¥ä¸º0ï¼Œç„¶åå°†å¯†ç é•¿åº¦é™åˆ¶ä¿®æ”¹ä¸º1ï¼Œæœ€åä¿®æ”¹å¯†ç </p><pre class="line-numbers language-mysql"><code class="language-mysql">mysql> set global validate_password_policy=0;mysql> set global validate_password_length=1;mysql> set password for root@localhost=password('root');<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/a2/0f74ed53f3a426d1fe005228478d8f.jpg" alt=""></p><p>åˆ›å»ºgerritç”¨æˆ·</p><pre class="line-numbers language-mysql"><code class="language-mysql">mysql> CREATE USER 'gerrit'@'%' IDENTIFIED BY '123456';<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åˆ›å»ºgerritè¦ç”¨çš„æ•°æ®è¡¨</p><pre class="line-numbers language-mysql"><code class="language-mysql">mysql> CREATE DATABASE ReviewDB; <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/d2/49b9ee020b217374593ca9bf2333b3.jpg" alt=""></p><p>æŠŠReviewDBçš„æ‰€æœ‰æƒé™èµ‹ç»™gerrit</p><pre class="line-numbers language-mysql"><code class="language-mysql">mysql> GRANT ALL ON ReviewDB.* TO 'gerrit'@'%'; <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/73/94a9f46a5dd2572e26ac02b13ec1d8.jpg" alt=""></p><h2 id="æ­¥éª¤å››ï¼šå®‰è£…Git"><a href="#æ­¥éª¤å››ï¼šå®‰è£…Git" class="headerlink" title="æ­¥éª¤å››ï¼šå®‰è£…Git"></a>æ­¥éª¤å››ï¼šå®‰è£…Git</h2><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># yum -y install git</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="æ­¥éª¤äº”ï¼šä¸‹è½½å®‰è£…gerrit"><a href="#æ­¥éª¤äº”ï¼šä¸‹è½½å®‰è£…gerrit" class="headerlink" title="æ­¥éª¤äº”ï¼šä¸‹è½½å®‰è£…gerrit"></a>æ­¥éª¤äº”ï¼šä¸‹è½½å®‰è£…<code>gerrit</code></h2><ul><li>ä»å®˜ç½‘ä¸‹è½½<code>gerrit</code>ï¼Œå­˜æ”¾äº<code>/home/gerrit</code>ç›®å½•ï¼š</li></ul><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># wget https://gerrit-releases.storage.googleapis.com/gerrit-2.15.5.war</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>å®‰è£…<code>gerrit</code>ï¼š</li></ul><p>é¦–å…ˆåˆ‡æ¢ä¸ºgerritç”¨æˆ·ï¼Œç„¶åè¿è¡Œgerritçš„waråŒ…</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># su gerrit</span>$ <span class="token function">cd</span> $ java -jar gerrit-2.15.war init -d review_site<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä¸€è·¯å›è½¦é»˜è®¤å®‰è£…(å…¶ä¸­çš„è®¤è¯æ–¹å¼å¤„æ”¹ä¸ºHTTP)</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@centos-7 gerrit<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># su gerrit</span><span class="token punctuation">[</span>gerrit@centos-7 ~<span class="token punctuation">]</span>$ llæ€»ç”¨é‡ 83864-rwxr-xr-x. 1 root root 85872756 8æœˆ  21 12:49 gerrit-2.14.war<span class="token punctuation">[</span>gerrit@centos-7 ~<span class="token punctuation">]</span>$ java -jar gerrit-2.15.5.war init -d review_siteUsing secure store: com.google.gerrit.server.securestore.DefaultSecureStore<span class="token punctuation">[</span>2018-08-21 12:51:37,463<span class="token punctuation">]</span> <span class="token punctuation">[</span>main<span class="token punctuation">]</span> INFO  com.google.gerrit.server.config.GerritServerConfigProvider <span class="token keyword">:</span> No /home/gerrit/review_site/etc/gerrit.config<span class="token punctuation">;</span> assuming defaults*** Gerrit Code Review 2.15.5***Create <span class="token string">'/home/gerrit/review_site'</span> <span class="token punctuation">[</span>Y/n<span class="token punctuation">]</span>?*** Git Repositories***Location of Git repositories   <span class="token punctuation">[</span>git<span class="token punctuation">]</span>:*** SQL Database***Database server <span class="token function">type</span>           <span class="token punctuation">[</span>h2<span class="token punctuation">]</span>:*** Index***Type                           <span class="token punctuation">[</span>LUCENE/?<span class="token punctuation">]</span>:*** User Authentication***Authentication method          <span class="token punctuation">[</span>OPENID/?<span class="token punctuation">]</span>: HTTPGet username from custom HTTP header <span class="token punctuation">[</span>y/N<span class="token punctuation">]</span>?SSO <span class="token function">logout</span> URL                 <span class="token keyword">:</span>Enable signed push support     <span class="token punctuation">[</span>y/N<span class="token punctuation">]</span>?*** Review Labels***Install Verified label         <span class="token punctuation">[</span>y/N<span class="token punctuation">]</span>?*** Email Delivery***SMTP server <span class="token function">hostname</span>           <span class="token punctuation">[</span>localhost<span class="token punctuation">]</span>:SMTP server port               <span class="token punctuation">[</span><span class="token punctuation">(</span>default<span class="token punctuation">)</span><span class="token punctuation">]</span>:SMTP encryption                <span class="token punctuation">[</span>NONE/?<span class="token punctuation">]</span>:SMTP username                  <span class="token keyword">:</span>*** Container Process***Run as                         <span class="token punctuation">[</span>gerrit<span class="token punctuation">]</span>:Java runtime                   <span class="token punctuation">[</span>/usr/java/jdk1.8.0_161/jre<span class="token punctuation">]</span>:Copy gerrit-2.15.5.war to review_site/bin/gerrit.war <span class="token punctuation">[</span>Y/n<span class="token punctuation">]</span>?Copying gerrit-2.15.5.war to review_site/bin/gerrit.war*** SSH Daemon***Listen on address              <span class="token punctuation">[</span>*<span class="token punctuation">]</span>:Listen on port                 <span class="token punctuation">[</span>29418<span class="token punctuation">]</span>:Generating SSH host key <span class="token punctuation">..</span>. rsa<span class="token punctuation">..</span>. dsa<span class="token punctuation">..</span>. <span class="token keyword">done</span>*** HTTP Daemon***Behind reverse proxy           <span class="token punctuation">[</span>y/N<span class="token punctuation">]</span>?Use SSL <span class="token punctuation">(</span>https://<span class="token punctuation">)</span>             <span class="token punctuation">[</span>y/N<span class="token punctuation">]</span>?Listen on address              <span class="token punctuation">[</span>*<span class="token punctuation">]</span>:Listen on port                 <span class="token punctuation">[</span>8080<span class="token punctuation">]</span>:Canonical URL                  <span class="token punctuation">[</span>http://centos-7.shared:8080/<span class="token punctuation">]</span>:*** Cache****** Plugins***Installing plugins.Install plugin commit-message-length-validator version v2.15.5 <span class="token punctuation">[</span>y/N<span class="token punctuation">]</span>?Install plugin download-commands version v2.15.5 <span class="token punctuation">[</span>y/N<span class="token punctuation">]</span>?Install plugin hooks version v2.15.5 <span class="token punctuation">[</span>y/N<span class="token punctuation">]</span>?Install plugin replication version v2.15.5 <span class="token punctuation">[</span>y/N<span class="token punctuation">]</span>?Install plugin reviewnotes version v2.15.5 <span class="token punctuation">[</span>y/N<span class="token punctuation">]</span>?Install plugin singleusergroup version v2.15.5 <span class="token punctuation">[</span>y/N<span class="token punctuation">]</span>?Initializing plugins.No plugins found with init steps.Initialized /home/gerrit/review_siteExecuting /home/gerrit/review_site/bin/gerrit.sh startStarting Gerrit Code Review: OKWaiting <span class="token keyword">for</span> server on centos-7.shared:8080 <span class="token punctuation">..</span>. OKOpening http://centos-7.shared:8080/<span class="token comment" spellcheck="true">#/admin/projects/ ...FAILED</span>Open Gerrit with a JavaScript capable browser:  http://centos-7.shared:8080/<span class="token comment" spellcheck="true">#/admin/projects/</span><span class="token punctuation">[</span>gerrit@centos-7 ~<span class="token punctuation">]</span>$<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆæƒæ–‡ä»¶å¤¹æƒé™ç»™gerritç”¨æˆ·ï¼š </p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># chown -R gerrit:gerrit review_site </span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>ä¿®æ”¹<code>gerrit</code>é…ç½®æ–‡ä»¶ï¼Œè¯´æ˜å¦‚ä¸‹</li></ul><pre class="line-numbers language-bash"><code class="language-bash">$ vim review_site/etc/gerrit.config<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>[gerrit]        basePath = git                          //æŒ‡å®šè¢«gerritç®¡ç†çš„æ‰€æœ‰gitåº“å­˜æ”¾ä½ç½®ï¼Œå³review_site_project/git/        canonicalWebUrl = http://10.211.55.19:8081/project   //æŒ‡å®šwebè®¿é—®gerritçš„ç½‘å€//å¡«è‡ªå·±çš„ipå’Œç«¯å£å·[database]        type = mysql                             //æŒ‡å®šgerritæ‰€é»˜è®¤æ•°æ®åº“ç±»å‹ï¼Œå¯ä»¥é€‰ç”¨mysqlï¼Œå®‰è£…å¹¶åˆ›å»ºgerritè´¦æˆ·        database = /home/gerrit/review_site/db/ReviewDB[auth]        type = HTTP                           //æŒ‡å®šæµè§ˆå™¨ç™»å½•gerritæ—¶çš„è®¤è¯æ–¹å¼[sendemail]        smtpServer = localhost                //å±€åŸŸç½‘é‚®ä»¶æœåŠ¡å™¨ï¼Œå¯ä½¿ç”¨hMailSeveræ­å»º[container]        user = gerrit                             //æŒ‡å®šgerritæ‰€åœ¨æœºå™¨çš„ç”¨æˆ·èº«ä»½ä¸ä¸Šæ–‡åˆ›å»ºçš„ç”¨æˆ·å¯¹åº”ä¸€è‡´,å¯ä»¥æ˜¯root        javaHome = /usr/java/jdk1.8.0_161/jre[sshd]        listenAddress = *:29418                   //æŒ‡å®šsshdæœåŠ¡ç›‘å¬çš„ç«¯å£å·[httpd]        listenUrl = http://*:8081/                //æŒ‡å®šhttpä»£ç†åœ°å€[cache]        directory = cache                        //ç¼“å­˜ä½ç½®</code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/31/8e586e93c265a2f6ff36d3db0454e7.jpg" alt=""></p><p>é‡å¯gerritæœåŠ¡</p><pre class="line-numbers language-bash"><code class="language-bash">$ review_site/bin/gerrit.sh restart<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è®¾ç½®gerritæœåŠ¡å¼€æœºå¯åŠ¨</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># ln -snf /home/gerrit/review_site/bin/gerrit.sh /etc/init.d/gerrit.sh</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="æ­¥éª¤å…­ï¼šé…ç½®åå‘ä»£ç†æœåŠ¡-nginx"><a href="#æ­¥éª¤å…­ï¼šé…ç½®åå‘ä»£ç†æœåŠ¡-nginx" class="headerlink" title="æ­¥éª¤å…­ï¼šé…ç½®åå‘ä»£ç†æœåŠ¡(nginx)"></a>æ­¥éª¤å…­ï¼šé…ç½®åå‘ä»£ç†æœåŠ¡(nginx)</h2><blockquote><p>è¯´æ˜ï¼š å±€åŸŸç½‘æœ¬åœ°å®‰è£…ï¼Œè®¾ç½®æœ¬åœ°<code>repo</code>åº“</p></blockquote><h3 id="å®‰è£…nginxåå‘ä»£ç†æœåŠ¡å™¨"><a href="#å®‰è£…nginxåå‘ä»£ç†æœåŠ¡å™¨" class="headerlink" title="å®‰è£…nginxåå‘ä»£ç†æœåŠ¡å™¨"></a>å®‰è£…<code>nginx</code>åå‘ä»£ç†æœåŠ¡å™¨</h3><ul><li>å®‰è£…<code>gcc-c++ pcre pcre-devel zlib zlib-devel openssl</code>ï¼š </li></ul><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># yum -y install gcc-c++ pcre pcre-devel zlib zlib-devel openssl</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>å®‰è£…å¯åŠ¨<code>nginx</code>å¹¶è®¾ç½®è‡ªå¯åŠ¨</li></ul><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># rpm -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm</span><span class="token comment" spellcheck="true"># yum update &amp;&amp; yum -y install nginx </span><span class="token comment" spellcheck="true"># systemctl enable nginx</span>Created symlink from /etc/systemd/system/multi-user.target.wants/nginx.service to /usr/lib/systemd/system/nginx.service.<span class="token comment" spellcheck="true"># systemctl start nginx</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="é…ç½®nginxï¼š"><a href="#é…ç½®nginxï¼š" class="headerlink" title="é…ç½®nginxï¼š"></a>é…ç½®<code>nginx</code>ï¼š</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vim /etc/nginx/conf.d/default.conf</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>server {    listen       82;    server_name  localhost;    auth_basic "Welcome to Gerrit Code Review !";    auth_basic_user_file /home/gerrit/review_site/etc/passwd;    #charset koi8-r;    #access_log  /var/log/nginx/host.access.log  main;    location / {        #root   /usr/share/nginx/html;        #index  index.html index.htm index.php index.jsp;        proxy_pass http://127.0.0.1:8081;        #proxy_set_header X-Forwarded-For $remote_addr;        proxy_set_header Host $host;        proxy_set_header X-Real-IP $remote_addr;        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;    }    #error_page  404              /404.html;    # redirect server error pages to the static page /50x.html    #    error_page   500 502 503 504  /50x.html;    location = /50x.html {        root   /usr/share/nginx/html;    }</code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/a1/7b9e070ca210075f5fec8631a40d8b.jpg" alt=""></p><p>å¯åŠ¨<code>nginx</code>æœåŠ¡ï¼š</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># setenforce 0                 //å…³é—­selinuxä»¥é¿å…é€ æˆæƒé™é—®é¢˜</span><span class="token comment" spellcheck="true"># systemctl disable firewalld  //ç¦ç”¨é˜²ç«å¢™</span><span class="token comment" spellcheck="true"># systemctl stop firewalld     //å…³é—­é˜²ç«å¢™</span><span class="token comment" spellcheck="true"># systemctl start nginx</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è®¾ç½®ç¬¬ä¸€ä¸ªgerritç”¨æˆ·çš„è´¦å·å’Œå¯†ç "><a href="#è®¾ç½®ç¬¬ä¸€ä¸ªgerritç”¨æˆ·çš„è´¦å·å’Œå¯†ç " class="headerlink" title="è®¾ç½®ç¬¬ä¸€ä¸ªgerritç”¨æˆ·çš„è´¦å·å’Œå¯†ç "></a>è®¾ç½®ç¬¬ä¸€ä¸ª<code>gerrit</code>ç”¨æˆ·çš„è´¦å·å’Œå¯†ç </h3><p>è¦ç”¨åˆ°htpasswdå‘½ä»¤éœ€è¦é¦–å…ˆå®‰è£…æœ‰httpd</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># yum -y install httpd</span>$ <span class="token function">touch</span> ./review_site/etc/passwd$ htpasswd -b ./review_site/etc/passwd gerrit 123456<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="æ­¥éª¤ä¸ƒï¼šå®‰è£…é…ç½®gitweb"><a href="#æ­¥éª¤ä¸ƒï¼šå®‰è£…é…ç½®gitweb" class="headerlink" title="æ­¥éª¤ä¸ƒï¼šå®‰è£…é…ç½®gitweb"></a>æ­¥éª¤ä¸ƒï¼šå®‰è£…é…ç½®<code>gitweb</code></h2><h3 id="å®‰è£…gitweb-æœ€å¥½åœ¨è”ç½‘ç¯å¢ƒä¸‹å®‰è£…ï¼Œæˆ–è€…åœ¨ç¦»çº¿ç¯å¢ƒä¸‹ä¸‹è½½å¯¹åº”çš„ä¾èµ–åŒ…"><a href="#å®‰è£…gitweb-æœ€å¥½åœ¨è”ç½‘ç¯å¢ƒä¸‹å®‰è£…ï¼Œæˆ–è€…åœ¨ç¦»çº¿ç¯å¢ƒä¸‹ä¸‹è½½å¯¹åº”çš„ä¾èµ–åŒ…" class="headerlink" title="å®‰è£…gitweb,æœ€å¥½åœ¨è”ç½‘ç¯å¢ƒä¸‹å®‰è£…ï¼Œæˆ–è€…åœ¨ç¦»çº¿ç¯å¢ƒä¸‹ä¸‹è½½å¯¹åº”çš„ä¾èµ–åŒ…"></a>å®‰è£…<code>gitweb</code>,æœ€å¥½åœ¨è”ç½‘ç¯å¢ƒä¸‹å®‰è£…ï¼Œæˆ–è€…åœ¨ç¦»çº¿ç¯å¢ƒä¸‹ä¸‹è½½å¯¹åº”çš„ä¾èµ–åŒ…</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># yum -y install gitweb</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="é…ç½®gitweb-ä¸gerrité›†æˆ"><a href="#é…ç½®gitweb-ä¸gerrité›†æˆ" class="headerlink" title="é…ç½®gitweb,ä¸gerrité›†æˆ"></a>é…ç½®<code>gitweb</code>,ä¸<code>gerrit</code>é›†æˆ</h3><p>ä¿®æ”¹<code>gitweb</code>çš„é…ç½®æ–‡ä»¶ï¼ˆ/etc/gitweb.confï¼‰ï¼Œå°†é…ç½®é¡¹ â€œ$projectrootâ€ä¿®æ”¹ä¸º<code>gerrit</code>çš„<code>git</code>ä»“åº“ç›®å½•ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/35/3723767206d90e1f1fbf859d5df6ba.jpg" alt=""></p><p>ä¿®æ”¹/home/gerrit/review_site/etc/gerrit.config,æ·»åŠ ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/26/432e046271c2658c8a203b86c19d5f.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/9d/b0b9039fc3682a7cdfae62ce5387d9.jpg" alt=""></p><h3 id="é…ç½®gerritæƒé™"><a href="#é…ç½®gerritæƒé™" class="headerlink" title="é…ç½®gerritæƒé™"></a>é…ç½®gerritæƒé™</h3><p>ä½¿ç”¨ç®¡ç†å‘˜è´¦å·ç™»å½•<code>gerrit</code>,ä¿®æ”¹<code>All-Projects</code>çš„æƒé™ï¼Œä¸º<code>refs/*</code>å’Œ<code>refs/meta/config</code>çš„<code>Read</code>é…ç½®é¡¹é…ç½®åˆé€‚çš„æƒé™ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/bc/d4431e93f304e1a913b244cadfd492.jpg" alt=""></p><p><strong>æ³¨æ„ï¼šå¦‚æœä½ æ˜¯åœ¨rootç”¨æˆ·ä¸‹è¾“å…¥ä¸Šé¢çš„å‘½ä»¤ åˆ›å»ºäº†passwordæ–‡ä»¶åˆ°/home/gerrit/review_site/etcç›®å½•ä¸­,ä½ ä¼šå‘ç°åœ¨ç™»å½•çš„æ—¶å€™æ°¸è¿œç™»å½•ä¸æˆåŠŸ,æ°¸è¿œä¼šå¾—åˆ°æœåŠ¡å™¨500çš„é”™è¯¯é¡µé¢ã€‚åŸå› æ˜¯passwordæ–‡ä»¶çš„æƒé™é—®é¢˜ã€‚æˆ‘ä»¬çŸ¥é“,/home/gerrit/æ˜¯æˆ‘ä»¬ä¹‹å‰æ–°å»ºçš„gerritç”¨æˆ·çš„,é‚£ä¹ˆè¿™ä¸ªæ–‡ä»¶å¤¹çš„æƒé™æ˜¯700,ä¹Ÿå°±æ˜¯åªå…è®¸gerritç”¨æˆ·è®¿é—®,å…¶ä»–ç»„çš„ç”¨æˆ·æ˜¯è®¿é—®ä¸äº†çš„,è™½ç„¶è¿™ä¸ªæ–‡ä»¶çš„æƒé™æ‹¥æœ‰rootç”¨æˆ·çš„æ‰€æœ‰æƒé™,ä½†æ˜¯å› ä¸ºå®ƒæ”¾åœ¨700æƒé™çš„æ–‡ä»¶å¤¹ä¸‹é¢,æ‰€ä»¥åŒæ ·å…¶ä»–ç”¨æˆ·æ˜¯è®¿é—®ä¸åˆ°çš„ã€‚è§£å†³æ–¹æ³•å¦‚ä¸‹</strong></p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># chown -R gerrit:gerrit /home/gerrit</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="é‡å¯gerritæœåŠ¡å’ŒNginxæœåŠ¡"><a href="#é‡å¯gerritæœåŠ¡å’ŒNginxæœåŠ¡" class="headerlink" title="é‡å¯gerritæœåŠ¡å’ŒNginxæœåŠ¡"></a>é‡å¯gerritæœåŠ¡å’ŒNginxæœåŠ¡</h3><p>é‡å¯<code>gerrit</code>å’Œ<code>nginx</code>æœåŠ¡</p><pre class="line-numbers language-bash"><code class="language-bash">$ /home/gerrit/review_site/bin/gerrit.sh restart<span class="token comment" spellcheck="true"># systemctl restart nginx</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="æ­¥éª¤å…«ï¼šæµ‹è¯•"><a href="#æ­¥éª¤å…«ï¼šæµ‹è¯•" class="headerlink" title="æ­¥éª¤å…«ï¼šæµ‹è¯•"></a>æ­¥éª¤å…«ï¼šæµ‹è¯•</h2><p>è®¿é—®<a href="http://localhostï¼Œç”¨gerritç”¨æˆ·ç™»å½•ï¼Œç™»å½•ç•Œé¢å¦‚ä¸‹" target="_blank" rel="noopener">http://localhostï¼Œç”¨gerritç”¨æˆ·ç™»å½•ï¼Œç™»å½•ç•Œé¢å¦‚ä¸‹</a></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/74/51196a5c04235cfbd07cf5a09e1b95.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/79/114d466e1f80823db828265ede65ee.jpg" alt=""></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Gerrit </tag>
            
            <tag> ä»£ç å®¡æŸ¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Jenkins é…ç½®éƒ¨ç½²</title>
      <link href="/posts/3d8ac6aa/"/>
      <url>/posts/3d8ac6aa/</url>
      
        <content type="html"><![CDATA[<h1 id="Jenkins-é…ç½®éƒ¨ç½²"><a href="#Jenkins-é…ç½®éƒ¨ç½²" class="headerlink" title="Jenkins é…ç½®éƒ¨ç½²"></a><center><code>Jenkins</code> é…ç½®éƒ¨ç½²</center></h1><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>Jenkinsæ˜¯ä¸€ä¸ªå¼€æºçš„ã€æä¾›å‹å¥½æ“ä½œç•Œé¢çš„æŒç»­é›†æˆ(CI)å·¥å…·ï¼Œèµ·æºäºHudsonï¼ˆHudsonæ˜¯å•†ç”¨çš„ï¼‰ï¼Œä¸»è¦ç”¨äºæŒç»­ã€è‡ªåŠ¨çš„æ„å»º/æµ‹è¯•è½¯ä»¶é¡¹ç›®ã€ç›‘æ§å¤–éƒ¨ä»»åŠ¡çš„è¿è¡Œã€‚Jenkinsç”¨Javaè¯­è¨€ç¼–å†™ï¼Œå¯åœ¨Tomcatç­‰æµè¡Œçš„servletå®¹å™¨ä¸­è¿è¡Œï¼Œä¹Ÿå¯ç‹¬ç«‹è¿è¡Œã€‚é€šå¸¸ä¸ç‰ˆæœ¬ç®¡ç†å·¥å…·(SCM)ã€æ„å»ºå·¥å…·ç»“åˆä½¿ç”¨ï¼›å¸¸ç”¨çš„ç‰ˆæœ¬ç®¡ç†ç³»ç»Ÿæœ‰SVNã€GITï¼Œæ„å»ºå·¥å…·æœ‰Mavenã€Antã€Gradleã€‚å…¶å…·å¤‡ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><ul><li>æ˜“äºå®‰è£…ï¼šä¸éœ€è¦å®‰è£…ã€ä¸éœ€è¦æ•°æ®åº“ï¼Œåªéœ€é€šè¿‡java -jar jenkins.waræˆ–éƒ¨ç½²åˆ°ä¸€ä¸ªservletå®¹å™¨ä¸­ã€‚</li><li>æ˜“äºé…ç½®ï¼šæ‰€æœ‰çš„é…ç½®éƒ½å¯èƒ½é€šè¿‡Jenkinsæä¾›çš„webç•Œé¢å®Œæˆï¼Œå½“ç„¶å¦‚æœä½ å–œæ¬¢ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ‰‹åŠ¨ä¿®æ”¹xmlæ–‡ä»¶è¿›è¡Œé…ç½®ã€‚</li><li>æ¶ˆæ¯é€šçŸ¥åŠæµ‹è¯•æŠ¥å‘Šï¼šèƒ½å¤Ÿç”Ÿæˆå„ç±»æµ‹è¯•æŠ¥å‘Šå¹¶é€šè¿‡æ¶ˆæ¯é€šçŸ¥æœºåˆ¶ï¼ˆEmailç­‰ï¼‰è¿›è¡ŒæŠ¥å‘Šï¼ŒåŒ…æ‹¬å•å…ƒæµ‹è¯•ã€è¦†ç›–ç‡æµ‹è¯•ã€é™æ€åˆ†æç­‰ã€‚</li><li>åˆ†å¸ƒå¼æ„å»ºï¼šJenkinsæ”¯æŒå¤šä¸ªSlaveèŠ‚ç‚¹çš„åŠ¨æ€æŒ‚è½½ï¼Œå®Œæˆåˆ†å¸ƒå¼æ„å»ºã€‚</li><li>èµ„æºåŠ¨æ€è°ƒåº¦ï¼šJenkinsçš„å®¹å™¨èµ„æºé€šè¿‡KubernetesåŠ¨æ€è°ƒåº¦ï¼ŒåŠ¨æ€æ‰©å®¹æ”¶ç¼©ã€‚</li><li>æ’ä»¶æ”¯æŒï¼šJenkinsæ”¯æŒä¸Šåƒç§æ’ä»¶ï¼Œå¯ä»¥è¿›è¡Œæ‰©å±•ï¼Œä¹Ÿå¯ä»¥æ ¹æ®éœ€æ±‚è¿‘å®šåˆ¶å¼€å‘ã€‚</li></ul><h2 id="å®‰è£…éƒ¨ç½²"><a href="#å®‰è£…éƒ¨ç½²" class="headerlink" title="å®‰è£…éƒ¨ç½²"></a>å®‰è£…éƒ¨ç½²</h2><p>ä»¥CentOSç¯å¢ƒå®‰è£…éƒ¨ç½²ä¸ºä¾‹ï¼Œè¯¦ç»†ä»‹ç»Jenkinså®‰è£…éƒ¨ç½²æ•´ä½“è¿‡ç¨‹å’Œå¸¸ç”¨è®¾ç½®ã€‚</p><h3 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h3><h4 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h4><p>å¦‚æœä½¿ç”¨Jenkins.waråŒ…çš„å½¢å¼è¿›è¡Œå®‰è£…ï¼Œéœ€è¦æå‰å‡†å¤‡ä»¥ä¸‹ç¯å¢ƒã€‚</p><h5 id="Javaç¯å¢ƒå‡†å¤‡"><a href="#Javaç¯å¢ƒå‡†å¤‡" class="headerlink" title="Javaç¯å¢ƒå‡†å¤‡"></a>Javaç¯å¢ƒå‡†å¤‡</h5><h6 id="å»å®˜ç½‘ä¸‹è½½JDKï¼š"><a href="#å»å®˜ç½‘ä¸‹è½½JDKï¼š" class="headerlink" title="å»å®˜ç½‘ä¸‹è½½JDKï¼š"></a>å»å®˜ç½‘ä¸‹è½½<code>JDK</code>ï¼š</h6><p><a href="http://www.oracle.com/technetwork/java/javase/downloads/java-archive-javase8-2177648.html" target="_blank" rel="noopener">http://www.oracle.com/technetwork/java/javase/downloads/java-archive-javase8-2177648.html</a></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/81/1b33b7e9dbe92a1515154d0193194f.jpg" alt=""></p><h6 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h6><ul><li>å°†ä¸‹è½½å¾—åˆ°çš„<code>jdk-8u161-linux-x64.rpm</code>åŒ…ä¿å­˜åˆ°<code>Linux</code>ä¸»æœº</li></ul><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># rpm -ivh jdk-8u161-linux-x64.rpm</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/ad/4301bf0ab8d0d138ded7bc3709fd4a.jpg" alt=""></p><h6 id="ç¯å¢ƒå˜é‡"><a href="#ç¯å¢ƒå˜é‡" class="headerlink" title="ç¯å¢ƒå˜é‡"></a>ç¯å¢ƒå˜é‡</h6><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vim ~/.bashrc</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨æ–‡ä»¶çš„æœ«å°¾æ·»åŠ ä»¥ä¸‹è¡Œ</p><pre><code>export JAVA_HOME=/usr/java/jdk1.8.0_161export JRE_HOME=$JAVA_HOME/jreexport CLASSPATH=$JAVA_HOME/libexport PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin:$CLASSPATH</code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/49/6ac74e90a641e355b29b9c4d17deb9.jpg" alt=""></p><p>ä½¿ç¯å¢ƒé…ç½®ç”Ÿæ•ˆ</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># source ~/.bashrc</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h6 id="æµ‹è¯•Javaç¯å¢ƒ"><a href="#æµ‹è¯•Javaç¯å¢ƒ" class="headerlink" title="æµ‹è¯•Javaç¯å¢ƒ"></a>æµ‹è¯•<code>Java</code>ç¯å¢ƒ</h6><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># java -version</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>â€ƒâ€ƒæŸ¥çœ‹æ˜¯å¦æ­£å¸¸æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ï¼Œè‹¥æ˜¾ç¤ºåˆ™å®‰è£…æˆåŠŸ</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/2f/49c7d622b298ae690db3c13754c1b1.jpg" alt=""></p><h5 id="Tomcatç¯å¢ƒå‡†å¤‡"><a href="#Tomcatç¯å¢ƒå‡†å¤‡" class="headerlink" title="Tomcatç¯å¢ƒå‡†å¤‡"></a>Tomcatç¯å¢ƒå‡†å¤‡</h5><h6 id="ä¸‹è½½Tomcat"><a href="#ä¸‹è½½Tomcat" class="headerlink" title="ä¸‹è½½Tomcat"></a>ä¸‹è½½Tomcat</h6><blockquote><p>åœ°å€: <a href="http://mirrors.shu.edu.cn/apache/tomcat/tomcat-8/v8.5.32/bin/apache-tomcat-8.5.32.tar.gz" target="_blank" rel="noopener">http://mirrors.shu.edu.cn/apache/tomcat/tomcat-8/v8.5.32/bin/apache-tomcat-8.5.32.tar.gz</a></p></blockquote><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># wget http://mirrors.shu.edu.cn/apache/tomcat/tomcat-8/v8.5.32/bin/apache-tomcat-8.5.32.tar.gz</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h6 id="å®‰è£…Tomcat"><a href="#å®‰è£…Tomcat" class="headerlink" title="å®‰è£…Tomcat"></a>å®‰è£…Tomcat</h6><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># tar zxvf apache-tomcat-8.5.32.tar.gz</span><span class="token comment" spellcheck="true"># mv apache-tomcat-8.5.32 /usr/local/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h6 id="é…ç½®Tomcatç¯å¢ƒ"><a href="#é…ç½®Tomcatç¯å¢ƒ" class="headerlink" title="é…ç½®Tomcatç¯å¢ƒ"></a>é…ç½®Tomcatç¯å¢ƒ</h6><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vim ~/.bashrc</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨æ–‡ä»¶çš„æœ«å°¾æ·»åŠ ä»¥ä¸‹è¡Œ</p><pre><code>export CATALINA_BASE=/usr/local/apache-tomcat-8.5.32export TOMCAT_HOME=/usr/local/apache-tomcat-8.5.32export CATALINA_HOME=/usr/local/apache-tomcat-8.5.32export PATH=$PATH:$CATALINA_HOME/bin:$CATALINA_HOME/lib</code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/66/1656ee9280886c6c7de6057c8835cd.jpg" alt=""></p><p>ä½¿ç¯å¢ƒé…ç½®ç”Ÿæ•ˆ</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># source ~/.bashrc</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h6 id="å¯åŠ¨TomcatæœåŠ¡"><a href="#å¯åŠ¨TomcatæœåŠ¡" class="headerlink" title="å¯åŠ¨TomcatæœåŠ¡"></a>å¯åŠ¨TomcatæœåŠ¡</h6><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># startup.sh</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/f9/4e6e503aa6fe748959adfb182e3e1c.jpg" alt=""></p><h6 id="æµ‹è¯•Tomcat"><a href="#æµ‹è¯•Tomcat" class="headerlink" title="æµ‹è¯•Tomcat"></a>æµ‹è¯•Tomcat</h6><p>æ‰“å¼€æµè§ˆå™¨ï¼Œåœ¨åœ°å€æ ä¸­è¾“å…¥<a href="http://IP:8080å›è½¦ï¼Œå¦‚æœçœ‹åˆ°Tomcatè‡ªå¸¦çš„ä¸€ä¸ªJSPé¡µé¢ï¼Œè¯´æ˜ä½ çš„Tomcatå·²æ­å»ºæˆåŠŸ">http://IP:8080å›è½¦ï¼Œå¦‚æœçœ‹åˆ°Tomcatè‡ªå¸¦çš„ä¸€ä¸ªJSPé¡µé¢ï¼Œè¯´æ˜ä½ çš„Tomcatå·²æ­å»ºæˆåŠŸ</a></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/43/36596794bdf3af70f1ecd35f8c40a0.jpg" alt=""></p><h3 id="å®‰è£…éƒ¨ç½²-1"><a href="#å®‰è£…éƒ¨ç½²-1" class="headerlink" title="å®‰è£…éƒ¨ç½²"></a>å®‰è£…éƒ¨ç½²</h3><h4 id="ä¸‹è½½waræ–‡ä»¶"><a href="#ä¸‹è½½waræ–‡ä»¶" class="headerlink" title="ä¸‹è½½waræ–‡ä»¶"></a>ä¸‹è½½waræ–‡ä»¶</h4><pre><code># wget http://mirrors.jenkins.io/war-stable/latest/jenkins.war</code></pre><h4 id="å®‰è£…Jenkins"><a href="#å®‰è£…Jenkins" class="headerlink" title="å®‰è£…Jenkins"></a>å®‰è£…Jenkins</h4><p>å°†ä¸‹è½½åçš„waråŒ…æ”¾åˆ°/usr/local/apache-tomcat-8.5.32/webapps/ç›®å½•ä¸‹ï¼Œå¯åŠ¨tomcatå³å¯ï¼Œ æˆ–è€…ç”¨å‘½ä»¤<code>java -jar jenkins.war</code>ã€‚</p><h4 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h4><p>æ‰“å¼€æµè§ˆå™¨è¾“å…¥<a href="http://IP:8080/jenkinså›è½¦å³å¯çœ‹åˆ°jenkinåˆå§‹é…ç½®ç•Œé¢ï¼ŒæŒ‰ç…§æç¤ºè¿›è¡Œè®¾ç½®ã€‚" target="_blank" rel="noopener">http://IP:8080/jenkinså›è½¦å³å¯çœ‹åˆ°jenkinåˆå§‹é…ç½®ç•Œé¢ï¼ŒæŒ‰ç…§æç¤ºè¿›è¡Œè®¾ç½®ã€‚</a></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/27/4f737ebea43eb34f747fb68a08b6fa.jpg" alt=""></p><h3 id="å¸¸ç”¨è®¾ç½®"><a href="#å¸¸ç”¨è®¾ç½®" class="headerlink" title="å¸¸ç”¨è®¾ç½®"></a>å¸¸ç”¨è®¾ç½®</h3><h5 id="é‚®ä»¶è®¾ç½®"><a href="#é‚®ä»¶è®¾ç½®" class="headerlink" title="é‚®ä»¶è®¾ç½®"></a>é‚®ä»¶è®¾ç½®</h5><p>Jenkins-&gt;ç³»ç»Ÿç®¡ç†-&gt;ç³»ç»Ÿè®¾ç½®ï¼Œå¼¹å‡ºå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/b0/075e39aad15468d3eb9cc0f6bf37f7.jpg" alt=""></p><ul><li>SMTPæœåŠ¡å™¨ï¼šä¸ºé‚®ç®±æœåŠ¡åœ°å€ã€‚<ul><li>QQ: smtp.qq.com</li><li>163: smtp.163.com</li></ul></li><li>ç”¨æˆ·é»˜è®¤åç¼€ï¼šå¯ä»¥è‡ªåŠ¨è¯†åˆ«ï¼Œåªéœ€å¡«å†™ç”¨æˆ·å³å¯ã€‚</li><li>å…¶ä»–é…ç½®ä¸ºJenkinsé‚®ç®±é»˜è®¤ç”¨æˆ·åŠé‡‡ç”¨çš„è®¤è¯æ–¹å¼ã€‚</li></ul><h5 id="Jobè®¾ç½®"><a href="#Jobè®¾ç½®" class="headerlink" title="Jobè®¾ç½®"></a>Jobè®¾ç½®</h5><p>åœ¨éœ€è¦é‚®ä»¶é€šçŸ¥çš„Jobè®¾ç½®é‡Œé¢å¢åŠ â€æ„å»ºåæ“ä½œæ­¥éª¤â€ -&gt; é€‰æ‹©E-mail Notificationã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/82/3005620b29b6fc4b2c9e3ce729af8b.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/9e/a3153b262215e17561eb34674635e2.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/6d/dce01f6fa0a84d625f0eb55759c422.jpg" alt=""></p><h5 id="æ‰©å±•æ’ä»¶è®¾ç½®"><a href="#æ‰©å±•æ’ä»¶è®¾ç½®" class="headerlink" title="æ‰©å±•æ’ä»¶è®¾ç½®"></a>æ‰©å±•æ’ä»¶è®¾ç½®</h5><p>ä½†æ˜¯å¦‚æœä½ ç¾¤å‘çš„æ”¶ä»¶äººåˆ—è¡¨æ¯”è¾ƒå¤šï¼Œæˆ–è€…æ¯æ¬¡é€šçŸ¥çš„äººä¸ä¸€æ ·ï¼Œæ¯”å¦‚æ¯æ¬¡åªæƒ³é€šçŸ¥å¯¼è‡´æ„å»ºå¤±è´¥çš„é‚£ä¸ªäººï¼ˆå³æœ€åä¸€æ¬¡ä¸Šä¼ ä»£ç çš„äººï¼‰ï¼Œé‚£ä¹ˆç®€å•çš„E-mail Notificationå°±ä¸èƒ½æ»¡è¶³è¦æ±‚ï¼Œéœ€è¦ä½¿ç”¨Email extension pluginæ’ä»¶ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/18/0775061dcf193cc08da229cef10eda.jpg" alt=""></p><ul><li><p>SMTP server â€“ è®¾ç½®SMTPæœåŠ¡å™¨åœ°å€</p></li><li><p>Default user E-mail suffix â€“ è®¾ç½®ç”¨æˆ·é»˜è®¤é‚®ä»¶åç¼€</p></li><li><p>Default Content Type â€“ é»˜è®¤å†…å®¹ç±»å‹(Plain Text HTML)</p></li><li><p>Default Subject â€“ é»˜è®¤é‚®ä»¶ä¸»é¢˜</p></li><li><p>Default Content â€“ é»˜è®¤é‚®ä»¶å†…å®¹ï¼Œå¯ä»¥è®¾ç½®æ¨¡æ¿</p></li><li><p>Default Triggers â€“ è§¦å‘å™¨</p></li><li><input disabled="" type="checkbox"> <p>å…¨å±€é…ç½®<br>æ ¹æ®å®é™…æƒ…å†µå‹¾é€‰éœ€è¦è§¦å‘é‚®ä»¶é€šçŸ¥çš„äº‹ä»¶ã€‚ç‚¹å‡»ä¸Šå›¾å³ä¸‹è§’Default Triggerï¼Œå¼¹å‡ºå¦‚ä¸‹è§¦å‘é¡¹ï¼š</p></li></ul><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/69/3127442cf5a527b984d83738c31e6f.jpg" alt=""></p><ul><li><input disabled="" type="checkbox"> é¡¹ç›®é…ç½®<br>è¿›å…¥åˆ°å…·ä½“çš„é¡¹ç›®é…ç½®ç•Œé¢ç‚¹å‡»â€é…ç½®ï¼Œåœ¨é…ç½®ç•Œé¢ç‚¹å‡»â€å¢åŠ æ„å»ºåæ“ä½œæ­¥éª¤â€ï¼Œé€‰æ‹©â€Editable Email Notificationâ€ã€‚</li></ul><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/71/133a454b2ee120f2b1df930b4ca9fe.jpg" alt=""></p><p>å¯ä»¥åœ¨â€œAdvanced Settingsâ€ä¸­é’ˆå¯¹è¯¥é¡¹ç›®è¿›è¡Œä¸ªæ€§åŒ–çš„é…ç½®ã€‚å¯ä»¥é’ˆå¯¹è¯¥é¡¹ç›®å®šä¹‰è¯¥é¡¹ç›®é€šçŸ¥çš„æ”¶ä»¶äººåˆ—è¡¨ã€ä¸»é¢˜ã€å†…å®¹ã€é™„ä»¶ç­‰ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/53/67346392186853caab6ee621418aa4.jpg" alt=""></p><h4 id="ä»»åŠ¡åˆ›å»º"><a href="#ä»»åŠ¡åˆ›å»º" class="headerlink" title="ä»»åŠ¡åˆ›å»º"></a>ä»»åŠ¡åˆ›å»º</h4><h5 id="æ„å»ºé¡¹ç›®ç±»å‹"><a href="#æ„å»ºé¡¹ç›®ç±»å‹" class="headerlink" title="æ„å»ºé¡¹ç›®ç±»å‹"></a>æ„å»ºé¡¹ç›®ç±»å‹</h5><p>ç‚¹å‡» Jenkins é¦–é¡µâ€åˆ›å»ºä¸€ä¸ªæ–°ä»»åŠ¡â€çš„é“¾æ¥ï¼Œå¼¹å‡ºå¦‚ä¸‹å›¾æ‰€ç¤ºé¡µé¢ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/04/c97a32a6b1285a76a6edb8497a1cd3.jpg" alt=""></p><p>Jenkins æä¾›äº†å…­ç§ç±»å‹çš„ä»»åŠ¡ã€‚</p><ul><li><p>æ„å»ºä¸€ä¸ªè‡ªç”±é£æ ¼çš„è½¯ä»¶é¡¹ç›®<br>è¿™æ˜¯Jenkinsçš„ä¸»è¦åŠŸèƒ½ã€‚Jenkins ä¼šç»“åˆä»»ä½• SCM å’Œä»»ä½•æ„å»ºç³»ç»Ÿæ¥æ„å»ºä½ çš„é¡¹ç›®, ç”šè‡³å¯ä»¥æ„å»ºè½¯ä»¶ä»¥å¤–çš„ç³»ç»Ÿã€‚</p></li><li><p>Pipeline(æµæ°´çº¿)<br>Orchestrates long-running activities that can span multiple build slaves. Suitable for building pipelines (formerly known as workflows) and/or organizing complex activities that do not easily fit in free-style job type. â€“ å¾ˆéš¾ç”¨ä¸€ä¸¤å¥è¯è¯´æ¸… Pipeline, å‚è€ƒ , åé¢å¦èµ·ä¸€æ–‡æ¥ä»‹ç»ã€‚</p></li><li><p>æ„å»ºä¸€ä¸ªå¤šé…ç½®é¡¹ç›®<br>é€‚ç”¨äºå¤šé…ç½®é¡¹ç›®,ä¾‹å¦‚å¤šç¯å¢ƒæµ‹è¯•ã€å¹³å°æŒ‡å®šæ„å»º,ç­‰ç­‰ã€‚</p></li><li><p>GitHub Organization<br>Scans a GitHub organization (or user account) for all repositories matching some defined markers. â€“ è¿™ä¸ªä¸»è¦é’ˆå¯¹ç”± Github æ‰˜ç®¡çš„é¡¹ç›®ã€‚</p></li><li><p>Multibranch Pipeline(å¤šåˆ†æ”¯æµæ°´çº¿)<br>Creates a set of Pipeline projects according to detected branches in one SCM repository. æ ¹æ®ä¸€ä¸ªSCMå­˜å‚¨åº“ä¸­æ£€æµ‹åˆ°çš„åˆ†æ”¯åˆ›å»ºä¸€ç»„ Pipeline é¡¹ç›®ã€‚</p></li><li><p>æ–‡ä»¶å¤¹<br>åˆ›å»ºä¸€ä¸ªå¯ä»¥åµŒå¥—å­˜å‚¨çš„å®¹å™¨ã€‚åˆ©ç”¨å®ƒå¯ä»¥è¿›è¡Œåˆ†ç»„ã€‚ è§†å›¾ä»…ä»…æ˜¯ä¸€ä¸ªè¿‡æ»¤å™¨ï¼Œè€Œæ–‡ä»¶å¤¹åˆ™æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å‘½åç©ºé—´ï¼Œ å› æ­¤ä½ å¯ä»¥æœ‰å¤šä¸ªç›¸åŒåç§°çš„çš„å†…å®¹ï¼Œåªè¦å®ƒä»¬åœ¨ä¸åŒçš„æ–‡ä»¶ å¤¹é‡Œå³å¯ã€‚</p></li></ul><p>è¿™é‡Œé€‰æ‹©ç¬¬ä¸€ä¸ªï¼šæ„å»ºä¸€ä¸ªè‡ªç”±é£æ ¼çš„è½¯ä»¶é¡¹ç›®ï¼Œ è¾“å…¥é¡¹ç›®åç§°ï¼špython test project ï¼Œç‚¹å‡»â€ç¡®å®šâ€æŒ‰é’®ã€‚</p><h5 id="æ„å»º-Windows-æµ‹è¯•ä»»åŠ¡"><a href="#æ„å»º-Windows-æµ‹è¯•ä»»åŠ¡" class="headerlink" title="æ„å»º Windows æµ‹è¯•ä»»åŠ¡"></a>æ„å»º Windows æµ‹è¯•ä»»åŠ¡</h5><p>å‡è®¾ï¼Œæœ‰ä¸€ä¸ª Python ç¼–å†™çš„æµ‹è¯•è„šæœ¬ py_tests.py ï¼Œå…¶ç»å¯¹è·¯å¾„ä¸º/root/py_tests.pyï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">print</span> <span class="token string">"Hello world"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨Linuxä¸‹æ€ä¹ˆæ‰§è¡Œè¿™ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œæ‰“å¼€ç»ˆç«¯</p><pre><code>[root@centos-7 ~]# cd[root@centos-7 ~]# ll py_tests.py-rw-r--r--. 1 root root 20 8æœˆ  16 16:07 py_tests.py[root@centos-7 ~]# python py_tests.pyHello world[root@centos-7 ~]#</code></pre><p>ä¸‹é¢å›åˆ°Jenkinsçš„é…ç½®è¿‡ç¨‹ä¸­</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/ab/46e2f5d22700eb539eac4128e19c85.jpg" alt=""></p><p>æ·»åŠ é¡¹ç›®çš„æè¿°ï¼šPython æµ‹è¯•é¡¹ç›®ï¼Œæ‰“å°Hello worldã€‚</p><p>å‰©ä¸‹çš„é€‰é¡¹éƒ½ä¸è¦ç®¡ï¼Œæ‹–åˆ°é¡µé¢åº•éƒ¨ï¼Œæ„å»º é€‰é¡¹ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/e0/dab0e9e3d049db8a84ee83f85582de.jpg" alt=""></p><p>é€‰æ‹©<code>æ‰§è¡Œshell</code>é€‰é¡¹ï¼Œæ‰§è¡ŒLinux shellå‘½ä»¤ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/c6/ef1db64d383033d03b465af7f3771d.jpg" alt=""></p><p>å¦‚ä¸Šå›¾ï¼Œè¾“å…¥ä½ åœ¨ Linux ç»ˆç«¯ä¸‹æ‰€è¾“çš„å‘½ä»¤<code>python /root/py_tests.py</code>ã€‚ ç‚¹å‡»<code>ä¿å­˜</code>ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/8f/6c232d4632eb024fa2cadcf0fbfc13.jpg" alt=""></p><p>ä¸€ä¸ªæç®€çš„ï¼ŒåŸºäº Linux ç³»ç»Ÿçš„ Python è„šæœ¬æµ‹è¯•æŒç»­é›†æˆé¡¹ç›®å°±åˆ›å»ºå®Œæˆäº†ã€‚</p><h4 id="èŠ‚ç‚¹æ·»åŠ "><a href="#èŠ‚ç‚¹æ·»åŠ " class="headerlink" title="èŠ‚ç‚¹æ·»åŠ "></a>èŠ‚ç‚¹æ·»åŠ </h4><p>Jenkinsæœ‰ä¸ªå¾ˆå¼ºå¤§çš„åŠŸèƒ½ï¼šåˆ†å¸ƒå¼æ„å»º(åœ¨Jenkinsçš„é…ç½®ä¸­å«åšèŠ‚ç‚¹)ï¼Œåˆ†å¸ƒå¼æ„å»ºèƒ½å¤Ÿè®©åŒä¸€å¥—ä»£ç åœ¨ä¸åŒçš„ç¯å¢ƒ(å¦‚ï¼šWindowså’ŒLinuxç³»ç»Ÿ)ä¸­ç¼–è¯‘ã€æµ‹è¯•ç­‰ã€‚è€Œä¸”Jenkinsæ„å»ºçš„ä»£ç å’Œäº§ç‰©æœ€åè‡ªåŠ¨æ‹·è´åˆ°ä¸»èŠ‚ç‚¹ã€‚</p><p><strong>æ³¨æ„ï¼šå¦‚æœèŠ‚ç‚¹ä¸»æœºä¸Šä¸å­˜åœ¨JDKï¼ŒJenkinsä¼šå»è‡ªåŠ¨ä¸‹è½½ã€‚</strong></p><p><strong>å»ºè®®ï¼šæ‰€æœ‰Unixæˆ–è€…Windowsæœºå™¨çš„ç¯å¢ƒè·¯å¾„ç»Ÿä¸€(å¦‚ï¼šJDKã€Antã€Maven)ï¼Œå¥½å¤„æ˜¯ä¾¿äºç®¡ç†ã€ä¸å®¹æ˜“å‡ºç°å¥‡è‘©é—®é¢˜ã€‚</strong></p><h5 id="æ–°å»ºèŠ‚ç‚¹"><a href="#æ–°å»ºèŠ‚ç‚¹" class="headerlink" title="æ–°å»ºèŠ‚ç‚¹"></a>æ–°å»ºèŠ‚ç‚¹</h5><p>ç³»ç»Ÿç®¡ç† â†’ ç®¡ç†èŠ‚ç‚¹ â†’ æ–°å»ºèŠ‚ç‚¹(å·¦ä¸Šè§’)ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/1e/067a4f7fa85272fa79f85208c937c0.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/eb/3eb8f07110c1e29abe65035fdc2b04.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/bb/e82fc1380ecf612e70e06bc156e17e.jpg" alt=""></p><p>â€ƒâ€ƒèŠ‚ç‚¹åç§°ï¼šå»ºè®®ä½¿ç”¨å­—æ¯ã€æ•°å­—æˆ–å­—æ¯å’Œæ•°å­—çš„ç»„åˆã€‚æœ€å¥½è§åçŸ¥æ„ã€‚ä¸å»ºè®®ä½¿ç”¨æ ‡ç‚¹ç¬¦å·å’Œä¸­æ–‡(ä¸­æ–‡å‘½åæ²¡æœ‰é—®é¢˜ï¼Œä½†Jobä¸­æ— æ³•å¼•ç”¨)ã€‚</p><h5 id="é…ç½®èŠ‚ç‚¹"><a href="#é…ç½®èŠ‚ç‚¹" class="headerlink" title="é…ç½®èŠ‚ç‚¹"></a>é…ç½®èŠ‚ç‚¹</h5><ul><li>Name(åç§°)ï¼šèŠ‚ç‚¹åç§°</li><li>Description(æè¿°)ï¼šèŠ‚ç‚¹æè¿°ï¼Œæ”¯æŒä¸­æ–‡</li><li>å¹¶å‘æ„å»ºæ•°ï¼šæœ€å¤§åŒæ—¶æ„å»ºæ•°é‡(æ ¹æ®æœºå™¨çš„æ€§èƒ½å®šï¼Œå•é¢—å››æ ¸cpuå»ºè®®ä¸è¦è¶…è¿‡5) - å¿…é¡»ä¸ºæ•°å­—</li><li>è¿œç¨‹å·¥ä½œç›®å½•ï¼šèŠ‚ç‚¹çš„æ ¹ç›®å½•(æ³¨æ„ï¼šå¦‚æœç›®å½•ä¸å­˜åœ¨ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºç›®å½•ã€‚ä½ å¿…é¡»å¯¹è¯¥ç›®å½•æœ‰è¯»å†™æƒé™ï¼Œä¸ç„¶ä¼šæŠ¥é”™)</li><li>æ ‡ç­¾ï¼šæ ‡è®°(åˆå«åšæ ‡ç­¾)ç”¨æ¥å¯¹å¤šèŠ‚ç‚¹åˆ†ç»„,æ ‡è®°ä¹‹é—´ç”¨ç©ºæ ¼åˆ†éš”.ä¾‹å¦‚â€™refression java6â€™å°†ä¼šæŠŠä¸€ä¸ªèŠ‚ç‚¹æ ‡è®°ä¸Šâ€™regressionâ€™å’Œâ€™java6â€™.</li></ul><blockquote><p>ä¾‹æ¥è¯´,å¦‚æœä½ æœ‰å¤šä¸ªLinuxç³»ç»Ÿçš„æ„å»ºèŠ‚ç‚¹å¹¶ä¸”ä½ çš„Jobä¹Ÿéœ€è¦åœ¨Linuxç³»ç»Ÿä¸Šè¿è¡Œ,é‚£ä¹ˆä½ å¯ä»¥é…ç½®æ‰€æœ‰çš„Linuxç³»ç»ŸèŠ‚ç‚¹éƒ½æ ‡è®°ä¸ºâ€™windowsâ€™, ç„¶åæŠŠJobä¹Ÿæ ‡è®°ä¸ºâ€™Linuxâ€™.è¿™æ ·çš„è¯ä½ çš„Jobå°±ä¸ä¼šè¿è¡Œåœ¨é™¤äº†LinuxèŠ‚ç‚¹ä»¥å¤–çš„å…¶å®ƒèŠ‚ç‚¹ä¹‹ä¸Šäº†.<br>Linuxç”¨æ³•ï¼šå°½å¯èƒ½çš„ä½¿ç”¨è¿™ä¸ªèŠ‚ç‚¹/åªå…è®¸è¿è¡Œç»‘å®šåˆ°è¿™å°æœºå™¨çš„Job(æ ¹æ®ä½ çš„éœ€æ±‚ï¼ŒäºŒé€‰ä¸€)</p></blockquote><ul><li>å¯åŠ¨æ–¹å¼ï¼š<ul><li>LinuxèŠ‚ç‚¹ï¼šæ¨è â€“ Launch slave agents via SSHï¼Œ åœ¨Unix(åŒ…æ‹¬Linux)æœºå™¨ä¸Šé€šè¿‡SSHé€šé“è¿æ¥èŠ‚ç‚¹ (é€‚ç”¨äºUnixå’ŒLinux)</li><li>Host(ä¸»æœº)ï¼šèŠ‚ç‚¹ä¸»æœºçš„ipåœ°å€</li><li>Credentialsï¼šå‡­æ®(å¦‚æœä¸ºç©ºæˆ–è€…ä¸å¯é€‰æ‹©ï¼Œè¯·åœ¨ç³»ç»Ÿç®¡ç†â†’Manage Credentialsä¸­é…ç½®ã€‚Manage Credentialsçš„é…ç½®éå¸¸ç®€å•ï¼Œè¿™é‡Œå°±ä¸åœ¨æè¿°äº†ã€‚Manage Credentialsé…ç½®å®Œæˆåï¼Œéœ€åˆ·æ–°èŠ‚ç‚¹é…ç½®é¡µé¢æ‰ä¼šæ˜¾ç¤ºã€‚)</li></ul></li></ul><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/35/d7416430314fd19e34a01ac59ff464.jpg" alt=""></p><h5 id="èŠ‚ç‚¹è¿æ¥"><a href="#èŠ‚ç‚¹è¿æ¥" class="headerlink" title="èŠ‚ç‚¹è¿æ¥"></a>èŠ‚ç‚¹è¿æ¥</h5><p>ä»¥Launch slave agents via SSHä¸ºä¾‹ï¼Œé€‰æ‹©Manually trusted key Verification Strategyï¼Œç„¶åç‚¹å‡»æœ€ä¸‹é¢çš„ä¿å­˜ã€‚</p><p>Jenkins -&gt; ç³»ç»Ÿç®¡ç† -&gt; ç³»ç»Ÿè®¾ç½®ï¼Œè®¾ç½®SSH Server</p><ul><li>Name: è¿™ä¸ªå¯ä»¥éšæ„å†™</li><li>Hostname: è¿œç¨‹ä¸»æœºçš„IPåœ°å€</li><li>Username: è¿œç¨‹ä¸»æœºç™»å½•çš„ç”¨æˆ·å</li><li>Remote Directory: è¿œç¨‹ç›®å½•</li></ul><p>å¦‚å›¾è®¾ç½®å¥½ä¿¡æ¯åï¼Œç‚¹å‡»ä¸‹é¢çš„ä¿å­˜</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/3f/b787c0c1b5bab76ad878fbb47542ad.jpg" alt=""></p><p>Jenkins -&gt; ç³»ç»Ÿç®¡ç† -&gt; ç®¡ç†èŠ‚ç‚¹ï¼Œç‚¹å‡»åˆšåˆšé…ç½®å¥½çš„èŠ‚ç‚¹ï¼Œä¸Šçº¿èŠ‚ç‚¹</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/1d/1f61d958c23269f4fcc4a7ae295b0b.jpg" alt=""></p><p>å›åˆ°èŠ‚ç‚¹åˆ—è¡¨åå‘ç°èŠ‚ç‚¹å°±å·²ç»æˆåŠŸä¸Šçº¿äº†</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/a4/346c91e15903e43bc6759a7c566502.jpg" alt=""></p><h4 id="è§’è‰²æƒé™"><a href="#è§’è‰²æƒé™" class="headerlink" title="è§’è‰²æƒé™"></a>è§’è‰²æƒé™</h4><p>ç”±äºjenkinsé»˜è®¤çš„æƒé™ç®¡ç†ä½“ç³»ä¸æ”¯æŒç”¨æˆ·ç»„æˆ–è§’è‰²çš„é…ç½®ï¼Œå› æ­¤éœ€è¦å®‰è£…ç¬¬ä¸‰å‘æ’ä»¶æ¥æ”¯æŒè§’è‰²çš„é…ç½®ï¼Œæœ¬æ–‡å°†ä½¿ç”¨Role Strategy Pluginï¼Œä»‹ç»é¡µé¢ï¼š<a href="https://wiki.jenkins-ci.org/display/JENKINS/Role+Strategy+Pluginã€‚" target="_blank" rel="noopener">https://wiki.jenkins-ci.org/display/JENKINS/Role+Strategy+Pluginã€‚</a></p><h5 id="é…ç½®æ’ä»¶"><a href="#é…ç½®æ’ä»¶" class="headerlink" title="é…ç½®æ’ä»¶"></a>é…ç½®æ’ä»¶</h5><p>å®‰è£…æ’ä»¶åï¼Œè¿›å…¥ç³»ç»Ÿè®¾ç½®é¡µé¢ï¼Œé…ç½®å¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/89/a69327d3e04b1b57ff022132e9f5a5.jpg" alt=""></p><h5 id="é…ç½®æƒé™"><a href="#é…ç½®æƒé™" class="headerlink" title="é…ç½®æƒé™"></a>é…ç½®æƒé™</h5><p>åœ¨ç³»ç»Ÿç®¡ç†é¡µé¢ç‚¹å‡»Manage and Assign Rolesè¿›å…¥è§’è‰²ç®¡ç†é¡µé¢</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/90/a06f0b7e2eff8c0a9d81576497ff0c.jpg" alt=""></p><p>è¿›å…¥ä¹‹å</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/be/1bbe3e8858dbac44ac5a1fa2451883.jpg" alt=""></p><ul><li>ç®¡ç†è§’è‰²ï¼ˆManage Rolesï¼‰<br>é€‰æ‹©è¯¥é¡¹å¯ä»¥åˆ›å»ºå…¨å±€è§’è‰²ã€é¡¹ç›®è§’è‰²ï¼Œå¹¶å¯ä»¥ä¸ºè§’è‰²åˆ†é…æƒé™ã€‚</li></ul><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/b8/ea91c0ea7091dca3faf3c86356da16.jpg" alt=""></p><p>;å¦‚ä¸Šå›¾ï¼Œåˆ†åˆ«åˆ›å»ºäº†adminã€anonymousä¸¤ä¸ªå…¨å±€è§’è‰²ï¼ŒOnline Programã€testä¸¤ä¸ªé¡¹ç›®è§’è‰²ã€‚</p><p>â€ƒâ€ƒé¡¹ç›®è§’è‰²ä¸å…¨å±€è§’è‰²çš„åŒºåˆ«å°±æ˜¯ï¼Œé¡¹ç›®è§’è‰²åªèƒ½ç®¡ç†é¡¹ç›®ï¼Œæ²¡æœ‰ç®¡ç†jenkinsçš„æƒé™é…ç½®ã€‚</p><p>â€ƒâ€ƒæ·»åŠ é¡¹ç›®è§’è‰²æ—¶ï¼Œéœ€è¦æŒ‡å®šåŒ¹é…é¡¹ç›®çš„æ¨¡å¼ï¼Œå¦‚ä¸Šå›¾ä¸­çš„Patternï¼Œå®˜æ–¹æ–‡æ¡£ä»‹ç»è¯¥é€‰é¡¹æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ï¼Œå¦‚â€Roger-.â€è¡¨ç¤ºæ‰€æœ‰ä»¥Roger-å¼€å¤´çš„é¡¹ç›®ï¼Œ<code>(?i)roger-.*</code>è¡¨ç¤ºä»¥roger-å¼€å¤´çš„é¡¹ç›®å¹¶ä¸”ä¸åŒºåˆ†å¤§å°å†™ï¼Œå¦‚ä»¥ABCå¼€å¤´çš„é¡¹ç›®å¯ä»¥é…ç½®ä¸ºâ€ABC|ABC.*â€ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨â€abc|bcd|efgâ€ç›´æ¥åŒ¹é…å¤šä¸ªé¡¹ç›®ã€‚</p><ul><li>åˆ›å»ºç”¨æˆ·<br>åœ¨åˆ†é…è§’è‰²ä¹‹å‰éœ€è¦å…ˆåˆ›å»ºç”¨æˆ·ã€‚<br>åœ¨ç³»ç»Ÿç®¡ç†é¡µé¢ï¼Œç‚¹å‡»ç®¡ç†ç”¨æˆ·ï¼š</li></ul><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/2e/6a8a273181a5357a4ca587a5c2ced9.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/60/d8fa2030fff834872c259f65720958.jpg" alt=""></p><p>â€ƒâ€ƒç‚¹å‡»æ–°å»ºä½¿ç”¨è€…å¯ä»¥åˆ›å»ºæ–°ç”¨æˆ·ï¼Œç‚¹å‡»ç”¨æˆ·IDæˆ–åç§°éƒ½å¯ä»¥ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯ã€‚</p><p>â€ƒâ€ƒé€‰æ‹©Assign Roleså¯ä»¥ä¸ºç”¨æˆ·åˆ†é…æ‰€å±è§’è‰²ï¼Œå¯ä»¥åˆ†é…å…¨å±€è§’è‰²å’Œé¡¹ç›®è§’è‰²ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/57/385c466d213dd9ead86034162d9029.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/93/ddef492ecd2995c5731ea8eb1e9ee1.jpg" alt=""></p><p>â€ƒâ€ƒå¦‚ä¸Šå›¾ï¼Œå°†ä¸åŒçš„ç”¨æˆ·åˆ†åˆ«åˆ†é…ç»™ä¸åŒçš„è§’è‰²ï¼Œè¿™æ ·ç”¨æˆ·å°±å¯ä»¥å…·æœ‰è§’è‰²æ‰€æ‹¥æœ‰çš„æƒé™ã€‚</p><h3 id="è¿è¡Œä¸ç»´æŠ¤"><a href="#è¿è¡Œä¸ç»´æŠ¤" class="headerlink" title="è¿è¡Œä¸ç»´æŠ¤"></a>è¿è¡Œä¸ç»´æŠ¤</h3><h4 id="Jenkinså‡çº§"><a href="#Jenkinså‡çº§" class="headerlink" title="Jenkinså‡çº§"></a>Jenkinså‡çº§</h4><ul><li>è¯´æ˜ï¼šJenkinsè¿­ä»£æ›´æ–°å¾ˆé¢‘ç¹ï¼Œä¸€èˆ¬1å‘¨æ›´æ–°ä¸€æ¬¡ï¼ŒåŠå¹´ä¸€ä¸ªå¤§ç‰ˆæœ¬ã€‚</li><li>å‡çº§ï¼šä¸‹è½½æ–°çš„waråŒ…ï¼Œæ›¿æ¢æ—§çš„waråŒ…ï¼Œé‡å¯å³å¯ã€‚ä¸‹è½½åœ°å€ä¸º<a href="http://mirrors.jenkins-ci.org/ã€‚" target="_blank" rel="noopener">http://mirrors.jenkins-ci.org/ã€‚</a></li></ul><p><strong>PSï¼šå‡çº§å‰ï¼Œè¯·æµ‹è¯•è¯¥ç‰ˆæœ¬å’Œä½ æœ¬åœ°æ•°æ®çš„å…¼å®¹æ€§ã€‚å¦‚ä½•æµ‹è¯•ï¼šå°†JENKINS_HOMEæ‹·è´ä¸€ä»½åˆ°æ–°çš„æœºå™¨ï¼Œç”¨æ–°ç‰ˆçš„ç¨‹åºå¯åŠ¨ã€‚æµ‹è¯•å¯¹åº”çš„æ’ä»¶å’Œé…ç½®ã€‚</strong></p><h4 id="Jenkinsè¿ç§»å’Œå¤‡ä»½"><a href="#Jenkinsè¿ç§»å’Œå¤‡ä»½" class="headerlink" title="Jenkinsè¿ç§»å’Œå¤‡ä»½"></a>Jenkinsè¿ç§»å’Œå¤‡ä»½</h4><p>é¦–å…ˆæ‰¾åˆ°JENKINS_HOMEï¼Œä¸€èˆ¬åœ¨ç”¨æˆ·æ ¹ç›®å½•ä¸‹.jenkinsç›®å½•ï¼Œå› ä¸ºJenkinsçš„æ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯ä»¥æ–‡ä»¶çš„å½¢å¼å­˜æ”¾åœ¨JENKINS_HOMEç›®å½•ä¸­ã€‚æ‰€ä»¥ä¸ç®¡æ˜¯è¿ç§»è¿˜æ˜¯å¤‡ä»½ï¼Œåªéœ€è¦æ“ä½œJENKINS_HOMEå°±è¡Œäº†ã€‚</p><ul><li><p>è¿ç§»ï¼šå»ºè®®å°†JENKINS_HOMEæ‰“åŒ…åå†æ‹·è´ï¼ŒWindowsä¸Šå¯ä»¥ç”¨zipï¼Œrarç­‰ï¼ŒLinuxä¸Šæœ‰zipï¼Œtarç­‰ã€‚ç„¶åå°†æ‰“åŒ…çš„æ–‡ä»¶è§£å‹åˆ°æ–°çš„JENKINS_HOMEç›®å½•å°±è¡Œäº†ã€‚</p></li><li><p>å¤‡ä»½ï¼šå¦‚æœæ˜¯ä¸´æ—¶å¤‡ä»½ï¼Œæ•´ä¸ªå‹ç¼©æ–‡ä»¶å°±è¡Œäº†ã€‚</p></li><li><p>æ¢å¤ï¼šæ¢å¤çš„æ—¶å€™éœ€è¦å…ˆåœæ­¢jenkinsã€‚</p></li></ul><h4 id="ç§»åŠ¨ï¼Œåˆ é™¤æˆ–ä¿®æ”¹jobs"><a href="#ç§»åŠ¨ï¼Œåˆ é™¤æˆ–ä¿®æ”¹jobs" class="headerlink" title="ç§»åŠ¨ï¼Œåˆ é™¤æˆ–ä¿®æ”¹jobs"></a>ç§»åŠ¨ï¼Œåˆ é™¤æˆ–ä¿®æ”¹jobs</h4><p>å¯¹äºç§»åŠ¨æˆ–åˆ é™¤jobsï¼Œåªéœ€è¦ç®€å•åœ°ç§»åŠ¨æˆ–åˆ é™¤<code>$JENKINS_HOME/jobs</code>ç›®å½•ã€‚<br>å¯¹äºä¿®æ”¹jobsçš„åå­—ï¼Œåªéœ€è¦ç®€å•åœ°ä¿®æ”¹<code>$JENKINS_HOME/jobs</code>ä¸‹å¯¹åº”jobçš„æ–‡ä»¶å¤¹çš„åå­—ã€‚<br>å¯¹äºä¸ç»å¸¸ä½¿ç”¨çš„jobï¼Œåªéœ€è¦å¯¹<code>$JENKINS_HOME/jobs</code>ä¸‹å¯¹åº”çš„jobsçš„ç›®å½•zipæˆ–taråå­˜å‚¨åˆ°å…¶ä»–çš„åœ°æ–¹ã€‚</p><h4 id="Jenkins-å¯åŠ¨æ—¶çš„å‘½ä»¤è¡Œå‚æ•°"><a href="#Jenkins-å¯åŠ¨æ—¶çš„å‘½ä»¤è¡Œå‚æ•°" class="headerlink" title="Jenkins å¯åŠ¨æ—¶çš„å‘½ä»¤è¡Œå‚æ•°"></a>Jenkins å¯åŠ¨æ—¶çš„å‘½ä»¤è¡Œå‚æ•°</h4><table><thead><tr><th><code>--httpPort=$HTTP_PORT</code></th><th>ç”¨æ¥è®¾ç½®jenkinsè¿è¡Œæ—¶çš„webç«¯å£ã€‚</th></tr></thead><tbody><tr><td><code>--httpsPort=$HTTP_PORT</code></td><td>è¡¨ç¤ºä½¿ç”¨httpsåè®®ã€‚</td></tr><tr><td><del>~</del>â€“httpListenAddress=$HTTP_HOST</td><td>ç”¨æ¥æŒ‡å®šjenkinsç›‘å¬çš„ipèŒƒå›´ï¼Œé»˜è®¤ä¸ºæ‰€æœ‰çš„ipéƒ½å¯ä»¥è®¿é—®æ­¤jenkins serverã€‚</td></tr></tbody></table><h4 id="ä¿®æ”¹jenkinsçš„timezone"><a href="#ä¿®æ”¹jenkinsçš„timezone" class="headerlink" title="ä¿®æ”¹jenkinsçš„timezone"></a>ä¿®æ”¹jenkinsçš„timezone</h4><p>å¦‚æœjenkinsæ‰€åœ¨çš„serverçš„timezoneä¸åŒäºç”¨æˆ·çš„timezoneï¼Œè¿™æ—¶å€™éœ€è¦ä¿®æ”¹jenkinsçš„timezoneï¼Œéœ€è¦åœ¨jenkinså¯åŠ¨çš„æ—¶å€™å¢åŠ ä¸‹åˆ—å‚æ•°-Dorg.apache.commons.jelly.tags.fmt.timeZone=TZã€‚</p><h4 id="æŸ¥çœ‹jenkinsçš„ç³»ç»Ÿä¿¡æ¯"><a href="#æŸ¥çœ‹jenkinsçš„ç³»ç»Ÿä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹jenkinsçš„ç³»ç»Ÿä¿¡æ¯"></a>æŸ¥çœ‹jenkinsçš„ç³»ç»Ÿä¿¡æ¯</h4><p>ä»¥åœ¨jenkinsçš„ç®¡ç†é¡µé¢ä¸‹çš„ç³»ç»Ÿä¿¡æ¯ä¸­ï¼ŒæŸ¥çœ‹æ‰€æœ‰çš„jenkinsçš„ä¿¡æ¯ï¼Œä¾‹å¦‚jenkinsçš„å¯åŠ¨é…ç½®ï¼Œæ‰€ä¾èµ–çš„ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡ï¼Œæ‰€å®‰è£…çš„pluginsã€‚</p><h4 id="Jenkinsä¸­æ‰§è¡Œbatchå’ŒPython"><a href="#Jenkinsä¸­æ‰§è¡Œbatchå’ŒPython" class="headerlink" title="Jenkinsä¸­æ‰§è¡Œbatchå’ŒPython"></a>Jenkinsä¸­æ‰§è¡Œbatchå’ŒPython</h4><p>Jenkinsçš„job -&gt; build æ”¯æŒAntï¼Œmavenï¼Œwindows batchå’ŒShellï¼Œ ä½†æ˜¯æˆ‘ä»¬çŸ¥é“pythonï¼Œperlï¼Œrubyç­‰è„šæœ¬å…¶å®ä¹Ÿæ˜¯shellè„šæœ¬ï¼Œæ‰€ä»¥è¿™é‡Œçš„Shellå¯ä»¥æ‰©å±•ä¸ºpythonï¼Œperlï¼Œrubyç­‰ã€‚å¦‚å›¾</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/99/04a1d6c847be966e185435823bb110.jpg" alt=""></p><h3 id="Jenkins-æ•´åˆ-LDAP-ä»¥åŠ-CAS-å•ç‚¹ç™»å½•"><a href="#Jenkins-æ•´åˆ-LDAP-ä»¥åŠ-CAS-å•ç‚¹ç™»å½•" class="headerlink" title="Jenkins æ•´åˆ LDAP ä»¥åŠ CAS å•ç‚¹ç™»å½•"></a>Jenkins æ•´åˆ LDAP ä»¥åŠ CAS å•ç‚¹ç™»å½•</h3><p>å‚è€ƒå¦å¤–ä¸€ç¯‡åšå®¢<br><a href="https://blog.iamzhl.top/Jenkins-integrate-with-ldap-and-CAS.html" target="_blank" rel="noopener">Jenkins æ•´åˆ LDAP ä»¥åŠ CAS å•ç‚¹ç™»å½•</a></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> CI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Jenkins </tag>
            
            <tag> æŒç»­é›†æˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SonarQubeå®‰è£…éƒ¨ç½²</title>
      <link href="/posts/3db59fdb/"/>
      <url>/posts/3db59fdb/</url>
      
        <content type="html"><![CDATA[<h1 id="SonarQubeå®‰è£…éƒ¨ç½²"><a href="#SonarQubeå®‰è£…éƒ¨ç½²" class="headerlink" title="SonarQubeå®‰è£…éƒ¨ç½²"></a><center>SonarQubeå®‰è£…éƒ¨ç½²</center></h1><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>SonarQubeæ˜¯ä¸€ä¸ªç®¡ç†ä»£ç è´¨é‡çš„å¼€æ”¾å¹³å°ï¼Œå¯ä»¥ä»ä¸ƒä¸ªç»´åº¦æ£€æµ‹ä»£ç è´¨é‡ï¼š</p><ul><li>å¤æ‚åº¦åˆ†å¸ƒï¼ˆcomplexityï¼‰ï¼šä»£ç å¤æ‚åº¦è¿‡é«˜å°†éš¾ä»¥ç†è§£ã€éš¾ä»¥ç»´æŠ¤ï¼›</li><li>é‡å¤ä»£ç ï¼ˆduplicationsï¼‰ï¼šç¨‹åºä¸­åŒ…å«å¤§é‡å¤åˆ¶ç²˜åº¦çš„ä»£ç æ˜¯è´¨é‡ä½ä¸‹çš„è¡¨ç°ï¼›</li><li>å•å…ƒæµ‹è¯•ï¼ˆunit testsï¼‰ï¼šç»Ÿè®¡å¹¶å±•ç¤ºå•å…ƒæµ‹è¯•è¦†ç›–ç‡ï¼›</li><li>ç¼–ç è§„èŒƒï¼ˆcoding rulesï¼‰ï¼šé€šè¿‡Findbugsã€PMDã€CheckStyleç­‰è§„èŒƒä»£ç ç¼–å†™ï¼›</li><li>æ³¨é‡Šï¼ˆcommmentsï¼‰ï¼šå°‘äº†å¯è¯»æ€§å·®ï¼Œå¤šäº†çœ‹èµ·æ¥è´¹åŠ²ï¼›</li><li>æ½œåœ¨çš„Bugï¼ˆpotential bugsï¼‰ï¼šé€šè¿‡Findbugsã€PMDã€CheckStyleç­‰æ£€æµ‹æ½œåœ¨bugï¼›</li><li>ç»“æ„ä¸è®¾è®¡ï¼ˆarchitecture &amp; designï¼‰ï¼šä¾èµ–ã€è€¦åˆç­‰ã€‚</li></ul><p>SonarQube å¯ä»¥é›†æˆä¸åŒçš„æµ‹è¯•å·¥å…·ï¼ˆCppCheckã€CheckStyleã€Junitã€CppUnitç­‰ï¼‰ï¼Œä»£ç åˆ†æå·¥å…·ã€æŒç»­é›†æˆå·¥å…·ï¼ˆJenkinsï¼‰ã€IDEï¼ˆVisualStudioï¼‰ã€‚</p><p>Sonaré€šè¿‡å¯¹ä»£ç è´¨é‡åˆ†æç»“æœæ•°æ®è¿›è¡Œåœ¨åŠ å·¥å¤„ç†ï¼Œé€šè¿‡é‡åŒ–çš„æ–¹å¼æ¥åº¦é‡ä»£ç çš„è´¨é‡å˜åŒ–ï¼Œä»è€Œå¯ä»¥æ–¹ä¾¿çš„å¯¹å·¥ç¨‹è¿›è¡Œä»£ç è´¨é‡ç®¡ç†ã€‚</p><p>æ”¯æŒè¯­è¨€ï¼šJAVA PHP C# C COBOL PL/SQL FLEXç­‰20ä½™ç§ã€‚</p><h2 id="ç»„æˆ"><a href="#ç»„æˆ" class="headerlink" title="ç»„æˆ"></a>ç»„æˆ</h2><p>SonarQubeå¹³å°çš„ç»„æˆï¼š</p><ul><li>æ•°æ®åº“ï¼šå­˜æ”¾SonarQubeçš„é…ç½®æ•°æ®ã€ä»£ç è´¨é‡çš„å¿«ç…§æ•°æ®ã€‚</li><li>WebæœåŠ¡ï¼šç”¨äºæŸ¥çœ‹SonarQubeçš„é…ç½®æ•°æ®ã€ä»£ç è´¨é‡çš„å¿«ç…§æ•°æ®ã€‚</li><li>åˆ†æå™¨ï¼šå¯¹é¡¹ç›®ä»£ç è¿›è¡Œåˆ†æã€ç”Ÿæˆè´¨é‡ç»“æœæ•°æ®å¹¶å­˜å…¥æ•°æ®åº“ä¸­ï¼ˆåˆ†æå™¨æœ‰å¤šä¸­ï¼Œæ­¤å¤„é€‰æ‹©SonarQube Maven Pluginï¼‰ã€‚</li></ul><h2 id="å®‰è£…ç¯å¢ƒ"><a href="#å®‰è£…ç¯å¢ƒ" class="headerlink" title="å®‰è£…ç¯å¢ƒ"></a>å®‰è£…ç¯å¢ƒ</h2><h3 id="å®‰è£…JDK"><a href="#å®‰è£…JDK" class="headerlink" title="å®‰è£…JDK"></a>å®‰è£…JDK</h3><p>å»å®˜ç½‘ä¸‹è½½<code>JDK</code>ï¼š<a href="http://www.oracle.com/technetwork/java/javase/downloads/java-archive-javase8-2177648.html" target="_blank" rel="noopener">http://www.oracle.com/technetwork/java/javase/downloads/java-archive-javase8-2177648.html</a></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/81/1b33b7e9dbe92a1515154d0193194f.jpg" alt=""></p><p>å®‰è£…<code>JDK</code><br>å°†ä¸‹è½½å¾—åˆ°çš„<code>jdk-8u161-linux-x64.rpm</code>åŒ…ä¿å­˜åˆ°<code>Linux</code>ä¸»æœº</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># rpm -ivh jdk-8u161-linux-x64.rpm</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œç¼–è¾‘<code>~/.bashrc</code>ï¼Œ</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vim ~/.bashrc</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨æ–‡ä»¶çš„æœ«å°¾æ·»åŠ ä»¥ä¸‹è¡Œ</p><pre><code>export JAVA_HOME=/usr/java/jdk1.8.0_161export JRE_HOME=$JAVA_HOME/jreexport CLASSPATH=$JAVA_HOME/libexport PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin:$CLASSPATH</code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/49/6ac74e90a641e355b29b9c4d17deb9.jpg" alt=""></p><p>ä½¿ç¯å¢ƒé…ç½®ç”Ÿæ•ˆ</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># source ~/.bashrc</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æµ‹è¯•<code>Java</code>ç¯å¢ƒï¼Œåœ¨ç»ˆç«¯è¾“å…¥ï¼š<code>java -version</code>æŸ¥çœ‹æ˜¯å¦æ­£å¸¸æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ï¼Œè‹¥æ˜¾ç¤ºåˆ™å®‰è£…æˆåŠŸ</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/2f/49c7d622b298ae690db3c13754c1b1.jpg" alt=""></p><p><strong>Note:</strong><br>å¦‚æœå·²ç»é¢„è£…äº†openjdkï¼Œè¯·å…ˆå¸è½½</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># yum list installed | grep openjdk # æ ¹æ®æ‰§è¡Œç»“æœè¿›è¡Œå¸è½½</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="å®‰è£…MySQL"><a href="#å®‰è£…MySQL" class="headerlink" title="å®‰è£…MySQL"></a>å®‰è£…MySQL</h3><p>MySQLçš„Serveråœ¨CentOS 7ä¸Šä»é»˜è®¤è½¯ä»¶åˆ—è¡¨ä¸­è¢«ç§»é™¤äº†ï¼Œç”¨MariaDBæ¥ä»£æ›¿ï¼Œæ‰€ä»¥è¿™å¯¼è‡´æˆ‘ä»¬å¿…é¡»è¦å»å®˜ç½‘ä¸Šè¿›è¡Œä¸‹è½½ï¼Œæ‰¾åˆ°é“¾æ¥ï¼Œç”¨wgetæ‰“å¼€ï¼Œç„¶åå†å®‰è£…ï¼š</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># wget http://dev.mysql.com/get/mysql57-community-release-el7-9.noarch.rpm</span><span class="token comment" spellcheck="true"># rpm -ivh mysql57-community-release-el7-9.noarch.rpm</span><span class="token comment" spellcheck="true"># yum -y install mysql mysql-server mysql-devel</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¯åŠ¨MySQLæœåŠ¡</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># systemctl start mysqld</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è·å–å®‰è£…MySQLæ—¶çš„åˆå§‹å¯†ç å¹¶ç™»å½•MySQL</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># grep 'temporary password' /var/log/mysqld.log</span><span class="token comment" spellcheck="true"># mysql -u root -p</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/4a/a001ae2bae5a494c7329cd78a477a3.jpg" alt=""></p><p>ç™»å½•æˆåŠŸåä¿®æ”¹å¯†ç ï¼Œé¦–å…ˆä¿®æ”¹å®‰å…¨ç­–ç•¥ä¸º0ï¼Œç„¶åå°†å¯†ç é•¿åº¦é™åˆ¶ä¿®æ”¹ä¸º1ï¼Œæœ€åä¿®æ”¹å¯†ç </p><pre class="line-numbers language-mysql"><code class="language-mysql">mysql> set global validate_password_policy=0;mysql> set global validate_password_length=1;mysql> set password for root@localhost=password('root');<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/a2/0f74ed53f3a426d1fe005228478d8f.jpg" alt=""></p><p>è®¾ç½®sonarçš„ç”¨æˆ·åå’Œæ•°æ®åº“</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># adduser sonar</span><span class="token comment" spellcheck="true"># passwd sonar # ä¿®æ”¹sonarç”¨æˆ·å¯†ç </span><span class="token comment" spellcheck="true"># su sonar # åˆ‡æ¢ä¸ºsonarç”¨æˆ·å®‰è£…</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-mysql"><code class="language-mysql">mysql> create user 'sonar'@'%' identified by 'sonar';mysql> CREATE DATABASE sonar CHARACTER SET utf8 COLLATE utf8_general_ci;mysql> grant all privileges on sonar.* to 'sonar'@'%';mysql> flush privileges;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å®‰è£…SonarQube"><a href="#å®‰è£…SonarQube" class="headerlink" title="å®‰è£…SonarQube"></a>å®‰è£…SonarQube</h3><pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">wget</span> https://binaries.sonarsource.com/Distribution/sonarqube/sonarqube-7.3.zip$ unzip sonarqube-7.3.zip  //è‹¥æç¤ºunzipå‘½ä»¤æ‰¾ä¸åˆ°ï¼Œç”¨yum -y <span class="token function">install</span> unzipå®‰è£…å³å¯$ <span class="token function">mv</span> sonarqube-7.3 sonarqube $ <span class="token function">mv</span> sonarqube /usr/local/<span class="token comment" spellcheck="true"># chown -R sonar:sonar /usr/local/sonarqube</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é…ç½®sonar"><a href="#é…ç½®sonar" class="headerlink" title="é…ç½®sonar"></a>é…ç½®sonar</h2><pre class="line-numbers language-bash"><code class="language-bash">$ vim /usr/local/sonarqube/conf/sonar.properties<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚å›¾è®¾ç½®ä»¥ä¸‹é€‰é¡¹</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/46/56cfe2c33866ab48ab8c9bdd402acc.jpg" alt=""></p><h2 id="å¯åŠ¨sonar"><a href="#å¯åŠ¨sonar" class="headerlink" title="å¯åŠ¨sonar"></a>å¯åŠ¨sonar</h2><pre class="line-numbers language-bash"><code class="language-bash">$ /usr/local/sonarqube/bin/linux-x86-64/sonar.sh start<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆåŠŸå¯åŠ¨åï¼Œè®¿é—®æœ¬åœ° <a href="http://IP:9000ï¼ŒSonarQube">http://IP:9000ï¼ŒSonarQube</a> åˆå§‹ç®¡ç†å‘˜è´¦å·ä¸º adminï¼Œé»˜è®¤å¯†ç ä¸º adminï¼Œç™»å½•åå¯ä¿®æ”¹å¯†ç ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/25/5b9f14a21cdaf024ea8b3ce551dd7a.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/83/71e7da548917e52b08eb37f385e000.jpg" alt=""></p><p><strong>Note:</strong><br>å¦‚æœé‡åˆ°Sonarå¯åŠ¨ä¸èµ·æ¥ï¼ŒæŸ¥çœ‹æ—¥å¿—è‡ªåŠ¨å…³é—­çš„é—®é¢˜ï¼Œå¯ä»¥é‡‡ç”¨ä»¥ä¸‹æ–¹æ³•è§£å†³</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># echo -e "vm.max_map_count=262144" >> /etc/sysctl.conf</span><span class="token comment" spellcheck="true"># sysctl -p</span><span class="token comment" spellcheck="true"># echo -e "sonar hard nofile 65536" >> /etc/security/limits.conf </span><span class="token comment" spellcheck="true"># echo -e "sonar soft nofile 65536" >> /etc/security/limits.conf </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åæ³¨é”€sonarç”¨æˆ·é‡æ–°ä»¥sonarèº«ä»½ç™»å½•åå†æ¬¡å¯åŠ¨:</p><pre class="line-numbers language-bash"><code class="language-bash">$ /usr/local/sonarqube/bin/linux-x86-64/sonar.sh start<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ’ä»¶å®‰è£…ï¼šå¦‚æœéœ€è¦ä¸‹è½½æ’ä»¶çš„è¯ï¼Œå„ä¸ªç‰ˆæœ¬ä¸ä¸€æ ·ï¼Œå¦‚å›¾æ‰€ç¤ºï¼Œå…ˆç‚¹å‡»Administration,å†æ‰“å¼€Marketplaceå°±å¯ä»¥çœ‹åˆ°Pluginså„ç§æ’ä»¶äº†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/c6/cef3a943ab5d4347d4af8f3332a196.jpg" alt=""></p><p>SonarQube æ”¯æŒåˆ†æçš„è¯­è¨€æœ‰å¾ˆå¤šï¼ŒåƒJavaã€Pythonã€Phpã€C/C++ã€C#ã€HTMLã€JavaScriptã€PL/SQLã€Objective Cç­‰20+è¯­è¨€ï¼Œå½“æˆ‘ä»¬éœ€è¦æ”¯æŒåˆ†æä»€ä¹ˆè¯­è¨€æ—¶ï¼Œåªéœ€è¦å»æ’ä»¶ä¸­å¿ƒå®‰è£…å¯¹åº”è¯­è¨€çš„æ’ä»¶å³å¯ï¼Œéå¸¸æ–¹ä¾¿ï¼Œå¯æ‰©å±•æ€§å¼ºï¼Œæ ¹æ®è‡ªå·±çš„éœ€è¦å»é€‰æ‹©æ’ä»¶ã€‚</p><h2 id="å®éªŒéªŒè¯"><a href="#å®éªŒéªŒè¯" class="headerlink" title="å®éªŒéªŒè¯"></a>å®éªŒéªŒè¯</h2><blockquote><p>æœ¬æ¬¡å®éªŒéªŒè¯ä»¥Javaå·¥ç¨‹ä¸ºä¾‹</p></blockquote><h3 id="å®‰è£…é…ç½®sonar-scanner"><a href="#å®‰è£…é…ç½®sonar-scanner" class="headerlink" title="å®‰è£…é…ç½®sonar-scanner"></a>å®‰è£…é…ç½®sonar-scanner</h3><ul><li>è·å–sonar-scanner</li></ul><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># wget https://sonarsource.bintray.com/Distribution/sonar-scanner-cli/sonar-scanner-cli-3.2.0.1227-linux.zip</span><span class="token comment" spellcheck="true"># unzip sonar-scanner-cli-3.2.0.1227-linux.zip</span><span class="token comment" spellcheck="true"># mv sonar-scanner-3.2.0.1227-linux sonar-scanner</span><span class="token comment" spellcheck="true"># mv sonar-scanner /usr/local/</span><span class="token comment" spellcheck="true"># chown -R sonar:sonar sonar-scanner</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>é…ç½®sonar-scannerç¯å¢ƒå˜é‡</li></ul><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># vim ~/.bashrc</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/40/6ea5e9c0aee37c056f4583b32c048d.jpg" alt=""></p><ul><li>ä½¿é…ç½®ç”Ÿæ•ˆ</li></ul><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># source ~/.bashrc</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/70/524b2333bbfb3e6a50b77f92eb201d.jpg" alt=""></p><ul><li>æ£€æŸ¥ç¯å¢ƒé…ç½®æ˜¯å¦æˆåŠŸ</li></ul><pre class="line-numbers language-bash"><code class="language-bash">$ sonar-scanner -version<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>é…ç½®sonar-scanner.propertiesæ–‡ä»¶</li></ul><pre class="line-numbers language-bash"><code class="language-bash">$ vim /usr/local/sonar-scanner/conf/sonar-scanner.properties<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/46/849b0c5cac635e91e9efcf07ba5fbd.jpg" alt=""></p><h3 id="éªŒè¯è¿‡ç¨‹"><a href="#éªŒè¯è¿‡ç¨‹" class="headerlink" title="éªŒè¯è¿‡ç¨‹"></a>éªŒè¯è¿‡ç¨‹</h3><ul><li>æ·»åŠ Java Mavenæµ‹è¯•å·¥ç¨‹</li></ul><p>ç¼–å†™æµ‹è¯•å·¥ç¨‹</p><ul><li>æ·»åŠ sonar-project.propertiesæ–‡ä»¶</li></ul><p>åœ¨å·¥ç¨‹æ ¹ç›®å½•ä¸­æ·»åŠ sonar-project.propertiesæ–‡ä»¶ï¼Œæ ¼å¼å¦‚ä¸‹</p><pre><code>sonar.projectKey=com.geovis         //é¡¹ç›®çš„å”¯ä¸€æ ‡è¯†sonar.projectName=helloworld        //é¡¹ç›®çš„åå­—sonar.projectVersion=1.0            //é¡¹ç›®çš„ç‰ˆæœ¬sonar.sources=/root/helloworld/src  //é¡¹ç›®çš„æºç ç›®å½•ï¼Œå¤šç›®å½•ä»¥è‹±æ–‡é€—å·åˆ†éš”</code></pre><p>ä¾‹å¦‚æˆ‘çš„é¡¹ç›®ç»“æ„å¦‚ä¸‹</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/6a/e62e31b74ec65b783f21f4d8cda98e.jpg" alt=""></p><p>é‚£ä¹ˆæ­¤é¡¹ç›®é…ç½®æ–‡ä»¶åº”ä¸º</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/98/4f0aa2e69db09a846cfd6da4a3442f.jpg" alt=""></p><ul><li>ä»£ç è´¨é‡æ£€æŸ¥<br>è®¾ç½®å®Œåï¼Œç»ˆç«¯è¿è¡Œ<code>sonar-scanner</code>å‘½ä»¤ï¼Œå¼€å§‹é¡¹ç›®æºä»£ç çš„åˆ†æ</li></ul><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/77/64ffb2ce43fdba046811cce438845c.jpg" alt=""></p><ul><li>æŸ¥çœ‹ç»“æœ<br>å‘½ä»¤è¿è¡Œå®Œæˆä¹‹åï¼Œè®¿é—®<a href="http://localhost:9000ï¼Œè¾“å…¥è´¦å·å¯†ç å³å¯æŸ¥çœ‹åˆ†æç»“æœï¼Œå¦‚ä¸‹å›¾">http://localhost:9000ï¼Œè¾“å…¥è´¦å·å¯†ç å³å¯æŸ¥çœ‹åˆ†æç»“æœï¼Œå¦‚ä¸‹å›¾</a></li></ul><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/b4/92864641223d1537b6f4dfa27a6358.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/97/221636aa330d56dea8bb870957f29a.jpg" alt=""></p><h2 id="SonarQube-æ•´åˆ-LDAP-å’Œ-CAS-å•ç‚¹ç™»å½•"><a href="#SonarQube-æ•´åˆ-LDAP-å’Œ-CAS-å•ç‚¹ç™»å½•" class="headerlink" title="SonarQube æ•´åˆ LDAP å’Œ CAS å•ç‚¹ç™»å½•"></a>SonarQube æ•´åˆ LDAP å’Œ CAS å•ç‚¹ç™»å½•</h2><p><code>SonarQube</code>æ•´åˆ<code>LDAP</code>å’Œ<code>CAS</code>å•ç‚¹ç™»å½•çš„è¿‡ç¨‹è¯·å‚è€ƒæˆ‘çš„å¦ä¸€ç¯‡åšå®¢<a href="https://blog.iamzhl.top/SonarQube-integrate-with-ldap-and-CAS.html" target="_blank" rel="noopener">SonarQube æ•´åˆ LDAP å’Œ CAS å•ç‚¹ç™»å½•</a></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> CI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SonarQube </tag>
            
            <tag> sonar-scanner </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MantisBT å®‰è£…éƒ¨ç½²è¿‡ç¨‹</title>
      <link href="/posts/80c45260/"/>
      <url>/posts/80c45260/</url>
      
        <content type="html"><![CDATA[<h1 id="MantisBTè½¯ä»¶å®‰è£…éƒ¨ç½²è¿‡ç¨‹"><a href="#MantisBTè½¯ä»¶å®‰è£…éƒ¨ç½²è¿‡ç¨‹" class="headerlink" title="MantisBTè½¯ä»¶å®‰è£…éƒ¨ç½²è¿‡ç¨‹"></a><strong><center>MantisBTè½¯ä»¶å®‰è£…éƒ¨ç½²è¿‡ç¨‹</center></strong></h1><h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p>&nbsp;&nbsp;&nbsp;&nbsp;Mantisæ˜¯ä¸€ä¸ªåŸºäºPHPæŠ€æœ¯çš„è½»é‡çº§çš„å¼€æºç¼ºé™·è·Ÿè¸ªç³»ç»Ÿï¼Œä»¥Webæ“ä½œçš„å½¢å¼æä¾›é¡¹ç›®ç®¡ç†åŠç¼ºé™·è·Ÿè¸ªæœåŠ¡ã€‚åœ¨åŠŸèƒ½ä¸Šã€å®ç”¨æ€§ä¸Šè¶³ä»¥æ»¡è¶³ä¸­å°å‹é¡¹ç›®çš„ç®¡ç†åŠè·Ÿè¸ªã€‚æ›´é‡è¦çš„æ˜¯å…¶å¼€æºï¼Œä¸éœ€è¦è´Ÿæ‹…ä»»ä½•è´¹ç”¨ã€‚</p><h1 id="éƒ¨ç½²ç¯å¢ƒ"><a href="#éƒ¨ç½²ç¯å¢ƒ" class="headerlink" title="éƒ¨ç½²ç¯å¢ƒ"></a>éƒ¨ç½²ç¯å¢ƒ</h1><p>Mantiså®‰è£…éƒ¨ç½²ç¯å¢ƒå¦‚ä¸‹ï¼š</p><table><thead><tr><th>åç§°</th><th>ç‰ˆæœ¬å·</th><th>æè¿°</th></tr></thead><tbody><tr><td>Mantisbt</td><td>2.16.0</td><td>BugTracing è½¯ä»¶</td></tr><tr><td>æ“ä½œç³»ç»Ÿ</td><td>CentOS 7</td><td>RedHat ç¤¾åŒºå‘è¡Œç‰ˆ</td></tr><tr><td>PHP</td><td>7.2.8</td><td>PHP ç¯å¢ƒ</td></tr></tbody></table><h1 id="éƒ¨ç½²è¿‡ç¨‹"><a href="#éƒ¨ç½²è¿‡ç¨‹" class="headerlink" title="éƒ¨ç½²è¿‡ç¨‹"></a>éƒ¨ç½²è¿‡ç¨‹</h1><h2 id="è½¯ä»¶å®‰è£…"><a href="#è½¯ä»¶å®‰è£…" class="headerlink" title="è½¯ä»¶å®‰è£…"></a>è½¯ä»¶å®‰è£…</h2><h3 id="å®‰è£…PHP"><a href="#å®‰è£…PHP" class="headerlink" title="å®‰è£…PHP"></a>å®‰è£…PHP</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># rpm -Uvh https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm</span><span class="token comment" spellcheck="true"># rpm -Uvh https://mirror.webtatic.com/yum/el7/webtatic-release.rpm</span><span class="token comment" spellcheck="true"># yum -y install libicu libicu-devel libicu-doc</span><span class="token comment" spellcheck="true"># yum -y install php70w php70w-gd php70w-xml php70w-mysql php70w-mbstring php70w-ldap php70w-xmlrpc php70w-odbc php70w-pear php70w-soap php70w-snmp</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å®‰è£…PHPMailer"><a href="#å®‰è£…PHPMailer" class="headerlink" title="å®‰è£…PHPMailer"></a>å®‰è£…PHPMailer</h3><pre><code>https://github.com/Synchro/PHPMailer/releases/tag/v5.2.13</code></pre><p>ä¸‹è½½è§£å‹åˆ°/var/www/html/mantis/PHPMailer-5.2.13/</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/0b/f7ba2cdc89ecb4edee3d7c32861ad1.jpg" alt=""></p><h3 id="å®‰è£…apache-mysqlç­‰å¿…è¦è½¯ä»¶"><a href="#å®‰è£…apache-mysqlç­‰å¿…è¦è½¯ä»¶" class="headerlink" title="å®‰è£…apache mysqlç­‰å¿…è¦è½¯ä»¶"></a>å®‰è£…apache mysqlç­‰å¿…è¦è½¯ä»¶</h3><p>MySQLçš„Serveråœ¨CentOS 7ä¸Šä»é»˜è®¤è½¯ä»¶åˆ—è¡¨ä¸­è¢«ç§»é™¤äº†ï¼Œç”¨MariaDBæ¥ä»£æ›¿ï¼Œæ‰€ä»¥è¿™å¯¼è‡´æˆ‘ä»¬å¿…é¡»è¦å»å®˜ç½‘ä¸Šè¿›è¡Œä¸‹è½½ï¼Œæ‰¾åˆ°é“¾æ¥ï¼Œç”¨wgetæ‰“å¼€ï¼Œç„¶åå†å®‰è£…ï¼š</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># wget http://dev.mysql.com/get/mysql57-community-release-el7-9.noarch.rpm</span><span class="token comment" spellcheck="true"># rpm -ivh mysql57-community-release-el7-9.noarch.rpm</span><span class="token comment" spellcheck="true"># yum -y install mysql mysql-server mysql-devel</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¯åŠ¨MySQLæœåŠ¡</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># systemctl start mysqld</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è·å–å®‰è£…MySQLæ—¶çš„åˆå§‹å¯†ç å¹¶ç™»å½•MySQL</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># grep 'temporary password' /var/log/mysqld.log</span><span class="token comment" spellcheck="true"># mysql -u root -p</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/4a/a001ae2bae5a494c7329cd78a477a3.jpg" alt=""></p><p>ç™»å½•æˆåŠŸåä¿®æ”¹å¯†ç ï¼Œé¦–å…ˆä¿®æ”¹å®‰å…¨ç­–ç•¥ä¸º0ï¼Œç„¶åå°†å¯†ç é•¿åº¦é™åˆ¶ä¿®æ”¹ä¸º1ï¼Œæœ€åä¿®æ”¹å¯†ç </p><pre class="line-numbers language-mysql"><code class="language-mysql">mysql> set global validate_password_policy=0;mysql> set global validate_password_length=1;mysql> set password for root@localhost=password('root');<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/a2/0f74ed53f3a426d1fe005228478d8f.jpg" alt=""></p><p>å®‰è£…apache httpd</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># yum -y install httpd</span><span class="token comment" spellcheck="true"># systemctl enable httpd   //è‡ªå¯åŠ¨</span><span class="token comment" spellcheck="true"># systemctl start httpd    //å¯åŠ¨</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="å®‰è£…mantis"><a href="#å®‰è£…mantis" class="headerlink" title="å®‰è£…mantis"></a>å®‰è£…mantis</h3><h4 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h4><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># cd /var/www/html</span><span class="token comment" spellcheck="true"># wget https://jaist.dl.sourceforge.net/project/mantisbt/mantis-stable/2.18.0/mantisbt-2.18.0.zip</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="è§£å‹é‡å‘½å"><a href="#è§£å‹é‡å‘½å" class="headerlink" title="è§£å‹é‡å‘½å"></a>è§£å‹é‡å‘½å</h4><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># tar zxvf mantisbt-2.16.0.tar.gz</span><span class="token comment" spellcheck="true"># mv mantisbt-2.16.0 mantis</span><span class="token comment" spellcheck="true"># mv mantis /var/www/html/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="ä¿®æ”¹ç”¨æˆ·ç»„"><a href="#ä¿®æ”¹ç”¨æˆ·ç»„" class="headerlink" title="ä¿®æ”¹ç”¨æˆ·ç»„"></a>ä¿®æ”¹ç”¨æˆ·ç»„</h4><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># chown -R apache:apache /var/www/html/mantis</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="åˆ›å»ºæ•°æ®åº“"><a href="#åˆ›å»ºæ•°æ®åº“" class="headerlink" title="åˆ›å»ºæ•°æ®åº“"></a>åˆ›å»ºæ•°æ®åº“</h4><pre class="line-numbers language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@centos-7 html<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># mysql -u root -p</span>Enter password:Welcome to the MySQL monitor.  Commands end with <span class="token punctuation">;</span> or \g.Your MySQL connection <span class="token function">id</span> is 8Server version: 5.7.23 MySQL Community Server <span class="token punctuation">(</span>GPL<span class="token punctuation">)</span>Copyright <span class="token punctuation">(</span>c<span class="token punctuation">)</span> 2000, 2018, Oracle and/or its affiliates. All rights reserved.Oracle is a registered trademark of Oracle Corporation and/or itsaffiliates. Other names may be trademarks of their respectiveowners.Type <span class="token string">'help;'</span> or <span class="token string">'\h'</span> <span class="token keyword">for</span> help. Type <span class="token string">'\c'</span> to <span class="token function">clear</span> the current input statement.mysql<span class="token operator">></span> create database mantis<span class="token punctuation">;</span>Query OK, 1 row affected <span class="token punctuation">(</span>0.00 sec<span class="token punctuation">)</span>mysql<span class="token operator">></span> grant all privileges on mantis.* to root@localhost identified by <span class="token string">'123456'</span><span class="token punctuation">;</span>ERROR 1819 <span class="token punctuation">(</span>HY000<span class="token punctuation">)</span>: Your password does not satisfy the current policy requirementsmysql<span class="token operator">></span> <span class="token keyword">set</span> global validate_password_policy<span class="token operator">=</span>0<span class="token punctuation">;</span>Query OK, 0 rows affected <span class="token punctuation">(</span>0.00 sec<span class="token punctuation">)</span>mysql<span class="token operator">></span> <span class="token keyword">set</span> global validate_password_length<span class="token operator">=</span>1<span class="token punctuation">;</span>Query OK, 0 rows affected <span class="token punctuation">(</span>0.00 sec<span class="token punctuation">)</span>mysql<span class="token operator">></span> grant all privileges on mantis.* to root@localhost identified by <span class="token string">'123456'</span><span class="token punctuation">;</span>Query OK, 0 rows affected, 1 warning <span class="token punctuation">(</span>0.01 sec<span class="token punctuation">)</span>mysql<span class="token operator">></span> flush privileges<span class="token punctuation">;</span>Query OK, 0 rows affected <span class="token punctuation">(</span>0.00 sec<span class="token punctuation">)</span>mysql<span class="token operator">></span> <span class="token keyword">exit</span>Bye<span class="token punctuation">[</span>root@centos-7 html<span class="token punctuation">]</span><span class="token comment" spellcheck="true">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h4><p>æ‰“å¼€æµè§ˆå™¨åœ¨åœ°å€æ è¾“å…¥ <a href="http://10.211.55.17:82/mantis" target="_blank" rel="noopener">http://10.211.55.17:82/mantis</a>  â€“  æ ¼å¼ä¸º <code>http://IP:ç«¯å£/mantisæ–‡ä»¶å¤¹åç§°</code>ï¼Œè¿™æ—¶å°±ä¼šè‡ªåŠ¨è·³è½¬åˆ°phpå®‰è£…å‘å¯¼çš„é¡µé¢: </p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/13/430b174ae372e2c4854b5804123ab1.jpg" alt=""></p><p>&nbsp;&nbsp;&nbsp;&nbsp;å¡«å¥½ä¸»æœºã€å¯†ç ç­‰ä¿¡æ¯ä¹‹åç‚¹å‡» Install/Upgrade Database å®‰è£…æ•°æ®åº“ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/86/f2dd1067427ccefb9829d5a3e2903e.jpg" alt=""></p><h4 id="ç™»å½•"><a href="#ç™»å½•" class="headerlink" title="ç™»å½•"></a>ç™»å½•</h4><p>è¿›å…¥Mantisç™»å½•ç•Œé¢ï¼Œè¾“å…¥ç”¨æˆ·å¯†ç ï¼šadministrator/root ï¼Œç™»é™†å³å¯çœ‹åˆ°mantisä¸»ç•Œé¢ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/b1/c3e84af9570ae5c9d61d788d482a69.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/f4/2302c64875ae7556c732820ffe6c2f.jpg" alt=""></p><h2 id="é‚®ä»¶é…ç½®"><a href="#é‚®ä»¶é…ç½®" class="headerlink" title="é‚®ä»¶é…ç½®"></a>é‚®ä»¶é…ç½®</h2><p>ä¿®æ”¹MantisBT/config/config_inc.phpæ–‡ä»¶</p><pre><code>$g_enable_email_notification = ON;$g_administrator_email = 'mailuser';    # é‚®ç®±åœ°å€$g_webmaster_email = 'mailuser';        # é‚®ç®±åœ°å€$g_from_email = 'mailuser';             # é‚®ç®±åœ°å€$g_from_name = 'Mantis Bug Tracker';$g_phpMailer_method = PHPMAILER_METHOD_SMTP;$g_smtp_host = 'smtp.163.com';          # SMTP æœåŠ¡å™¨$g_smtp_username = 'mailuser';          # é‚®ç®±åœ°å€$g_smtp_password = 'mailpwd';           # é‚®ç®±å¯†ç $g_use_phpMailer = ON; $g_return_path_email = 'mailuser';      # é‚®ç®±åœ°å€</code></pre><h2 id="ä¸­æ–‡é…ç½®"><a href="#ä¸­æ–‡é…ç½®" class="headerlink" title="ä¸­æ–‡é…ç½®"></a>ä¸­æ–‡é…ç½®</h2><p>ä¿®æ”¹/var/www/html/mantis/config_defaults_inc.phpæ–‡ä»¶ï¼Œåœ¨è¯¥æ–‡ä»¶ä¸­æ‰¾åˆ°è¯­è¨€è®¾ç½®çš„åœ°æ–¹ï¼Œä¿®æ”¹$g_default_languageï¼Œå°†â€™englishâ€™æ”¹ä¸ºâ€™chinese_simplifiedâ€™ã€‚æ‡’å¾—æ‰¾çš„è¯ç›´æ¥å¤åˆ¶ä¸‹é¢çš„å‘½ä»¤ä¹Ÿå¯ä»¥ã€‚</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># sed -i -e "s/$g_default_language = 'auto'/$g_default_language = 'chinese_simplified'/g" /var/www/html/mantis/config_defaults_inc.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/17/52f55640c0580b49bb51e81728e32b.jpg" alt=""></p><h1 id="é—®é¢˜è§£å†³"><a href="#é—®é¢˜è§£å†³" class="headerlink" title="é—®é¢˜è§£å†³"></a>é—®é¢˜è§£å†³</h1><p>é—®é¢˜æè¿°ï¼šé…ç½®å®Œæˆåï¼Œæ— æ³•å‘é€é‚®ä»¶ã€‚</p><p>è§£å†³æ–¹æ³•ï¼š<br>é‚®ç®±é…ç½®é—®é¢˜ï¼Œæ·»åŠ æœ¬åœ°é‚®ç®±æœåŠ¡å™¨ï¼Œè®¾ç½®æœ¬åœ°é‚®ç®±ï¼Œå¯¹äºæœ¬åœ°æµ‹è¯•é‚®ç®±ï¼Œè®¾ç½®$g_smtp_host=æœ¬åœ°IPåœ°å€ã€‚</p><h1 id="å®ä¾‹è¿è¡Œ"><a href="#å®ä¾‹è¿è¡Œ" class="headerlink" title="å®ä¾‹è¿è¡Œ"></a>å®ä¾‹è¿è¡Œ</h1><ul><li>ä¸ºäº†ä¾¿äºç†è§£ï¼Œå…ˆç»™å‡ºBUGè·Ÿè¸ªæµç¨‹å›¾ï¼š</li></ul><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/b7/a17671861ee0f1c0ef2d34063c1f7e.png" alt=""></p><ul><li>Mantisä½¿ç”¨æµç¨‹å›¾ï¼š</li></ul><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/36/e0cd2969561f3a3847f00064f10d86.jpg" alt=""></p><ul><li>æ–°ç”¨æˆ·åˆ›å»ºä¸ç™»å½•</li></ul><p>ç›®å‰æœ¬ç³»ç»Ÿçš„è®¿é—®åœ°å€ä¸ºï¼š<a href="http://IP:port/mantis/login_page.phpï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡é¦–é¡µæ˜¾ç¤ºçš„&quot;æ³¨å†Œä¸€ä¸ªæ–°å¸å·&quot;è¿›è¡Œæ–°ç”¨æˆ·æ³¨å†Œã€‚">http://IP:port/mantis/login_page.phpï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡é¦–é¡µæ˜¾ç¤ºçš„"æ³¨å†Œä¸€ä¸ªæ–°å¸å·"è¿›è¡Œæ–°ç”¨æˆ·æ³¨å†Œã€‚</a></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/7d/1aa6506c45bdc101125dbf0eb471cb.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/e0/c44b7bd62656a42effb30cbe072d8d.jpg" alt=""></p><p>ç„¶åç‚¹å‡»é‚®ç®±å†…çš„æ¿€æ´»é‚®ä»¶ï¼Œè¿›è¡Œç”¨æˆ·åä¸å¯†ç çš„è®¾ç½®ã€‚ä¹Ÿå¯ä»¥é€šè¿‡ç®¡ç†å‘˜åˆ›å»ºæ–°ç”¨æˆ·</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/f3/3984a7b93cb83f5018a886334554f3.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/38/81f16e90a837e3b2e4753481d53d49.jpg" alt=""></p><p>ç®¡ç†å‘˜å¯ä»¥å¯¹ç”¨æˆ·çš„è§’è‰²ã€æ‰€å±çš„é¡¹ç›®ä»¥åŠä¸€äº›å…¶ä»–çš„æƒ…å†µè¿›è¡Œå¯¹åº”çš„é…ç½®ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/7e/8a3bf7d3b7d54549861c08cc2b8695.jpg" alt=""></p><p>å„ç§å…·ä½“çš„é…ç½®ä»¥åŠå„ç§è§’è‰²ç”¨æˆ·çš„æƒé™å¯å‚è§ç®¡ç†å‘˜çš„ç®¡ç†è§†å›¾ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/64/fb372744682c06a5abf50d6d08e3c3.jpg" alt=""></p><p><strong>æ“ä½œæµç¨‹</strong><br>é¦–å…ˆï¼Œè¯´æ˜ä¸€ä¸‹ç³»ç»Ÿä¸­çš„è§’è‰²å’Œä¸€èˆ¬æ‰€å¯¹åº”çš„äººå‘˜ï¼šè§‚å¯Ÿè€…ï¼ˆå¤æŸ¥å‘˜ï¼‰ã€æŠ¥å‘Šè€…ï¼ˆæµ‹è¯•å‘˜ï¼‰ã€å‡çº§è€…ï¼ˆå®¡æ ¸å‘˜ï¼‰ã€å¼€å‘äººå‘˜ï¼ˆå¼€å‘å‘˜ï¼‰ã€ç»ç†ï¼ˆé¡¹ç›®ç»ç†ï¼‰ã€ç®¡ç†å‘˜ï¼ˆç³»ç»Ÿç®¡ç†å‘˜ï¼‰ã€‚è¿˜è¦ç®€å•è¯´æ˜ä¸€ä¸‹é—®é¢˜çŠ¶æ€åŠç›¸å…³å«ä¹‰ï¼ˆä»¥ä¸Šçš„ä¸¤ç‚¹åªæ˜¯ä¸­æ–‡ç†è§£å’Œä¸­æ–‡ç¿»è¯‘çš„é—®é¢˜ï¼Œå¯ä»¥åœ¨mantisbt-2.15.0/lang/strings_chinese_simplified.txtä¸­ä¿®æ”¹ï¼‰ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/32/a9311c413f72019f384eb9fdb64e91.jpg" alt=""></p><ul><li>æ–°å»ºï¼šæ–°æäº¤çš„æŠ¥å‘Šï¼Œé»˜è®¤çŠ¶æ€ä¸ºæ–°å»º</li><li>åé¦ˆï¼šä¿®æ­£çš„é—®é¢˜ç»è¿‡æµ‹è¯•åä»ä¸å®Œå–„</li><li>è®¤å¯ï¼šæŠ¥å‘Šçš„é—®é¢˜ç¡®å®å­˜åœ¨</li><li>å·²ç¡®è®¤ï¼šé€šå¸¸ä¸ºé¡¹ç›®ç»ç†ç¡®è®¤æ—¶ä½¿ç”¨</li><li>å·²åˆ†é…ï¼šåˆ†æ´¾ç»™å…·ä½“å¼€å‘äººå‘˜</li><li>å·²è§£å†³ï¼šä¿®æ”¹åçš„é—®é¢˜ï¼Œå¯ä»¥è¿›è¡Œæµ‹è¯•</li><li>å·²å…³é—­ï¼šæµ‹è¯•é€šè¿‡çš„é—®é¢˜ï¼Œæˆ–è€…åœ¨æŠ¥å‘Šå‘¨æœŸå†…åˆ¤å®šä¸ºæ— éœ€ä¿®æ”¹çš„é—®é¢˜ã€‚</li></ul><p>ä¸‹é¢ä»‹ç»ä¸€ä¸‹ç®€å•çš„æ“ä½œæµç¨‹ï¼Œè¿™é‡Œä»¥ç®¡ç†å‘˜å’ŒæŠ¥å‘Šè€…ä½œä¸ºç¤ºä¾‹ï¼Œè¿™é‡Œä¸ºäº†æ–¹ä¾¿ç¤ºä¾‹ï¼Œç¤ºä¾‹ä¸­ç®¡ç†å‘˜åŒ…å«äº†å…¶ä»–è§’è‰²å±æ€§ã€‚è§‚å¯Ÿè€…ã€å‡çº§è€…ä»¥åŠç»ç†å¯ä»¥æ ¹æ®å…·ä½“æƒ…å†µè¿›è¡Œæ·»åŠ ã€‚</p><ul><li>æäº¤é—®é¢˜</li></ul><p><strong>æƒé™ï¼š</strong>å…¨éƒ¨è§’è‰²<br><strong>å¿…å¡«ä¿¡æ¯ï¼š</strong>åˆ†ç±»ã€æ‘˜è¦ã€æè¿°ã€æŸ¥çœ‹æƒé™<br><strong>é€‰å¡«ä¿¡æ¯ï¼š</strong>å‡ºç°é¢‘ç‡ã€ä¸¥é‡æ€§ã€ä¼˜å…ˆçº§ã€é€‰æ‹©å¹³å°è®¾ç½®ã€é‡ç°æ­¥éª¤ã€è¾…åŠ©ã€æ ‡ç­¾ã€ä¸Šä¼ æ–‡ä»¶ã€‚<br><strong>é—®é¢˜å•çŠ¶æ€ï¼š</strong>æ–°å»º</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/7a/b1f51f397d2700ccd2ae21cc7edbc7.jpg" alt=""></p><ul><li>å®¡æ ¸é—®é¢˜</li></ul><p><strong>æƒé™ï¼š</strong>å®¡æ ¸å‘˜ã€é¡¹ç›®ç»ç†ã€ï¼ˆå¼€å‘å‘˜ï¼‰<br><strong>å¯è¿›è¡Œæ“ä½œï¼š</strong>æ·»åŠ é™„ä»¶ã€æ·»åŠ æ³¨é‡Š<br><strong>é—®é¢˜å•çŠ¶æ€ï¼š</strong>æ–°å»º -&gt; å·²å®¡æ ¸ï¼ˆè®¤å¯ï¼‰ï¼Œå®¡æ ¸å‘˜å¯¹é—®é¢˜è¿›è¡Œå®¡æ ¸ï¼Œå¹¶ç¡®è®¤æ­¤é—®é¢˜ï¼›æ–°å»º -&gt; å·²å…³é—­ï¼Œå®¡æ ¸å‘˜è®¤ä¸ºæŠ¥å‘Šçš„é—®é¢˜ä¸å­˜åœ¨æˆ–æ— éœ€ä¿®æ”¹ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/cc/cf2fa843e333b7b168418e13720f06.jpg" alt=""></p><ul><li>ç¡®è®¤é—®é¢˜</li></ul><p><strong>æƒé™ï¼š</strong>é¡¹ç›®ç»ç†<br><strong>é—®é¢˜å•çŠ¶æ€ï¼š</strong>è®¤å¯ -&gt; å·²ç¡®è®¤ï¼Œé¡¹ç›®ç»ç†ç¡®è®¤é—®é¢˜ï¼Œç¡®è®¤åè¿›å…¥ä¿®æ”¹æµç¨‹ï¼›è®¤å¯ -&gt; åé¦ˆï¼Œé¡¹ç›®ç»ç†å¯¹é—®é¢˜å­˜åœ¨å¼‚è®®ï¼Œåé¦ˆç»™å®¡æ ¸è€…ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/61/b450cb7f3eb6af3ce04b1e071dd25e.jpg" alt=""></p><ul><li>åˆ†æ´¾é—®é¢˜</li></ul><p><strong>æƒé™ï¼š</strong>é¡¹ç›®ç»ç†ã€å¼€å‘å‘˜<br><strong>é—®é¢˜å•çŠ¶æ€ï¼š</strong>å·²ç¡®è®¤ -&gt; å·²åˆ†æ´¾ï¼Œé¡¹ç›®ç»ç†åˆ†æ´¾é—®é¢˜ç»™ç›¸åº”çš„å¼€å‘äººå‘˜ï¼›å·²åˆ†æ´¾ -&gt; å·²åˆ†æ´¾ï¼Œå¼€å‘ç»„é•¿ä¹Ÿå¯ä»¥ç»™ç»„å‘˜åˆ†æ´¾é—®é¢˜ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/97/1e02d524da8f78c447a2fae2b0ceb3.jpg" alt=""></p><ul><li>ä¿®å¤é—®é¢˜</li></ul><p><strong>æƒé™ï¼š</strong>å¼€å‘å‘˜<br><strong>é—®é¢˜å•çŠ¶æ€ï¼š</strong>å·²åˆ†æ´¾ -&gt; å·²è§£å†³ï¼Œåˆ†æ´¾ç»™å¼€å‘å‘˜çš„é—®é¢˜å·²ä¿®å¤åŠå†…éƒ¨æµ‹è¯•ï¼Œå¯ä»¥æäº¤ä¸šåŠ¡æµ‹è¯•æ—¶ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/46/f8d53110204d554fe1339fa16d4d98.jpg" alt=""></p><ul><li>æµ‹è¯•é—®é¢˜</li></ul><p><strong>æƒé™ï¼š</strong>æŠ¥å‘Šè€…<br><strong>é—®é¢˜å•çŠ¶æ€ï¼š</strong>å·²è§£å†³ -&gt; å·²å…³é—­ï¼ŒæŠ¥å‘Šè€…å¯¹å·²è§£å†³çš„é—®é¢˜æµ‹è¯•ä¸”æµ‹è¯•é€šè¿‡ï¼›å·²è§£å†³ -&gt; åé¦ˆï¼ŒæŠ¥å‘Šè€…å¯¹å·²è§£å†³çš„é—®é¢˜æµ‹è¯•ï¼Œè€Œæµ‹è¯•æœªé€šè¿‡ï¼Œå¼€å‘å‘˜å¯å¯¹åé¦ˆçš„é—®é¢˜ç»§ç»­ä¿®å¤ï¼Œå†è¿›å…¥åç»­ç¯èŠ‚ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/93/d945f5412b7aece0c5595564633ad6.jpg" alt=""></p><p>åˆ°æ­¤ï¼Œæ•´ä¸ªæµç¨‹ç»“æŸã€‚<br><strong>è¯´æ˜ï¼šæ•´ä¸ªæµç¨‹ä¸­ï¼Œé—®é¢˜å¤„äºä¸åŒçš„çŠ¶æ€ï¼Œæ ‡è®°çš„é¢œè‰²ä¸åŒã€‚</strong></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> CI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MantisBT </tag>
            
            <tag> Bugè¿½è¸ª </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>awk to use</title>
      <link href="/posts/4b423979/"/>
      <url>/posts/4b423979/</url>
      
        <content type="html"><![CDATA[<h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p><code>awk</code>æ˜¯<code>Linux</code>æœ€å¸¸ç”¨çš„å­—ç¬¦ä¸²å¤„ç†å·¥å…·</p><h1 id="awk-å†…ç½®å‚æ•°"><a href="#awk-å†…ç½®å‚æ•°" class="headerlink" title="awk å†…ç½®å‚æ•°"></a>awk å†…ç½®å‚æ•°</h1><ul><li>NR â€“ è¡Œå·</li><li>NF â€“ åˆ—æ€»æ•°</li><li>FILENAME â€“ å½“å‰æ–‡ä»¶å</li></ul><blockquote><p>å®ä¾‹</p></blockquote><ul><li><p>æ‰“å°<code>/etc/passwd</code>æ¯è¡Œçš„è¡Œå·ï¼Œæ¯è¡Œçš„å­—ç¬¦æ€»æ•°ä»¥åŠç¬¬ä¸€è¡Œ(å³æ¯è¡Œçš„ç”¨æˆ·å)</p><p><code>print</code>å®ç°</p><pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">awk</span> -F <span class="token string">':'</span> <span class="token string">'{print "Line:"NR,"Col:"NF,"User:"<span class="token variable">$1</span>}'</span> /etc/passwd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>printf</code>å®ç°</p><pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">awk</span> -F <span class="token string">':'</span> <span class="token string">'{printf "Line:%s,Col:%s,User:%s\n",NR,NF,<span class="token variable">$1</span>}'</span> /etc/passwd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>æ‰“å°<code>/etc/passwd</code>ä¸­<code>UID(å³ç¬¬ä¸‰åˆ—)</code>å¤§äº100çš„è¡Œçš„è¡Œå·ï¼Œå­—ç¬¦æ€»æ•°ä»¥åŠç¬¬ä¸€åˆ—(å³æ¯è¡Œçš„ç”¨æˆ·å)</p><p><code>print</code>å®ç°</p><pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">awk</span> -F <span class="token string">':'</span> <span class="token string">'{if (<span class="token variable">$3</span>>100) print "Line:"NR,"Col:"NF,"User:",<span class="token variable">$1</span>}'</span> /etc/passwd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>printf</code>å®ç°</p><pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">awk</span> -F <span class="token string">':'</span> <span class="token string">'{if (<span class="token variable">$3</span>>100) printf("Line:%s,Col:%s,User:%s\n",NR,NF,<span class="token variable">$1</span>)}'</span> /etc/passwd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>æå–æœåŠ¡å™¨æ—¥å¿—<code>fresh.log</code>ä¸­<code>ERROR</code>è¡Œå‘ç”Ÿçš„æ—¶é—´</p></li></ul><p><code>fresh.log</code>å†…å®¹æ ¼å¼å¦‚ä¸‹å›¾</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/7b/0fc81ccb4783036209f7ed10c01128.jpg" alt=""></p><p>  åˆ©ç”¨<code>sed</code>å’Œ<code>awk</code></p><pre class="line-numbers language-bash"><code class="language-bash">  $ <span class="token function">sed</span> <span class="token string">'/ERROR/p'</span> fresh.log <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$1</span>}'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>  åªåˆ©ç”¨<code>awk</code></p><pre class="line-numbers language-bash"><code class="language-bash">  $ <span class="token function">awk</span> <span class="token string">'/ERROR/{print <span class="token variable">$1</span>}'</span> fresh.log<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="START-END"><a href="#START-END" class="headerlink" title="START END"></a><code>START</code> <code>END</code></h1><blockquote><p><code>awk</code>æä¾›äº†ä¸€ä¸ªç®€å•çš„æ–¹å¼åœ¨åˆ©ç”¨<code>awk</code>å¤„ç†ç¼–ç¨‹éœ€æ±‚æ—¶çš„é—®é¢˜ï¼Œä¾‹å¦‚åˆ¶è¡¨æ—¶éœ€åœ¨è¡¨å‰æ‰“å°è¡¨å¤´ã€è¡¨åæ‰“å°è¡¨å°¾ã€‚</p></blockquote><blockquote><p>ä¸¾ä¸€ä¸ªæ¡ˆä¾‹ï¼Œåˆ¶è¡¨æ˜¾ç¤º<code>/etc/passwd</code>çš„è¡Œå·ã€åˆ—å·å’Œç”¨æˆ·å</p></blockquote><blockquote><p>æ€è·¯æ˜¯é¦–å…ˆåœ¨å¼€å¤´æ‰“å°â€Line Col Userâ€ï¼Œç„¶åä¾æ¬¡æ‰“å°<code>/etc/passwd</code>æ¯ä¸€è¡Œçš„è¡Œå·ã€åˆ—å·å’Œç”¨æˆ·åï¼Œæœ€åå¦èµ·ä¸€è¡Œæ‰“å°<code>--------</code>å¹¶åœ¨ä¸­é—´åŠ å…¥<code>awk</code>æ“ä½œçš„æ–‡ä»¶åä»¥ç»“æŸåˆ¶è¡¨</p></blockquote><pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">awk</span> -F <span class="token string">':'</span> <span class="token string">'BEGIN{print "Line    Col    User"}{print NR,NF,<span class="token variable">$1</span>}END{print "------",FILENAME,"------"}'</span> /etc/passwd <span class="token operator">|</span> <span class="token function">grep</span> -v <span class="token string">"#"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>å…¶ä¸­çš„<code>grep -v "#"</code>ç”¨ä»¥è¿‡æ»¤æ‰<code>/etc/passwd</code>ä¸­å¼€å¤´çš„æ— ç”¨è¯´æ˜ä¿¡æ¯</p></blockquote><h2 id="è¿è¡Œç»“æœ"><a href="#è¿è¡Œç»“æœ" class="headerlink" title="è¿è¡Œç»“æœ"></a>è¿è¡Œç»“æœ</h2><blockquote><p>ä¸ºæˆªå›¾æ–¹ä¾¿è¿™é‡Œåªæˆªäº†å‰é¢çš„ä¸€äº›è¡Œå’Œæœ€åçš„ä¸€äº›è¡Œ</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/93/04d33ecfbe22a469a95806f4d7e33f.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/6a/599d7e553eddcb04e05d87118fe358.jpg" alt=""></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>quicksort</title>
      <link href="/posts/ebad436c/"/>
      <url>/posts/ebad436c/</url>
      
        <content type="html"><![CDATA[<h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h1><pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"stdio.h"</span></span><span class="token keyword">void</span> <span class="token function">quicksort</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> left<span class="token punctuation">,</span> <span class="token keyword">int</span> right<span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> t<span class="token punctuation">,</span> temp<span class="token punctuation">;</span>     <span class="token keyword">if</span><span class="token punctuation">(</span>left <span class="token operator">></span> right<span class="token punctuation">)</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>     temp <span class="token operator">=</span> a<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">;</span>    i <span class="token operator">=</span> left<span class="token punctuation">;</span>     j <span class="token operator">=</span> right<span class="token punctuation">;</span>     <span class="token keyword">while</span><span class="token punctuation">(</span>i <span class="token operator">!=</span> j<span class="token punctuation">)</span>     <span class="token punctuation">{</span>         <span class="token keyword">while</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">>=</span> temp <span class="token operator">&amp;&amp;</span> i <span class="token operator">&lt;</span> j<span class="token punctuation">)</span>             j <span class="token operator">--</span><span class="token punctuation">;</span>         <span class="token keyword">while</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> temp <span class="token operator">&amp;&amp;</span> i <span class="token operator">&lt;</span> j<span class="token punctuation">)</span>             i <span class="token operator">++</span><span class="token punctuation">;</span>         <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">&lt;</span> j<span class="token punctuation">)</span>         <span class="token punctuation">{</span>             t <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>             a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>             a<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> t<span class="token punctuation">;</span>         <span class="token punctuation">}</span>     <span class="token punctuation">}</span>     a<span class="token punctuation">[</span>left<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>     a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>     <span class="token function">quicksort</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> left<span class="token punctuation">,</span> i<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">quicksort</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> right<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> t<span class="token punctuation">;</span>     <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> a<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>         <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">quicksort</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>         <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">putchar</span><span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="è¿è¡Œç»“æœ"><a href="#è¿è¡Œç»“æœ" class="headerlink" title="è¿è¡Œç»“æœ"></a>è¿è¡Œç»“æœ</h1><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/b8/847de187a667d431036df4a77966d9.jpg" alt=""></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿«é€Ÿæ’åº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>macOS åŸç‰ˆé•œåƒå¤§å…¨</title>
      <link href="/posts/a2a9ac74/"/>
      <url>/posts/a2a9ac74/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬äººæ‰€æœ‰é•œåƒå‡é‡‡ç”¨<code>Applestore</code>å®˜æ–¹å•†åº—ä¸‹è½½æ•´åŒ…åˆ¶ä½œï¼Œé€‚ç”¨äº<code>gpt</code>åˆ†åŒºè¡¨ï¼ŒåŠ å…¥äº†å„ä¸ªç‰ˆæœ¬åˆšæ¨é€æ—¶çš„<code>Clover</code>æºç æœ€æ–°å¼•å¯¼ï¼Œåç»­çš„æµ‹è¯•ç‰ˆæ¨é€ä¹‹åæˆ‘ä¼šå°½æ—©åšå‡ºä¾›å›å‹ä½¿ç”¨ï¼Œå¸Œæœ›å¤§å®¶å¤šå¤šæ”¯æŒç»™æ¥¼ä¸»åŠ ä¸ªåˆ†ï¼Œä½ ä»¬çš„æ”¯æŒå°±æ˜¯æˆ‘çš„åŠ¨åŠ›</p><hr><p>æ¥¼ä¸»æ‰€åšçš„é•œåƒå…¨éƒ¨é›†æˆå¤šé©±åŠ¨ï¼Œå¤š<code>config</code>ï¼Œé•œåƒæ‰€é›†æˆçš„è¿™äº›ä¸œè¥¿åªæ˜¯æ–¹ä¾¿å¤§å®¶ç”¨ï¼Œå›å‹å†™å…¥ä¹‹åè¯·é€‚å½“åˆ å‡ä½¿ç”¨ï¼Œæœ‰èƒ½åŠ›çš„æˆ–è€…æœ¬èº«è‡ªå·±æœ‰ä¸€å¥—é€‚åˆè‡ªå·±çš„<code>EFI</code>çš„æœ‹å‹è¯·ç”¨è‡ªå·±çš„ï¼Œæœ›å‘¨çŸ¥ã€‚</p><p><strong><em>PS: é•œåƒå†…é©±åŠ¨å’Œconfigæ˜¯ä¸ºæ–°æ‰‹å‡†å¤‡ï¼Œè€é¸Ÿå‹¿å–·<br>é•œåƒå†…æœ‰æ–‡ä»¶è¯¦ç»†è¯´æ˜ï¼Œæ–°æ‰‹è¯·æŒ‰è¯´æ˜è‡ªè¡Œé…ç½®å¼•å¯¼ã€‚</em></strong></p><h2 id="æœ€è¿‘ä¸€æ¬¡æ›´æ–°å†…å®¹"><a href="#æœ€è¿‘ä¸€æ¬¡æ›´æ–°å†…å®¹" class="headerlink" title="æœ€è¿‘ä¸€æ¬¡æ›´æ–°å†…å®¹"></a>æœ€è¿‘ä¸€æ¬¡æ›´æ–°å†…å®¹</h2><p>æ–°æ¬¾<code>MacBook Pro</code>ä¸Šå¸‚ä¹‹åï¼Œ<code>Apple</code>æ¨å‡ºç‰¹ä¾›ç‰ˆæœ¬ä»¥æ”¯æŒå…«ä»£<code>CPU</code>ï¼Œä¾ç„¶æ˜¯<code>10.13.6</code>ï¼Œæ­¤æ¬¡ç‰ˆæœ¬å·ä¸º<code>17G2208</code>ï¼Œç»æµ‹è¯•ï¼Œå·²åŸç”Ÿæ”¯æŒå…«ä»£æœºå™¨</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/35/a6f93b4a09ab4880e7b5736b6e87e7.jpg" alt=""></p><p>æ­¤å¤–,<code>Clover</code>ä¹ŸåŠæ—¶è·Ÿæ–°äº†<code>mbp15,1</code>ä»¥åŠ<code>mbp15,2</code>çš„<code>SMBIOS</code>ï¼Œæ¨èå¤§å®¶ä½¿ç”¨ï¼Œä½å‹æœ¬ç”¨<code>mbp15,2</code>ï¼Œå…¶ä»–<code>mbp15,1</code>ï¼Œä¸‹é¢æ˜¯<code>SMBIOS</code>ï¼Œå¤§å®¶å¯ä»¥ç›´æ¥å¥—ç”¨ï¼Œè®°å¾—ä¿®æ”¹<code>BoardSerialNumber</code>ä¸ºè‡ªå·±ä¹‹å‰æ­£åœ¨ç”¨çš„ã€‚</p><blockquote><p>MacBook Pro 15,1</p></blockquote><pre><code>&lt;key&gt;SMBIOS&lt;/key&gt;&lt;dict&gt;    &lt;key&gt;BiosReleaseDate&lt;/key&gt;    &lt;string&gt;06/26/2018&lt;/string&gt;    &lt;key&gt;BiosVendor&lt;/key&gt;    &lt;string&gt;Apple Inc.&lt;/string&gt;    &lt;key&gt;BiosVersion&lt;/key&gt;    &lt;string&gt;MBP151.88Z.0178.B00.1806260902&lt;/string&gt;    &lt;key&gt;Board-ID&lt;/key&gt;    &lt;string&gt;Mac-937A206F2EE63C01&lt;/string&gt;    &lt;key&gt;BoardManufacturer&lt;/key&gt;    &lt;string&gt;Apple Inc.&lt;/string&gt;    &lt;key&gt;BoardSerialNumber&lt;/key&gt;    &lt;string&gt;C02418108QXF64WCB&lt;/string&gt;    &lt;key&gt;BoardType&lt;/key&gt;    &lt;integer&gt;11&lt;/integer&gt;    &lt;key&gt;BoardVersion&lt;/key&gt;    &lt;string&gt;1.0&lt;/string&gt;    &lt;key&gt;ChassisAssetTag&lt;/key&gt;    &lt;string&gt;MacBook-Aluminum&lt;/string&gt;    &lt;key&gt;ChassisManufacturer&lt;/key&gt;    &lt;string&gt;Apple Inc.&lt;/string&gt;    &lt;key&gt;ChassisType&lt;/key&gt;    &lt;string&gt;0x09&lt;/string&gt;    &lt;key&gt;Family&lt;/key&gt;    &lt;string&gt;MacBook Pro&lt;/string&gt;    &lt;key&gt;FirmwareFeatures&lt;/key&gt;    &lt;string&gt;0xFC0FE137&lt;/string&gt;    &lt;key&gt;FirmwareFeaturesMask&lt;/key&gt;    &lt;string&gt;0xFF1FFF3F&lt;/string&gt;    &lt;key&gt;LocationInChassis&lt;/key&gt;    &lt;string&gt;Part Component&lt;/string&gt;    &lt;key&gt;Manufacturer&lt;/key&gt;    &lt;string&gt;Apple Inc.&lt;/string&gt;    &lt;key&gt;Mobile&lt;/key&gt;    &lt;true/&gt;    &lt;key&gt;PlatformFeature&lt;/key&gt;    &lt;string&gt;0x1A&lt;/string&gt;    &lt;key&gt;ProductName&lt;/key&gt;    &lt;string&gt;MacBookPro15,1&lt;/string&gt;    &lt;key&gt;SerialNumber&lt;/key&gt;    &lt;string&gt;C02X1HACKGYG&lt;/string&gt;    &lt;key&gt;Version&lt;/key&gt;    &lt;string&gt;1.0&lt;/string&gt;&lt;/dict&gt;</code></pre><blockquote><p>MacBook Pro 15,2</p></blockquote><pre><code>&lt;key&gt;SMBIOS&lt;/key&gt;&lt;dict&gt;    &lt;key&gt;BiosReleaseDate&lt;/key&gt;    &lt;string&gt;06/26/2018&lt;/string&gt;    &lt;key&gt;BiosVendor&lt;/key&gt;    &lt;string&gt;Apple Inc.&lt;/string&gt;    &lt;key&gt;BiosVersion&lt;/key&gt;    &lt;string&gt;MBP152.88Z.0178.B00.1806260902&lt;/string&gt;    &lt;key&gt;Board-ID&lt;/key&gt;    &lt;string&gt;Mac-827FB448E656EC26&lt;/string&gt;    &lt;key&gt;BoardManufacturer&lt;/key&gt;    &lt;string&gt;Apple Inc.&lt;/string&gt;    &lt;key&gt;BoardSerialNumber&lt;/key&gt;    &lt;string&gt;C02418108QXF64WCB&lt;/string&gt;    &lt;key&gt;BoardType&lt;/key&gt;    &lt;integer&gt;11&lt;/integer&gt;    &lt;key&gt;BoardVersion&lt;/key&gt;    &lt;string&gt;1.0&lt;/string&gt;    &lt;key&gt;ChassisAssetTag&lt;/key&gt;    &lt;string&gt;MacBook-Aluminum&lt;/string&gt;    &lt;key&gt;ChassisManufacturer&lt;/key&gt;    &lt;string&gt;Apple Inc.&lt;/string&gt;    &lt;key&gt;ChassisType&lt;/key&gt;    &lt;string&gt;0x09&lt;/string&gt;    &lt;key&gt;Family&lt;/key&gt;    &lt;string&gt;MacBook Pro&lt;/string&gt;    &lt;key&gt;FirmwareFeatures&lt;/key&gt;    &lt;string&gt;0xFC0FE137&lt;/string&gt;    &lt;key&gt;FirmwareFeaturesMask&lt;/key&gt;    &lt;string&gt;0xFF1FFF3F&lt;/string&gt;    &lt;key&gt;LocationInChassis&lt;/key&gt;    &lt;string&gt;Part Component&lt;/string&gt;    &lt;key&gt;Manufacturer&lt;/key&gt;    &lt;string&gt;Apple Inc.&lt;/string&gt;    &lt;key&gt;Mobile&lt;/key&gt;    &lt;true/&gt;    &lt;key&gt;PlatformFeature&lt;/key&gt;    &lt;string&gt;0x1A&lt;/string&gt;    &lt;key&gt;ProductName&lt;/key&gt;    &lt;string&gt;MacBookPro15,2&lt;/string&gt;    &lt;key&gt;SerialNumber&lt;/key&gt;    &lt;string&gt;C02X1HACJHCD&lt;/string&gt;    &lt;key&gt;Version&lt;/key&gt;    &lt;string&gt;1.0&lt;/string&gt;&lt;/dict&gt;</code></pre><h2 id="é•œåƒå†…å®¹"><a href="#é•œåƒå†…å®¹" class="headerlink" title="é•œåƒå†…å®¹"></a>é•œåƒå†…å®¹</h2><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/88/e3735f1df7c1698869bc4700b0e34f.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/48/99a6d0d9094d41acc455008be82109.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/48/87d2b0ec6f40a3df7347148b03d196.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/04/9fa489977f2fc21eccce5b795eddb6.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/a6/ba1d85d46d0523daf0d539579bcbbd.png" alt=""></p><h2 id="é•œåƒåœ°å€"><a href="#é•œåƒåœ°å€" class="headerlink" title="é•œåƒåœ°å€"></a>é•œåƒåœ°å€</h2><p>æ¯å‡ºä¸€ä¸ªç‰ˆæœ¬éƒ½å†™ä¸€ä¸ªå¸–å­çš„è¯å¤ªéº»çƒ¦ï¼Œæ‰€ä»¥å†³å®šç›´æ¥å†™ä¸€ä¸ªé•œåƒçš„é›†åˆè´´ï¼Œä¸‹é¢æ˜¯å„ä¸ªç‰ˆæœ¬çš„é“¾æ¥ï¼š</p><pre><code>é“¾æ¥:https://pan.baidu.com/s/1ymm0dm2R3dlFGyCH88fbmA  å¯†ç :vvon</code></pre><h2 id="é•œåƒæ ¡éªŒ"><a href="#é•œåƒæ ¡éªŒ" class="headerlink" title="é•œåƒæ ¡éªŒ"></a>é•œåƒæ ¡éªŒ</h2><p>ä¸ºé˜²æ­¢ä¸‹è½½æ–‡ä»¶æŸåï¼Œè¯·å°½é‡è¿›è¡Œ<code>MD5</code>ã€<code>SHA1</code>ã€<code>SHA256</code>æ ¡éªŒï¼Œæ ¡éªŒæ–‡ä»¶ä»¥å›¾ç‰‡çš„å½¢å¼å­˜åœ¨äºå„ä¸ªé•œåƒæ–‡ä»¶å¤¹å†…ã€‚</p><h2 id="é•œåƒåˆ—è¡¨"><a href="#é•œåƒåˆ—è¡¨" class="headerlink" title="é•œåƒåˆ—è¡¨"></a>é•œåƒåˆ—è¡¨</h2><ul><li><p>OS X EI Capitan</p><ul><li>OS X EI Capitan 10.11.6 15G31</li></ul></li><li><p>macOS Sierra</p><ul><li>macOS Sierra 10.12.5 16F73</li><li>macOS Sierra 10.12.6 16G29</li></ul></li><li><p>macOS High Sierra</p><ul><li>macOS High Sierra DP1 17A264c</li><li>macOS High Sierra DP1 17A291m</li><li>macOS High Sierra DP1 17A306F</li><li>macOS High Sierra DP1 17A315i</li><li>macOS High Sierra DP1 17A330h</li><li>macOS High Sierra DP1 17A344b</li><li>macOS High Sierra DP1 17A352a</li><li>macOS High Sierra DP1 17A358a</li><li>macOS High Sierra DP1 17A360a</li><li>macOS High Sierra Golden Master 17A362a</li><li>macOS High Sierra 10.13.0 17A365</li><li>macOS High Sierra 10.13.0 17A405</li><li>macOS High Sierra 10.13.1 17B48</li><li>macOS High Sierra 10.13.2 17C88</li><li>macOS High Sierra 10.13.2 17C88 å…‰ - æš—å½±ç²¾çµ II ä¸“ç”¨</li><li>macOS High Sierra 10.13.3 17D47</li><li>macOS High Sierra 10.13.4 17E199</li><li>macOS High Sierra 10.13.5 17F77</li><li>macOS High Sierra 10.13.6 17G65</li><li>macOS High Sierra 10.13.6 17G2112</li><li>macOS High Sierra 10.13.6 17G2208</li></ul></li><li><p>macOS Mojave</p><ul><li>macOS Mojave 10.14 DP1 18A293u</li><li>macOS Mojave 10.14 DP2 18A324h</li><li>macOS Mojave 10.14 DP3 18A326h</li><li>macOS Mojave 10.14 DP4 18A336e</li><li>macOS Mojave 10.14 DP5 18A347e</li><li>macOS Mojave 10.14 DP6 18A353d</li><li>macOS Mojave 10.14 DP7 18A365a</li><li>macOS Mojave 10.14 DP8 18A371a</li><li>macOS Mojave 10.14 DP9 18A377a</li><li>macOS Mojave 10.14 DP10 18A384a</li><li>macOS Mojave 10.14 Golden Master 18A389</li><li>macOS Mojave 10.14.0 18A389</li><li>macOS Mojave 10.14.1 18B75</li><li>macOS Mojave 10.14.1 18B2107</li><li>macOS Mojave 10.14.1 18B3094</li><li>macOS Mojave 10.14.2 18C54</li><li>macOS Mojave 10.14.3 18D42</li><li>macOS Mojave 10.14.4 18E226</li><li>macOS Mojave 10.14.4 18E2034 (iMac 19 ç‰¹ä¾›ç‰ˆ)</li></ul></li></ul><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Hackintosh </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åŸç‰ˆé•œåƒ </tag>
            
            <tag> é»‘è‹¹æœé•œåƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mac ä¸Šä½¿ç”¨å­—ç¬¦ä¸²å¤„ç†ç¥å™¨ sed çš„æ­£ç¡®å§¿åŠ¿</title>
      <link href="/posts/266b2c6f/"/>
      <url>/posts/266b2c6f/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><code>sed</code>æ˜¯<code>shell</code>ä¸­å­—ç¬¦ä¸²å¤„ç†çš„ä¸‰å¤§ç¥å™¨ä¹‹ä¸€ï¼Œåˆ©ç”¨<code>sed</code>è¿›è¡Œå­—ç¬¦ä¸²å¤„ç†å¯¹ä»äº‹<code>Linux</code>ç›¸å…³èŒä¸šçš„äººæ¥è¯´æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œä½†æ˜¯åœ¨<code>mac</code>ä¸Šçš„<code>sed</code>ä¸<code>Linux</code>çš„<code>sed</code>æ˜¯æœ‰ä¸€å®šåŒºåˆ«çš„ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Œå› ä¸º<code>mac</code>å®è´¨ä¸Šå’Œ<code>Linux</code>å°±æ˜¯ä¸ä¸€æ ·çš„ï¼Œå°½ç®¡å…¶ä¸­å¾ˆå¤šåŸºæœ¬å‘½ä»¤æ˜¯é€šç”¨çš„ï¼Œä¾‹å¦‚<code>ls</code>ã€<code>cd</code>ã€<code>pwd</code>ç­‰ã€‚<code>mac</code>æ˜¯<code>unix</code>å†…æ ¸ï¼Œæ˜¯åŸºäº<code>FreeBSD</code>çš„ï¼Œè€Œæˆ‘ä»¬å¸¸ç”¨çš„<code>Linux</code>å¦‚<code>Ubuntu</code>ã€<code>CentOS</code>ç­‰æ˜¯<code>Linux</code>å†…æ ¸ã€‚</p><h2 id="sedçš„ä¸åŒ"><a href="#sedçš„ä¸åŒ" class="headerlink" title="sedçš„ä¸åŒ"></a><code>sed</code>çš„ä¸åŒ</h2><p>éå¸¸å¤§çš„ä¸€ä¸ªå‘å°±æ˜¯<code>sed</code>å‘½ä»¤çš„ä¸ç»Ÿä¸€ï¼Œ<code>Linux</code>çš„<code>sed</code>æ˜¯åŸºäº<code>GNU</code>çš„<code>sed</code>ï¼Œè€Œ<code>FreeBSD</code>ä¸­çš„<code>sed</code>åˆ™æ˜¯åŸºäº<code>XNU</code>çš„ï¼Œå…¶ç”¨æ³•æœ‰äº›ä¸åŒï¼Œä¸‹é¢ä¼šåšå¯¹æ¯”ç®€è¦è¯´æ˜ã€‚</p><p>æ‹¿æœ€å¸¸ç”¨çš„è¿½åŠ è¡Œæ¥è¯´ï¼Œæˆ‘ä»¬å‡è®¾ä¸€ä¸ªåœºæ™¯ï¼Œæˆ‘éœ€è¦å¯¹<code>test.txt</code>æ–‡ä»¶å®æ—¶å†™å…¥ï¼Œåœ¨æ–‡ä»¶ç¬¬äºŒè¡Œæ·»åŠ <code>1234</code>ï¼Œæ–‡ä»¶åˆå§‹å†…å®¹å¦‚ä¸‹æ‰€ç¤º</p><pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">cat</span> test.txt333311123333<span class="token function">test</span>44445555<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨<code>Linux</code>ä¸‹ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å³å¯å®ç°è¿½åŠ </p><pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">sed</span> -i -e <span class="token string">'1a\1234'</span> test.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä½†æ˜¯åœ¨<code>mac</code>ä¸‹è¿™æ¡å‘½ä»¤ä¼šæŠ¥é”™å¦‚ä¸‹</p><pre><code>sed: 1: "1a\1234": extra characters after \ at the end of a command</code></pre><p>è¿™æ˜¯å› ä¸º<code>xnu</code>çš„<code>sed</code>å‘½ä»¤ç”¨æ³•ä¸åŒäº<code>gnu</code>ï¼Œå…·ä½“å¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æŸ¥çœ‹<code>sed</code>å‘½ä»¤æ‰‹å†Œ</p><pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">man</span> <span class="token function">sed</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypvvrfr68j31p818kn8n.jpg" alt=""></p><p>é‚£ä¹ˆæˆ‘æƒ³ç”¨æˆ‘ä¹ æƒ¯çš„<code>Linux</code>çš„<code>GNU-sed</code>æ€ä¹ˆè§£å†³å‘¢ï¼Œæˆ‘ä»¬å¯ä»¥å®‰è£…<code>gnu-sed</code>æ¥ä»£æ›¿ç³»ç»Ÿå†…çš„<code>sed</code>ï¼Œå…·ä½“æ–¹æ³•å¦‚ä¸‹</p><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦<code>Homebrew</code>åŒ…ç®¡ç†å™¨</p><pre class="line-numbers language-bash"><code class="language-bash">$ /usr/bin/ruby -e <span class="token string">"<span class="token variable"><span class="token variable">$(</span>curl -fsSL https://cdn.jsdelivr.net/gh/Homebrew/install/master/install<span class="token variable">)</span></span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åï¼Œé€šè¿‡<code>brew</code>æ¥å®‰è£…<code>gnu-sed</code></p><pre class="line-numbers language-bash"><code class="language-bash">$ brew <span class="token function">install</span> gnu-sed<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é»˜è®¤<code>brew</code>ä¼šå°†<code>gnu-sed</code>å®‰è£…åˆ°<code>/usr/local/Cellar/</code>ç›®å½•ä¸‹ï¼Œè¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨<code>gsed</code>æ¥æ‰§è¡Œäº†</p><pre class="line-numbers language-bash"><code class="language-bash">$ gsed -i -e <span class="token string">'1a\1234'</span> test.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚æœæç¤ºå‘½ä»¤æ‰¾ä¸åˆ°çš„è¯ï¼Œåªéœ€è¦å°†ä¸‹é¢çš„è·¯å¾„æ·»åŠ åˆ°<code>PATH</code>ç¯å¢ƒå˜é‡å°±å¯ä»¥äº†</p><pre><code>/usr/local/Cellar/gnu-sed/4.5/bin/</code></pre><p>æˆ–è€…å°†<code>/usr/local/Cellar/gnu-sed/4.5/bin/gsed</code>æ·»åŠ åˆ«åéƒ½å¯ä»¥ã€‚</p><p>ç½‘ä¸Šä¹Ÿæœ‰äººç”¨ä¸‹é¢çš„å‘½ä»¤å®‰è£…</p><pre class="line-numbers language-bash"><code class="language-bash">$ brew <span class="token function">install</span> gnu-sed --with-default-names<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è²Œä¼¼è¿™ç§æ–¹å¼ç›´æ¥æ›¿ä»£äº†ç³»ç»Ÿå†…çš„<code>sed</code>ï¼Œæˆ‘ä¸ªäººä¸æ˜¯å¾ˆæ¨èè¿™ç§æ–¹å¼ï¼Œä¸æ˜¯è¯´ä¸å¥½ï¼Œè€Œæ˜¯å½“æˆ‘ä»¬çš„æœºå™¨ä¸åªæ˜¯ä¸€ä¸ªäººç”¨ï¼Œæ˜¯åšæœåŠ¡å™¨ç”¨çš„ï¼Œæˆ–è€…æœ‰ä¸€äº›æˆ‘ä»¬æ­£åœ¨ç”¨çš„è„šæœ¬é‡Œé¢æœ‰<code>xnu</code>çš„<code>sed</code>è°ƒç”¨ï¼Œé‚£ä¹ˆè¿™ç§æ–¹å¼å°±ä¼šé€ æˆä¸€äº›é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä¸ªäººè®¤ä¸ºå®‰è£…äº†<code>gnu-sed</code>åï¼Œåˆ©ç”¨åˆ«åã€ç¯å¢ƒå˜é‡ã€é…ç½®æ–‡ä»¶ç­‰æ–¹å¼è°ƒç”¨æ˜¯æ›´å¥½çš„ä¸€ç§æ–¹æ³•ï¼Œå½“ç„¶ï¼Œè¿™ä¸ªæ ¹æ®ä¸ªäººéœ€æ±‚å†³å®šå°±å¥½äº†ã€‚</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sed </tag>
            
            <tag> gnu-sed </tag>
            
            <tag> xnu-sed </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iTerm2 + ohmyzsh + powerlevel9k + tmux æ‰“é€ ä¸“å±ä¸ªæ€§åŒ–ç»ˆç«¯</title>
      <link href="/posts/710a9e8b/"/>
      <url>/posts/710a9e8b/</url>
      
        <content type="html"><![CDATA[<h1 id="å…ˆæ¥å¼ å›¾é•‡æ¥¼"><a href="#å…ˆæ¥å¼ å›¾é•‡æ¥¼" class="headerlink" title="å…ˆæ¥å¼ å›¾é•‡æ¥¼"></a>å…ˆæ¥å¼ å›¾é•‡æ¥¼</h1><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/5c/d74f1affaf72faac5b2887dc78625d.jpg" alt=""></p><h1 id="é¦–å…ˆæ­å»ºå¥½å®‰è£…homebrewç¯å¢ƒ"><a href="#é¦–å…ˆæ­å»ºå¥½å®‰è£…homebrewç¯å¢ƒ" class="headerlink" title="é¦–å…ˆæ­å»ºå¥½å®‰è£…homebrewç¯å¢ƒ"></a>é¦–å…ˆæ­å»ºå¥½å®‰è£…<code>homebrew</code>ç¯å¢ƒ</h1><blockquote><p>åœ¨<code>mac</code>ä¸Šæ‹¥æœ‰ä¸€ä¸ªå¥½çš„åŒ…ç®¡ç†å™¨æ˜¯éå¸¸é‡è¦çš„ï¼Œ<code>Debian</code>å®¶æ—æœ‰<code>apt</code>ï¼Œ<code>mac</code>æœ‰<code>homebrew</code>ï¼Œéå¸¸å¥½ç”¨ã€‚</p></blockquote><pre class="line-numbers language-bash"><code class="language-bash">$ /usr/bin/ruby -e <span class="token string">"<span class="token variable"><span class="token variable">$(</span>curl -fsSL https://cdn.jsdelivr.net/gh/Homebrew/install/master/install<span class="token variable">)</span></span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="å®‰è£…oh-my-zsh"><a href="#å®‰è£…oh-my-zsh" class="headerlink" title="å®‰è£…oh-my-zsh"></a>å®‰è£…<code>oh-my-zsh</code></h1><blockquote><p><code>oh-my-zsh</code>æ˜¯ä¸€æ¬¾éå¸¸å¥½ç”¨ä¸”ç¾è§‚çš„<code>shell</code>å·¥å…·ï¼Œå…¶å‘½ä»¤çš„è¡¥å…¨ç­‰éƒ½æ˜¯å…¶ä»–å¦‚<code>bash</code>ã€<code>csh</code>ç­‰æ‰€æ— æ³•æ¯”æ‹Ÿçš„</p></blockquote><blockquote><p>å®‰è£…æ–¹å¼ä¸¤ç§</p></blockquote><ul><li>é€šè¿‡<code>curl</code></li></ul><pre class="line-numbers language-bash"><code class="language-bash">$ sh -c <span class="token string">"<span class="token variable"><span class="token variable">$(</span>curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh<span class="token variable">)</span></span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>é€šè¿‡<code>wget</code></li></ul><pre class="line-numbers language-bash"><code class="language-bash">$ sh -c <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">wget</span> https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh -O -<span class="token variable">)</span></span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å®‰è£…å®Œæˆåè®¾å®š<code>zsh</code>ä¸ºé»˜è®¤<code>shell</code></p><pre class="line-numbers language-bash"><code class="language-bash">$ chsh -s /bin/zsh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="è®¾å®šoh-my-zshçš„ä¸»é¢˜"><a href="#è®¾å®šoh-my-zshçš„ä¸»é¢˜" class="headerlink" title="è®¾å®šoh-my-zshçš„ä¸»é¢˜"></a>è®¾å®š<code>oh-my-zsh</code>çš„ä¸»é¢˜</h1><blockquote><p><code>oh-my-zsh</code>æ”¯æŒéå¸¸å¤šçš„ä¸»é¢˜ï¼Œè¿™é‡Œæˆ‘å°†æˆ‘ä¸ªäººæ¯”è¾ƒå–œæ¬¢çš„ä¸»é¢˜<code>powerlevel9k</code>ä½œä¸ºå®ä¾‹</p></blockquote><pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">git</span> clone https://github.com/bhilburn/powerlevel9k.git ~/.oh-my-zsh/custom/themes/powerlevel9k<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åä¿®æ”¹<code>zsh</code>çš„é…ç½®æ–‡ä»¶</p><pre class="line-numbers language-bash"><code class="language-bash">$ vim ~/.zshrc <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å°†<code>ZSH_THEME</code>è®¾å®šä¸º<code>powerlevel9k</code>ï¼Œå¦‚å›¾</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypw3om3nij31p817atmw.jpg" alt=""></p><p>ç„¶åä¿å­˜é€€å‡ºï¼Œä½¿é…ç½®æ–‡ä»¶é‡æ–°ç”Ÿæ•ˆ</p><pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">source</span> ~/.zshrc<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="å®‰è£…iTerm2"><a href="#å®‰è£…iTerm2" class="headerlink" title="å®‰è£…iTerm2"></a>å®‰è£…<code>iTerm2</code></h1><blockquote><p><code>iTerm2</code>æ˜¯ä¸€æ¬¾æ›¿ä»£ç³»ç»Ÿå†…ç½®ç»ˆç«¯çš„å·¥å…·ï¼Œå…¶åŠŸèƒ½æ›´å¼ºå¤§ï¼Œå¯å®šä¹‰æ‰©å±•æ€§ä¹Ÿæ›´å¼º</p></blockquote><pre class="line-numbers language-bash"><code class="language-bash">$ brew cask <span class="token function">install</span> iterm2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="å®‰è£…archeyå°å·¥å…·"><a href="#å®‰è£…archeyå°å·¥å…·" class="headerlink" title="å®‰è£…archeyå°å·¥å…·"></a>å®‰è£…<code>archey</code>å°å·¥å…·</h1><blockquote><p><code>archey</code>æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œç¾åŒ–å·¥å…·ï¼Œå…¶å¯ä»¥åœ¨è¿è¡Œç»ˆç«¯ç¨‹åºæ—¶ä¸ºç”¨æˆ·æ˜¾ç¤ºæ‰“å°å‡ºä¸€ä¸ªä¸ƒå½©çš„è‹¹æœ<code>logo</code></p></blockquote><blockquote><p>è¿™ä¸ªå·¥å…·çš„åŸä½œè€…æ˜¯<a href="https://github.com/obihann" target="_blank" rel="noopener"><code>obihann</code></a>ï¼Œæˆ‘å°†å…¶æŒ‰ç…§è‡ªå·±çš„ä¹ æƒ¯è¿›è¡Œäº†ä¸€äº›ä¿®æ”¹ï¼Œå¹¶åšäº†æ±‰åŒ–ï¼Œæœ‹å‹ä»¬å¯ä»¥è‡ªè¡Œé€‰æ‹©</p></blockquote><ul><li>åŸä½œè€…çš„å®‰è£…æ–¹å¼</li></ul><pre class="line-numbers language-bash"><code class="language-bash">brew <span class="token function">install</span> archey<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆ‘ä¸ªäººä¿®æ”¹çš„å’Œæ±‰åŒ–çš„å¯ä»¥é€šè¿‡æˆ‘<code>GitHub</code>ä»“åº“ä¸­<code>Pages</code>é¡µé¢çš„<code>README</code>è¯´æ˜æ–‡æ¡£è¿›è¡Œå®‰è£…ï¼ŒæŒ‰ç…§è¦æ±‚å®‰è£…å¹¶é…ç½®å®Œæˆåï¼Œé€€å‡ºç»ˆç«¯å†é‡æ–°æ‰“å¼€å°±å¯ä»¥å‘ç°ç»ˆç«¯å¯ä»¥è‡ªåŠ¨æ‰“å°å›¾ä¸­çš„ä¸ƒå½©è‹¹æœäº†ã€‚</p><p><a href="https://athlonreg.github.io/archey-osx/" target="_blank" rel="noopener">https://athlonreg.github.io/archey-osx/</a></p><h1 id="å®‰è£…tmuxå°å·¥å…·"><a href="#å®‰è£…tmuxå°å·¥å…·" class="headerlink" title="å®‰è£…tmuxå°å·¥å…·"></a>å®‰è£…<code>tmux</code>å°å·¥å…·</h1><blockquote><p><code>Tmux</code>æ˜¯ä¸€ä¸ªä¼˜ç§€çš„ç»ˆç«¯å¤ç”¨è½¯ä»¶ï¼Œç±»ä¼¼<code>GNU Screen</code>ï¼Œä½†æ¥è‡ªäº<code>OpenBSD</code>ï¼Œé‡‡ç”¨<code>BSD</code>æˆæƒã€‚</p></blockquote><pre class="line-numbers language-bash"><code class="language-bash">$ brew <span class="token function">install</span> tmux<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å®‰è£…å®Œæˆåè¾“å…¥å‘½ä»¤<code>tmux</code>å³å¯æ‰“å¼€è½¯ä»¶ï¼Œç•Œé¢ååˆ†ç®€å•ï¼Œç±»ä¼¼ä¸€ä¸ªä¸‹æ–¹å¸¦æœ‰çŠ¶æ€æ çš„ç»ˆç«¯æ§åˆ¶å°</p><p>å®‰è£…å®Œæˆåï¼Œæˆ‘ä»¬å°†å…¶å†ç¾åŒ–ä¸€ä¸‹</p><pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">cd</span> <span class="token punctuation">;</span> <span class="token function">rm</span> -rf .tmux$ <span class="token function">git</span> clone https://github.com/gpakosz/.tmux.git$ <span class="token function">ln</span> -s .tmux/.tmux.conf$ <span class="token function">cp</span> .tmux/.tmux.conf.local <span class="token keyword">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h1 id="ç¾åŒ–ç»“æŸ"><a href="#ç¾åŒ–ç»“æŸ" class="headerlink" title="ç¾åŒ–ç»“æŸ"></a>ç¾åŒ–ç»“æŸ</h1><blockquote><p>åˆ°è¿™é‡Œï¼Œç›¸ä¿¡ä½ åº”è¯¥å’Œæˆ‘å¼€å¤´çš„æˆªå›¾æœ‰ä¸€æ ·çš„æ•ˆæœäº†ï¼Œå¦‚æœæ²¡æœ‰çš„è¯ï¼Œå¯ä»¥åœ¨æœ¬æ–‡åé¢è¯„è®ºï¼Œæˆ‘ä¼šå°½å¿«å›å¤ã€‚</p></blockquote><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iTerm2 </tag>
            
            <tag> tmux </tag>
            
            <tag> oh-my-zsh </tag>
            
            <tag> ç»ˆç«¯ç¾åŒ– </tag>
            
            <tag> archey </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é»‘è‹¹æœå£°å¡ cx20751/2 é©±åŠ¨æ–¹æ³•</title>
      <link href="/posts/942dd3f5/"/>
      <url>/posts/942dd3f5/</url>
      
        <content type="html"><![CDATA[<h3 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h3><p>é¦–å…ˆä»<code>linux</code>æå–<code>codec</code>ï¼Œç„¶åæ•´ç†<code>codec</code>æå–èŠ‚ç‚¹æ•°æ®ï¼Œå‚è€ƒæˆ‘çš„å¦ä¸€ç¯‡å¸–å­<a href="http://blog.athlonreg.top/Driver-audio-for-hackintosh.html" target="_blank" rel="noopener">http://blog.athlonreg.top/Driver-audio-for-hackintosh.html</a></p><h3 id="å¯¹æ¯”èŠ‚ç‚¹æ•°æ®"><a href="#å¯¹æ¯”èŠ‚ç‚¹æ•°æ®" class="headerlink" title="å¯¹æ¯”èŠ‚ç‚¹æ•°æ®"></a>å¯¹æ¯”èŠ‚ç‚¹æ•°æ®</h3><p>è¿™é‡Œæ‹¿æˆ‘çš„<code>CX20751</code>ä¸ºä¾‹ï¼Œ<code>codec</code>æ•´ç†çš„æ•°æ®å¦‚ä¸‹</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypwbciiatj32701f6h20.jpg" alt=""></p><p>çœ‹å…¶ä¸­çš„<code>Line in</code>èŠ‚ç‚¹ï¼Œå³<code>Mic at Ext</code>ï¼Œæˆ‘çš„æ˜¯<code>0x19</code>ï¼Œé‚£ä¹ˆæˆ‘çš„<code>AppleALC</code>å°±éœ€è¦æ³¨å…¥<code>Layout-ID</code>ä¸º<code>28</code>ï¼Œå¦‚æœä½ çš„<code>CX20751/2</code>æå–çš„æ•°æ®ä¸­æ­¤èŠ‚ç‚¹æ˜¯<code>0x18</code>ï¼Œå°±éœ€è¦æ³¨å…¥<code>Layout-ID</code>ä¸º<code>3</code>ã€‚</p><h3 id="æ³¨å…¥Layout-ID"><a href="#æ³¨å…¥Layout-ID" class="headerlink" title="æ³¨å…¥Layout-ID"></a>æ³¨å…¥<code>Layout-ID</code></h3><h4 id="DSDTæ–¹å¼"><a href="#DSDTæ–¹å¼" class="headerlink" title="DSDTæ–¹å¼"></a><code>DSDT</code>æ–¹å¼</h4><p>æŒ‚è½½ä½ çš„<code>ESP</code>åˆ†åŒºï¼Œæ‰“å¼€<code>DSDT</code>ï¼Œæ‰“ä¸Šå£°å¡<code>Layout-ID</code>æ³¨å…¥è¡¥ä¸</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypwc693jij31ke17i1ag.jpg" alt=""></p><p>å¦‚å›¾ï¼Œ<code>3</code>å’Œ<code>12</code>éƒ½å¯ä»¥ï¼Œæˆ‘æ‹¿<code>12</code>ä¸ºä¾‹ï¼Œç‚¹å‡»æ­¤è¡¥ä¸ï¼Œå°†å¦‚ä¸‹å›¾ä¸­çš„<code>12</code>æ”¹ä¸º<code>28</code>ï¼Œç„¶åç‚¹å‡»<code>Apply</code>ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypwdcqetkj31ru17idw8.jpg" alt=""></p><p>å¦‚æœä½ çš„éœ€è¦æ³¨å…¥<code>3</code>ï¼Œåªéœ€ç›´æ¥æ‰“ä¸Šé‚£ä¸ªä¸º<code>3</code>çš„è¡¥ä¸å³å¯</p><h4 id="Hotpatchæ–¹å¼"><a href="#Hotpatchæ–¹å¼" class="headerlink" title="Hotpatchæ–¹å¼"></a><code>Hotpatch</code>æ–¹å¼</h4><p>å°†å›¾ä¸­ä¸‰ä¸ª<code>SSDT</code>æ”¾å…¥<code>/EFI/CLOVER/ACPI/patched</code>ï¼Œä¸‰ä¸ªæ–‡ä»¶åˆ†åˆ«åšä»¥ä¸‹ä¿®æ”¹ï¼Œæˆ‘çš„æ˜¯<code>28</code>æ”¹ä¸º<code>0x1C</code>ï¼Œå¦‚æœä½ çš„æ˜¯<code>3</code>ï¼Œåˆ™æ”¹ä¸º<code>0x03</code>ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypwghuvp8j30b60b845o.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypwh26ts3j31aw118qdw.jpg" alt=""></p><p>![image-20181231141502091](/Users/canvas/Library/Application Support/typora-user-images/image-20181231141502091.png)</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypwi1ni90j31ke17i19h.jpg" alt=""></p><p>ç„¶ååœ¨<code>config.plist</code>ä¸­å‹¾é€‰ä»¥ä¸‹é€‰é¡¹</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypwj5qbvwj32201801db.jpg" alt=""></p><h4 id="configæ–¹å¼"><a href="#configæ–¹å¼" class="headerlink" title="configæ–¹å¼"></a><code>config</code>æ–¹å¼</h4><p>åŒæ ·å‹¾é€‰ä»¥ä¸‹é€‰é¡¹</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypwj5qbvwj32201801db.jpg" alt=""></p><p>ç„¶åæ³¨å…¥<code>ID</code>ï¼Œæ­¤å¤„æ ¹æ®å‰é¢çš„<code>Layout-ID</code>å†³å®šæ³¨å…¥<code>3</code>è¿˜æ˜¯<code>28</code></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypwl0wucij3220180tod.jpg" alt=""></p><h3 id="æ”¾é©±åŠ¨"><a href="#æ”¾é©±åŠ¨" class="headerlink" title="æ”¾é©±åŠ¨"></a>æ”¾é©±åŠ¨</h3><p>å°†<code>AppleALC</code>ã€<code>Lilu</code>ã€<code>CodecCommander</code>ä¸‰ä¸ªé©±åŠ¨æ”¾åˆ°<code>/EFI/CLOVER/kexts/Other</code></p><p><a href="https://github.com/vit9696/AppleALC/releases" target="_blank" rel="noopener">https://github.com/vit9696/AppleALC/releases</a><br><a href="https://github.com/vit9696/Lilu/releases" target="_blank" rel="noopener">https://github.com/vit9696/Lilu/releases</a><br><a href="https://bitbucket.org/RehabMan/os-x-eapd-codec-commander/downloads/" target="_blank" rel="noopener">https://bitbucket.org/RehabMan/os-x-eapd-codec-commander/downloads/</a></p><p><strong>æ³¨æ„ä¸‰ä¸ªé©±åŠ¨éƒ½ç”¨<code>Release</code>é‡Œé¢çš„</strong></p><h3 id="æ”¾SSDT"><a href="#æ”¾SSDT" class="headerlink" title="æ”¾SSDT"></a>æ”¾<code>SSDT</code></h3><p>æ‰“å¼€ç»ˆç«¯æ‰§è¡Œ</p><pre><code>$ git clone https://github.com/RehabMan/OS-X-Clover-Laptop-Config</code></pre><p>åˆ©ç”¨<code>MaciASL</code>æ‰“å¼€<code>SSDT-CX20752.dsl</code>ï¼Œå°†å…¶å¦å­˜ä¸º<code>SSDT-CX20752.aml</code>ã€‚ä¿å­˜è‡³<code>/EFI/CLOVER/ACPI/patched</code>,å¦‚æœä½ æ­£åœ¨ä½¿ç”¨<code>SortedOrder</code>ï¼Œåˆ™å°†å…¶åŠ å…¥è¿›å»ã€‚</p><p>ç„¶åä¿å­˜å…¨éƒ¨å·¥ä½œé‡å¯ã€‚</p><h3 id="å£°å¡è¾“å…¥ä¿®å¤"><a href="#å£°å¡è¾“å…¥ä¿®å¤" class="headerlink" title="å£°å¡è¾“å…¥ä¿®å¤"></a>å£°å¡è¾“å…¥ä¿®å¤</h3><p>è‹¥é‡åˆ°å£°å¡å†…å»ºè¾“å…¥æˆ–è€³æœºçº¿è·¯è¾“å…¥æ— ç”µå¹³çš„æƒ…å†µï¼Œè¯·ç»§ç»­ä»¥ä¸‹æ­¥éª¤ã€‚</p><p>ä¸‹è½½<code>ALCPlugFix for AppleALC.zip</code></p><p><a href="https://github.com/athlonreg/ASUS-F455LD-i5-4210u" target="_blank" rel="noopener">https://github.com/athlonreg/ASUS-F455LD-i5-4210u</a></p><p>æ‰“å¼€ç»ˆç«¯æ‰§è¡Œ</p><pre><code>$ git clone https://github.com/athlonreg/ASUS-F455LD-i5-4210u</code></pre><p>ä¸‹è½½å®Œæˆåï¼Œå¦‚æœä½ çš„<code>Layout-ID</code>æ˜¯<code>3</code>ï¼Œåˆ™å°†å…¶ä¸­çš„<code>ALCPlugFix-LayoutID=3.zip</code>è§£å‹è‡³æ¡Œé¢ï¼Œè‹¥ä¸º<code>28</code>åˆ™å°†å…¶ä¸­çš„<code>ALCPlugFix-LayoutID=28.zip</code>è§£å‹è‡³æ¡Œé¢ï¼Œæ‰§è¡Œ</p><pre><code>$ cd ~/Desktop/ALCPlugFix/alc_fix $ chmod +x install.sh $ ./install.sh </code></pre><p>ç„¶åæ ¹æ®æç¤ºè¾“å…¥å¯†ç å›è½¦ã€‚æœ€åä¿å­˜é‡å¯å³å¯ã€‚</p><p><strong><em>æ–°ç‰ˆ AppleALC å·²ç»è§£å†³æ­¤é—®é¢˜ï¼Œæ³¨å…¥ ID 7å³å¯ã€‚</em></strong></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Hackintosh </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cx20751 </tag>
            
            <tag> cx20752 </tag>
            
            <tag> ALCPlugFix </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OSI ä¸ƒå±‚æ¨¡å‹è¯¦è§£</title>
      <link href="/posts/8ae9fc70/"/>
      <url>/posts/8ae9fc70/</url>
      
        <content type="html"><![CDATA[<h2 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h2><p>OSIï¼ˆOpen System Interconnectionï¼‰å‚è€ƒæ¨¡å‹æ˜¯å›½é™…æ ‡å‡†åŒ–ç»„ç»‡ï¼ˆISOï¼‰åˆ¶å®šçš„ä¸€ä¸ªç”¨äºè®¡ç®—æœºæˆ–é€šä¿¡ç³»ç»Ÿé—´äº’è”çš„æ ‡å‡†ä½“ç³»ï¼Œä¸€èˆ¬ç§°ä¸ºOSIå‚è€ƒæ¨¡å‹æˆ–ä¸ƒå±‚æ¨¡å‹ã€‚</p><h2 id="æ¨¡å‹å›¾"><a href="#æ¨¡å‹å›¾" class="headerlink" title="æ¨¡å‹å›¾"></a>æ¨¡å‹å›¾</h2><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypy5q4ps0j30ra0esac0.jpg" alt=""></p><h3 id="å„å±‚æè¿°"><a href="#å„å±‚æè¿°" class="headerlink" title="å„å±‚æè¿°"></a>å„å±‚æè¿°</h3><h3 id="ç‰©ç†å±‚"><a href="#ç‰©ç†å±‚" class="headerlink" title="ç‰©ç†å±‚"></a>ç‰©ç†å±‚</h3><blockquote><p>è®¾å¤‡ä¹‹é—´çš„æ¯”ç‰¹æµä¼ è¾“ã€ç‰©ç†æ¥å£ã€ç”µæ°”ç‰¹æ€§ç­‰</p></blockquote><p>ç‰©ç†å±‚å¹¶ä¸æ˜¯ç‰©ç†åª’ä½“æœ¬èº«ï¼Œå®ƒåªæ˜¯å¼€æ”¾ç³»ç»Ÿä¸­åˆ©ç”¨ç‰©ç†åª’ä½“å®ç°ç‰©ç†è¿æ¥çš„åŠŸèƒ½æè¿°å’Œæ‰§è¡Œè¿æ¥çš„è§„ç¨‹ã€‚ç‰©ç†å±‚æä¾›ç”¨äºå»ºç«‹ã€ä¿æŒå’Œæ–­å¼€ç‰©ç†è¿æ¥çš„æœºæ¢°çš„ã€ç”µæ°”çš„ã€åŠŸèƒ½çš„å’Œè¿‡ç¨‹çš„æ¡ä»¶ã€‚ç®€è€Œè¨€ä¹‹ï¼Œç‰©ç†å±‚æä¾›æœ‰å…³åŒæ­¥å’Œå…¨åŒå·¥æ¯”ç‰¹æµåœ¨ç‰©ç†åª’ä½“ä¸Šçš„ä¼ è¾“æ‰‹æ®µï¼Œå…¶å…¸å‹çš„åè®®æœ‰<code>RS 232C</code>ã€<code>RS 449/422/423</code>ã€<code>V.24</code>å’Œ<code>X.21</code>ã€<code>X.21bis</code>ç­‰ã€‚</p><p>ç‰©ç†å±‚æ˜¯<code>OSI</code>çš„ç¬¬ä¸€å±‚ï¼Œå®ƒè™½ç„¶å¤„äºæœ€åº•å±‚ï¼Œå´æ˜¯æ•´ä¸ªå¼€æ”¾ç³»ç»Ÿçš„åŸºç¡€ã€‚ç‰©ç†å±‚ä¸ºè®¾å¤‡ä¹‹é—´çš„æ•°æ®é€šä¿¡æä¾›ä¼ è¾“åª’ä½“åŠäº’è¿è®¾å¤‡ï¼Œä¸ºæ•°æ®ä¼ è¾“æä¾›å¯é çš„ç¯å¢ƒã€‚</p><ul><li><p>ä¸ºæ•°æ®ç«¯è®¾å¤‡æä¾›ä¼ é€æ•°æ®çš„é€šè·¯ï¼Œæ•°æ®é€šè·¯å¯ä»¥æ˜¯ä¸€ä¸ªç‰©ç†åª’ä½“ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šä¸ªç‰©ç†åª’ä½“è¿æ¥è€Œæˆã€‚ä¸€æ¬¡å®Œæ•´çš„æ•°æ®ä¼ è¾“ï¼ŒåŒ…æ‹¬æ¿€æ´»ç‰©ç†è¿æ¥ã€ä¼ é€æ•°æ®å’Œç»ˆæ­¢ç‰©ç†è¿æ¥ã€‚æ‰€è°“æ¿€æ´»ï¼Œå°±æ˜¯ä¸ç®¡æœ‰å¤šå°‘ç‰©ç†åª’ä½“å‚ä¸ï¼Œéƒ½è¦åœ¨é€šä¿¡çš„ä¸¤ä¸ªæ•°æ®ç»ˆç«¯è®¾å¤‡é—´è¿æ¥èµ·æ¥ï¼Œå½¢æˆä¸€æ¡é€šè·¯ã€‚</p></li><li><p>ä¼ è¾“æ•°æ®ã€‚ç‰©ç†å±‚è¦å½¢æˆé€‚åˆæ•°æ®ä¼ è¾“éœ€è¦çš„å®ä½“ï¼Œä¸ºæ•°æ®ä¼ é€æœåŠ¡ã€‚ä¸€æ˜¯è¦ä¿è¯æ•°æ®èƒ½åœ¨å…¶ä¸Šæ­£ç¡®é€šè¿‡ï¼ŒäºŒæ˜¯è¦æä¾›è¶³å¤Ÿçš„å¸¦å®½(å¸¦å®½æ˜¯æŒ‡æ¯ç§’é’Ÿå†…èƒ½é€šè¿‡çš„æ¯”ç‰¹(<code>Bit</code>)æ•°)ï¼Œä»¥å‡å°‘ä¿¡é“ä¸Šçš„æ‹¥å¡ã€‚ä¼ è¾“æ•°æ®çš„æ–¹å¼èƒ½æ»¡è¶³ç‚¹åˆ°ç‚¹ï¼Œä¸€ç‚¹åˆ°å¤šç‚¹ï¼Œä¸²è¡Œæˆ–å¹¶è¡Œï¼ŒåŠåŒå·¥æˆ–å…¨åŒå·¥ï¼ŒåŒæ­¥æˆ–å¼‚æ­¥ä¼ è¾“çš„éœ€è¦ã€‚</p></li><li><p>å®Œæˆç‰©ç†å±‚çš„ä¸€äº›ç®¡ç†å·¥ä½œã€‚</p></li></ul><h3 id="æ•°æ®é“¾è·¯å±‚"><a href="#æ•°æ®é“¾è·¯å±‚" class="headerlink" title="æ•°æ®é“¾è·¯å±‚"></a>æ•°æ®é“¾è·¯å±‚</h3><blockquote><p>å°è£…æ•°æ®å¸§</p></blockquote><p>æ•°æ®é“¾è·¯å¯ä»¥ç²—ç•¥åœ°ç†è§£ä¸ºæ•°æ®é€šé“ã€‚ç‰©ç†å±‚è¦ä¸ºç»ˆç«¯è®¾å¤‡é—´çš„æ•°æ®é€šä¿¡æä¾›ä¼ è¾“ä»‹è´¨åŠå…¶è¿æ¥ã€‚ä»‹è´¨æ˜¯é•¿æœŸçš„ï¼Œè¿æ¥æ˜¯æœ‰ç”Ÿå­˜æœŸçš„ã€‚åœ¨è¿æ¥ç”Ÿå­˜æœŸå†…ï¼Œæ”¶å‘ä¸¤ç«¯å¯ä»¥è¿›è¡Œä¸ç­‰çš„ä¸€æ¬¡æˆ–å¤šæ¬¡æ•°æ®é€šä¿¡ã€‚æ¯æ¬¡é€šä¿¡éƒ½è¦ç»è¿‡å»ºç«‹é€šä¿¡è”ç»œå’Œæ‹†é™¤é€šä¿¡è”ç»œä¸¤ä¸ªè¿‡ç¨‹ã€‚è¿™ç§å»ºç«‹èµ·æ¥çš„æ•°æ®æ”¶å‘å…³ç³»å°±å«åšæ•°æ®é“¾è·¯ã€‚è€Œåœ¨ç‰©ç†åª’ä½“ä¸Šä¼ è¾“çš„æ•°æ®éš¾å…å—åˆ°å„ç§ä¸å¯é å› ç´ çš„å½±å“è€Œäº§ç”Ÿå·®é”™ï¼Œä¸ºäº†å¼¥è¡¥ç‰©ç†å±‚ä¸Šçš„ä¸è¶³ï¼Œä¸ºä¸Šå±‚æä¾›æ— å·®é”™çš„æ•°æ®ä¼ è¾“ï¼Œå°±è¦èƒ½å¯¹æ•°æ®è¿›è¡Œæ£€é”™å’Œçº é”™ã€‚æ•°æ®é“¾è·¯çš„å»ºç«‹ï¼Œæ‹†é™¤ï¼Œå¯¹æ•°æ®çš„æ£€é”™ï¼Œçº é”™æ˜¯æ•°æ®é“¾è·¯å±‚çš„åŸºæœ¬ä»»åŠ¡ã€‚</p><p>é“¾è·¯å±‚æ˜¯ä¸ºç½‘ç»œå±‚æä¾›æ•°æ®ä¼ é€æœåŠ¡çš„ï¼Œè¿™ç§æœåŠ¡è¦ä¾é æœ¬å±‚å…·å¤‡çš„åŠŸèƒ½æ¥å®ç°ã€‚é“¾è·¯å±‚åº”å…·å¤‡å¦‚ä¸‹åŠŸèƒ½ï¼š</p><ul><li>é“¾è·¯è¿æ¥çš„å»ºç«‹ã€æ‹†é™¤å’Œåˆ†ç¦»ï¼›</li><li>å¸§å®šç•Œå’Œå¸§åŒæ­¥ã€‚é“¾è·¯å±‚çš„æ•°æ®ä¼ è¾“å•å…ƒæ˜¯å¸§ï¼Œåè®®ä¸åŒï¼Œå¸§çš„é•¿çŸ­å’Œç•Œé¢ä¹Ÿæœ‰å·®åˆ«ï¼Œä½†æ— è®ºå¦‚ä½•å¿…é¡»å¯¹å¸§è¿›è¡Œå®šç•Œï¼›</li><li>é¡ºåºæ§åˆ¶ï¼ŒæŒ‡å¯¹å¸§çš„æ”¶å‘é¡ºåºçš„æ§åˆ¶ï¼›</li><li>å·®é”™æ£€æµ‹å’Œæ¢å¤ã€‚è¿˜æœ‰é“¾è·¯æ ‡è¯†ï¼Œæµé‡æ§åˆ¶ç­‰ç­‰ã€‚å·®é”™æ£€æµ‹å¤šç”¨æ–¹é˜µç æ ¡éªŒå’Œå¾ªç¯ç æ ¡éªŒæ¥æ£€æµ‹ä¿¡é“ä¸Šæ•°æ®çš„è¯¯ç ï¼Œè€Œå¸§ä¸¢å¤±ç­‰ç”¨åºå·æ£€æµ‹ã€‚å„ç§é”™è¯¯çš„æ¢å¤åˆ™å¸¸é åé¦ˆé‡å‘æŠ€æœ¯æ¥å®Œæˆã€‚</li></ul><p>ç‹¬ç«‹çš„é“¾è·¯äº§å“ä¸­æœ€å¸¸è§çš„å½“å±ç½‘å¡ï¼Œç½‘æ¡¥ä¹Ÿæ˜¯é“¾è·¯äº§å“ã€‚æ•°æ®é“¾è·¯å±‚å°†æœ¬è´¨ä¸Šä¸å¯é çš„ä¼ è¾“åª’ä½“å˜æˆå¯é çš„ä¼ è¾“é€šè·¯æä¾›ç»™ç½‘ç»œå±‚ã€‚åœ¨<code>IEEE802.3</code>æƒ…å†µä¸‹ï¼Œæ•°æ®é“¾è·¯å±‚åˆ†æˆäº†ä¸¤ä¸ªå­å±‚ï¼Œä¸€ä¸ªæ˜¯é€»è¾‘é“¾è·¯æ§åˆ¶ï¼Œå¦ä¸€ä¸ªæ˜¯åª’ä½“è®¿é—®æ§åˆ¶.</p><p><code>OSI</code>å…¶ä¸­ï¼š</p><ul><li><code>AUI</code>â€”â€”è¿æ¥å•å…ƒæ¥å£ </li><li><code>PMA</code>â€”â€”ç‰©ç†åª’ä½“è¿æ¥</li><li><code>MAU</code>â€”â€”åª’ä½“è¿æ¥å•å…ƒ </li><li><code>PLS</code>â€”â€”ç‰©ç†ä¿¡ä»¤</li><li><code>MDI</code>â€”â€”åª’ä½“ç›¸å…³æ¥å£</li></ul><h3 id="ç½‘ç»œå±‚"><a href="#ç½‘ç»œå±‚" class="headerlink" title="ç½‘ç»œå±‚"></a>ç½‘ç»œå±‚</h3><blockquote><p>å°è£…æ•°æ®æŠ¥æ–‡</p></blockquote><p>ç½‘ç»œå±‚çš„äº§ç”Ÿä¹Ÿæ˜¯ç½‘ç»œå‘å±•çš„ç»“æœã€‚åœ¨è”æœºç³»ç»Ÿå’Œçº¿è·¯äº¤æ¢çš„ç¯å¢ƒä¸­ï¼Œç½‘ç»œå±‚çš„åŠŸèƒ½æ²¡æœ‰å¤ªå¤§æ„ä¹‰ã€‚å½“æ•°æ®ç»ˆç«¯å¢å¤šæ—¶ã€‚å®ƒä»¬ä¹‹é—´æœ‰ä¸­ç»§è®¾å¤‡ç›¸è¿ï¼Œæ­¤æ—¶ä¼šå‡ºç°ä¸€å°ç»ˆç«¯è¦æ±‚ä¸åªæ˜¯ä¸æƒŸä¸€çš„ä¸€å°è€Œæ˜¯èƒ½å’Œå¤šå°ç»ˆç«¯é€šä¿¡çš„æƒ…å†µï¼Œè¿™å°±äº§ç”Ÿäº†æŠŠä»»æ„ä¸¤å°æ•°æ®ç»ˆç«¯è®¾å¤‡çš„æ•°æ®é“¾æ¥èµ·æ¥çš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯è·¯ç”±æˆ–è€…å«å¯»å¾„ã€‚å¦å¤–ï¼Œå½“ä¸€æ¡ç‰©ç†ä¿¡é“å»ºç«‹ä¹‹åï¼Œè¢«ä¸€å¯¹ç”¨æˆ·ä½¿ç”¨ï¼Œå¾€å¾€æœ‰è®¸å¤šç©ºé—²æ—¶é—´è¢«æµªè´¹æ‰ã€‚äººä»¬è‡ªç„¶ä¼šå¸Œæœ›è®©å¤šå¯¹ç”¨æˆ·å…±ç”¨ä¸€æ¡é“¾è·¯ï¼Œä¸ºè§£å†³è¿™ä¸€é—®é¢˜å°±å‡ºç°äº†é€»è¾‘ä¿¡é“æŠ€æœ¯å’Œè™šæ‹Ÿç”µè·¯æŠ€æœ¯ã€‚</p><p>ä¸­ç»§æ§åˆ¶å±‚ï¼Œå…¶ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ•°æ®é“¾è·¯å±‚æ‰€ä¿è¯çš„é‚»æ¥èŠ‚ç‚¹é—´çš„æ— å·®é”™æ•°æ®ä¼ è¾“åŠŸèƒ½ï¼Œé€šè¿‡è·¯ç”±é€‰æ‹©å’Œä¸­ç»§åŠŸèƒ½ï¼Œå®ç°ä¸¤ä¸ªç«¯ç³»ç»Ÿä¹‹é—´çš„æ•°æ®ä¼ è¾“ã€‚ä¸ºæ­¤ï¼Œç½‘ç»œå±‚è¿˜å…·æœ‰å¤šè·¯å¤ç”¨åŠŸèƒ½ï¼Œé‡‡ç”¨ç»Ÿè®¡æ—¶åˆ†å¤ç”¨åŸç†ï¼Œå°†ä¸€æ¡æ•°æ®é“¾è·¯å¤ç”¨ä¸ºå¤šæ¡é€»è¾‘ä¿¡é“ï¼Œä»è€Œå®ç°ä¸€ä¸ªæ•°æ®ç»ˆç«¯è®¾å¤‡åˆ©ç”¨ä¸€æ¡ç‰©ç†ç”µè·¯åŒæ—¶å’Œå¤šä¸ªè¿œç¨‹æ•°æ®é€šä¿¡è®¾å¤‡çš„é€šä¿¡ã€‚ç½‘ç»œå±‚è§„å®šäº†ç½‘è·¯è¿æ¥çš„å»ºç«‹å’Œæ‹†é™¤è§„ç¨‹ä»¥åŠæ•°æ®ä¼ é€è§„ç¨‹ç­‰ã€‚</p><ul><li>è·¯ç”±é€‰æ‹©å’Œä¸­ç»§ï¼›</li><li>æ¿€æ´»ï¼Œç»ˆæ­¢ç½‘ç»œè¿æ¥ï¼›</li><li>åœ¨ä¸€æ¡æ•°æ®é“¾è·¯ä¸Šå¤ç”¨å¤šæ¡ç½‘ç»œè¿æ¥ï¼Œå¤šé‡‡å–åˆ†æ—¶å¤ç”¨æŠ€æœ¯ï¼›</li><li>æ£€æµ‹ä¸æ¢å¤ï¼›</li><li>æ’åºï¼Œæµé‡æ§åˆ¶ï¼›</li><li>æœåŠ¡é€‰æ‹©ï¼›</li><li>ç½‘ç»œç®¡ç†ã€‚</li></ul><h3 id="ä¼ è¾“å±‚"><a href="#ä¼ è¾“å±‚" class="headerlink" title="ä¼ è¾“å±‚"></a>ä¼ è¾“å±‚</h3><blockquote><p>ç¡®å®šä¼ è¾“åè®®ã€ç¡®å®šæ•°æ®ä¼ è¾“çš„æ¥å£</p></blockquote><p>ä¸»è¦åŠŸèƒ½æ˜¯ç«¯å¼€æ”¾ç³»ç»Ÿä¹‹é—´æ•°æ®çš„æ”¶å¦¥ç¡®è®¤ã€‚åŒæ—¶ï¼Œè¿˜ç”¨äºå¼¥è¡¥å„ç§é€šä¿¡ç½‘è·¯çš„è´¨é‡å·®å¼‚ï¼Œå¯¹ç»è¿‡ä¸‹ä¸‰å±‚ä¹‹åä»ç„¶å­˜åœ¨çš„ä¼ è¾“å·®é”™è¿›è¡Œæ¢å¤ï¼Œè¿›ä¸€æ­¥æé«˜å¯é æ€§ã€‚å¦å¤–ï¼Œè¿˜é€šè¿‡å¤ç”¨ã€åˆ†æ®µå’Œç»„åˆã€è¿æ¥å’Œåˆ†ç¦»ã€åˆ†æµå’Œåˆæµç­‰æŠ€æœ¯æªæ–½ï¼Œæé«˜ååé‡å’ŒæœåŠ¡è´¨é‡ã€‚</p><p>ä¼ è¾“å±‚æ˜¯ä¸¤å°è®¡ç®—æœºç»è¿‡ç½‘ç»œè¿›è¡Œæ•°æ®é€šä¿¡æ—¶ï¼Œç¬¬ä¸€ä¸ªç«¯åˆ°ç«¯çš„å±‚æ¬¡ï¼Œå…·æœ‰ç¼“å†²ä½œç”¨ã€‚å½“ç½‘ç»œå±‚æœåŠ¡è´¨é‡ä¸èƒ½æ»¡è¶³è¦æ±‚æ—¶ï¼Œå®ƒå°†æœåŠ¡åŠ ä»¥æé«˜ï¼Œä»¥æ»¡è¶³é«˜å±‚çš„è¦æ±‚ï¼›å½“ç½‘ç»œå±‚æœåŠ¡è´¨é‡è¾ƒå¥½æ—¶ï¼Œå®ƒåªç”¨å¾ˆå°‘çš„å·¥ä½œã€‚ä¼ è¾“å±‚è¿˜å¯è¿›è¡Œå¤ç”¨ï¼Œå³åœ¨ä¸€ä¸ªç½‘ç»œè¿æ¥ä¸Šåˆ›å»ºå¤šä¸ªé€»è¾‘è¿æ¥ã€‚ä¼ è¾“å±‚ä¹Ÿç§°ä¸ºè¿è¾“å±‚ã€‚ä¼ è¾“å±‚åªå­˜åœ¨äºç«¯å¼€æ”¾ç³»ç»Ÿä¸­ï¼Œæ˜¯ä»‹äºä½3å±‚é€šä¿¡å­ç½‘ç³»ç»Ÿå’Œé«˜3å±‚ä¹‹é—´çš„ä¸€å±‚ï¼Œä½†æ˜¯å¾ˆé‡è¦çš„ä¸€å±‚ã€‚å› ä¸ºå®ƒæ˜¯æºç«¯åˆ°ç›®çš„ç«¯å¯¹æ•°æ®ä¼ é€è¿›è¡Œæ§åˆ¶ä»ä½åˆ°é«˜çš„æœ€åä¸€å±‚ã€‚</p><p>æœ‰ä¸€ä¸ªæ—¢å­˜äº‹å®ï¼Œå³ä¸–ç•Œä¸Šå„ç§é€šä¿¡å­ç½‘åœ¨æ€§èƒ½ä¸Šå­˜åœ¨ç€å¾ˆå¤§å·®å¼‚ã€‚ä¾‹å¦‚ç”µè¯äº¤æ¢ç½‘ï¼Œåˆ†ç»„äº¤æ¢ç½‘ï¼Œå…¬ç”¨æ•°æ®äº¤æ¢ç½‘ï¼Œå±€åŸŸç½‘ç­‰é€šä¿¡å­ç½‘éƒ½å¯äº’è¿ï¼Œä½†å®ƒä»¬æä¾›çš„ååé‡ï¼Œä¼ è¾“é€Ÿç‡ï¼Œæ•°æ®å»¶è¿Ÿé€šä¿¡è´¹ç”¨å„ä¸ç›¸åŒã€‚å¯¹äºä¼šè¯å±‚æ¥è¯´ï¼Œå´è¦æ±‚æœ‰ä¸€æ€§èƒ½æ’å®šçš„ç•Œé¢ã€‚ä¼ è¾“å±‚å°±æ‰¿æ‹…äº†è¿™ä¸€åŠŸèƒ½ã€‚å®ƒé‡‡ç”¨åˆ†æµ/åˆæµï¼Œå¤ç”¨/ä»‹å¤ç”¨æŠ€æœ¯æ¥è°ƒèŠ‚ä¸Šè¿°é€šä¿¡å­ç½‘çš„å·®å¼‚ï¼Œä½¿ä¼šè¯å±‚æ„Ÿå—ä¸åˆ°ã€‚</p><p>æ­¤å¤–ä¼ è¾“å±‚è¿˜è¦å…·å¤‡å·®é”™æ¢å¤ï¼Œæµé‡æ§åˆ¶ç­‰åŠŸèƒ½ï¼Œä»¥æ­¤å¯¹ä¼šè¯å±‚å±è”½é€šä¿¡å­ç½‘åœ¨è¿™äº›æ–¹é¢çš„ç»†èŠ‚ä¸å·®å¼‚ã€‚ä¼ è¾“å±‚é¢å¯¹çš„æ•°æ®å¯¹è±¡å·²ä¸æ˜¯ç½‘ç»œåœ°å€å’Œä¸»æœºåœ°å€ï¼Œè€Œæ˜¯ä¼šè¯å±‚çš„ç•Œé¢ç«¯å£ã€‚ä¸Šè¿°åŠŸèƒ½çš„æœ€ç»ˆç›®çš„æ˜¯ä¸ºä¼šè¯æä¾›å¯é çš„ï¼Œæ— è¯¯çš„æ•°æ®ä¼ è¾“ã€‚ä¼ è¾“å±‚çš„æœåŠ¡ä¸€èˆ¬è¦ç»å†ä¼ è¾“è¿æ¥å»ºç«‹ã€æ•°æ®ä¼ é€ã€ä¼ è¾“è¿æ¥é‡Šæ”¾3ä¸ªé˜¶æ®µæ‰ç®—å®Œæˆä¸€ä¸ªå®Œæ•´çš„æœåŠ¡è¿‡ç¨‹ã€‚è€Œåœ¨æ•°æ®ä¼ é€é˜¶æ®µåˆåˆ†ä¸ºä¸€èˆ¬æ•°æ®ä¼ é€å’ŒåŠ é€Ÿæ•°æ®ä¼ é€ä¸¤ç§ã€‚</p><h3 id="ä¼šè¯å±‚"><a href="#ä¼šè¯å±‚" class="headerlink" title="ä¼šè¯å±‚"></a>ä¼šè¯å±‚</h3><blockquote><p>å¯¹åº”ç”¨ä¼šè¯çš„ç®¡ç†ã€åŒæ­¥</p></blockquote><p>æŒ‰ç…§åœ¨åº”ç”¨è¿›ç¨‹ä¹‹é—´çº¦å®šçš„åŸåˆ™ï¼ŒæŒ‰ç…§æ­£ç¡®çš„é¡ºåºæ”¶ã€å‘æ•°æ®ï¼Œè¿›è¡Œå„ç§å½¢æ€çš„å¯¹è¯ã€‚ä¼šè¯å±‚è§„å®šäº†ä¼šè¯æœåŠ¡ç”¨æˆ·é—´ä¼šè¯è¿æ¥çš„å»ºç«‹å’Œæ‹†é™¤è§„ç¨‹ä»¥åŠæ•°æ®ä¼ é€è§„ç¨‹ã€‚</p><p>ä¼šè¯å±‚æä¾›çš„æœåŠ¡æ˜¯åº”ç”¨å»ºç«‹å’Œç»´æŒä¼šè¯ï¼Œå¹¶èƒ½ä½¿ä¼šè¯è·å¾—åŒæ­¥ã€‚ä¼šè¯å±‚ä½¿ç”¨æ ¡éªŒç‚¹å¯ä½¿é€šä¿¡ä¼šè¯åœ¨é€šä¿¡å¤±æ•ˆæ—¶ä»æ ¡éªŒç‚¹ç»§ç»­æ¢å¤é€šä¿¡ã€‚è¿™ç§èƒ½åŠ›å¯¹äºä¼ é€å¤§çš„æ–‡ä»¶æä¸ºé‡è¦ã€‚ä¼šè¯å±‚ï¼Œè¡¨ç¤ºå±‚ï¼Œåº”ç”¨å±‚æ„æˆå¼€æ”¾ç³»ç»Ÿçš„é«˜3å±‚ï¼Œé¢å‘åº”ç”¨è¿›ç¨‹æä¾›åˆ†å¸ƒå¤„ç†ã€å¯¹è¯ç®¡ç†ã€ä¿¡æ¯è¡¨ç¤ºã€æ£€æŸ¥å’Œæ¢å¤ä¸è¯­ä¹‰ä¸Šä¸‹æ–‡æœ‰å…³çš„ä¼ é€å·®é”™ç­‰ã€‚ä¸ºç»™ä¸¤ä¸ªå¯¹ç­‰ä¼šè¯æœåŠ¡ç”¨æˆ·å»ºç«‹ä¸€ä¸ªä¼šè¯è¿æ¥ï¼Œåº”è¯¥åšå¦‚ä¸‹å‡ é¡¹å·¥ä½œï¼š</p><ul><li>å°†ä¼šè¯åœ°å€æ˜ å°„ä¸ºè¿è¾“åœ°å€ï¼›</li><li>æ•°æ®ä¼ è¾“é˜¶æ®µï¼›</li><li>è¿æ¥é‡Šæ”¾ã€‚</li></ul><h3 id="è¡¨ç¤ºå±‚"><a href="#è¡¨ç¤ºå±‚" class="headerlink" title="è¡¨ç¤ºå±‚"></a>è¡¨ç¤ºå±‚</h3><blockquote><p>æ•°æ®çš„è¡¨ç°å½¢å¼ã€ç‰¹æ®Šæ•°æ®çš„åŠ å¯†ã€å‹ç¼©ï¼ˆè§£é‡Šä¼ è¾“çš„æ•°æ®ï¼‰</p></blockquote><p>æŠŠåº”ç”¨å±‚æä¾›çš„ä¿¡æ¯å˜æ¢ä¸ºèƒ½å¤Ÿå…±åŒç†è§£çš„å½¢å¼ï¼Œæä¾›å­—ç¬¦ä»£ç ã€æ•°æ®æ ¼å¼ã€æ§åˆ¶ä¿¡æ¯æ ¼å¼ã€åŠ å¯†ç­‰çš„ç»Ÿä¸€è¡¨ç¤ºã€‚è¡¨ç¤ºå±‚çš„ä½œç”¨ä¹‹ä¸€æ˜¯ä¸ºå¼‚ç§æœºé€šä¿¡æä¾›ä¸€ç§å…¬å…±è¯­è¨€ï¼Œä»¥ä¾¿èƒ½è¿›è¡Œäº’æ“ä½œã€‚è¿™ç§ç±»å‹çš„æœåŠ¡ä¹‹æ‰€ä»¥éœ€è¦ï¼Œæ˜¯å› ä¸ºä¸åŒçš„è®¡ç®—æœºä½“ç³»ç»“æ„ä½¿ç”¨çš„æ•°æ®è¡¨ç¤ºæ³•ä¸åŒã€‚ä¾‹å¦‚ï¼Œ<code>IBM</code>ä¸»æœºä½¿ç”¨<code>EBCDIC</code>ç¼–ç ï¼Œè€Œå¤§éƒ¨åˆ†<code>PC</code>æœºä½¿ç”¨çš„æ˜¯<code>ASCII</code>ç ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¾¿éœ€è¦è¡¨ç¤ºå±‚æ¥å®Œæˆè¿™ç§è½¬æ¢ã€‚é€šè¿‡å‰é¢çš„ä»‹ç»ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œä¼šè¯å±‚ä»¥ä¸‹5å±‚å®Œæˆäº†ç«¯åˆ°ç«¯çš„æ•°æ®ä¼ é€ï¼Œå¹¶ä¸”æ˜¯å¯é çš„ã€æ— å·®é”™çš„ä¼ é€ã€‚ä½†æ˜¯æ•°æ®ä¼ é€åªæ˜¯æ‰‹æ®µè€Œä¸æ˜¯ç›®çš„ï¼Œæœ€ç»ˆæ˜¯è¦å®ç°å¯¹æ•°æ®çš„ä½¿ç”¨ã€‚ç”±äºå„ç§ç³»ç»Ÿå¯¹æ•°æ®çš„å®šä¹‰å¹¶ä¸å®Œå…¨ç›¸åŒï¼Œæœ€æ˜“æ˜ç™½çš„ä¾‹å­æ˜¯é”®ç›˜â€”â€”å…¶ä¸Šçš„æŸäº›é”®çš„å«ä¹‰åœ¨è®¸å¤šç³»ç»Ÿä¸­éƒ½æœ‰å·®å¼‚ã€‚è¿™è‡ªç„¶ç»™åˆ©ç”¨å…¶å®ƒç³»ç»Ÿçš„æ•°æ®é€ æˆäº†éšœç¢ã€‚è¡¨ç¤ºå±‚å’Œåº”ç”¨å±‚å°±æ‹…è´Ÿäº†æ¶ˆé™¤è¿™ç§éšœç¢çš„ä»»åŠ¡ã€‚</p><h3 id="åº”ç”¨å±‚"><a href="#åº”ç”¨å±‚" class="headerlink" title="åº”ç”¨å±‚"></a>åº”ç”¨å±‚</h3><blockquote><p>æä¾›ç”¨æˆ·æ¥å£</p></blockquote><p>å®ç°åº”ç”¨è¿›ç¨‹ï¼ˆå¦‚ç”¨æˆ·ç¨‹åºã€ç»ˆç«¯æ“ä½œå‘˜ç­‰ï¼‰ä¹‹é—´çš„ä¿¡æ¯äº¤æ¢ã€‚åŒæ—¶ï¼Œè¿˜å…·æœ‰ä¸€ç³»åˆ—ä¸šåŠ¡å¤„ç†æ‰€éœ€è¦çš„æœåŠ¡åŠŸèƒ½ã€‚åº”ç”¨å±‚ä¸€èˆ¬åŒ…æ‹¬å…¬å…±åº”ç”¨æœåŠ¡è¦ç´ ï¼ˆ<code>CASE</code>ï¼‰å’Œç‰¹å®šåº”ç”¨æœåŠ¡è¦ç´ ï¼ˆ<code>SASE</code>ï¼‰ã€‚å…¶ä¸­<code>CASE</code>æä¾›åº”ç”¨è¿›ç¨‹ä¸­æœ€åŸºæœ¬çš„æœåŠ¡ï¼Œå‘åº”ç”¨è¿›ç¨‹æä¾›ä¿¡æ¯ä¼ é€æ‰€å¿…éœ€çš„ã€ä½†åˆç‹¬ç«‹äºåº”ç”¨è¿›ç¨‹é€šä¿¡çš„èƒ½åŠ›ã€‚SASEå®è´¨ä¸Šæ˜¯å„ç§åº”ç”¨è¿›ç¨‹åœ¨åº”ç”¨å±‚ä¸­çš„æ˜ å°„ï¼Œæ¯ä¸€ä¸ª<code>SASE</code>éƒ½é’ˆå¯¹æŸä¸€ç±»å…·ä½“åº”ç”¨ï¼Œä¾‹å¦‚æ–‡ä»¶ä¼ é€ã€è®¿é—®å’Œç®¡ç†ï¼ˆ<code>FTAM</code>ï¼‰ã€è™šæ‹Ÿç»ˆç«¯ï¼ˆ<code>VT</code>ï¼‰ã€æ¶ˆæ¯å¤„ç†ç³»ç»Ÿï¼ˆ<code>MHS</code>ï¼‰ã€ç”µå­æ•°æ®äº’æ¢ï¼ˆ<code>EDI</code>ï¼‰å’Œç›®å½•æŸ¥è¯¢ç­‰ã€‚</p><p>åº”ç”¨å±‚å‘åº”ç”¨ç¨‹åºæä¾›æœåŠ¡ï¼Œè¿™äº›æœåŠ¡æŒ‰å…¶å‘åº”ç”¨ç¨‹åºæä¾›çš„ç‰¹æ€§åˆ†æˆç»„ï¼Œå¹¶ç§°ä¸ºæœåŠ¡å…ƒç´ ã€‚æœ‰äº›å¯ä¸ºå¤šç§åº”ç”¨ç¨‹åºå…±åŒä½¿ç”¨ï¼Œæœ‰äº›åˆ™ä¸ºè¾ƒå°‘çš„ä¸€ç±»åº”ç”¨ç¨‹åºä½¿ç”¨ã€‚åº”ç”¨å±‚æ˜¯å¼€æ”¾ç³»ç»Ÿçš„æœ€é«˜å±‚ï¼Œæ˜¯ç›´æ¥ä¸ºåº”ç”¨è¿›ç¨‹æä¾›æœåŠ¡çš„ã€‚å…¶ä½œç”¨æ˜¯åœ¨å®ç°å¤šä¸ªç³»ç»Ÿåº”ç”¨è¿›ç¨‹ç›¸äº’é€šä¿¡çš„åŒæ—¶ï¼Œå®Œæˆä¸€ç³»åˆ—ä¸šåŠ¡å¤„ç†æ‰€éœ€çš„æœåŠ¡ã€‚</p><h2 id="OSIä¸ƒå±‚æ¨¡å‹-ç›¸å…³åè®®-ç¼©å†™"><a href="#OSIä¸ƒå±‚æ¨¡å‹-ç›¸å…³åè®®-ç¼©å†™" class="headerlink" title="OSIä¸ƒå±‚æ¨¡å‹ ç›¸å…³åè®® ç¼©å†™"></a>OSIä¸ƒå±‚æ¨¡å‹ ç›¸å…³åè®® ç¼©å†™</h2><h3 id="åº”ç”¨å±‚-1"><a href="#åº”ç”¨å±‚-1" class="headerlink" title="åº”ç”¨å±‚"></a>åº”ç”¨å±‚</h3><p>HTTP        è¶…æ–‡æœ¬ä¼ è¾“åè®®<br>FTP         æ–‡ä»¶ä¼ è¾“åè®®<br>SMTP        ç®€å•é‚®ä»¶ä¼ è¾“åè®®<br>TELNETTCP/IP    ç»ˆç«¯ä»¿çœŸåè®®<br>POP3        é‚®å±€åè®®ç¬¬ä¸‰ç‰ˆ<br>Finger      ç”¨æˆ·ä¿¡æ¯åè®®<br>NNTP        ç½‘ç»œæ–°é—»ä¼ è¾“åè®®<br>IMAP4       å› ç‰¹ç½‘ä¿¡æ¯è®¿é—®åè®®ç¬¬å››ç‰ˆ<br>LPR UNIX    è¿œç¨‹æ‰“å°åè®®<br>Rwho UNIX   è¿œç¨‹ Whoåè®®<br>Rexec UNIX  è¿œç¨‹æ‰§è¡Œåè®®<br>Login UNIX  è¿œç¨‹ç™»é™†åè®®<br>RSH UNIX    è¿œç¨‹Shellåè®®<br>NTF HP      ç½‘ç»œæ–‡ä»¶ä¼ è¾“åè®®<br>RDA HP      è¿œç¨‹æ•°æ®åº“è®¿é—®åè®®<br>VT          è™šæ‹Ÿç»ˆç«¯ä»¿çœŸåè®®<br>RFA HP      è¿œç¨‹æ–‡ä»¶è®¿é—®åè®®<br>RPC Remote Process Comm.<br>S-HTTP      å®‰å…¨è¶…æ–‡æœ¬ä¼ è¾“åè®®<br>GDP         ç½‘å…³å‘ç°åè®®<br>X-Window<br>CMOT        åŸºäºTCP/IPçš„CMIPåè®®<br>SOCKS       å®‰å…¨å¥—æ¥å­—åè®®<br>FANP        æµå±æ€§é€šçŸ¥åè®®<br>SLP         æœåŠ¡å®šä½åè®®<br>MSN         å¾®è½¯ç½‘ç»œæœåŠ¡<br>Radius      è¿œç¨‹ç”¨æˆ·æ‹¨å·è®¤è¯æœåŠ¡åè®®<br>DNS         åŸŸåç³»ç»Ÿ<br>NFS         ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿåè®®<br>NIS SUN     ç½‘ç»œä¿¡æ¯ç³»ç»Ÿåè®®<br>R-STAT SUN  è¿œç¨‹çŠ¶æ€åè®®<br>NSM SUN     ç½‘ç»œçŠ¶æ€ç›‘æµ‹åè®®<br>PMAP SUN    ç«¯å£æ˜ å°„åè®®<br>Mount<br>LPR         UNIXè¿œç¨‹æ‰“å°åè®®</p><h4 id="å¸¸ç”¨UDPåè®®çš„åº”ç”¨å±‚æœåŠ¡"><a href="#å¸¸ç”¨UDPåè®®çš„åº”ç”¨å±‚æœåŠ¡" class="headerlink" title="å¸¸ç”¨UDPåè®®çš„åº”ç”¨å±‚æœåŠ¡"></a>å¸¸ç”¨UDPåè®®çš„åº”ç”¨å±‚æœåŠ¡</h4><p>BOOTP   å¼•å¯¼åè®®<br>DHCP    åŠ¨æ€ä¸»æœºé…å¥—åè®®<br>NTP     ç½‘ç»œæ—¶é—´åè®®<br>TFTP    ç®€å•æ–‡ä»¶ä¼ è¾“åè®®<br>SNMP    ç®€å•ç½‘ç»œç®¡ç†åè®®</p><h3 id="è¡¨ç¤ºå±‚-1"><a href="#è¡¨ç¤ºå±‚-1" class="headerlink" title="è¡¨ç¤ºå±‚"></a>è¡¨ç¤ºå±‚</h3><p>DECnet NSP<br>LPP             è½»é‡çº§è¡¨ç¤ºåè®®<br>NBSSN NetBIOS   ä¼šè¯æœåŠ¡åè®®<br>XDP             å¤–éƒ¨æ•°æ®è¡¨ç¤ºåè®®<br>IPX</p><h3 id="ä¼šè¯å±‚-1"><a href="#ä¼šè¯å±‚-1" class="headerlink" title="ä¼šè¯å±‚"></a>ä¼šè¯å±‚</h3><p>SSL     å®‰å…¨å¥—æ¥å­—å±‚åè®®<br>TLS     ä¼ è¾“å±‚å®‰å…¨åè®®<br>DAP     ç›®å½•è®¿é—®åè®®<br>LDAP    è½»é‡çº§ç›®å½•è®¿é—®åè®®<br>RPC     è¿œç¨‹è¿‡ç¨‹è°ƒç”¨åè®®<br>VINES NETRPC<br>VFRP<br>NeTBIOS<br>IPX</p><h3 id="ä¼ è¾“å±‚-1"><a href="#ä¼ è¾“å±‚-1" class="headerlink" title="ä¼ è¾“å±‚"></a>ä¼ è¾“å±‚</h3><p>XOT         åŸºäºtcpä¹‹ä¸Šçš„Xåè®®<br>Van Jacobson å‹ç¼©TCPåè®®<br>ISO-DE ISO  å¼€å‘ç¯å¢ƒâ€”â€”â€“&gt;NetBISO<br>TALI        ä¼ è¾“é€‚é…å±‚æ¥å£åè®®<br>DSIã€NetBIOSã€IP NeTBIOSã€ISO-TP SSPã€SMBã€MSRPC<br>UDP         ç”¨æˆ·æ•°æ®æŠ¥åè®®<br>RUDP        å¯é çš„ç”¨æˆ·æ•°æ®æŠ¥åè®®<br>Mobile IP   ç§»åŠ¨IPåè®®</p><h3 id="ç½‘ç»œå±‚-1"><a href="#ç½‘ç»œå±‚-1" class="headerlink" title="ç½‘ç»œå±‚"></a>ç½‘ç»œå±‚</h3><p>IP/IPv6 äº’è”ç½‘åè®®/äº’è”ç½‘åè®®ç¬¬å…­ç‰ˆ<br>ICMPv6  äº’è”ç½‘æ§åˆ¶ä¿¡æ¯åè®®ç¬¬å…­ç‰ˆ<br>ICMP    äº’è”ç½‘æ§åˆ¶ä¿¡æ¯åè®®<br>IGMP    äº’è”ç½‘ç»„ç®¡ç†åè®®<br>SLIP    ä¸²è¡Œçº¿è·¯IPåè®®</p><h4 id="å®‰å…¨åè®®"><a href="#å®‰å…¨åè®®" class="headerlink" title="å®‰å…¨åè®®"></a>å®‰å…¨åè®®</h4><p>AH  è®¤è¯å¤´åè®®<br>ESP å®‰è£…å°è£…æœ‰æ•ˆè½½è·åè®®</p><h4 id="è·¯ç”±åè®®"><a href="#è·¯ç”±åè®®" class="headerlink" title="è·¯ç”±åè®®"></a>è·¯ç”±åè®®</h4><p>EGP     å¤–éƒ¨ç½‘å…³åè®®<br>OSPF    å¼€æ”¾æœ€çŸ­è·¯å¾„ä¼˜å…ˆåè®®<br>IGRP    å†…éƒ¨ç½‘å…³è·¯ç”±åè®®<br>NHRP    ä¸‹ä¸€è·³è§£æåè®®<br>IE-IRGP     å¢å¼ºå†…éƒ¨ç½‘å…³è·¯ç”±é€‰æ‹©åè®®<br>RIPng for IPv6 IPv6è·¯ç”±ä¿¡æ¯åè®®<br>GGP     ç½‘å…³åˆ°ç½‘å…³åè®®<br>VRRP    è™šæ‹Ÿè·¯ç”±å™¨å†—ä½™åè®®<br>PGM     å®é™…é€šç”¨ç»„æ’­åè®®<br>RSVP    èµ„æºé¢„ç•™åè®®<br>PIM-DM  å¯†é›†æ¨¡å¼ç‹¬ç«‹ç»„æ’­åè®®<br>DVMRP   è·ç¦»çŸ¢é‡ç»„æ’­è·¯ç”±åè®®<br>RIP2    è·¯ç”±ä¿¡æ¯åè®®ç¬¬äºŒç‰ˆ<br>PIM-SM  ç¨€ç–æ¨¡å¼ç‹¬ç«‹ç»„æ’­åè®®<br>MOSPF   ç»„æ’­å¼€æ”¾æœ€çŸ­è·¯å¾„ä¼˜å…ˆåè®®</p><h3 id="æ•°æ®é“¾è·¯å±‚-1"><a href="#æ•°æ®é“¾è·¯å±‚-1" class="headerlink" title="æ•°æ®é“¾è·¯å±‚"></a>æ•°æ®é“¾è·¯å±‚</h3><p>MPLS    å¤šåè®®æ ‡ç­¾äº¤æ¢åè®®<br>XTP     å‹ç¼©ä¼ è¾“åè®®<br>DCAP    æ•°æ®è½¬æ¢å®¢æˆ·è®¿é—®åè®®<br>SLE     ä¸²è¡Œè¿æ¥å°è£…åè®®<br>IPinIP  IPå¥—IPå°è£…åè®®</p><h4 id="éš§é“åè®®"><a href="#éš§é“åè®®" class="headerlink" title="éš§é“åè®®"></a>éš§é“åè®®</h4><p>PPTP    ç‚¹å¯¹ç‚¹éš§é“åè®®<br>L2F     ç¬¬äºŒå±‚è½¬å‘åè®®<br>L2TP    ç¬¬äºŒå±‚éš§é“åè®®<br>ATMP    æ¥å…¥éš§é“ç®¡ç†åè®®<br>Cisco   åè®®<br>CDP     æ€ç§‘å‘ç°åè®®<br>CGMP    æ€ç§‘ç»„ç®¡ç†åè®®</p><h4 id="åœ°å€è§£æåè®®"><a href="#åœ°å€è§£æåè®®" class="headerlink" title="åœ°å€è§£æåè®®"></a>åœ°å€è§£æåè®®</h4><p>ARP     åœ°å€è§£æåè®®<br>RAR     é€†å‘åœ°å€è§£æåè®®</p><h3 id="ç‰©ç†å±‚-1"><a href="#ç‰©ç†å±‚-1" class="headerlink" title="ç‰©ç†å±‚"></a>ç‰©ç†å±‚</h3><p>IEEE        802.2<br>Ethernet    v.2<br>Internetwork</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Study </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OSI </tag>
            
            <tag> ä¸ƒå±‚æ¨¡å‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é»‘è‹¹æœå¸¸è§è¡¥ä¸</title>
      <link href="/posts/8aecf8b2/"/>
      <url>/posts/8aecf8b2/</url>
      
        <content type="html"><![CDATA[<h3 id="å…ˆè¯´è¯´æ€æ ·å¼ºåˆ¶åŠ è½½æŸä¸ªé©±åŠ¨"><a href="#å…ˆè¯´è¯´æ€æ ·å¼ºåˆ¶åŠ è½½æŸä¸ªé©±åŠ¨" class="headerlink" title="å…ˆè¯´è¯´æ€æ ·å¼ºåˆ¶åŠ è½½æŸä¸ªé©±åŠ¨"></a>å…ˆè¯´è¯´æ€æ ·å¼ºåˆ¶åŠ è½½æŸä¸ªé©±åŠ¨</h3><p>å¦‚ä¸‹ï¼Œ<code>KextToPatch</code>å¹¶åˆ—<code>ForceKextsToLoad</code>ï¼Œè®¾ç½®<code>kext</code>è·¯å¾„</p><pre><code>&lt;key&gt;ForceKextsToLoad&lt;/key&gt;&lt;array&gt;    &lt;string&gt;\System\Library\Extensions\AppleHDA.kext&lt;/string&gt;    &lt;string&gt;\Extra\Extensions&lt;/string&gt;&lt;/array&gt;</code></pre><h3 id="ç¬”è®°æœ¬æ˜¾å­˜ä¿®æ”¹è‡³2048MB"><a href="#ç¬”è®°æœ¬æ˜¾å­˜ä¿®æ”¹è‡³2048MB" class="headerlink" title="ç¬”è®°æœ¬æ˜¾å­˜ä¿®æ”¹è‡³2048MB"></a>ç¬”è®°æœ¬æ˜¾å­˜ä¿®æ”¹è‡³<code>2048MB</code></h3><blockquote><p>HD4200_4400_4600 Mobileï¼š</p></blockquote><pre><code>Nameï¼š        AppleIntelFramebufferAzulFindï¼š        01030303 00000002 00003001 00006000 00000060Replaceï¼š    01030303 00000002 00003001 00009000 00000080Comment:    1536MB -&gt; 2048MB for HD4200_4400_4600 Mobile</code></pre><blockquote><p>HD620 Mobileï¼š</p></blockquote><pre><code>Nameï¼š        AppleIntelKBLGraphicsFramebufferFindï¼š        01030303 00002002 00000000 00000060Replaceï¼š    01030303 00002002 00000000 00000080 Comment:    1536MB -&gt; 2048MB for HD620 Mobile</code></pre><blockquote><p>HD630 Mobileï¼š</p></blockquote><pre><code>Nameï¼š        AppleIntelKBLGraphicsFramebufferFindï¼š        01030303 00006002 00005001 00000060Replaceï¼š    01030303 00006002 00005001 00000080Comment:    1536MB -&gt; 2048MB for HD630 Mobile</code></pre><blockquote><p>HD520_530_540 Mobileï¼š</p></blockquote><pre><code>Nameï¼š        AppleIntelSKLGraphicsFramebufferFindï¼š        01030303 00002002 00005001 00000060Replaceï¼š    01030303 00002002 00005001 00000080Comment:    1536MB -&gt; 2048MB for HD520_530_540 Mobile</code></pre><blockquote><p>HD5500 Mobileï¼š</p></blockquote><pre><code>Nameï¼š        AppleIntelBDWGraphicsFramebuffer Find:         01030303 00002002 00005001 00000060Replace:     01030303 00002002 00005001 00000080Comment:    1536MB -&gt; 2048MB for HD5500 Mobile</code></pre><h3 id="å¼€å¯Trim"><a href="#å¼€å¯Trim" class="headerlink" title="å¼€å¯Trim"></a>å¼€å¯<code>Trim</code></h3><pre><code>Name: com.apple.iokit.IOAHCIBlockStorageFind: 00415050 4C452053 534400Replcae: 00000000 00000000 000000Comment: Enable TRIM for SSD</code></pre><h3 id="èŠ±å±è¡¥ä¸"><a href="#èŠ±å±è¡¥ä¸" class="headerlink" title="èŠ±å±è¡¥ä¸"></a>èŠ±å±è¡¥ä¸</h3><pre><code>Name: com.apple.iokit.IOGraphicsFamilyFind: 4188C4EB 11Replcae: 4188C4EB 31Comment: Boot graphics glitch, 10.10.2/10.10.3MatchOS: 10.10.2,10.10.3</code></pre><pre><code>Name: com.apple.iokit.IOGraphicsFamilyFind: 01000075 17Replcae: 010000EB 17Comment: Boot graphics glitch, 10.10.x/10.11.x (credit lisai9093, cecekpawon)MatchOS: 10.10.x,10.11.x</code></pre><pre><code>Name: com.apple.iokit.IOGraphicsFamilyFind: 01000075 25Replcae: 010000EB 25Comment: Boot graphics glitch, 10.12.dp1 (credit denskop)MatchOS: 10.12.x</code></pre><pre><code>Name: com.apple.iokit.IOGraphicsFamilyFind: 01000075 22Replcae: 010000EB 22Comment: Boot graphics glitch, 10.13 beta (based on denskop patch)MatchOS: 10.13.x</code></pre><h3 id="DVMTè¡¥ä¸"><a href="#DVMTè¡¥ä¸" class="headerlink" title="DVMTè¡¥ä¸"></a>DVMTè¡¥ä¸</h3><blockquote><p>Broadwell</p></blockquote><pre><code>Name: com.apple.driver.AppleIntelBDWGraphicsFramebufferFind: 39CF763CReplcae: 39CFEB3CComment: Disable minStolenSize less or equal fStolenMemorySize assertion, 10.10.x (based on Austere.J patch)MatchOS: 10.10.x</code></pre><pre><code>Name: com.apple.driver.AppleIntelBDWGraphicsFramebufferFind: 4139C476 3EReplcae: 4139C4EB 3EComment: Disable minStolenSize less or equal fStolenMemorySize assertion, 10.11.beta (based on Austere.J patch)MatchOS: 10.11.x</code></pre><pre><code>Name: com.apple.driver.AppleIntelBDWGraphicsFramebufferFind: 8945C839 C7764FReplcae: 8945C839 C7EB4FComment: Disable minStolenSize less or equal fStolenMemorySize assertion, 10.12.0 (based on Austere.J patch)MatchOS: 10.12.x</code></pre><pre><code>Name: com.apple.driver.AppleIntelBDWGraphicsFramebufferFind: 4C895DB8 7644Replcae: 4C895DB8 EB44Comment: Disable minStolenSize less or equal fStolenMemorySize assertion, 10.13.0/1 (credit PMHeart)MatchOS: 10.13.0,10.13.1</code></pre><pre><code>Name: com.apple.driver.AppleIntelBDWGraphicsFramebufferFind: 4C8945C0 7644Replcae: 4C8945C0 EB44Comment: Disable minStolenSize less or equal fStolenMemorySize assertion, 10.13.2/3 (credit RehabMan)MatchOS: 10.13.2,10.13.3</code></pre><blockquote><p>Skylake</p></blockquote><pre><code>Name: com.apple.driver.AppleIntelSKLGraphicsFramebufferFind: 4139C476 2AReplcae: 4139C4EB 2AComment: Disable minStolenSize less or equal fStolenMemorySize assertion, 10.11.4 (based on Austere.J patch)MatchOS: 10.11.x</code></pre><pre><code>Name: com.apple.driver.AppleIntelSKLGraphicsFramebufferFind: 8945C839 C67651Replcae: 8945C839 C6EB51Comment: Disable minStolenSize less or equal fStolenMemorySize assertion, 10.12.0 (based on Austere.J patch)MatchOS: 10.12.x</code></pre><pre><code>Name: com.apple.driver.AppleIntelSKLGraphicsFramebufferFind: 4C8955B8 7640Replcae: 4C8955B8 EB40Comment: Disable minStolenSize less or equal fStolenMemorySize assertion, 10.13.0/1 (credit PMHeart)MatchOS: 10.13.0,10.13.1</code></pre><pre><code>Name: com.apple.driver.AppleIntelSKLGraphicsFramebufferFind: 4C895DB8 7640Replcae: 4C895DB8 EB40Comment: Disable minStolenSize less or equal fStolenMemorySize assertion, 10.13.2/3 (credit PMHeart, , shdkpr2008)MatchOS: 10.13.2,10.13.3</code></pre><blockquote><p>Kabylake</p></blockquote><pre><code>Name: com.apple.driver.AppleIntelKBLGraphicsFramebufferFind: 4C895DC0 7646Replcae: 4C895DC0 EB46Comment: Disable minStolenSize less or equal fStolenMemorySize assertion, 10.13.0/1 (credit PMHeart)MatchOS: 10.13.0,10.13.1</code></pre><pre><code>Name: com.apple.driver.AppleIntelKBLGraphicsFramebufferFind: 4C896DB8 7646Replcae: 4C896DB8 EB46Comment: Disable minStolenSize less or equal fStolenMemorySize assertion, 10.13.2/3 (credit RehabMan)MatchOS: 10.13.2,10.13.3</code></pre><h3 id="ç¡¬ç›˜æ©™è‰²"><a href="#ç¡¬ç›˜æ©™è‰²" class="headerlink" title="ç¡¬ç›˜æ©™è‰²"></a>ç¡¬ç›˜æ©™è‰²</h3><pre><code>Name: AppleAHCIPortFind: 45787465 726E616CReplcae: 496E7465 726E616CComment: Define external drivers as internal to fix yellow drive icons</code></pre><h3 id="è®©æ²¡æœ‰ECCå†…å­˜çš„æœºå™¨åˆ©ç”¨MacPro4-1æˆ–è€…-MacPro5-1æœºå‹å¯åŠ¨"><a href="#è®©æ²¡æœ‰ECCå†…å­˜çš„æœºå™¨åˆ©ç”¨MacPro4-1æˆ–è€…-MacPro5-1æœºå‹å¯åŠ¨" class="headerlink" title="è®©æ²¡æœ‰ECCå†…å­˜çš„æœºå™¨åˆ©ç”¨MacPro4,1æˆ–è€… MacPro5,1æœºå‹å¯åŠ¨"></a>è®©æ²¡æœ‰<code>ECC</code>å†…å­˜çš„æœºå™¨åˆ©ç”¨<code>MacPro4,1</code>æˆ–è€… <code>MacPro5,1</code>æœºå‹å¯åŠ¨</h3><pre><code>Name: AppleTyMCEDriverFind: 720A004D 61635072 6F342C31 004D6163 50726F35 2C310058Replcae: 720A0000 00000000 00000000 00000000 00000000 00000058Comment: Allow booting with a MacPro4,1 or MacPro5,1 SMBIOS definition without ECC memory</code></pre><h3 id="ä¸‡èƒ½å£°å¡å°†Headphonesæ˜¾ç¤ºæ›¿ä»£ä¸ºTelephones"><a href="#ä¸‡èƒ½å£°å¡å°†Headphonesæ˜¾ç¤ºæ›¿ä»£ä¸ºTelephones" class="headerlink" title="ä¸‡èƒ½å£°å¡å°†Headphonesæ˜¾ç¤ºæ›¿ä»£ä¸ºTelephones"></a>ä¸‡èƒ½å£°å¡å°†<code>Headphones</code>æ˜¾ç¤ºæ›¿ä»£ä¸º<code>Telephones</code></h3><pre><code>Name: VoodooHDAFind: 48656164 70686F6E 657300Replcae: 54656C65 70686F6E 657300Comment: For VoodooHDA replacing the string Headphones with Telephones</code></pre><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Hackintosh </category>
          
      </categories>
      
      
        <tags>
            
            <tag> patch </tag>
            
            <tag> Hackintosh </tag>
            
            <tag> è¡¥ä¸ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>macOS ä¸‹ä¸€äº›å¸¸ç”¨å‘½ä»¤</title>
      <link href="/posts/fb653643/"/>
      <url>/posts/fb653643/</url>
      
        <content type="html"><![CDATA[<h3 id="Trim"><a href="#Trim" class="headerlink" title="Trim"></a>Trim</h3><blockquote><p>å¼€å¯</p></blockquote><pre><code>$ sudo trimforce enable</code></pre><blockquote><p>å…³é—­</p></blockquote><pre><code>$ sudo trimforce disable</code></pre><h3 id="æŸ¥çœ‹å¯ç”¨çš„ig-platform-id"><a href="#æŸ¥çœ‹å¯ç”¨çš„ig-platform-id" class="headerlink" title="æŸ¥çœ‹å¯ç”¨çš„ig-platform-id"></a>æŸ¥çœ‹å¯ç”¨çš„<code>ig-platform-id</code></h3><pre><code>$ ioreg -l | grep -y platform-id</code></pre><h3 id="ç¬”è®°æœ¬å¼€å¯æ’ç”µæºå‡ºæç¤ºéŸ³"><a href="#ç¬”è®°æœ¬å¼€å¯æ’ç”µæºå‡ºæç¤ºéŸ³" class="headerlink" title="ç¬”è®°æœ¬å¼€å¯æ’ç”µæºå‡ºæç¤ºéŸ³:"></a>ç¬”è®°æœ¬å¼€å¯æ’ç”µæºå‡ºæç¤ºéŸ³:</h3><blockquote><p>å¼€å¯:</p></blockquote><pre><code>$ defaults write com.apple.PowerChime ChimeOnAllHardware -bool true; open /System/Library/CoreServices/PowerChime.app &amp;</code></pre><blockquote><p>å…³é—­:</p></blockquote><pre><code>$ defaults write com.apple.PowerChime ChimeOnAllHardware -bool false; killall PowerChime</code></pre><h3 id="å»æ‰apfs-efiæœ€æ–°ç‰ˆæœ¬çš„æ—¥å¿—è°ƒè¯•æ˜¾ç¤º"><a href="#å»æ‰apfs-efiæœ€æ–°ç‰ˆæœ¬çš„æ—¥å¿—è°ƒè¯•æ˜¾ç¤º" class="headerlink" title="å»æ‰apfs.efiæœ€æ–°ç‰ˆæœ¬çš„æ—¥å¿—è°ƒè¯•æ˜¾ç¤º"></a>å»æ‰<code>apfs.efi</code>æœ€æ–°ç‰ˆæœ¬çš„æ—¥å¿—è°ƒè¯•æ˜¾ç¤º</h3><pre><code>$ cd ~/Desktop                        &amp; cp /usr/standalone/i386/apfs.efi .$ perl -i -pe 's|\x00\x74\x07\xb8\xff\xff|\x00\x90\x90\xb8\xff\xff|sg' ./apfs.efi</code></pre><h3 id="æå–æ˜¾ç¤ºå™¨EDIDåŠè®¾å¤‡IDå‚å•†ID"><a href="#æå–æ˜¾ç¤ºå™¨EDIDåŠè®¾å¤‡IDå‚å•†ID" class="headerlink" title="æå–æ˜¾ç¤ºå™¨EDIDåŠè®¾å¤‡IDå‚å•†ID"></a>æå–æ˜¾ç¤ºå™¨<code>EDID</code>åŠè®¾å¤‡<code>ID</code>å‚å•†<code>ID</code></h3><blockquote><p>EDID</p></blockquote><pre><code>$ ioreg -lw0 | grep -i "IODisplayEDID" | sed -e 's/.*&lt;//' -e 's/&gt;//'</code></pre><blockquote><p>PID</p></blockquote><pre><code>$ ioreg -l | grep "DisplayProductID"    </code></pre><blockquote><p>VID</p></blockquote><pre><code>$ ioreg -l | grep "DisplayVendorID"  </code></pre><h3 id="ä¸ºmacOS-Sierraä»¥ä¸Šçš„OS-Xå¼€å¯ä»»ä½•æ¥æº"><a href="#ä¸ºmacOS-Sierraä»¥ä¸Šçš„OS-Xå¼€å¯ä»»ä½•æ¥æº" class="headerlink" title="ä¸ºmacOS Sierraä»¥ä¸Šçš„OS Xå¼€å¯ä»»ä½•æ¥æº"></a>ä¸º<code>macOS Sierra</code>ä»¥ä¸Šçš„<code>OS X</code>å¼€å¯ä»»ä½•æ¥æº</h3><pre><code>$ sudo spctl --master-disable</code></pre><h3 id="æŸ¥çœ‹åŠ è½½çš„éå®˜æ–¹å†…æ ¸æ‰©å±•-â€“-kext"><a href="#æŸ¥çœ‹åŠ è½½çš„éå®˜æ–¹å†…æ ¸æ‰©å±•-â€“-kext" class="headerlink" title="æŸ¥çœ‹åŠ è½½çš„éå®˜æ–¹å†…æ ¸æ‰©å±• â€“ kext"></a>æŸ¥çœ‹åŠ è½½çš„éå®˜æ–¹å†…æ ¸æ‰©å±• â€“ <code>kext</code></h3><pre><code>$ kextstat | grep -v "com.apple" | grep -v Energy</code></pre><h3 id="æŸ¥çœ‹æ˜¾ç¤ºå™¨ç¡¬ä»¶ä¿¡æ¯"><a href="#æŸ¥çœ‹æ˜¾ç¤ºå™¨ç¡¬ä»¶ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹æ˜¾ç¤ºå™¨ç¡¬ä»¶ä¿¡æ¯"></a>æŸ¥çœ‹æ˜¾ç¤ºå™¨ç¡¬ä»¶ä¿¡æ¯</h3><blockquote><p>EDID</p></blockquote><pre><code>$ ioreg -l | grep "IODisplayEDID"</code></pre><blockquote><p>ProductID</p></blockquote><pre><code>$ ioreg -l | grep "DisplayProductID"</code></pre><blockquote><p>VendorID</p></blockquote><pre><code>$ ioreg -l | grep "DisplayVendorID"</code></pre><h3 id="è®¾ç½®ç³»ç»Ÿè¯­è¨€"><a href="#è®¾ç½®ç³»ç»Ÿè¯­è¨€" class="headerlink" title="è®¾ç½®ç³»ç»Ÿè¯­è¨€"></a>è®¾ç½®ç³»ç»Ÿè¯­è¨€</h3><pre><code>$ languagesetup</code></pre><h3 id="ç£ç›˜å·¥å…·"><a href="#ç£ç›˜å·¥å…·" class="headerlink" title="ç£ç›˜å·¥å…·"></a>ç£ç›˜å·¥å…·</h3><pre><code>$ diskutil $ fdisk $ df </code></pre><h3 id="kextå·¥å…·"><a href="#kextå·¥å…·" class="headerlink" title="kextå·¥å…·"></a><code>kext</code>å·¥å…·</h3><pre><code>$ kextstat $ kextfind$ kextlibs$ kextcache</code></pre><h3 id="ç³»ç»Ÿè®¾ç½®å·¥å…·"><a href="#ç³»ç»Ÿè®¾ç½®å·¥å…·" class="headerlink" title="ç³»ç»Ÿè®¾ç½®å·¥å…·"></a>ç³»ç»Ÿè®¾ç½®å·¥å…·</h3><pre><code># systemsetup</code></pre><h3 id="ç³»ç»Ÿæ§åˆ¶å·¥å…·"><a href="#ç³»ç»Ÿæ§åˆ¶å·¥å…·" class="headerlink" title="ç³»ç»Ÿæ§åˆ¶å·¥å…·"></a>ç³»ç»Ÿæ§åˆ¶å·¥å…·</h3><pre><code>$ sysctl $ sysadminctl</code></pre><h3 id="ç³»ç»ŸçŠ¶æ€æŸ¥çœ‹å·¥å…·"><a href="#ç³»ç»ŸçŠ¶æ€æŸ¥çœ‹å·¥å…·" class="headerlink" title="ç³»ç»ŸçŠ¶æ€æŸ¥çœ‹å·¥å…·"></a>ç³»ç»ŸçŠ¶æ€æŸ¥çœ‹å·¥å…·</h3><pre><code>$ systemstats $ system_profiler$ ioreg$ iostat$ bdmesg</code></pre><h3 id="nvramå·¥å…·"><a href="#nvramå·¥å…·" class="headerlink" title="nvramå·¥å…·"></a><code>nvram</code>å·¥å…·</h3><pre><code>$ nvram</code></pre><h3 id="pkgå·¥å…·"><a href="#pkgå·¥å…·" class="headerlink" title="pkgå·¥å…·"></a><code>pkg</code>å·¥å…·</h3><pre><code>$ pkgutil</code></pre><h3 id="cloverç”Ÿæˆå·¥å…·"><a href="#cloverç”Ÿæˆå·¥å…·" class="headerlink" title="cloverç”Ÿæˆå·¥å…·"></a><code>clover</code>ç”Ÿæˆå·¥å…·</h3><pre><code>$ clover-genconfig</code></pre><h3 id="æŸ¥çœ‹å¯åŠ¨å‚æ•°"><a href="#æŸ¥çœ‹å¯åŠ¨å‚æ•°" class="headerlink" title="æŸ¥çœ‹å¯åŠ¨å‚æ•°"></a>æŸ¥çœ‹å¯åŠ¨å‚æ•°</h3><pre><code>$ sysctl -n kern.bootargs </code></pre><h3 id="æŸ¥çœ‹CPUå†…æ ¸æ•°"><a href="#æŸ¥çœ‹CPUå†…æ ¸æ•°" class="headerlink" title="æŸ¥çœ‹CPUå†…æ ¸æ•°"></a>æŸ¥çœ‹<code>CPU</code>å†…æ ¸æ•°</h3><pre><code>$ sysctl -n hw.physicalcpu </code></pre><h3 id="æŸ¥çœ‹CPUçº¿ç¨‹æ•°"><a href="#æŸ¥çœ‹CPUçº¿ç¨‹æ•°" class="headerlink" title="æŸ¥çœ‹CPUçº¿ç¨‹æ•°"></a>æŸ¥çœ‹<code>CPU</code>çº¿ç¨‹æ•°</h3><pre><code>$ sysctl -n hw.logicalcpu </code></pre><h3 id="æŸ¥çœ‹æœºå‹SMBIOS"><a href="#æŸ¥çœ‹æœºå‹SMBIOS" class="headerlink" title="æŸ¥çœ‹æœºå‹SMBIOS"></a>æŸ¥çœ‹æœºå‹<code>SMBIOS</code></h3><pre><code>$ sysctl -n machdep.cpu.brand_string </code></pre><h3 id="æŸ¥çœ‹ç½‘ç»œæ˜¯å¦è¿é€š"><a href="#æŸ¥çœ‹ç½‘ç»œæ˜¯å¦è¿é€š" class="headerlink" title="æŸ¥çœ‹ç½‘ç»œæ˜¯å¦è¿é€š"></a>æŸ¥çœ‹ç½‘ç»œæ˜¯å¦è¿é€š</h3><pre><code>$ ping -c 2 www.baidu.com &amp;&gt;/dev/null&amp;&amp; echo "Internet: Connected" || echo "Internet: Disconnected" </code></pre><h3 id="æŸ¥çœ‹å½“å‰ç™»å½•ç”¨æˆ·"><a href="#æŸ¥çœ‹å½“å‰ç™»å½•ç”¨æˆ·" class="headerlink" title="æŸ¥çœ‹å½“å‰ç™»å½•ç”¨æˆ·"></a>æŸ¥çœ‹å½“å‰ç™»å½•ç”¨æˆ·</h3><pre><code>$ who </code></pre><h3 id="æŸ¥çœ‹DNS"><a href="#æŸ¥çœ‹DNS" class="headerlink" title="æŸ¥çœ‹DNS"></a>æŸ¥çœ‹<code>DNS</code></h3><pre><code>$ cat /etc/resolv.conf | sed -n '16p' | awk '{print $2}' </code></pre><h3 id="æŸ¥çœ‹IP"><a href="#æŸ¥çœ‹IP" class="headerlink" title="æŸ¥çœ‹IP"></a>æŸ¥çœ‹<code>IP</code></h3><pre><code>$ osascript -e "IPv4 address of (system info)" //å†…ç½‘$ dig +short myip.opendns.com @resolver1.opendns.com //å…¬ç½‘</code></pre><h3 id="æŸ¥çœ‹è¿è¡Œæ—¶é—´"><a href="#æŸ¥çœ‹è¿è¡Œæ—¶é—´" class="headerlink" title="æŸ¥çœ‹è¿è¡Œæ—¶é—´"></a>æŸ¥çœ‹è¿è¡Œæ—¶é—´</h3><pre><code>$ uptime | sed 's/.*up \([^,]*\), .*/\1/'</code></pre><h3 id="æŸ¥çœ‹ç”µé‡å‰©ä½™"><a href="#æŸ¥çœ‹ç”µé‡å‰©ä½™" class="headerlink" title="æŸ¥çœ‹ç”µé‡å‰©ä½™"></a>æŸ¥çœ‹ç”µé‡å‰©ä½™</h3><pre><code>$ ioreg -c AppleSmartBattery -r | awk '$1~/Capacity/{c[$1]=$3} END{OFMT="%.2f%"; max=c["\"MaxCapacity\""]; if (max&gt;0) { print 100*c["\"CurrentCapacity\""]/max;} }' </code></pre><h3 id="æŸ¥çœ‹ç”µæ± å……ç”µçŠ¶æ€"><a href="#æŸ¥çœ‹ç”µæ± å……ç”µçŠ¶æ€" class="headerlink" title="æŸ¥çœ‹ç”µæ± å……ç”µçŠ¶æ€"></a>æŸ¥çœ‹ç”µæ± å……ç”µçŠ¶æ€</h3><pre><code>$ pmset -g batt | sed -n '2p' | awk '{print $4}' | sed 's/;//g' </code></pre><h3 id="æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬"><a href="#æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬" class="headerlink" title="æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬"></a>æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬</h3><pre><code>$ sw_vers -productVersion </code></pre><h3 id="æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬å·"><a href="#æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬å·" class="headerlink" title="æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬å·"></a>æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬å·</h3><pre><code>$ sw_vers -buildVersion</code></pre><h3 id="æŸ¥çœ‹å†…å­˜å®¹é‡"><a href="#æŸ¥çœ‹å†…å­˜å®¹é‡" class="headerlink" title="æŸ¥çœ‹å†…å­˜å®¹é‡"></a>æŸ¥çœ‹å†…å­˜å®¹é‡</h3><pre><code>$ echo $(($(sysctl -n hw.memsize) / 1024 / 1024))</code></pre><h3 id="æŸ¥çœ‹æ“ä½œç³»ç»Ÿå‹å·"><a href="#æŸ¥çœ‹æ“ä½œç³»ç»Ÿå‹å·" class="headerlink" title="æŸ¥çœ‹æ“ä½œç³»ç»Ÿå‹å·"></a>æŸ¥çœ‹æ“ä½œç³»ç»Ÿå‹å·</h3><pre><code>$ sysctl -n hw.model</code></pre><h3 id="æŸ¥çœ‹å½“å‰ç³»ç»ŸçŸ­ç‰ˆæœ¬åç§°"><a href="#æŸ¥çœ‹å½“å‰ç³»ç»ŸçŸ­ç‰ˆæœ¬åç§°" class="headerlink" title="æŸ¥çœ‹å½“å‰ç³»ç»ŸçŸ­ç‰ˆæœ¬åç§°"></a>æŸ¥çœ‹å½“å‰ç³»ç»ŸçŸ­ç‰ˆæœ¬åç§°</h3><pre><code>$ xxd -ps /Applications/Utilities/System\ Information.app/Contents/MacOS/System\ Information|tr -d '\n'|perl -nle "print $&amp; if m{00$(sw_vers -productVersion|awk -F '.' '{printf $1"."$2}'|xxd -ps)00\K.*?00}"|xxd -r -p</code></pre><h3 id="å¾…ç»­â€¦"><a href="#å¾…ç»­â€¦" class="headerlink" title="å¾…ç»­â€¦"></a>å¾…ç»­â€¦</h3><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Hackintosh </category>
          
      </categories>
      
      
        <tags>
            
            <tag> command </tag>
            
            <tag> macOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç®€å•ä¿®æ”¹ FB å®ç°æ˜¾å­˜å¢åŠ è‡³ 2048MB ä¿®å¤æŸäº›èŠ±å±</title>
      <link href="/posts/94f182e4/"/>
      <url>/posts/94f182e4/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h2><p>æœ¬æ¥ä¸æ‰“ç®—å‘è¿™ä¸ªå¸–å­çš„ï¼Œå› ä¸ºå¥½å¤šäººè§‰å¾—æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œä½†å‰å‡ å¤©å¸®è®ºå›å¥½å‹é˜¿æ—è§£å†³ä»–<code>hd4600</code>èŠ±å±é—®é¢˜æ—¶ï¼Œå‘ç°è¿™ä¸ªæ–¹æ³•è¿˜æ˜¯æœ‰ä¸€å®šä½œç”¨çš„ã€‚ä¹‹å‰åœ¨<code>10.12</code>åŒºæœ‰å›å‹çš„<code>4600</code>éƒ¨åˆ†åŒºåŸŸå‡ºç°èŠ±å±çš„æƒ…å†µï¼Œæœ€åé€šè¿‡ä¿®æ”¹æ³¨å…¥çš„<code>ig</code>æ¥è§£å†³çš„ï¼Œå¤§å®¶éƒ½çŸ¥é“ï¼Œ<code>4200 4400 4600</code>éƒ½æ˜¯é <code>FakeID</code>ä¸º<code>0x04128086</code>å’Œ<code>ig</code>ä¸º<code>0x0a260006</code>ç„¶åé…åˆ<code>FakePCIID</code>å’Œ<code>FakePCIID_HD_Graphics</code>ä¸¤ä¸ª<code>kext</code>æ¥é©±åŠ¨çš„ï¼Œå¤§å®¶ä¹ŸçŸ¥é“ï¼Œä¸€éƒ¨åˆ†<code>4600</code>ä¹Ÿå¯ä»¥ç”¨<code>0x04160000</code>è€Œä¸éœ€è¦<code>FakeID</code>æ³¨å…¥æ¥é©±åŠ¨ï¼ˆç›¸åº”çš„ä¸å°‘<code>4400</code>ä¹Ÿå¯ä»¥ç”¨<code>0x0a160000</code>è€Œä¸éœ€è¦<code>FakeID</code>æ¥é©±åŠ¨ï¼‰ï¼Œä¸¤ç§æ–¹æ³•éƒ½å¯ä»¥é©±åŠ¨æ ¸æ˜¾ï¼Œä½†åŒºåˆ«è¿˜æ˜¯æœ‰çš„ï¼Œæœ€å®¹æ˜“å‘ç°çš„å°±æ˜¯æ˜¾å­˜äº†ï¼Œç¬¬ä¸€ç§æ–¹æ³•é©±åŠ¨åéƒ½æ˜¯<code>1536m</code>ï¼Œç¬¬äºŒç§åˆ™æ˜¯<code>1024m</code>ã€‚è€Œå‰é¢æåˆ°çš„<code>4600</code>éƒ¨åˆ†åŒºåŸŸèŠ±å±çš„æ¡ˆä¾‹åˆ™æ˜¯ç”¨ç¬¬äºŒç§æ–¹å¼æ¥è§£å†³çš„ï¼Œåæ¥ç»è¿‡æµ‹è¯•ï¼Œå‘ç°é€šè¿‡å¯¹<code>framebuffer</code>è¿›è¡Œ<code>patch</code>ä»¥è¾¾åˆ°<code>2048m</code>çš„æ˜¾å­˜ä¹Ÿå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œäºæ˜¯è¿™ä¸ªæ–¹æ³•å°±è¢«æˆ‘è®°åœ¨å¿ƒé‡Œäº†ã€‚åæ¥åœ¨å¸®é˜¿æ—è§£å†³äº†ä»–çš„èŠ±å±é—®é¢˜åï¼Œå†³å®šè¿˜æ˜¯æŠŠç›¸å…³æ–¹æ³•å†™å‡ºæ¥ï¼Œè™½ç„¶æ²¡ä»€ä¹ˆæŠ€æœ¯å«é‡ï¼Œä½†ä¹Ÿèƒ½ä¸ºæ™¯å‹æä¾›ä¸€ä¸ªæ€è·¯ã€‚<br>åºŸè¯å°±è¯´åˆ°è¿™ï¼Œä¸‹é¢è¯´æ–¹æ³•:</p><h2 id="å¼€å·¥"><a href="#å¼€å·¥" class="headerlink" title="å¼€å·¥"></a>å¼€å·¥</h2><h3 id="æŸ¥çœ‹FBä»¥åŠig"><a href="#æŸ¥çœ‹FBä»¥åŠig" class="headerlink" title="æŸ¥çœ‹FBä»¥åŠig"></a>æŸ¥çœ‹<code>FB</code>ä»¥åŠ<code>ig</code></h3><p>é¦–å…ˆï¼Œç¡®å®šä½ å½“å‰åŠ è½½çš„Framebufferï¼Œç»ˆç«¯æ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p><pre class="line-numbers language-bash"><code class="language-bash">$ kextstat <span class="token operator">|</span> <span class="token function">grep</span> -y AppleIntel<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypwub6t0ej31p817agtj.jpg" alt=""></p><p>å¦‚å›¾ï¼Œçœ‹è¾“å‡ºç»“æœä¸­å¸¦Framebufferçš„å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„ï¼ˆhaswellä¹‹å‰çš„æ˜¯å¸¦FBçš„ï¼‰ï¼Œå›¾ä¸­æˆ‘çš„å°±æ˜¯AppleIntelFramebufferAzulç„¶åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹å½“å‰ä½¿ç”¨çš„ig</p><pre class="line-numbers language-bash"><code class="language-bash">$ ioreg -l <span class="token operator">|</span> <span class="token function">grep</span> ig-platform-id<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypwujmt1cj31p817a479.jpg" alt=""></p><p>å¦‚å›¾æˆ‘çš„å°±æ˜¯<code>0x0a260006</code>,æœ‰æœ‹å‹ä¸æ¸…æ¥šï¼Œä¸æ˜¯<code>0600260a</code>å—ï¼Œä¸‹æ¬¡ä¸€å®šè¦çŸ¥é“ï¼Œè¿™ç§<code>id</code>å°†æ¯ä¸¤ä½ä¸€ç»„åˆ†ç»„ï¼Œç„¶åä»åå¾€å‰æ’åºï¼Œæœ€åç”±äºæ˜¯åå…­è¿›åˆ¶ï¼Œæˆ‘ä»¬åœ¨æœ€å‰é¢åŠ ä¸Š<code>0x</code>æ¥è¡¨ç¤ºï¼Œå°±å¾—å‡ºäº†<code>0x0a260006</code>ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬çš„<code>id</code>ï¼Œå½“ç„¶äº†ï¼Œåé¢æ­¥éª¤ä¸­ç”¨åˆ°çš„è¿˜æ˜¯<code>0600260a</code>ã€‚</p><h3 id="ä¸‹è½½å¹¶å®‰è£…hexfiend"><a href="#ä¸‹è½½å¹¶å®‰è£…hexfiend" class="headerlink" title="ä¸‹è½½å¹¶å®‰è£…hexfiend"></a>ä¸‹è½½å¹¶å®‰è£…<code>hexfiend</code></h3><p>æˆ‘ç›´æ¥æ”¾é“¾æ¥äº†<br>é“¾æ¥:<a href="https://pan.baidu.com/s/1EhkVv2eaUE1u_Gmp87arJw" target="_blank" rel="noopener">https://pan.baidu.com/s/1EhkVv2eaUE1u_Gmp87arJw</a>  å¯†ç :lm1o</p><h3 id="åœ¨FBä¸­æŸ¥æ‰¾igè¿›è¡Œå¤„ç†"><a href="#åœ¨FBä¸­æŸ¥æ‰¾igè¿›è¡Œå¤„ç†" class="headerlink" title="åœ¨FBä¸­æŸ¥æ‰¾igè¿›è¡Œå¤„ç†"></a>åœ¨<code>FB</code>ä¸­æŸ¥æ‰¾<code>ig</code>è¿›è¡Œå¤„ç†</h3><p>ç„¶åï¼Œåœ¨<code>/System/Library/Extensions</code>ä¸‹æ‰¾åˆ°å’Œç¬¬ä¸€æ­¥æ‰¾å‡ºçš„<code>Frambuffer</code>åŒå<code>kext</code>ï¼Œä»¥æˆ‘çš„ä¸ºä¾‹ï¼Œå°±æ˜¯<code>AppleIntelFramebufferAzul.kext</code>,å³é”®æ˜¾ç¤ºåŒ…å†…å®¹ï¼Œåœ¨<code>/Contents/MacOS</code>ä¸‹å°†<code>kext</code>çš„åŒåæ–‡ä»¶æ‹·è´åˆ°æ¡Œé¢ï¼Œä»¥æˆ‘çš„ä¸ºä¾‹å°±æ˜¯<code>AppleIntelFramebufferAzul</code>ã€‚</p><p>å³é”®æ­¤æ–‡ä»¶æ‰“å¼€æ–¹å¼é€‰æˆ‘ä»¬åˆšæ‰å®‰è£…çš„<code>hexfiend</code>ï¼Œå¿«æ·é”®<code>command + F</code>è°ƒå‡ºæœç´¢æ¡†ï¼Œè¾“å…¥åˆšæ‰åœ¨ç¬¬ä¸€æ­¥æ‰¾åˆ°çš„<code>ig</code>ï¼Œå›è½¦æœç´¢ï¼Œæ‰¾åˆ°åé¢ç´§è·Ÿ<code>01030303</code>çš„é‚£ä¸€ä¸²å­—ç¬¦ï¼Œå¦‚å›¾</p><p><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/29/165432j9e9ve5zw091q6mj.png" alt=""></p><p>ä»æœç´¢çš„<code>ig</code>åé¢ç¬¬ä¸€ä¸²å¼€å§‹ï¼Œåˆ°<code>00000060</code>ç»“æŸï¼Œå°†è¿™äº›å­—ç¬¦ä¸²æ‹·è´åˆ°ä¸€ä¸ªæ–‡æœ¬æ–‡æ¡£ï¼Œå¹¶å…«ä¸ªæ•°å­—ä¸€ç»„ï¼Œæ•´ç†å¥½ï¼Œç„¶åå†å¤åˆ¶ä¸€è¡Œï¼Œå°†ç¬¬äºŒè¡Œæœ€åçš„<code>60</code>æ”¹ä¸º<code>80</code>ï¼Œå¦‚å›¾</p><p><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/29/165830l1ji7ero3hez1js6.png" alt=""></p><p>ç¬¬ä¸€ä¸²å°±æ˜¯æˆ‘ä»¬è¦åšçš„<code>patch</code>çš„<code>Find</code>ï¼Œç¬¬äºŒä¸²æ˜¯<code>Replace</code>ï¼Œè€Œ<code>Name</code>åˆ™æ˜¯ç¬¬ä¸€æ­¥ä¸­çš„<code>Framebuffer</code>åå­—ï¼Œæˆ‘è¿™é‡Œå°±æ˜¯<code>AppleIntelFramebufferAzul</code>ï¼Œ<code>Comment</code>å°±æ— æ‰€è°“äº†ï¼Œæˆ‘å†™æˆ<code>Change VRAM from 1536MB to 2048MB for HD4400</code>ï¼Œè¿™æ—¶æˆ‘ä»¬çš„è¡¥ä¸å°±åšå¥½äº†ã€‚</p><p><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/29/170205ia9i0jppida5jai5.png" alt=""></p><p>æœ€åå°†<code>patch</code>æ‰“åˆ°<code>config.plist</code></p><p><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/29/170356xpbiyid3del3byda.png" alt=""></p><p>ç„¶åä¿å­˜é‡å¯ï¼Œå°±ä¼šå‘ç°å…³äºæœ¬æœºçš„æ˜¾å­˜ä»åŸæ¥çš„<code>1536MB</code>å˜æˆäº†<code>2048MB</code></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypwxgweqkj312s0pun6l.jpg" alt=""></p><p>å¦‚æœæ²¡æ•ˆæœï¼Œå¯ä»¥å°è¯•é‡å»ºç¼“å­˜ã€‚</p><h2 id="å¸–å­çš„æœ€åï¼Œæˆ‘å°†ä¹‹å‰åšçš„å‡ ä¸ªpatchè´´å‡ºæ¥ï¼Œå¤§å®¶å¯ä»¥å°è¯•ä½¿ç”¨"><a href="#å¸–å­çš„æœ€åï¼Œæˆ‘å°†ä¹‹å‰åšçš„å‡ ä¸ªpatchè´´å‡ºæ¥ï¼Œå¤§å®¶å¯ä»¥å°è¯•ä½¿ç”¨" class="headerlink" title="å¸–å­çš„æœ€åï¼Œæˆ‘å°†ä¹‹å‰åšçš„å‡ ä¸ªpatchè´´å‡ºæ¥ï¼Œå¤§å®¶å¯ä»¥å°è¯•ä½¿ç”¨"></a>å¸–å­çš„æœ€åï¼Œæˆ‘å°†ä¹‹å‰åšçš„å‡ ä¸ª<code>patch</code>è´´å‡ºæ¥ï¼Œå¤§å®¶å¯ä»¥å°è¯•ä½¿ç”¨</h2><blockquote><p>HD4200_4400_4600 Mobile</p></blockquote><pre><code>Nameï¼š           AppleIntelFramebufferAzulFindï¼š           01030303 00000002 00003001 00006000 00000060Replaceï¼š        01030303 00000002 00003001 00009000 00000080Commentï¼š        1536MB -&gt; 2048MB for HD4200_4400_4600 Mobile</code></pre><blockquote><p>HD620 Mobileï¼š</p></blockquote><pre><code>Nameï¼š           AppleIntelKBLGraphicsFramebufferFindï¼š           01030303 00002002 00000000 00000060Replaceï¼š        01030303 00002002 00000000 00000080 Commentï¼š        1536MB -&gt; 2048MB for HD620 Mobile</code></pre><blockquote><p>HD630 Mobileï¼š</p></blockquote><pre><code>Nameï¼š           AppleIntelKBLGraphicsFramebufferFindï¼š           01030303 00006002 00005001 00000060Replaceï¼š        01030303 00006002 00005001 00000080Commentï¼š        1536MB -&gt; 2048MB for HD630 Mobile</code></pre><blockquote><p>HD520_530_540 Mobileï¼š</p></blockquote><pre><code>Nameï¼š           AppleIntelSKLGraphicsFramebufferFindï¼š           01030303 00002002 00005001 00000060Replaceï¼š        01030303 00002002 00005001 00000080Commentï¼š        1536MB -&gt; 2048MB for HD520_530_540 Mobile</code></pre><blockquote><p>HD5500 Mobileï¼š</p></blockquote><pre><code>Nameï¼š           AppleIntelBDWGraphicsFramebuffer findï¼š           01030303 00002002 00005001 00000060Replaceï¼š        01030303 00002002 00005001 00000080Commentï¼š        1536MB -&gt; 2048MB for HD5500 Mobile</code></pre><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Hackintosh </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ˜¾å­˜ </tag>
            
            <tag> FB </tag>
            
            <tag> èŠ±å± </tag>
            
            <tag> Framebuffer </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>macOS ä¿®æ”¹å¸æˆ·åã€ä¸»æœºåå’Œè®¡ç®—æœºå</title>
      <link href="/posts/bd12634f/"/>
      <url>/posts/bd12634f/</url>
      
        <content type="html"><![CDATA[<h3 id="å¸æˆ·ä¿¡æ¯ä¿®æ”¹"><a href="#å¸æˆ·ä¿¡æ¯ä¿®æ”¹" class="headerlink" title="å¸æˆ·ä¿¡æ¯ä¿®æ”¹"></a>å¸æˆ·ä¿¡æ¯ä¿®æ”¹</h3><pre><code>System Preferences &gt; Users &amp; Groups &gt; å³å•å‡»å½“å‰ç”¨æˆ· &gt; Advanced Options</code></pre><p><em>æ³¨æ„ï¼šç”¨äº†ä¸€æ®µæ—¶é—´çš„ç”µè„‘ä¸å»ºè®®ä¿®æ”¹ï¼Œå¯èƒ½ä¼šå¯¼è‡´å¾ˆå¤šè½¯ä»¶è¦é‡æ–°å®‰è£…ã€‚</em></p><h3 id="ä¸»æœºåä¿®æ”¹"><a href="#ä¸»æœºåä¿®æ”¹" class="headerlink" title="ä¸»æœºåä¿®æ”¹"></a>ä¸»æœºåä¿®æ”¹</h3><pre><code>$ sudo scutil --set HostName MacBookPro</code></pre><h3 id="è®¡ç®—æœºåä¿®æ”¹"><a href="#è®¡ç®—æœºåä¿®æ”¹" class="headerlink" title="è®¡ç®—æœºåä¿®æ”¹"></a>è®¡ç®—æœºåä¿®æ”¹</h3><pre><code>$ sudo scutil --set ComputerName MacBookPro</code></pre><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Hackintosh </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è´¦æˆ·å </tag>
            
            <tag> ä¸»æœºå </tag>
            
            <tag> è®¡ç®—æœºå </tag>
            
            <tag> mac </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>0-1èƒŒåŒ…é—®é¢˜</title>
      <link href="/posts/72b23132/"/>
      <url>/posts/72b23132/</url>
      
        <content type="html"><![CDATA[<h3 id="é€’å½’"><a href="#é€’å½’" class="headerlink" title="é€’å½’"></a>é€’å½’</h3><pre class="line-numbers language-c"><code class="language-c"><span class="token comment" spellcheck="true">//</span><span class="token comment" spellcheck="true">//  main.c</span><span class="token comment" spellcheck="true">//  algorithm</span><span class="token comment" spellcheck="true">//</span><span class="token comment" spellcheck="true">//  Created by athlonreg on 17/01/2018.</span><span class="token comment" spellcheck="true">//  Copyright Â© 2018 athlonreg. All rights reserved.</span><span class="token comment" spellcheck="true">//</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">define</span> n 5</span><span class="token macro property">#<span class="token directive keyword">define</span> c 10</span><span class="token keyword">int</span> weight<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span> value<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span><span class="token keyword">int</span> j<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> m1<span class="token punctuation">,</span>m2<span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">==</span>n<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>j<span class="token operator">>=</span>weight<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> value<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>j<span class="token operator">&lt;</span>weight<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token function">f</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>    m1<span class="token operator">=</span><span class="token function">f</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>    m2<span class="token operator">=</span><span class="token function">f</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>j<span class="token operator">-</span>weight<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span>value<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> m1<span class="token operator">></span>m2<span class="token operator">?</span>m1<span class="token punctuation">:</span>m2<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è¿è¡Œç»“æœ"><a href="#è¿è¡Œç»“æœ" class="headerlink" title="è¿è¡Œç»“æœ"></a>è¿è¡Œç»“æœ</h3><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypv22cywpj32c01fewvf.jpg" alt=""></p><h3 id="åŠ¨æ€è§„åˆ’"><a href="#åŠ¨æ€è§„åˆ’" class="headerlink" title="åŠ¨æ€è§„åˆ’"></a>åŠ¨æ€è§„åˆ’</h3><pre><code>////  main.c//  algorithm////  Created by athlonreg on 17/01/2018.//  Copyright Â© 2018 athlonreg. All rights reserved.//#include &lt;stdio.h&gt;#define n 5#define c 10int weight[n]={2,2,6,5,4}, value[n]={6,3,5,4,6};int main(int argc, const char * argv[]) {    int s[n][c+1];    int i,j;    for(j=0;j&lt;=c;j++){        if(j&gt;weight[n-1])            s[n-1][j]=value[n-1];        else            s[n-1][j]=0;    }    for(i=n-2;i&gt;=0;i--){        for(j=0;j&lt;=c;j++){            if(j&lt;weight[i])                s[i][j]=s[i+1][j];            else                s[i][j]=s[i+1][j]&gt;(s[i+1][j-weight[i]]+value[i])?s[i+1][j]:(s[i+1][j-weight[i]]+value[i]);        }    }    printf("%d\n",s[0][c]);    return 0;}</code></pre><h3 id="è¿è¡Œç»“æœ-1"><a href="#è¿è¡Œç»“æœ-1" class="headerlink" title="è¿è¡Œç»“æœ"></a>è¿è¡Œç»“æœ</h3><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypv4po8i8j32c01fetpm.jpg" alt=""></p><h3 id="å›æº¯"><a href="#å›æº¯" class="headerlink" title="å›æº¯"></a>å›æº¯</h3><pre><code>////  main.c//  algorithm////  Created by athlonreg on 17/01/2018.//  Copyright Â© 2018 athlonreg. All rights reserved.//#include &lt;stdio.h&gt;#define n 5#define c 10int weight[n]={2,2,6,5,4}, value[n]={6,3,5,4,6};int maxvalue, tempvalue, tempweight;void traceback(int t){    if(t==n){        if(tempvalue&gt;maxvalue)            maxvalue=tempvalue;        return;    }    if(tempweight+weight[t]&lt;=c){        tempweight+=weight[t];        tempvalue+=value[t];        traceback(t+1);        tempweight-=weight[t];        tempvalue-=value[t];    }    traceback(t+1);}int main(int argc, const char * argv[]) {    traceback(0);    printf("%d\n",maxvalue);    return 0;}</code></pre><h3 id="è¿è¡Œç»“æœ-2"><a href="#è¿è¡Œç»“æœ-2" class="headerlink" title="è¿è¡Œç»“æœ"></a>è¿è¡Œç»“æœ</h3><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fyq1iqgsbfj32c01fedwn.jpg" alt=""></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 0-1èƒŒåŒ…é—®é¢˜ </tag>
            
            <tag> algorithm </tag>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>n çš‡åé—®é¢˜</title>
      <link href="/posts/9ae8a9e0/"/>
      <url>/posts/9ae8a9e0/</url>
      
        <content type="html"><![CDATA[<h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><pre class="line-numbers language-c"><code class="language-c"><span class="token comment" spellcheck="true">//</span><span class="token comment" spellcheck="true">//  main.c</span><span class="token comment" spellcheck="true">//  algorithm</span><span class="token comment" spellcheck="true">//</span><span class="token comment" spellcheck="true">//  Created by athlonreg on 17/01/2018.</span><span class="token comment" spellcheck="true">//  Copyright Â© 2018 athlonreg. All rights reserved.</span><span class="token comment" spellcheck="true">//</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;math.h></span></span><span class="token macro property">#<span class="token directive keyword">define</span> n 8</span><span class="token keyword">int</span> a<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">judge</span><span class="token punctuation">(</span><span class="token keyword">int</span> t<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>t<span class="token operator">==</span>n<span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>t<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span>t<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>a<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>                <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>i<span class="token operator">-</span>j<span class="token punctuation">)</span><span class="token operator">==</span><span class="token function">abs</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span>a<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">traceback</span><span class="token punctuation">(</span><span class="token keyword">int</span> t<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>t<span class="token operator">==</span>n<span class="token punctuation">)</span><span class="token punctuation">{</span>        count<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%3d"</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        a<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token operator">=</span>i<span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">judge</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token function">traceback</span><span class="token punctuation">(</span>t<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token function">traceback</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è¿è¡Œç»“æœ"><a href="#è¿è¡Œç»“æœ" class="headerlink" title="è¿è¡Œç»“æœ"></a>è¿è¡Œç»“æœ</h3><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypy499b85j32c01fewv3.jpg" alt=""></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> algorithm </tag>
            
            <tag> ç®—æ³• </tag>
            
            <tag> nçš‡åé—®é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çŸ©é˜µè¿ä¹˜é—®é¢˜</title>
      <link href="/posts/30df953c/"/>
      <url>/posts/30df953c/</url>
      
        <content type="html"><![CDATA[<h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><pre class="line-numbers language-c"><code class="language-c"><span class="token comment" spellcheck="true">//</span><span class="token comment" spellcheck="true">//  main.c</span><span class="token comment" spellcheck="true">//  RecurMatrix</span><span class="token comment" spellcheck="true">//</span><span class="token comment" spellcheck="true">//  Created by Canvas on 2018/12/31.</span><span class="token comment" spellcheck="true">//  Copyright Â© 2018 Canvas. All rights reserved.</span><span class="token comment" spellcheck="true">//</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">define</span> n 6</span><span class="token keyword">int</span> a<span class="token punctuation">[</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">35</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">int</span> b<span class="token punctuation">[</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">RecurMatrix</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> j<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">==</span>j<span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> minvalue<span class="token operator">=</span><span class="token function">RecurMatrix</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">RecurMatrix</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token operator">+</span>a<span class="token punctuation">[</span>i<span class="token number">-1</span><span class="token punctuation">]</span><span class="token operator">*</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span>a<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>    b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>i<span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>k<span class="token operator">&lt;</span>j<span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">int</span> tempvalue<span class="token operator">=</span><span class="token function">RecurMatrix</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">RecurMatrix</span><span class="token punctuation">(</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token operator">+</span>a<span class="token punctuation">[</span>i<span class="token number">-1</span><span class="token punctuation">]</span><span class="token operator">*</span>a<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">*</span>a<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>tempvalue<span class="token operator">&lt;</span>minvalue<span class="token punctuation">)</span><span class="token punctuation">{</span>            minvalue<span class="token operator">=</span>tempvalue<span class="token punctuation">;</span>            b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>k<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> minvalue<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">traceback</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> j<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">==</span>j<span class="token punctuation">)</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token function">traceback</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">traceback</span><span class="token punctuation">(</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"A[%d-%d]*A[%d-%d]\n"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">RecurMatrix</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">traceback</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è¿è¡Œç»“æœ"><a href="#è¿è¡Œç»“æœ" class="headerlink" title="è¿è¡Œç»“æœ"></a>è¿è¡Œç»“æœ</h3><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypywc48exj32c01fe7ml.jpg" alt=""></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> algorithm </tag>
            
            <tag> ç®—æ³• </tag>
            
            <tag> çŸ©é˜µè¿ä¹˜é—®é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äºŒåˆ†æŸ¥æ‰¾</title>
      <link href="/posts/e8eb0481/"/>
      <url>/posts/e8eb0481/</url>
      
        <content type="html"><![CDATA[<h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><pre class="line-numbers language-c"><code class="language-c"><span class="token comment" spellcheck="true">//</span><span class="token comment" spellcheck="true">//  main.c</span><span class="token comment" spellcheck="true">//  algorithm</span><span class="token comment" spellcheck="true">//</span><span class="token comment" spellcheck="true">//  Created by athlonreg on 17/01/2018.</span><span class="token comment" spellcheck="true">//  Copyright Â© 2018 athlonreg. All rights reserved.</span><span class="token comment" spellcheck="true">//</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">define</span> n 5</span><span class="token keyword">int</span> arr<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">BinarySearch</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> low<span class="token punctuation">,</span> <span class="token keyword">int</span> high<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>low<span class="token operator">&lt;</span>high<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">int</span> mid<span class="token operator">=</span><span class="token punctuation">(</span>low<span class="token operator">+</span>high<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>mid<span class="token punctuation">]</span><span class="token operator">==</span>k<span class="token punctuation">)</span>            <span class="token keyword">return</span> mid<span class="token punctuation">;</span>        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>mid<span class="token punctuation">]</span><span class="token operator">></span>k<span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token function">BinarySearch</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> low<span class="token punctuation">,</span> mid<span class="token number">-1</span><span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            <span class="token keyword">return</span> <span class="token function">BinarySearch</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> high<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> x<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">BinarySearch</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> n<span class="token number">-1</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è¿è¡Œç»“æœ"><a href="#è¿è¡Œç»“æœ" class="headerlink" title="è¿è¡Œç»“æœ"></a>è¿è¡Œç»“æœ</h3><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypvgc3ii4j32701f64fp.jpg" alt=""></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> algorithm </tag>
            
            <tag> ç®—æ³• </tag>
            
            <tag> äºŒåˆ†æŸ¥æ‰¾ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Clover ACPI hotpatch</title>
      <link href="/posts/991f5d00/"/>
      <url>/posts/991f5d00/</url>
      
        <content type="html"><![CDATA[<h2 id="Prefaceâ€“åºè¨€"><a href="#Prefaceâ€“åºè¨€" class="headerlink" title="Prefaceâ€“åºè¨€"></a>Prefaceâ€“åºè¨€</h2><p>This blog is created by me to introduce how to using Clover to hotpatch ACPIï¼Œand provide an Chinese versionã€‚</p><blockquote><p>æˆ‘å†™è¿™ç¯‡åšå®¢æ˜¯ä¸ºäº†ä»‹ç»å¦‚ä½•ä½¿ç”¨<code>Clover</code>å¯¹<code>ACPI</code>ä½¿ç”¨<code>hotpatch</code>ï¼Œå¹¶ç¿»è¯‘åŸè´´æä¾›ä¸­æ–‡å‚è€ƒå¸–ã€‚</p></blockquote><h2 id="Brief-description-for-hotpatchâ€“hotpatchæ¦‚è¦"><a href="#Brief-description-for-hotpatchâ€“hotpatchæ¦‚è¦" class="headerlink" title="Brief description for hotpatchâ€“hotpatchæ¦‚è¦"></a>Brief description for hotpatchâ€“<code>hotpatch</code>æ¦‚è¦</h2><p>In RehabManâ€™s GitHub homepage, a repository named <code>OS-X-Clover-Laptop-Config</code> Contains some Clover <code>config.plist</code> for common Intel graphics and hotpatch for common configurations.More information in <a href="https://github.com/RehabMan/OS-X-Clover-Laptop-Config" target="_blank" rel="noopener">here</a>.</p><blockquote><p><code>RehabMan</code>çš„<code>GitHub</code>æœ‰ä¸€ä¸ªä»“åº“â€“<code>OS-X-Clover-Laptop-Config</code>,é‡Œé¢åŒ…å«äº†ä¸€äº›é€‚ç”¨äºå¸¸è§çš„è‹±ç‰¹å°”æ ¸èŠ¯æ˜¾å¡çš„<code>config.plist</code>,è¿˜æœ‰<code>hotpatch</code>ã€‚ç‚¹å‡»<a href="https://github.com/RehabMan/OS-X-Clover-Laptop-Config" target="_blank" rel="noopener">è¿™é‡Œ</a>äº†è§£æ›´å¤šã€‚</p></blockquote><p>There are some handy SSDTs for use with Clover ACPI hotpatch (in conjunction with hotpatch/config.plist) If you understand ACPI, you may find the SSDTs and hotpatch/config.plist quite useful.</p><blockquote><p>è¿™å„¿æœ‰è®¸å¤šé’ˆå¯¹ä½¿ç”¨Clover ACPI hotpatch(è¿åŒä½¿ç”¨hotpatch/config.plist)çš„SSDTã€‚å¦‚æœä½ ç†è§£äº†ACPIï¼Œä½ ä¼šå‘ç°è¿™äº›<code>SSDT</code>å’Œ<code>hotpatch/config.plist</code>ç›¸å½“é‡è¦ã€‚</p></blockquote><p>Read here for the hotpatch guide: <a href="https://www.tonymacx86.com/threads/guide-using-clover-to-hotpatch-acpi.200137/" target="_blank" rel="noopener">https://www.tonymacx86.com/threads/guide-using-clover-to-hotpatch-acpi.200137/</a></p><blockquote><p>è¿™é‡Œæ˜¯<code>hotpatch</code>çš„â€˜å…¥é—¨å¼•å¯¼è´´ã€‚<br><a href="https://www.tonymacx86.com/threads/guide-using-clover-to-hotpatch-acpi.200137/" target="_blank" rel="noopener">https://www.tonymacx86.com/threads/guide-using-clover-to-hotpatch-acpi.200137/</a></p></blockquote><h2 id="A-brief-description-of-each-hotpatch-SSDT-is-provided-belowâ€“ä¸‹é¢æ˜¯æ¯ä¸€ä¸ª-hotpatch-SSDT-çš„æ¦‚è¦"><a href="#A-brief-description-of-each-hotpatch-SSDT-is-provided-belowâ€“ä¸‹é¢æ˜¯æ¯ä¸€ä¸ª-hotpatch-SSDT-çš„æ¦‚è¦" class="headerlink" title="A brief description of each hotpatch SSDT is provided belowâ€“ä¸‹é¢æ˜¯æ¯ä¸€ä¸ª hotpatch SSDT çš„æ¦‚è¦"></a>A brief description of each hotpatch SSDT is provided belowâ€“ä¸‹é¢æ˜¯æ¯ä¸€ä¸ª <code>hotpatch SSDT</code> çš„æ¦‚è¦</h2><p><code>SSDT-Config.dsl</code>: This file provides configuration data for other SSDTs. Read the comments within the file for more information.</p><blockquote><p><code>SSDT-Config.dsl</code>:è¿™ä¸ªæ–‡ä»¶ä¸ºå…¶ä»–<code>SSDT</code>æä¾›å‚æ•°ã€‚è¯·é˜…è¯»æ–‡ä»¶ä¸­çš„æ³¨é‡Šä»¥è·å¾—æ›´å¤šä¿¡æ¯ã€‚</p></blockquote><p><code>SSDT-Debug.dsl</code>: This SSDT is for use with ACPIDebug.kext. Instead of patching your DSDT to add the RMDT device, you can use this SSDT and refer to the methods with External. See ACPIDebug.kext documentation for more information regarding the RMDT methods.</p><blockquote><p>è¿™ä¸ª<code>SSDT</code>å’Œ<code>ACPIDebug.kext</code>ä¸€èµ·ä½¿ç”¨ã€‚ä¸éœ€è¦å¯¹ä½ çš„<code>DSDT</code>æ‰“è¡¥ä¸å¢åŠ <code>RMDT</code>è®¾å¤‡ï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ª<code>SSDT</code>é€šè¿‡<code>External</code>å¯¼å…¥è¿™ä¸ªæ–¹æ³•ã€‚å…³äº<code>RMDT</code>æ–¹æ³•ï¼Œè¦äº†è§£æ›´å¤šè¯·å‚é˜…<code>ACPIDebug.kext</code>æ–‡æ¡£ã€‚</p></blockquote><p><code>SSDT-XOSI.dsl</code>: This SSDT provides the XOSI method, which is a replacement for the system provided _OSI object when the _OSI-&gt;XOSI patch is being used. This is actually one of the examples in the Clover ACPI hotpatch guide, linked above.</p><blockquote><p>è¿™ä¸ª<code>SSDT</code>æä¾›äº†<code>XOSI</code>æ–¹æ³•ï¼Œå½“æ‰“äº†<code>_OSI-&gt;XOSI</code>è¡¥ä¸æ—¶ï¼Œ<code>XOSI</code>æ–¹æ³•ä¼šæ›¿æ¢ç³»ç»Ÿæä¾›çš„<code>_OSI</code>å¯¹è±¡ã€‚å®é™…ä¸Šï¼Œè¿™å°±æ˜¯<code>Clover ACPI hotpatch</code>å…¥é—¨å‚è€ƒå¸–çš„ä¸€ä¸ªä¾‹å­ï¼Œé“¾æ¥åœ¨ä¸‹é¢ã€‚</p></blockquote><p>SSDT-IGPU.dsl This SSDT injects Intel GPU properties depending on the configuration data in SSDT-Config and the device-id that is discovered to be present on the system. It assumes the IGPU is named IGPU (typical is GFX0, requring GFX0-&gt;IGPU rename). Configured with RMCF.TYPE, RMCF.HIGH, RMCF.IGPI, and SSDT-SkylakeSpoof.aml.</p><blockquote><p>è¿™ä¸ª<code>SSDT</code>æ ¹æ®<code>SSDT-config</code>çš„é…ç½®æ•°æ®å’Œç³»ç»Ÿä¸­å‘ç°çš„è®¾å¤‡idæ³¨å…¥äº†Intel GPUâ€“æ ¸èŠ¯æ˜¾å¡å±æ€§ã€‚å®ƒå‡å®š<code>IGPU</code>è¢«å‘½åæˆ<code>IGPU</code>(é€šå¸¸æ˜¯<code>GFX0</code>ï¼Œéœ€è¦é‡å‘½å<code>GFX0-&gt;IGPU</code>)ã€‚é€šè¿‡<code>RMCF.TYPE, RMCF.HIGH, RMCF.IGPI, and SSDT-SkylakeSpoof.aml</code>æ¥é…ç½®ã€‚</p></blockquote><p><code>SSDT-SkylakeSpoof.aml</code>: This SSDT is an optional SSDT that can be paired with SSDT-IGPU.dsl. When present, SSDT-IGPU uses the data within as an override for various KabyLake graphics devices which spoofs those devices as Skylake. Prior to 10.12.6, Skylake spoofing is the only option for KabyLake graphics. And even with 10.12.6 (or later, including 10.13.x), it still may be useful to spoof KabyLake graphics as Skyake. Keep in mind complete Skylake spoofing requires FakePCIID.kext + FakePCIID_Intel_HD_Graphics.kext.</p><blockquote><p>è¿™ä¸ª<code>SSDT</code>æ˜¯ä¸€ä¸ªå¯é€‰çš„<code>SSDT</code>,å®ƒå¯ä»¥é…åˆ<code>SSDT-IGPU.dsl</code>ä½¿ç”¨ã€‚<code>SSDT-IGPU</code>ä½¿ç”¨è¿™äº›æ•°æ®å¯¹<code>KabyLake</code>å›¾å½¢è®¾å¤‡çš„æ•°æ®è¿›è¡Œè¦†ç›–é‡å†™ï¼ŒæŠŠ<code>KabyLake</code>ä»¿å†’æˆ<code>Skylake</code>ã€‚10.12.6ä¹‹å‰,<code>KabyLake</code>åªæœ‰ä»¿å†’æˆâ€™SkyLakeâ€™é©±åŠ¨æ ¸æ˜¾ï¼Œå³ä½¿åœ¨10.12.6ä¹‹å(æˆ–è€…æ›´æ–°çš„ç‰ˆæœ¬ï¼ŒåŒ…æ‹¬10.13.x)ï¼Œå°†<code>KabyLake</code>ä»¿å†’æˆâ€™SkyLakeâ€™ä»ç„¶æ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯å®Œæ•´çš„ä»¿å†’éœ€è¦<code>FakePCIID.kext + FakePCIID_Intel_HD_Graphics.kext</code>ã€‚</p></blockquote><p><code>SSDT-IMEI.dsl</code>: This SSDT injects fake device-id as required for IMEI when using mixed HD3000/7-series or HD4000/6-series. Be sure to read the comments within carefully, as customization is required if your system already has an IMEI identity in ACPI.</p><blockquote><p>å½“ä½¿ç”¨æ··åˆçš„hd3000/7ç³»æˆ–hd4000/6ç³»æ—¶ï¼Œè¯¥SSDTä¸ºIMEIæ³¨å…¥äº†ä»¿å†’çš„è®¾å¤‡idã€‚ä¸€å®šè¦ä»”ç»†é˜…è¯»æ³¨é‡Šï¼Œå› ä¸ºå¦‚æœæ‚¨çš„ç³»ç»Ÿå·²ç»åœ¨ACPIä¸­æœ‰äº†IMEIæ ‡è¯†ï¼Œé‚£ä¹ˆå°±éœ€è¦è¿›è¡Œå®šåˆ¶ã€‚</p></blockquote><p><code>SSDT-PNLF.dsl</code>: This SSDT injects a PNLF device that works with IntelBacklight.kext or AppleBacklight.kext. Configured with RMCF.BKLT, RMCF.LMAX, RMCF.FBTP. See guide for more information: <a href="https://www.tonymacx86.com/threads/guide-laptop-backlight-control-using-applebacklightinjector-kext.218222/" target="_blank" rel="noopener">https://www.tonymacx86.com/threads/guide-laptop-backlight-control-using-applebacklightinjector-kext.218222/</a></p><blockquote><p>è¿™ä¸ªSSDTæ³¨å…¥äº†ä¸€ä¸ª<code>PNLF</code>è®¾å¤‡ï¼Œå®ƒå¯ä»¥ä¸<code>IntelBacklight.kext</code> æˆ–è€…<code>AppleBacklight.kext</code>ä¸€èµ·å·¥ä½œã€‚é€šè¿‡<code>RMCF.BKLT</code> ,<code>RMCF.LMAX</code> <code>RMCF.FBTP</code>ã€‚æ›´å¤šä¿¡æ¯å‚è§æŒ‡å—:</p></blockquote><p><code>SSDT-LPC.dsl</code>:This SSDT injects properties to force AppleLPC to load for various unsupported LPC device-ids. It assumes the LPC device is named LPCB.</p><blockquote><p>è¿™ä¸ªSSDT:æ³¨å…¥å±æ€§ä»¥å¼ºåˆ¶<code>AppleLPC</code>åŠ è½½å„ç§ä¸æ”¯æŒçš„<code>LPC</code>è®¾å¤‡idã€‚éœ€è¦<code>LPC</code>è®¾å¤‡è¢«å‘½åä¸º<code>LPCB</code>ã€‚</p></blockquote><p><code>SSDT-SATA.dsl</code>: This SSDT injects properties (fake device-id, compatible) to enable the SATA controller with certain unsupported SATA controllers. It assumes the SATA device is named SATA (typical is SAT0, thus requiring SAT0-&gt;SATA rename).</p><blockquote><p>è¿™ä¸ªSSDTæ³¨å…¥äº†ä¸€äº›å±æ€§(ä»¿å†’çš„è®¾å¤‡idï¼Œå…¼å®¹çš„)ï¼Œä»¥ä½¿æŸäº›ä¸å—æ”¯æŒçš„<code>SATA</code>æ§åˆ¶å™¨å¯ç”¨<code>SATA</code>æ§åˆ¶å™¨ã€‚å®ƒå‡è®¾<code>SATA</code>è®¾å¤‡è¢«å‘½åä¸º<code>SATA</code>(å¸¸è§çš„æ˜¯<code>SAT0</code>ï¼Œå› æ­¤éœ€è¦<code>SAT0-SATA</code>é‡å‘½å)ã€‚</p></blockquote><p><code>SSDT-Disable_DGPU.dsl</code>: This SSDT provides an _INI method that will call _OFF for a couple of common paths for a discrete GPU in a switched/dual GPU scenario. This SSDT can work to disable the Nvidia or AMD graphics device, if the path matches (or is modified to math) and your _OFF method code path has no EC related code. Refer to the hotpatch guide for a complete example.</p><blockquote><p>è¿™ä¸ªSSDTæä¾›äº†ä¸€ä¸ª<code>INI</code>æ–¹æ³•ï¼Œå®ƒå°†åœ¨å¯åˆ‡æ¢çš„/åŒ<code>GPU</code>ä¸­ä¸ºç‹¬ç«‹æ˜¾å¡æä¾›ä¸€äº›é€šç”¨çš„è·¯å¾„æ¥è°ƒç”¨<code>_OFF</code>ã€‚å¦‚æœè·¯å¾„åŒ¹é…(æˆ–è¢«è‡ªå®šä¹‰æ¥åŒ¹é…)è€Œä¸”ä½ çš„<code>_OFF</code>æ–¹æ³•ä»£ç è·¯å¾„åˆ™æ²¡æœ‰ä¸<code>EC</code>ç›¸å…³çš„ä»£ç ï¼Œé‚£ä¹ˆè¿™ä¸ª<code>SSDT</code>å¯ä»¥ç¦ç”¨<code>Nvidia</code>æˆ–<code>AMD</code>å›¾å½¢è®¾å¤‡ã€‚æœ‰å…³ä¸€ä¸ªå®Œæ•´çš„ç¤ºä¾‹ï¼Œè¯·å‚é˜…çƒ­è¡¥ä¸æŒ‡å—ã€‚</p></blockquote><p><code>SSDT-SMBUS.dsl</code>:This SSDT injects the missing DVL0 device. Mostly used with Sandy Bridge and Ivy Bridge systems.</p><blockquote><p>è¿™ä¸ªSSDTæ³¨å…¥äº†ä¸¢å¤±çš„<code>DVL0</code>è®¾å¤‡ã€‚ä¸»è¦ç”¨äº<code>Sandy Bridge</code>å’Œ<code>Ivy Bridge</code>å¹³å°ã€‚</p></blockquote><p><code>SSDT-GPRW.dsl</code> and <code>SSDT-UPRW.dsl</code>: These SSDTs is used in conjuction with the GPRW-&gt;XPRW or UPRW-&gt;XPRW patch. Used together this SSDT can fix â€œinstant-wakeâ€ by disabling â€œwake on USBâ€. It overrides the _PRW package return for GPE indexes 0x0d or 0x6d. Potential companion patches are provided in hotpatch/config.plist</p><blockquote><p>è¿™äº›SSDTä¸<code>GPRW-XPRW</code>æˆ–<code>UPRW-XPRW</code>è¡¥ä¸ä¸€èµ·ä½¿ç”¨ã€‚é€šè¿‡ä½¿ç”¨è¿™äº›<code>SSDT</code>ï¼Œå¯ä»¥é€šè¿‡ç¦ç”¨<code>wake on USB</code>æ¥ä¿®å¤<code>instant wake</code>ã€‚å®ƒé‡å†™äº†<code>GPE</code>çš„ç´¢å¼•<code>0x0d</code>æˆ–<code>0x6d</code>çš„<code>PRW</code>åŒ…è¿”å›å€¼ã€‚åœ¨<code>hotpatch</code>/<code>config.plist</code>ä¸­æä¾›äº†æ½œåœ¨çš„ä¼™ä¼´è¡¥ä¸ã€‚</p></blockquote><p><code>SSDT-LANC_PRW.dsl</code>: Also part of fixing â€œinstant wakeâ€, but this is for _PRW on the Ethernet device. Potential companion patches are provided in hotpatch/config.plist.</p><blockquote><p>è¿™ä¹Ÿæ˜¯ä¿®å¤<code>instant wake</code>çš„ä¸€éƒ¨åˆ†ï¼Œä½†è¿™æ˜¯åœ¨ä»¥å¤ªç½‘è®¾å¤‡ä¸Šè¿›è¡Œä¿®å¤çš„ã€‚åœ¨<code>hotpatch</code>/<code>config.plist</code>ä¸­æä¾›äº†æ½œåœ¨çš„ä¼™ä¼´è¡¥ä¸ã€‚</p></blockquote><p><code>SSDT-PTSWAK.dsl</code>: This SSDT provides overrides for both _PTS and _WAK. When combined with the appropriate companion patches from hotpatch/config.plist, these methods can provide various fixes. The actions are controlled by RMCF.DPTS, RMCF.SHUT, RMCF.XPEE, RMCF.SSTF. Refer to SSDT-Config.dsl for more information on those options.</p><blockquote><p>è¿™ä¸ªSSDTæä¾›äº†å¯¹<code>_PTS</code>å’Œ<code>_WAK</code>çš„é‡å†™ã€‚å½“ä¸æ¥è‡ª<code>hotpatch</code>/<code>config.plist</code>çš„é€‚å½“çš„è¡¥ä¸ç›¸ç»“åˆä½¿ç”¨æ—¶ï¼Œè¿™äº›æ–¹æ³•å¯ä»¥æä¾›ä¸€ç³»åˆ—çš„ä¿®å¤ã€‚è¿™äº›è¡Œä¸ºæ˜¯ç”±<code>RMCF.DPTS</code>, <code>RMCF.SHUT</code>,<code>RMCF.XPEE</code>,<code>RMCF.XPEE</code> ,<code>RMCF.SSTF</code>.æ›´å¤šå…³äºè¿™äº›é€‰é¡¹çš„ä¿¡æ¯å‚é˜…<code>SSDT-Config</code>ã€‚</p></blockquote><p><code>SSDT-Disable_EHCI.dsl</code>: This SSDT can disable both EHCI controllers. It is assumed both have been renamed to EH01/EH02 (typically original names are EHC1/EHC2).</p><blockquote><p>è¿™ä¸ªSSDTå¯ä»¥ç¦ç”¨<code>EHCI</code>æ§åˆ¶å™¨ã€‚è¦æ±‚è¿™ä¸¤ç§æƒ…å†µéƒ½è¢«é‡æ–°å‘½åä¸º<code>EH01/EH02</code>(é€šå¸¸åŸæ¥çš„åå­—æ˜¯<code>EHC1/EHC2</code>).</p></blockquote><p><code>SSDT-Disable_EH01.dsl</code>, <code>SSDT-Disable_EH02.dsl</code>: Each of these SSDTs is just SSDT-Disable_EHCI.dsl broken down to only disable EH01 or only EH02. Use as appropriate depending on which EHCI controllers are active/present in your ACPI set.</p><blockquote><p>è¿™äº›SSDTæ¯ä¸€ä¸ªéƒ½æ˜¯<code>SSDT-Disable_EHCI.dsl</code>åˆ†è§£çš„ï¼Œä»…ä»…ç”¨ä»¥ç¦ç”¨<code>EH01</code>æˆ–<code>EH02</code>ã€‚å–å†³äºåœ¨ä½ çš„<code>ACPI</code>é›†åˆä¸­ä½¿ç”¨å“ªä¸ª<code>EHCI</code>æ§åˆ¶å™¨æ˜¯åˆé€‚çš„ã€‚</p></blockquote><p><code>SSDT-XWAK.dsl</code>, <code>SSDT-XSEL.dsl</code>, <code>SSDT-ESEL.dsl</code>: Each of these SSDTs provides an empty XWAK, XSEL, and ESEL methods (respectively). Use with the appropriate companion patch from hotpatch/config.plist. Typically, these methods are disabled (by having no code in them) to disable certain actions native ACPI may be doing on wake from sleep or during startup that cause problems with the xHCI/EHCI configuration.</p><blockquote><p>è¿™äº›SSDTåˆ†åˆ«æä¾›äº†ä¸€ä¸ªç©ºçš„<code>XWAK</code>ã€<code>XSEL</code>å’Œ<code>ESEL</code>æ–¹æ³•(ç‹¬ç«‹åœ°)ã€‚é…åˆ<code>hotpatch/config.plist</code>ä¸­é€‚å½“çš„è¡¥ä¸ä¸€èµ·ä½¿ç”¨ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œè¿™äº›æ–¹æ³•è¢«ç¦ç”¨(å› ä¸ºåœ¨å®ƒä»¬ä¸­æ²¡æœ‰ä»£ç )ï¼Œä»¥ç¦ç”¨æœ¬åœ°<code>ACPI</code>å¯èƒ½åœ¨å”¤é†’ç¡çœ æˆ–åœ¨å¯åŠ¨æ—¶å¯¼è‡´<code>xHCI/EHCI</code>ié…ç½®é—®é¢˜çš„æŸäº›åŠ¨ä½œã€‚</p></blockquote><p><code>SSDT-PluginType1.dsl</code>: This SSDT injects â€œplugin-typeâ€=1 on CPU0. It assumes ACPI Processor objects are in Scope(_PR). It can be used to enable native CPU power management on Haswell and later CPUs. See guide for more information: <a href="https://www.tonymacx86.com/threads/guide-native-power-management-for-laptops.175801/" target="_blank" rel="noopener">https://www.tonymacx86.com/threads/guide-native-power-management-for-laptops.175801/</a>.</p><blockquote><p>è¿™ä¸ªSSDTåœ¨<code>CPU0</code>æ³¨å…¥<code>â€œplugin-typeâ€=1</code>ã€‚å®ƒè¦æ±‚<code>ACPI</code>å¤„ç†å™¨å¯¹è±¡åœ¨<code>Scope(_PR)</code>èŒƒå›´å†…ã€‚å®ƒå¯ä»¥ç”¨äºåœ¨<code>Haswell</code>å’Œæ›´æ–°çš„<code>CPU</code>å¯ç”¨åŸç”Ÿç”µæºç®¡ç†ã€‚æ›´å¤šä¿¡æ¯è§æŒ‡å—ï¼š<a href="https://www.tonymacx86.com/threads/guide-native-power-management-for-laptops.175801/" target="_blank" rel="noopener">https://www.tonymacx86.com/threads/guide-native-power-management-for-laptops.175801/</a>.</p></blockquote><p><code>SSDT-HDEF.dsl</code> and <code>SSDT-HDAU.dsl</code>: Injects layout-id, hda-gfx, and PinConfiguration properties on HDEF and HDAU in order to implement audio with patched AppleHDA.kext Configured with: RMCF.AUDL.</p><blockquote><p>åœ¨<code>HDEF</code>å’Œ<code>HDAU</code>ä¸Šæ³¨å…¥<code>layout-id</code>ã€<code>hda-gfx</code>å’Œ<code>PinConfiguration</code>å±æ€§ï¼Œä»¥é€šè¿‡å¯¹<code>AppleHDA</code>çš„<code>patch</code>å®ç°éŸ³é¢‘ã€‚é€šè¿‡<code>RMCF.AUDL</code>é…ç½®.</p></blockquote><p><code>SSDT-EH01.dsl</code>,<code>SSDT-EH02.dsl</code>, and <code>SSDT-XHC.dsl</code>:These SSDTs inject USB power properties and control over FakePCIID_XHCIMux (dending on SSDT-Disable_EH*.dsl).</p><blockquote><p>è¿™äº›SSDTæ³¨å…¥<code>USB</code>ç”µæºå±æ€§å¹¶é€šè¿‡<code>FakePCIID_XHCIMux</code>æ§åˆ¶(å–å†³äº<code>SSDT-Disable_EH*.dsl</code>)ã€‚</p></blockquote><p><code>SSDT-ALS0.dsl</code>: Injects a fake ALS device (ambient light sensor). This SSDT is used to fix problems with restoring brightness upon reboot.</p><blockquote><p>æ³¨å…¥ä»¿å†’<code>ALS</code>è®¾å¤‡(ç¯å¢ƒå…‰ä¼ æ„Ÿå™¨)ã€‚è¿™ä¸ª<code>SSDT</code>ç”¨äºä¿®å¤é‡æ–°å¯åŠ¨æ—¶è¿˜åŸäº®åº¦çš„é—®é¢˜ã€‚</p></blockquote><h2 id="Introduction-è¯´æ˜æ–‡æ¡£"><a href="#Introduction-è¯´æ˜æ–‡æ¡£" class="headerlink" title="Introduction-è¯´æ˜æ–‡æ¡£"></a>Introduction-è¯´æ˜æ–‡æ¡£</h2><p>Patching ACPI is always necessary to enable (near) full functionality when installing OS X on non-Apple hardware.</p><blockquote><p>åœ¨éè‹¹æœç¡¬ä»¶ä¸Šå®‰è£…OS Xæ—¶ï¼Œä¿®è¡¥<code>ACPI</code>ä»¥å¯ç”¨(æ¥è¿‘)å®Œæ•´çš„åŠŸèƒ½æ€»æ˜¯å¿…è¦çš„ã€‚</p></blockquote><p>There is a complete guide here: <a href="http://www.tonymacx86.com/threads/guide-patching-laptop-dsdt-ssdts.152573/" target="_blank" rel="noopener">http://www.tonymacx86.com/threads/guide-patching-laptop-dsdt-ssdts.152573/</a></p><blockquote><p>è¿™é‡Œæœ‰ä¸€ä¸ªå®Œæ•´çš„æŒ‡å—: <a href="http://www.tonymacx86.com/threads/guide-patching-laptop-dsdt-ssdts.152573/" target="_blank" rel="noopener">http://www.tonymacx86.com/threads/guide-patching-laptop-dsdt-ssdts.152573/</a></p></blockquote><p>That guide uses what is known as â€œstatic patchingâ€. In order to inject patched ACPI files, we extract native ACPI, disassemble them, make changes, then recompile and place the files in ACPI/patched, so that Clover injects the patched ACPI instead of native ACPI. With the techniques detailed in this guide, the changes can be made directly to the ACPI binaries provided by BIOS, skipping the extract, disassembly, and recompilation steps.</p><blockquote><p>è¯¥æŒ‡å—ä½¿ç”¨äº†æ‰€è°“çš„â€œé™æ€è¡¥ä¸â€ã€‚ä¸ºäº†æ³¨å…¥æ‰“äº†è¡¥ä¸çš„<code>ACPI</code>æ–‡ä»¶ï¼Œæˆ‘ä»¬æå–æœ¬åœ°çš„ACPIï¼Œå°†å®ƒä»¬åç¼–è¯‘ï¼Œè¿›è¡Œä¿®æ”¹ï¼Œç„¶åé‡æ–°ç¼–è¯‘ï¼Œå¹¶å°†æ–‡ä»¶æ”¾åœ¨<code>ACPI/patched</code>ä¸­ï¼Œè¿™æ ·Cloverå°±æ³¨å…¥äº†æ‰“è¿‡è¡¥ä¸çš„<code>ACPI</code>ï¼Œè€Œä¸æ˜¯åŸç”Ÿçš„<code>ACPI</code>ã€‚é€šè¿‡æœ¬æŒ‡å—ä¸­è¯¦ç»†ä»‹ç»çš„æŠ€æœ¯ï¼Œå¯ä»¥ç›´æ¥å¯¹<code>BIOS</code>æä¾›çš„<code>ACPI</code>äºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡Œæ›´æ”¹ï¼Œè·³è¿‡æå–ã€åˆ†è§£å’Œé‡æ–°ç¼–è¯‘æ­¥éª¤ã€‚</p></blockquote><p>You should have a solid understanding of static ACPI patching before attempting to hotpatch. You should also have an understanding of the ACPI spec, binary patching, programming, and ACPI concepts. Donâ€™t expect step-by-step and spoon feeding in this thread.</p><blockquote><p>åœ¨å°è¯•<code>hotpatch</code>ä¹‹å‰ï¼Œä½ åº”è¯¥å¯¹é™æ€çš„<code>ACPI</code>è¡¥ä¸æœ‰ä¸€å®šçš„äº†è§£ã€‚ä½ è¿˜åº”è¯¥äº†è§£<code>ACPI</code>è§„èŒƒã€äºŒè¿›åˆ¶è¡¥ä¸ã€è¯­æ³•å’Œ<code>ACPI</code>æ¦‚å¿µã€‚ä¸è¦æŒ‡æœ›åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å¾ªåºæ¸è¿›åœ°å­¦ä¹ ã€‚</p></blockquote><h3 id="Clover-mechanisms-Cloveræœºåˆ¶"><a href="#Clover-mechanisms-Cloveræœºåˆ¶" class="headerlink" title="Clover mechanisms-Cloveræœºåˆ¶"></a>Clover mechanisms-<code>Clover</code>æœºåˆ¶</h3><p>Clover provides a few methods for accomplishing ACPI hotpatch:</p><blockquote><p>Cloveræä¾›äº†ä¸€äº›æ–°çš„æ–¹æ³•æ¥å®ç°<code>ACPI hotpatch</code>.</p></blockquote><ul><li>config.plist/ACPI/DSDT/Fixes</li><li>config.plist/ACPI/DSDT/Patches</li><li>ability to inject additional SSDTs</li></ul><p><code>DSDT/Fixes</code> provide fixed function ACPI patching. Each â€œFixâ€ can do a particular kind of patching that can be used instead of typical patching you might do with MaciASL and static patching. For example, â€œIRQ Fixâ€ can be accomplished with â€œFixHPET_0010â€ â€œFixIPIC_0040â€ â€œFIX_RTC_20000â€ and â€œFIX_TMR_40000â€. As an other example, â€œFix _WAK Arg0 v2â€ can be accomplished with â€œFIX_WAK_200000â€. You can read the Clover wiki for more information on each patch. Most of the time, there are not many DSDT â€œFixesâ€ needed for basic functionality. DSDT â€œFixesâ€ are useful for implementing patches that are difficult or impossible to implement with ACPI/DSDT/Patches or additional SSDTs.</p><blockquote><p><code>DSDT/Fixes</code>æä¾›äº†å…·æœ‰ä¿®å¤åŠŸèƒ½çš„<code>ACPI</code>è¡¥ä¸ã€‚æ¯ä¸€ä¸ª<code>Fix</code>éƒ½å¯ä»¥ä½¿ç”¨ä¸€ç§ç‰¹æ®Šçš„è¡¥ä¸ï¼Œä»è€Œä¸éœ€è¦ä½ ä½¿ç”¨<code>MaciASL</code>å’Œé™æ€è¡¥ä¸ã€‚ä¾‹å¦‚ï¼Œ<code>IRQ Fix</code>å¯ä»¥ç”¨<code>FixHPET_0010</code>ã€<code>FixIPIC_0040</code>ã€<code>FIX_RTC_20000</code>å’Œ<code>FIX_TMR_40000</code>æ¥å®Œæˆã€‚å†ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œ<code>Fix _WAK Arg0 v2</code>å¯ä»¥ç”¨<code>FIX_WAK_200000</code>æ¥å®Œæˆã€‚å¯¹äºæ¯ä¸ªè¡¥ä¸é˜…è¯»<code>Clover wiki</code>ä»¥è·å¾—æ›´å¤šä¿¡æ¯ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒåŸºæœ¬åŠŸèƒ½æ‰€éœ€çš„DSDT<code>Fix</code>å¹¶ä¸å¤šã€‚å¯¹äºç”¨<code>ACPI/DSDT/Patches</code>æˆ–é™„åŠ çš„<code>SSDT</code>å¾ˆéš¾å®ç°ç”šè‡³ä¸å¯èƒ½å®ç°çš„è¡¥ä¸,åˆ©ç”¨DSDT<code>Fixes</code>å®ç°éå¸¸æœ‰ç”¨ã€‚</p></blockquote><p>DSDT/Patches allows for binary search and replace by Clover. Clover loads the native ACPI files, applies the patches specified in ACPI/Patches using binary search/replace, then injects the patched ACPI. You need to have an understanding of the binary AML format. It is fully documented in the ACPI spec.</p><blockquote><p><code>DSDT/Patches</code>å…è®¸é€šè¿‡<code>Clover</code>å¯¹äºŒè¿›åˆ¶è¿›è¡ŒæŸ¥æ‰¾å¹¶æ›¿æ¢ã€‚<code>Clover</code>åŠ è½½æœ¬åœ°çš„<code>ACPI</code>æ–‡ä»¶ï¼Œåœ¨<code>ACPI/Patches</code>ä¸­ä½¿ç”¨äºŒè¿›åˆ¶æŸ¥æ‰¾æ›¿æ¢ä»¥åº”ç”¨æŒ‡å®šçš„è¡¥ä¸ï¼Œç„¶åæ³¨å…¥æ‰“è¿‡è¡¥ä¸çš„<code>ACPI</code>ã€‚æ‚¨éœ€è¦äº†è§£äºŒè¿›åˆ¶<code>AML</code>æ ¼å¼ã€‚å®ƒåœ¨<code>ACPI</code>è§„èŒƒä¸­æœ‰å®Œæ•´çš„æ–‡æ¡£è®°å½•ã€‚</p></blockquote><p>ACPI namespace is built by merging the DSDT and SSDTs at load time. By placing additional SSDTs into ACPI/patched, we can essentially add code to this ACPI set. Since many OS X patches involve adding properties to ioreg with a _DSM method, it is often adequate to simply add an SSDT which contains the additional _DSM method instead of patching the native ACPI files. A perfect example youâ€™re already familiar with is the SSDT.aml that is generated by Pikeâ€™s ssdtPRgen.sh.</p><blockquote><p>ACPIå‘½åç©ºé—´åœ¨åŠ è½½æ—¶é€šè¿‡åˆå¹¶<code>DSDT</code>å’Œ<code>SSDT</code>æ„å»ºã€‚é€šè¿‡å°†é¢å¤–çš„<code>SSDT</code>æ”¾åˆ°<code>ACPI/patched</code>,æˆ‘ä»¬å¯ä»¥æ·»åŠ ä»£ç åˆ°<code>ACPI</code>é›†ã€‚å› ä¸ºè®¸å¤š<code>OS X</code>è¡¥ä¸æ¶‰åŠ<code>_DSM</code>æ–¹æ³•æ·»åŠ å±æ€§åˆ°<code>ioreg</code> ,é€šå¸¸æ˜¯é€‚å½“çš„<code>SSDT</code>åŒ…å«é¢å¤–çš„ä¸€ä¸ª<code>_DSM</code>æ–¹æ³•è€Œä¸æ˜¯å¯¹æœ¬åœ°<code>ACPI</code>æ–‡ä»¶æ‰“è¡¥ä¸ã€‚ä½ å·²ç»ç†Ÿæ‚‰çš„ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­æ˜¯<code>Pike</code>çš„<code>ssdtprgensh.sh</code>è„šæœ¬ç”Ÿæˆçš„<code>SSDT.aml</code>ã€‚</p></blockquote><p>In some cases, more than one mechanism must be used to accomplish a single goal. For example, you might use binary patching to disable or rename components in the native ACPI set, and then replace it with additional SSDTs.</p><blockquote><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¿…é¡»ä½¿ç”¨ä¸æ­¢ä¸€ä¸ªæœºåˆ¶æ¥å®ŒæˆæŸä¸€ä¸ªç›®æ ‡ã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½ä½¿ç”¨äºŒè¿›åˆ¶è¡¥ä¸æ¥ç¦ç”¨æˆ–é‡å‘½åæœ¬åœ°<code>ACPI</code>é›†åˆä¸­çš„ç»„ä»¶ï¼Œç„¶åç”¨é¢å¤–çš„<code>SSDT</code>æ›¿æ¢å®ƒã€‚</p></blockquote><h3 id="Renaming-ACPI-objects-é‡å‘½åACPIå¯¹è±¡"><a href="#Renaming-ACPI-objects-é‡å‘½åACPIå¯¹è±¡" class="headerlink" title="Renaming ACPI objects-é‡å‘½åACPIå¯¹è±¡"></a>Renaming ACPI objects-é‡å‘½å<code>ACPI</code>å¯¹è±¡</h3><p>Since OS X can depend on specific ACPI object names used by Macs, a common patch is to rename an object in the native ACPI set. For example, most PC laptops use GFX0 for the integrated Intel GPU object (Intel HD Graphics). In OS X, power management for Intel graphics is not enabled unless this device is named IGPU. Using static patching, we apply â€œRename IGPU to GFX0â€ in order to rename this object. The patch must be applied to the DSDT and all SSDTs that reference it.</p><blockquote><p>ç”±äº<code>OS X</code>å¯ä»¥ä¾èµ–äº<code>Mac</code>æ‰€ä½¿ç”¨çš„ç‰¹å®šçš„<code>ACPI</code>å¯¹è±¡åç§°ï¼Œä¸€ä¸ªå¸¸è§çš„è¡¥ä¸æ˜¯åœ¨æœ¬åœ°çš„ACPIé›†åˆä¸­é‡å‘½åä¸€ä¸ªå¯¹è±¡ï¼Œä¾‹å¦‚ï¼Œå¤§å¤šæ•°<code>PC</code>ç¬”è®°æœ¬ä½¿ç”¨<code>GFX0</code>ä½œä¸ºé›†æˆçš„<code>Intel GPU</code>å¯¹è±¡(<code>Intel HD</code>æ˜¾å¡)ã€‚åœ¨<code>OS X</code>ä¸­ï¼Œé™¤éè¿™ä¸ªè®¾å¤‡è¢«å‘½åä¸º<code>IGPU</code>ï¼Œå¦åˆ™è‹±ç‰¹å°”å›¾å½¢çš„ç”µæºç®¡ç†æ˜¯ä¸èƒ½å¯ç”¨çš„ã€‚ä½¿ç”¨é™æ€è¡¥ä¸ï¼Œæˆ‘ä»¬åº”ç”¨<code>Rename IGPU to GFX0</code>æ¥é‡å‘½åè¿™ä¸ªå¯¹è±¡ã€‚è¿™ä¸ªè¡¥ä¸å¿…é¡»åº”ç”¨åˆ°<code>DSDT</code>å’Œæ‰€æœ‰æœ‰å¼•ç”¨<code>GFX0</code>çš„<code>SSDT</code>ä¸Šã€‚</p></blockquote><p>With hotpatch, we can rename GFX0 to IGPU using a simple Clover patch in ACPI/DSDT/Patches. Such patches apply to DSDT and all native SSDTs (DSDT/Patches do not apply to SSDTs that are added via ACPI/patched). The patch for the rename would be:</p><blockquote><p>ä½¿ç”¨<code>hotpatch</code>ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨<code>ACPI/DSDT/Patches</code>ä½¿ç”¨ä¸€ä¸ªç®€å•çš„å››å¶è‰è¡¥ä¸å°†<code>GFX0</code>é‡å‘½åä¸º<code>IGPU</code>ã€‚è¿™äº›è¡¥ä¸é€‚ç”¨äº<code>DSDT</code>å’Œæ‰€æœ‰æœ¬åœ°çš„<code>SSDTs</code>(<code>(DSDT/Patches</code>ä¸èƒ½è¢«åº”ç”¨åˆ°é€šè¿‡<code>ACPI/patched</code>æ·»åŠ çš„<code>SSDT</code>)ã€‚é‡å‘½åçš„è¡¥ä¸æ˜¯:</p></blockquote><pre><code>Comment: Rename GFX0 to IGPUFind: &lt;4746 5830&gt;Replace: &lt;4947 5055&gt;</code></pre><p>The hex values in Find and Replaces are the ASCII codes for GFX0 and IGPU, respectively.</p><blockquote><p>æŸ¥æ‰¾å’Œæ›¿æ¢çš„åå…­è¿›åˆ¶å€¼åˆ†åˆ«æ˜¯<code>GFX0</code>å’Œ<code>IGPU</code>çš„<code>ASCII</code>ç ,åˆ†åˆ«æ˜¯ï¼š</p></blockquote><pre><code>$ echo -n GFX0|xxd0000000: 4746 5830                                GFX0$ echo -n IGPU|xxd0000000: 4947 5055                                IGPU</code></pre><p>There are number of common renames, and most are in the config.plist that are part of my Clover/hoptpatch project:</p><p><a href="https://github.com/RehabMan/OS-X-Clover-Laptop-Config/tree/master/hotpatch" target="_blank" rel="noopener">https://github.com/RehabMan/OS-X-Clover-Laptop-Config/tree/master/hotpatch</a></p><blockquote><p>æœ‰è®¸å¤šé€šç”¨çš„é‡å‘½åï¼Œè€Œä¸”å¾ˆå¤šéƒ½åœ¨<code>config.plist</code>é‡Œï¼Œè¿™ä¸ª<code>config.plist</code>æ˜¯æˆ‘çš„<code>Clover/hotpatch</code>é¡¹ç›®çš„ä¸€éƒ¨åˆ†:<a href="https://github.com/RehabMan/OS-X-Clover-Laptop-Config/tree/master/hotpatch" target="_blank" rel="noopener">https://github.com/RehabMan/OS-X-Clover-Laptop-Config/tree/master/hotpatch</a></p></blockquote><p>In fact, the hotpatch SSDTs that are part of the same project depend on the renames being implemented.</p><blockquote><p>äº‹å®ä¸Šï¼Œè¿™äº›<code>hotpach</code>çš„<code>SSDT</code>ä¹Ÿæ˜¯ä¸Šé¢é‚£ä¸ªé¡¹ç›®çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸”å®ƒä»¬è¦æ±‚è¿™äº›é‡å‘½åå¿…é¡»è¢«å®ç°ã€‚</p></blockquote><p>Common renames:</p><blockquote><p>é€šç”¨çš„é‡å‘½åï¼š</p></blockquote><pre><code>GFX0 -&gt; IGPUSAT0 -&gt; SATAEHC1 -&gt; EH01EHC2 -&gt; EH02XHCI -&gt; XHCHECI -&gt; IMEIMEI -&gt; IMEILPC -&gt; LPCBHDAS -&gt; HDEFAZAL -&gt; HDEF</code></pre><p>Note: All ACPI identifiers are 4 characters. Shorter names are padded with underscore. So, for example, XHC is represented in the AML binary as XHC_, EC would be EC__, EC0 would be EC_, MEI would be MEI_, etc.</p><blockquote><p>æ³¨æ„ï¼šæ‰€æœ‰çš„<code>ACPI</code>æ ‡è¯†ç¬¦éƒ½æ˜¯4ä¸ªå­—ç¬¦ã€‚è¾ƒçŸ­çš„åå­—ç”¨ä¸‹åˆ’çº¿å¡«å……ã€‚ä¾‹å¦‚ï¼Œ<code>XHC</code>åœ¨<code>AML</code>äºŒè¿›åˆ¶æ–‡ä»¶ä¸­è¢«è¡¨ç¤ºä¸º<code>XHC_</code>ï¼Œ<code>EC</code>æ˜¯<code>EC__</code>ï¼Œ<code>EC0</code>æ˜¯<code>EC0_</code>ï¼Œ<code>MEI</code>æ˜¯<code>MEI_</code>ï¼Œç­‰ç­‰ã€‚</p></blockquote><h3 id="Removing-methods-ç§»é™¤æ–¹æ³•"><a href="#Removing-methods-ç§»é™¤æ–¹æ³•" class="headerlink" title="Removing methods-ç§»é™¤æ–¹æ³•"></a>Removing methods-ç§»é™¤æ–¹æ³•</h3><p>It is very difficult to remove ACPI objects, (methods, names, devices, etc) using Clover binary patches. Commonly, we must add _DSM methods to inject properties that describe various hardware properties. But added _DSM methods can conflict with existing _DSM methods that may already be in the native ACPI files. With static patching, â€œRemove _DSM methodsâ€ would be used.</p><blockquote><p>ä½¿ç”¨<code>Clover</code>äºŒè¿›åˆ¶è¡¥ä¸æ¥ç§»é™¤<code>ACPI</code>å¯¹è±¡(æ–¹æ³•ã€åç§°ã€è®¾å¤‡ç­‰ç­‰)æ˜¯éå¸¸å›°éš¾çš„ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬å¿…é¡»æ·»åŠ <code>_DSM</code>æ–¹æ³•æ¥æ³¨å…¥å„ç§æè¿°ç¡¬ä»¶å±æ€§çš„å±æ€§ã€‚ä½†æ˜¯ï¼Œæ·»åŠ <code>_DSM</code>æ–¹æ³•å¯èƒ½ä¸æœ¬åœ°<code>ACPI</code>æ–‡ä»¶ç°æœ‰çš„<code>_DSM</code>æ–¹æ³•å†²çªã€‚è¿™æ—¶ï¼Œå°±ä¼šç”¨åˆ°é™æ€è¡¥ä¸<code>Remove _DSM methods</code>ã€‚</p></blockquote><p>Since it is difficult to remove the methods, but we donâ€™t want the native methods to conflict with new _DSM methods that are added, the fix is to rename the native methods to something else.</p><blockquote><p>ç”±äºå¾ˆéš¾åˆ é™¤è¿™äº›æ–¹æ³•ï¼Œä½†æ˜¯æˆ‘ä»¬åˆä¸å¸Œæœ›æœ¬åœ°æ–¹æ³•ä¸æ·»åŠ çš„æ–°<code>_DSM</code>æ–¹æ³•ç›¸å†²çªï¼Œæ‰€ä»¥å°±å°†æœ¬åœ°æ–¹æ³•é‡å‘½åä¸ºå…¶ä»–åå­—æ¥ä¿®å¤è¿™ä¸ªé—®é¢˜ã€‚</p></blockquote><p>Soâ€¦ again, we use a simple rename patch:</p><blockquote><p>é‚£ä¹ˆâ€¦åŒæ ·åœ°ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç®€å•çš„é‡å‘½åè¡¥ä¸:</p></blockquote><pre><code>Comment: Rename _DSM to XDSMFind: &lt;5f44534d&gt;Replace: &lt;5844534d&gt;</code></pre><p>Sometimes, you might rename an object to effectively disable it so it does not cause problems. For example, my Intel DH67GD DSDT defines an APSS object. If this object is left in the DSDT it interferes with power management (causes panic). I use a rename from APSS -&gt; APXX. Because AppleIntelCPUPowerManagement is looking for APSS, it does not cause a problem once renamed to APXX.</p><blockquote><p>æœ‰æ—¶ï¼Œä½ å¯èƒ½ä¼šé‡å‘½åä¸€ä¸ªå¯¹è±¡ï¼Œä»¥ä¾¿æœ‰æ•ˆåœ°ç¦ç”¨å®ƒï¼Œè¿™æ ·å®ƒå°±ä¸ä¼šé€ æˆé—®é¢˜ã€‚ä¾‹å¦‚ï¼Œæˆ‘çš„<code>Intel DH67GD</code>çš„ <code>DSDT</code>å®šä¹‰äº†<code>APSS</code>å¯¹è±¡ã€‚å¦‚æœè¿™ä¸ªå¯¹è±¡ç•™åœ¨<code>DSDT</code>ä¸­ï¼Œå®ƒä¼šå¹²æ‰°ç”µæºç®¡ç†(å¼•èµ·<code>KP</code>)ã€‚æˆ‘ä½¿ç”¨<code>APSS-&gt;APXX</code>çš„é‡å‘½åã€‚å› ä¸º<code>AppleIntelCPUPowerManagement</code>ä¼šæŸ¥æ‰¾<code>APSS</code>,åªè¦æ”¹åä¸º<code>APXX</code>å°±ä¸ä¼šå¼•èµ·é—®é¢˜ã€‚</p></blockquote><h3 id="Redirect-and-Replace-é‡å®šå‘å’Œæ›¿æ¢"><a href="#Redirect-and-Replace-é‡å®šå‘å’Œæ›¿æ¢" class="headerlink" title="Redirect and Replace-é‡å®šå‘å’Œæ›¿æ¢"></a>Redirect and Replace-é‡å®šå‘å’Œæ›¿æ¢</h3><p>In some cases, we would like to replace code to change the behavior. For this, we can rename the object and provide an alternate implementation in an SSDT.</p><blockquote><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›æ›¿æ¢ä»£ç æ¥æ”¹å˜æŸäº›åŠ¨ä½œã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é‡å‘½åè¿™ä¸ªå¯¹è±¡ï¼Œå¹¶åœ¨<code>SSDT</code>ä¸­æä¾›ä¸€ä¸ªç”¨æ¥æ›¿ä»£çš„å¯¹è±¡ä»¥è¾¾åˆ°ç›®çš„ã€‚</p></blockquote><p>A common fix is spoofing the ACPI code in DSDT and SSDTs such that it behaves as if a certain version of Windows is the ACPI host. When static patching, we might use â€œOS Check Fix (Windows 8)â€. When applied, it changes code from:</p><blockquote><p>ä¸€ä¸ªå¸¸è§çš„ä¿®å¤æ˜¯åœ¨<code>DSDT</code>å’Œ<code>SSDT</code>ä¸­ä»¿å†’<code>ACPI</code>ä»£ç ï¼Œä½¿å…¶è¡¨ç°å¾—å°±åƒæ˜¯<code>ACPI</code>ä¸»æœºçš„æŸä¸ªç‰ˆæœ¬çš„<code>Windows</code>ä¸€æ ·ã€‚å½“åˆ©ç”¨é™æ€è¡¥ä¸æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šä½¿ç”¨<code>OS Check Fix (Windows 8)</code>ã€‚å½“åº”ç”¨è¿™ä¸ªè¡¥ä¸æ—¶ï¼Œå®ƒä¼šå°†ä»£ç ä»:</p></blockquote><pre><code>If (_OSI("Windows 2012"))</code></pre><p>To:</p><blockquote><p>æ”¹ä¸ºï¼š</p></blockquote><pre><code>If (LOr(_OSI("Darwin"),_OSI("Windows 2012"))</code></pre><p>Since the _OSI implementation in OS X only responds to â€œDarwinâ€ the code is changed so that this specific _OSI check also accomodates â€œDarwinâ€.</p><blockquote><p>ç”±äº<code>OS X</code>ä¸­<code>_OSI</code>æ–¹æ³•çš„å®ç°åªå¯¹è¢«ä¿®æ”¹äº†ä»£ç çš„<code>Darwin</code>ä½œå‡ºå“åº”ï¼Œæ‰€ä»¥è¿™ä¸ªç‰¹å®šçš„<code>_OSI check</code>è¡¥ä¸ä¹Ÿèƒ½å“åº”<code>Darwin</code>ã€‚</p></blockquote><p>With hotpatching, the opposite approach is taken. Instead of changing the code using _OSI, we change the code so it calls a different method that emulates the _OSI implementation that would be in the Windows ACPI host.</p><blockquote><p>è€Œçƒ­è¡¥ä¸åˆ™é‡‡ç”¨ç›¸åçš„æ–¹æ³•ï¼Œæˆ‘ä»¬ä¸ä½¿ç”¨<code>_OSI</code>ä¿®æ”¹ä»£ç ï¼Œè€Œæ˜¯æ”¹å˜ä»£ç è®©å®ƒè°ƒç”¨ä¸€ç§ä¸åŒçš„æ–¹æ³•æ¥æ¨¡æ‹Ÿåœ¨<code>Windows ACPI</code>ä¸»æœºä¸Šçš„<code>_OSI</code>å®ç°ã€‚</p></blockquote><p>This technique relies on two of the techniquesâ€¦ a patch to change all calls from _OSI to XOSIâ€¦ and an implementation of XOSI that emulates what Windows would do for a certain Windows version.</p><blockquote><p>è¿™é¡¹æŠ€æœ¯ä¾èµ–äºä¸¤ç§æŠ€æœ¯ï¼Œä¸€ä¸ªè¡¥ä¸æ¥æ”¹å˜ä»<code>_OSI</code>åˆ°<code>XOSI</code>çš„æ‰€æœ‰è°ƒç”¨ã€‚å¦ä¸€ä¸ªæ˜¯<code>XOSI</code>çš„å®ç°ï¼Œå³æ¨¡æ‹Ÿ<code>Windows</code>å¯¹æŸä¸ª<code>Windows</code>ç‰ˆæœ¬çš„æ“ä½œã€‚</p></blockquote><p>First, changing the code to call XOSI instead of _OSI:</p><blockquote><p>é¦–å…ˆï¼Œæ”¹å˜ä»£ç æ¥è°ƒç”¨<code>XOSI</code>è€Œä¸æ˜¯<code>_OSI</code>:</p></blockquote><pre><code>Comment: Change _OSI to XOSIFind: &lt;5f4f 5349&gt;Replace: &lt;584f 5349&gt;</code></pre><p>The hex codes above should be no mystery (they are ASCII for _OSI and XOSI, respectively).</p><blockquote><p>ä¸Šé¢çš„åå…­è¿›åˆ¶ä»£ç æ²¡æœ‰ä»€ä¹ˆç¥ç§˜çš„(å®ƒä»¬åˆ†åˆ«æ˜¯<code>_OSI</code>å’Œ<code>XOSI</code>çš„<code>ASCII</code>ç )ã€‚</p></blockquote><p>Now the code mentioned above, after patching by Clover, will read:</p><blockquote><p>ç°åœ¨ï¼Œä¸Šé¢æåˆ°çš„ä»£ç ï¼Œåœ¨é€šè¿‡<code>Clover</code>æ‰“äº†è¡¥ä¸ä¹‹åï¼Œå°†ä¼šè¯»åˆ°:</p></blockquote><pre><code>If (XOSI("Windows 2012"))</code></pre><p>Now we need an SSDT that implements XOSI. You will find such an implementation in the repository (SSDT-XOSI.dsl).</p><blockquote><p>ç°åœ¨æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå®ç°<code>XOSI</code>çš„<code>SSDT</code>ã€‚ä½ å¯ä»¥æˆ‘çš„<code>GitHub</code>ä»“åº“ä¸­æ‰¾åˆ°è¿™æ ·çš„å®ç°(SSDT-XOSI.dsl).</p></blockquote><p>Note that without the SSDT that implements the XOSI method, the (patched) calls to XOSI would cause an ACPI abort (ACPI abort causes execution of the ACPI method to be terminated immediately with an error). Donâ€™t use the _OSI-&gt;XOSI patch without the XOSI method.</p><blockquote><p>æ³¨æ„ï¼Œå¦‚æœæ²¡æœ‰å®ç°<code>XOSI</code>æ–¹æ³•çš„<code>SSDT</code>ï¼Œè¿™ä¸ªè¡¥ä¸å¯¹<code>XOSI</code>çš„è°ƒç”¨å°†å¯¼è‡´<code>ACPI</code>çš„åŠ è½½è¢«ç»ˆæ­¢(<code>ACPI</code>ä¸­æ­¢å¯¼è‡´<code>ACPI</code>æ–¹æ³•çš„æ‰§è¡Œè¢«é”™è¯¯ç«‹å³ç»ˆæ­¢)ã€‚å¦‚æœæ²¡æœ‰<code>XOSI</code>æ–¹æ³•ä¸è¦ä½¿ç”¨<code>_OSI</code>-&gt;<code>XOSI</code>è¡¥ä¸ã€‚</p></blockquote><h3 id="Rename-and-Replace-é‡å‘½åå’Œæ›¿æ¢"><a href="#Rename-and-Replace-é‡å‘½åå’Œæ›¿æ¢" class="headerlink" title="Rename and Replace-é‡å‘½åå’Œæ›¿æ¢"></a>Rename and Replace-é‡å‘½åå’Œæ›¿æ¢</h3><p>A second pattern, similar to â€œRedirect and Replaceâ€ is â€œRename and Replaceâ€. In this case, instead of changing all the call sites, we change the method definition such that the method is named something different than it was originally, but leave the original method name at the call sites. This allows the method that is the target of the calls to be replaced.</p><p>For example, it is very common for USB devices to cause â€œinstant wakeâ€. As a work around, wake on USB can be disabled. Most laptops donâ€™t have a BIOS option for it, so instead the _PRW methods that control this feature are patched.</p><p>For example, the native _SB.PCI0.EHC1._PRW method might read:</p><pre><code>Method (_PRW, 0, NotSerialized)  // _PRW: Power Resources for Wake{    Return (GPRW (0x6D, 0x03))}</code></pre><p>In order to patch it so USB devices on EHCI#1 cannot cause wake, it would be changed:</p><pre><code>Method (_PRW, 0, NotSerialized)  // _PRW: Power Resources for Wake{    Return (GPRW (0x6D, 0))}</code></pre><p>Usually, there are several such call sites to GPRW that need to be changed (also, keep in mind not all ACPI sets use the specific name GPRW). Instead of trying to patch all the call sites as above, we can instead patch the method definition of GPRW instead:</p><p>With the original code:</p><pre><code>Method (GPRW, 2, NotSerialized){   ...}</code></pre><p>If we change it to:</p><pre><code>Method (XPRW, 2, NotSerialized){   ...}</code></pre><p>Since you donâ€™t want to change any call sites, the patch must be constructed such that it affects only the method itself and not the call sites. According to ACPI spec, a method definition starts with bytecode 14, is followed by the method size, the method name, argument count/flags. You can use the â€œ-lâ€ option in iasl to generate a mixed listing of your ACPI file. For example, the Lenovo u430 GPRW method mixed listing:</p><pre><code>4323:          Method (GPRW, 2, NotSerialized)00003F95:  14 45 08 47 50 52 57 02     ".E.GPRW."4324:          {4325:              Store (Arg0, Index (PRWP, Zero))00003F9D:  70 68 ..................    "ph"00003F9F:  88 50 52 57 50 00 00 ...    ".PRWP.."</code></pre><p>We could do a find replace using the method header bytes:</p><pre><code>Find: &lt;14 45 08 47 50 52 57 02&gt;Replace: &lt;14 45 08 58 50 52 57 02&gt;</code></pre><p>But what happens if the method differs slightly between different versions of BIOS or models that are similar, but not exactly the same? In that case, the byte following the 14 will change due to the change in the method length.</p><p>My thought is that the beginning of the method body is less likely to be different than the total length of the method, so it helps to add a few extra bytes from the body of the method to the find/replace specification:</p><pre><code>Find: &lt;47 50 52 57 02 70 68&gt;Replace: &lt;58 50 52 57 02 70 68&gt;</code></pre><p>The number of follow-on bytes that you use depends on how many you need to make the find/replace affect only the method definition. You can verify by looking at the native AML binary in a hex editor such as Hex Fiend (it is a nice hex editor and is also open source).</p><p>Note: Although you could search just for the method name + arg count/flags, it is possible that the same pattern will find a call site to the method which you donâ€™t want to change. In the case of the u430 that wasnâ€™t the case, so I was able to find/replace with just the method name+flags.</p><pre><code>Find: &lt;47505257 02&gt;Replace: &lt;58505257 02&gt;</code></pre><p>In the case of the ProBook UPRW, it was necessary to use the follow-on bytes that are part of the method body:</p><pre><code>Find: &lt;55505257 0a7012&gt;Replace: &lt;58505257 0a7012&gt;</code></pre><p>Now any code that calls GPRW (or UPRW in the ProBook example) will not call the implementation in XPRW because the name doesnâ€™t match. The original XPRW is now unreachable code. Which means the GPRW implementation can be changed for our purpose:</p><pre><code>Method(GPRW, 2){    If (0x6d == Arg0) { Return(Package() { 0x6d, 0, }) }    External(\XPRW, MethodObj)    Return(XPRW(Arg0, Arg1))}</code></pre><p>Explaining the code: For any call to GPRW with the first argument set to 0x6d (the GPE we are trying to disable for wake), instead of returning what the original GPRW would, we return a package with 0x6d and 0 (which disables wake). And for other GPE values, the code simply calls the original GPRW method now named XPRW.</p><p>Another simple case is patching EC query methods to fix the brightness keys. A simple rename of the _Qxx methods involved to XQxx, and a new definition of the method with the original name is all that is needed.</p><p>For example, in the HP Envy Haswell repo:</p><pre><code>// _Q13 called on brightness/mirror display keyMethod (_Q13, 0, Serialized)  // _Qxx: EC Query{    External(\HKNO, FieldUnitObj)    Store(HKNO, Local0)    If (LEqual(Local0,7))    {        // Brightness Down        Notify(\_SB.PCI0.LPCB.PS2K, 0x0405)    }    If (LEqual(Local0,8))    {        // Brightness Up        Notify(\_SB.PCI0.LPCB.PS2K, 0x0406)    }    If (LEqual(Local0,4))    {        // Mirror toggle        Notify(\_SB.PCI0.LPCB.PS2K, 0x046e)    }}</code></pre><p>And the associated patch:</p><pre><code>Comment: change Method(_Q13,0,S) to XQ13Find: &lt;5f513133 08&gt;Replace: &lt;58513133 08&gt;</code></pre><p>This same â€œRename and Replaceâ€ mechanism can be used in cases that are much more complex than this. For example, it is typically used to patch battery methods, which need to be patched to avoid access to multibyte EC fields.</p><h4 id="Tips-for-complex-Rename-and-Replace"><a href="#Tips-for-complex-Rename-and-Replace" class="headerlink" title="Tips for complex Rename and Replace"></a>Tips for complex Rename and Replace</h4><p>As you probably already know, patching for battery status (multibyte EC fields) can be very complex and can involve a lot of code changes to many methods.</p><p>This section will detail some of the techniques and procedures used for battery patching.</p><p>It is advisable to patch for battery without using hotpatch first. After you get it working, then attempt hotpatch. Also, the difference between the code not patched for battery and the code patched for battery is very helpful. You can use a tool like â€˜diffmergeâ€™ to compare each. This is especially true if there is already a static battery patch for your laptop in my laptop repository.</p><p>General procedure:</p><ul><li>start with native ACPI</li><li>patch for battery status using static patching (verify it works)</li><li>use diffmerge to compare the unpatched code with patched code</li><li>for each method that is different, implement the â€œRename and Replaceâ€ pattern</li><li>for the EC fields, create another EC OperationRegion (use a name that is different from the original) and Field definition as a sort of â€œoverlayâ€ which contains only the EC fields you need to patch</li><li>to create the EC overlay, you can use the patched Field/OperationRegion in the patched DSDT, then eliminate unpatched fields</li><li>use External to allow the replacement methods in the SSDT to access the fields defined elsewhere in the ACPI set (usually DSDT)</li><li>let the compiler point out where you need to use External</li><li>watch out for symbols with duplicate names in different scopes</li></ul><p>An example is provided in post #2 of this thread.</p><h3 id="Code-value-patching"><a href="#Code-value-patching" class="headerlink" title="Code value patching"></a>Code value patching</h3><p>Consider the case of â€œFix Mutex with non-zero SyncLevelâ€. This patch finds all Mutex objects and replaces the SyncLevel with 0. We use this patch since OS X does not support Mutex debugging correctly and aborts on any Acquire with a Mutex that has a non-zero SyncLevel.</p><p>As an example, the u430 has Mutexes delcared as such:</p><pre><code>Mutex (MSMI, 0x07)</code></pre><p>To make it compatible with OS X it must be changed:</p><pre><code>Mutex (MSMI, 0)</code></pre><p>The ACPI spec defines how a Mutex object is encoded in the AML, but it can be helpful to look at a mixed disassembly of a small ACPI file:</p><pre><code>DefinitionBlock ("", "DSDT", 2, "test", "test", 0){    Mutex(ABCD, 7)}</code></pre><p>The iasl compiler can create a mixed listing file with the â€œ-lâ€ option.</p><p>If we compile the above file with: iasl -l test.dsl, test.lst contains:</p><pre><code>       1:  DefinitionBlock ("", "DSDT", 2, "test", "test", 0)00000000:  44 53 44 54 2B 00 00 00     "DSDT+..."00000008:  02 36 74 65 73 74 00 00     ".6test.."00000010:  74 65 73 74 00 00 00 00     "test...."00000018:  00 00 00 00 49 4E 54 4C     "....INTL"00000020:  10 04 16 20 ............    "... "       2:  {       3:          Mutex(ABCD, 7)00000024:  5B 01 41 42 43 44 07 ...    "[.ABCD."       4:  }   </code></pre><p>As you can see, the <code>Mutex(ABCD, 7)</code>, is encoded as <code>&lt;5B 01 41 42 43 44 07&gt;</code></p><p>It is now very easy to construct a patch for it:</p><pre><code>Comment: Change Mutex(ABCD,7) to Mutex(ABCD,0)Find: &lt;5B 01 41 42 43 44 07&gt;Replace: &lt;5B 01 41 42 43 44 00&gt;</code></pre><h3 id="Clover-ACPI-configuration"><a href="#Clover-ACPI-configuration" class="headerlink" title="Clover ACPI configuration"></a>Clover ACPI configuration</h3><p>With static patching, DropOem=true is used and patched DSDT and SSDTs are added to ACPI/patched. With hotpatch, instead use DropOem=false, and only add-on SSDTs are placed in ACPI/patched.</p><p>It is important to note that config.plist/ACPI/patches are applied only to native SSDTs, and not the SSDTs in ACPI/patched. This means that if you are renaming objects using config.plist, the add-on SSDTs must refer to the new names, not the old names. Unlike SSDTs in ACPI/patched, binary patches in ACPI/Patches <em>do apply</em> to DSDT.aml that might be in ACPI/patched. Keep this in mind if youâ€™re using a combination of static and hotpatching.</p><p>Also, with static patching, SortedOrder is used to specify the order of SSDTs in ACPI/patched. With hotpatch it is not strictly necessary as it is possible to construct the code in each SSDT such that the code is not order dependent. Especially if you place all add-on code in a single SSDT such as many of my laptop repo examples. Unless your add-on SSDTs are order dependent, you do not have to name each one in SortedOrder.</p><p>It is also not necessary to choose â€œnumbered namesâ€ for each SSDT. Instead you can use meaningful names, such as â€œSSDT-USB.amlâ€, SSDT-XOSI.amlâ€, etc. Using numbers instead of meaningul names will just confuse you. Donâ€™t do it.</p><h3 id="Troubleshooting"><a href="#Troubleshooting" class="headerlink" title="Troubleshooting"></a>Troubleshooting</h3><p>You can use patchmatic to look at your complete ACPI set as injected by Clover after patching. By runnning â€˜patchmatic -extractâ€™, patchmatic will write all injected DSDT.aml and SSDT*.aml in the order they were injected by Clover. You can disassemble them with â€˜iasl -da -dl *.amlâ€™. If iasl shows errors with the disassembly (for example duplicate symbols), it is likley OS X is also rejecting the conflicting SSDTs.</p><p>If youâ€™re a novice with this technique, it is a good idea to implement one patch at a time, and slowly build it up to a full set of working patches + SSDTs. Trying to do all at once can make it difficult to locate your mistake.</p><h2 id="Battery-Status-Hotpatch"><a href="#Battery-Status-Hotpatch" class="headerlink" title="Battery Status Hotpatch"></a>Battery Status Hotpatch</h2><p>This second post is dedicated to patching battery status with Clover hotpatch. To demonstrate the process, we will work through an example DSDT. The example files used are from the guide for disabling discrete graphics, an â€œAsus UX303LNâ€.</p><p><a href="https://www.tonymacx86.com/threads/guide-disabling-discrete-graphics-in-dual-gpu-laptops.163772/" target="_blank" rel="noopener">https://www.tonymacx86.com/threads/guide-disabling-discrete-graphics-in-dual-gpu-laptops.163772/</a></p><p>You should download the ACPI/origin files that are attached to that guide, so you can follow along.</p><p>As mentioned in post #1, the general procedures are as follows:</p><ul><li>start with native ACPI</li><li>patch for battery status using static patching (verify it works)</li><li>use diffmerge to compare the unpatched code with patched code</li><li>for each method that is different, implement the â€œRename and Replaceâ€ pattern</li><li>for the EC fields, create another EC OperationRegion (use a name that is different from the original) and Field definition as a sort of â€œoverlayâ€ which contains only the EC fields you need to patch</li><li>to create the EC overlay, you can use the patched Field/OperationRegion in the patched DSDT, then eliminate unpatched fields</li><li>use External to allow the replacement methods in the SSDT to access the fields defined elsewhere in the ACPI set (usually DSDT)</li><li>let the compiler point out where you need to use External</li><li>watch out for symbols with duplicate names in different scopes</li></ul><h3 id="Using-diffmerge-to-find-patched-vs-native-differences"><a href="#Using-diffmerge-to-find-patched-vs-native-differences" class="headerlink" title="Using diffmerge to find patched vs. native differences"></a>Using diffmerge to find patched vs. native differences</h3><p>Start by disassembling the origin files: iasl -da -dl *.aml<br>(you should be familiar with this part as it is part of normal ACPI patching)</p><p>Next apply the battery patch only using MaciASL to DSDT.dsl. In this case, we apply the â€œASUS N55SL/VivoBookâ€. There is no need to fix any errors, as we are interested only in the differences created by applying the battery patch. Save the patched file as DSDT_patched.dsl.</p><p>Now you can run diffmerge to see the differences between DSDT.dsl and DSDT_patched.dsl. I usually just do this from Terminal:</p><p><code>$ diffmerge DSDT.dsl DSDT_patched.dsl</code></p><p>The initial diffmerge window will look something like this:<br><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypvstpmgaj30u40nljze.jpg" alt=""></p><p>From there, we can examine the parts that have changes by clicking on the markers in the left column.</p><p>In the examples, the groups of changes you find:</p><ul><li>group 1: is the changes to the EC fields (multibyte to single byte)</li><li>group 2: addition of RDBA, WRBA, RDBB, WRBB methods</li><li>group 3: patched FBST, _BIX, B1FA methods</li><li>group 4: patched SMBR, SMBW, ECSB methods</li><li>group 5: patched TACH method</li><li>final group: addition of B1B2 method</li></ul><h3 id="Constructing-the-initial-SSDT"><a href="#Constructing-the-initial-SSDT" class="headerlink" title="Constructing the initial SSDT"></a>Constructing the initial SSDT</h3><p>Start with an empty SSDT in MaciASL:</p><pre><code>DefinitionBlock("", "SSDT", 2, "hack", "batt", 0){}</code></pre><p>Next, add all methods that were added by the patch. In the example, this includes RDBA, WRBA, RDBB, WRBB and B1B2 methods. You can copy them directly from the DSDT_patched.dsl.</p><p>You want to be certain each method is placed in the same scope. For example, here is the â€œgroup 2â€ methods added:</p><pre><code>DefinitionBlock("", "SSDT", 2, "hack", "batt", 0){    Scope (_SB.PCI0.LPCB.EC0)    {        Scope (EC0)        {            Method (RDBA, 0, Serialized)            {                Name (TEMP, Buffer(0x20) { })                Store (BA00, Index(TEMP, 0x00))                Store (BA01, Index(TEMP, 0x01))                Store (BA02, Index(TEMP, 0x02))                Store (BA03, Index(TEMP, 0x03))                Store (BA04, Index(TEMP, 0x04))                Store (BA05, Index(TEMP, 0x05))                Store (BA06, Index(TEMP, 0x06))                Store (BA07, Index(TEMP, 0x07))                Store (BA08, Index(TEMP, 0x08))                Store (BA09, Index(TEMP, 0x09))                Store (BA0A, Index(TEMP, 0x0A))                Store (BA0B, Index(TEMP, 0x0B))                Store (BA0C, Index(TEMP, 0x0C))                Store (BA0D, Index(TEMP, 0x0D))                Store (BA0E, Index(TEMP, 0x0E))                Store (BA0F, Index(TEMP, 0x0F))                Store (BA10, Index(TEMP, 0x10))                Store (BA11, Index(TEMP, 0x11))                Store (BA12, Index(TEMP, 0x12))                Store (BA13, Index(TEMP, 0x13))                Store (BA14, Index(TEMP, 0x14))                Store (BA15, Index(TEMP, 0x15))                Store (BA16, Index(TEMP, 0x16))                Store (BA17, Index(TEMP, 0x17))                Store (BA18, Index(TEMP, 0x18))                Store (BA19, Index(TEMP, 0x19))                Store (BA1A, Index(TEMP, 0x1A))                Store (BA1B, Index(TEMP, 0x1B))                Store (BA1C, Index(TEMP, 0x1C))                Store (BA1D, Index(TEMP, 0x1D))                Store (BA1E, Index(TEMP, 0x1E))                Store (BA1F, Index(TEMP, 0x1F))                Return (TEMP)            }            Method (WRBA, 1, Serialized)            {                Name (TEMP, Buffer(0x20) { })                Store (Arg0, TEMP)                Store (DerefOf(Index(TEMP, 0x00)), BA00)                Store (DerefOf(Index(TEMP, 0x01)), BA01)                Store (DerefOf(Index(TEMP, 0x02)), BA02)                Store (DerefOf(Index(TEMP, 0x03)), BA03)                Store (DerefOf(Index(TEMP, 0x04)), BA04)                Store (DerefOf(Index(TEMP, 0x05)), BA05)                Store (DerefOf(Index(TEMP, 0x06)), BA06)                Store (DerefOf(Index(TEMP, 0x07)), BA07)                Store (DerefOf(Index(TEMP, 0x08)), BA08)                Store (DerefOf(Index(TEMP, 0x09)), BA09)                Store (DerefOf(Index(TEMP, 0x0A)), BA0A)                Store (DerefOf(Index(TEMP, 0x0B)), BA0B)                Store (DerefOf(Index(TEMP, 0x0C)), BA0C)                Store (DerefOf(Index(TEMP, 0x0D)), BA0D)                Store (DerefOf(Index(TEMP, 0x0E)), BA0E)                Store (DerefOf(Index(TEMP, 0x0F)), BA0F)                Store (DerefOf(Index(TEMP, 0x10)), BA10)                Store (DerefOf(Index(TEMP, 0x11)), BA11)                Store (DerefOf(Index(TEMP, 0x12)), BA12)                Store (DerefOf(Index(TEMP, 0x13)), BA13)                Store (DerefOf(Index(TEMP, 0x14)), BA14)                Store (DerefOf(Index(TEMP, 0x15)), BA15)                Store (DerefOf(Index(TEMP, 0x16)), BA16)                Store (DerefOf(Index(TEMP, 0x17)), BA17)                Store (DerefOf(Index(TEMP, 0x18)), BA18)                Store (DerefOf(Index(TEMP, 0x19)), BA19)                Store (DerefOf(Index(TEMP, 0x1A)), BA1A)                Store (DerefOf(Index(TEMP, 0x1B)), BA1B)                Store (DerefOf(Index(TEMP, 0x1C)), BA1C)                Store (DerefOf(Index(TEMP, 0x1D)), BA1D)                Store (DerefOf(Index(TEMP, 0x1E)), BA1E)                Store (DerefOf(Index(TEMP, 0x1F)), BA1F)            }            Method (RDBB, 0, Serialized)            {                Name (TEMP, Buffer(0x20) { })                Store (BB00, Index(TEMP, 0x00))                Store (BB01, Index(TEMP, 0x01))                Store (BB02, Index(TEMP, 0x02))                Store (BB03, Index(TEMP, 0x03))                Store (BB04, Index(TEMP, 0x04))                Store (BB05, Index(TEMP, 0x05))                Store (BB06, Index(TEMP, 0x06))                Store (BB07, Index(TEMP, 0x07))                Store (BB08, Index(TEMP, 0x08))                Store (BB09, Index(TEMP, 0x09))                Store (BB0A, Index(TEMP, 0x0A))                Store (BB0B, Index(TEMP, 0x0B))                Store (BB0C, Index(TEMP, 0x0C))                Store (BB0D, Index(TEMP, 0x0D))                Store (BB0E, Index(TEMP, 0x0E))                Store (BB0F, Index(TEMP, 0x0F))                Store (BB10, Index(TEMP, 0x10))                Store (BB11, Index(TEMP, 0x11))                Store (BB12, Index(TEMP, 0x12))                Store (BB13, Index(TEMP, 0x13))                Store (BB14, Index(TEMP, 0x14))                Store (BB15, Index(TEMP, 0x15))                Store (BB16, Index(TEMP, 0x16))                Store (BB17, Index(TEMP, 0x17))                Store (BB18, Index(TEMP, 0x18))                Store (BB19, Index(TEMP, 0x19))                Store (BB1A, Index(TEMP, 0x1A))                Store (BB1B, Index(TEMP, 0x1B))                Store (BB1C, Index(TEMP, 0x1C))                Store (BB1D, Index(TEMP, 0x1D))                Store (BB1E, Index(TEMP, 0x1E))                Store (BB1F, Index(TEMP, 0x1F))                Return (TEMP)            }            Method (WRBB, 1, Serialized)            {                Name (TEMP, Buffer(0x20) { })                Store (Arg0, TEMP)                Store (DerefOf(Index(TEMP, 0x00)), BB00)                Store (DerefOf(Index(TEMP, 0x01)), BB01)                Store (DerefOf(Index(TEMP, 0x02)), BB02)                Store (DerefOf(Index(TEMP, 0x03)), BB03)                Store (DerefOf(Index(TEMP, 0x04)), BB04)                Store (DerefOf(Index(TEMP, 0x05)), BB05)                Store (DerefOf(Index(TEMP, 0x06)), BB06)                Store (DerefOf(Index(TEMP, 0x07)), BB07)                Store (DerefOf(Index(TEMP, 0x08)), BB08)                Store (DerefOf(Index(TEMP, 0x09)), BB09)                Store (DerefOf(Index(TEMP, 0x0A)), BB0A)                Store (DerefOf(Index(TEMP, 0x0B)), BB0B)                Store (DerefOf(Index(TEMP, 0x0C)), BB0C)                Store (DerefOf(Index(TEMP, 0x0D)), BB0D)                Store (DerefOf(Index(TEMP, 0x0E)), BB0E)                Store (DerefOf(Index(TEMP, 0x0F)), BB0F)                Store (DerefOf(Index(TEMP, 0x10)), BB10)                Store (DerefOf(Index(TEMP, 0x11)), BB11)                Store (DerefOf(Index(TEMP, 0x12)), BB12)                Store (DerefOf(Index(TEMP, 0x13)), BB13)                Store (DerefOf(Index(TEMP, 0x14)), BB14)                Store (DerefOf(Index(TEMP, 0x15)), BB15)                Store (DerefOf(Index(TEMP, 0x16)), BB16)                Store (DerefOf(Index(TEMP, 0x17)), BB17)                Store (DerefOf(Index(TEMP, 0x18)), BB18)                Store (DerefOf(Index(TEMP, 0x19)), BB19)                Store (DerefOf(Index(TEMP, 0x1A)), BB1A)                Store (DerefOf(Index(TEMP, 0x1B)), BB1B)                Store (DerefOf(Index(TEMP, 0x1C)), BB1C)                Store (DerefOf(Index(TEMP, 0x1D)), BB1D)                Store (DerefOf(Index(TEMP, 0x1E)), BB1E)                Store (DerefOf(Index(TEMP, 0x1F)), BB1F)            }        }    }}</code></pre><p>And with B1B2 added:</p><pre><code>DefinitionBlock("", "SSDT", 2, "hack", "batt", 0){    Method (B1B2, 2, NotSerialized) { Return (Or (Arg0, ShiftLeft (Arg1, 8))) }    // added methods (group 2)    Scope (_SB.PCI0.LPCB.EC0)    {        Scope (EC0)        {            Method (RDBA, 0, Serialized)            {                Name (TEMP, Buffer(0x20) { })                Store (BA00, Index(TEMP, 0x00))                Store (BA01, Index(TEMP, 0x01))                Store (BA02, Index(TEMP, 0x02))                Store (BA03, Index(TEMP, 0x03))                Store (BA04, Index(TEMP, 0x04))                Store (BA05, Index(TEMP, 0x05))                Store (BA06, Index(TEMP, 0x06))                Store (BA07, Index(TEMP, 0x07))                Store (BA08, Index(TEMP, 0x08))                Store (BA09, Index(TEMP, 0x09))                Store (BA0A, Index(TEMP, 0x0A))                Store (BA0B, Index(TEMP, 0x0B))                Store (BA0C, Index(TEMP, 0x0C))                Store (BA0D, Index(TEMP, 0x0D))                Store (BA0E, Index(TEMP, 0x0E))                Store (BA0F, Index(TEMP, 0x0F))                Store (BA10, Index(TEMP, 0x10))                Store (BA11, Index(TEMP, 0x11))                Store (BA12, Index(TEMP, 0x12))                Store (BA13, Index(TEMP, 0x13))                Store (BA14, Index(TEMP, 0x14))                Store (BA15, Index(TEMP, 0x15))                Store (BA16, Index(TEMP, 0x16))                Store (BA17, Index(TEMP, 0x17))                Store (BA18, Index(TEMP, 0x18))                Store (BA19, Index(TEMP, 0x19))                Store (BA1A, Index(TEMP, 0x1A))                Store (BA1B, Index(TEMP, 0x1B))                Store (BA1C, Index(TEMP, 0x1C))                Store (BA1D, Index(TEMP, 0x1D))                Store (BA1E, Index(TEMP, 0x1E))                Store (BA1F, Index(TEMP, 0x1F))                Return (TEMP)            }            Method (WRBA, 1, Serialized)            {                Name (TEMP, Buffer(0x20) { })                Store (Arg0, TEMP)                Store (DerefOf(Index(TEMP, 0x00)), BA00)                Store (DerefOf(Index(TEMP, 0x01)), BA01)                Store (DerefOf(Index(TEMP, 0x02)), BA02)                Store (DerefOf(Index(TEMP, 0x03)), BA03)                Store (DerefOf(Index(TEMP, 0x04)), BA04)                Store (DerefOf(Index(TEMP, 0x05)), BA05)                Store (DerefOf(Index(TEMP, 0x06)), BA06)                Store (DerefOf(Index(TEMP, 0x07)), BA07)                Store (DerefOf(Index(TEMP, 0x08)), BA08)                Store (DerefOf(Index(TEMP, 0x09)), BA09)                Store (DerefOf(Index(TEMP, 0x0A)), BA0A)                Store (DerefOf(Index(TEMP, 0x0B)), BA0B)                Store (DerefOf(Index(TEMP, 0x0C)), BA0C)                Store (DerefOf(Index(TEMP, 0x0D)), BA0D)                Store (DerefOf(Index(TEMP, 0x0E)), BA0E)                Store (DerefOf(Index(TEMP, 0x0F)), BA0F)                Store (DerefOf(Index(TEMP, 0x10)), BA10)                Store (DerefOf(Index(TEMP, 0x11)), BA11)                Store (DerefOf(Index(TEMP, 0x12)), BA12)                Store (DerefOf(Index(TEMP, 0x13)), BA13)                Store (DerefOf(Index(TEMP, 0x14)), BA14)                Store (DerefOf(Index(TEMP, 0x15)), BA15)                Store (DerefOf(Index(TEMP, 0x16)), BA16)                Store (DerefOf(Index(TEMP, 0x17)), BA17)                Store (DerefOf(Index(TEMP, 0x18)), BA18)                Store (DerefOf(Index(TEMP, 0x19)), BA19)                Store (DerefOf(Index(TEMP, 0x1A)), BA1A)                Store (DerefOf(Index(TEMP, 0x1B)), BA1B)                Store (DerefOf(Index(TEMP, 0x1C)), BA1C)                Store (DerefOf(Index(TEMP, 0x1D)), BA1D)                Store (DerefOf(Index(TEMP, 0x1E)), BA1E)                Store (DerefOf(Index(TEMP, 0x1F)), BA1F)            }            Method (RDBB, 0, Serialized)            {                Name (TEMP, Buffer(0x20) { })                Store (BB00, Index(TEMP, 0x00))                Store (BB01, Index(TEMP, 0x01))                Store (BB02, Index(TEMP, 0x02))                Store (BB03, Index(TEMP, 0x03))                Store (BB04, Index(TEMP, 0x04))                Store (BB05, Index(TEMP, 0x05))                Store (BB06, Index(TEMP, 0x06))                Store (BB07, Index(TEMP, 0x07))                Store (BB08, Index(TEMP, 0x08))                Store (BB09, Index(TEMP, 0x09))                Store (BB0A, Index(TEMP, 0x0A))                Store (BB0B, Index(TEMP, 0x0B))                Store (BB0C, Index(TEMP, 0x0C))                Store (BB0D, Index(TEMP, 0x0D))                Store (BB0E, Index(TEMP, 0x0E))                Store (BB0F, Index(TEMP, 0x0F))                Store (BB10, Index(TEMP, 0x10))                Store (BB11, Index(TEMP, 0x11))                Store (BB12, Index(TEMP, 0x12))                Store (BB13, Index(TEMP, 0x13))                Store (BB14, Index(TEMP, 0x14))                Store (BB15, Index(TEMP, 0x15))                Store (BB16, Index(TEMP, 0x16))                Store (BB17, Index(TEMP, 0x17))                Store (BB18, Index(TEMP, 0x18))                Store (BB19, Index(TEMP, 0x19))                Store (BB1A, Index(TEMP, 0x1A))                Store (BB1B, Index(TEMP, 0x1B))                Store (BB1C, Index(TEMP, 0x1C))                Store (BB1D, Index(TEMP, 0x1D))                Store (BB1E, Index(TEMP, 0x1E))                Store (BB1F, Index(TEMP, 0x1F))                Return (TEMP)            }            Method (WRBB, 1, Serialized)            {                Name (TEMP, Buffer(0x20) { })                Store (Arg0, TEMP)                Store (DerefOf(Index(TEMP, 0x00)), BB00)                Store (DerefOf(Index(TEMP, 0x01)), BB01)                Store (DerefOf(Index(TEMP, 0x02)), BB02)                Store (DerefOf(Index(TEMP, 0x03)), BB03)                Store (DerefOf(Index(TEMP, 0x04)), BB04)                Store (DerefOf(Index(TEMP, 0x05)), BB05)                Store (DerefOf(Index(TEMP, 0x06)), BB06)                Store (DerefOf(Index(TEMP, 0x07)), BB07)                Store (DerefOf(Index(TEMP, 0x08)), BB08)                Store (DerefOf(Index(TEMP, 0x09)), BB09)                Store (DerefOf(Index(TEMP, 0x0A)), BB0A)                Store (DerefOf(Index(TEMP, 0x0B)), BB0B)                Store (DerefOf(Index(TEMP, 0x0C)), BB0C)                Store (DerefOf(Index(TEMP, 0x0D)), BB0D)                Store (DerefOf(Index(TEMP, 0x0E)), BB0E)                Store (DerefOf(Index(TEMP, 0x0F)), BB0F)                Store (DerefOf(Index(TEMP, 0x10)), BB10)                Store (DerefOf(Index(TEMP, 0x11)), BB11)                Store (DerefOf(Index(TEMP, 0x12)), BB12)                Store (DerefOf(Index(TEMP, 0x13)), BB13)                Store (DerefOf(Index(TEMP, 0x14)), BB14)                Store (DerefOf(Index(TEMP, 0x15)), BB15)                Store (DerefOf(Index(TEMP, 0x16)), BB16)                Store (DerefOf(Index(TEMP, 0x17)), BB17)                Store (DerefOf(Index(TEMP, 0x18)), BB18)                Store (DerefOf(Index(TEMP, 0x19)), BB19)                Store (DerefOf(Index(TEMP, 0x1A)), BB1A)                Store (DerefOf(Index(TEMP, 0x1B)), BB1B)                Store (DerefOf(Index(TEMP, 0x1C)), BB1C)                Store (DerefOf(Index(TEMP, 0x1D)), BB1D)                Store (DerefOf(Index(TEMP, 0x1E)), BB1E)                Store (DerefOf(Index(TEMP, 0x1F)), BB1F)            }        }    }}</code></pre><p>Donâ€™t worry that the code does not compile at the moment. It is not expected at this point, due to the EC fields (and other identifiers) that are not defined in this file. They will need to be definined or referenced via External (eventually).</p><p>Now letâ€™s add the patched methods. Just like the methods that were added methods, the patched methods are just copied from the DSDT_patched.dsl:</p><pre><code>DefinitionBlock("", "SSDT", 2, "hack", "batt", 0){    // patched methods    Scope (_SB.PCI0)    {        Scope (BAT0)        {            Method (FBST, 4, NotSerialized)            {                And (Arg1, 0xFFFF, Local1)                Store (Zero, Local0)                If (^^LPCB.EC0.ACAP ())                {                    Store (One, Local0)                }                If (Local0)                {                    If (CHGS (Zero)){    Store (0x02, Local0)}Else{    Store (Zero, Local0)}                }                Else                {                    Store (One, Local0)                }                If (BLLO)                {                    ShiftLeft (One, 0x02, Local2)                    Or (Local0, Local2, Local0)                }                If (And (^^LPCB.EC0.EB0S, 0x08))                {                    ShiftLeft (One, 0x02, Local2)                    Or (Local0, Local2, Local0)                }                If (LGreaterEqual (Local1, 0x8000))                {                    Subtract (0xFFFF, Local1, Local1)                }                Store (Arg2, Local2)                If (LEqual (PUNT, Zero))                {                    Multiply (Local1, ^^LPCB.EC0.B0DV, Local1)                    Multiply (Local2, 0x0A, Local2)                }                And (Local0, 0x02, Local3)                If (LNot (Local3))                {                    Subtract (LFCC, Local2, Local3)                    Divide (LFCC, 0xC8, Local4, Local5)                    If (LLess (Local3, Local5))                    {                        Store (LFCC, Local2)                    }                }                Else                {                    Divide (LFCC, 0xC8, Local4, Local5)                    Subtract (LFCC, Local5, Local4)                    If (LGreater (Local2, Local4))                    {                        Store (Local4, Local2)                    }                }                If (LNot (^^LPCB.EC0.ACAP ()))                {                    Divide (Local2, MBLF, Local3, Local4)                    If (LLess (Local1, Local4))                    {                        Store (Local4, Local1)                    }                }                Store (Local0, Index (PBST, Zero))                Store (Local1, Index (PBST, One))                Store (Local2, Index (PBST, 0x02))                Store (Arg3, Index (PBST, 0x03))            }            Method (_BIX, 0, NotSerialized)  // _BIX: Battery Information Extended            {                If (LNot (^^LPCB.EC0.BATP (Zero)))                {                    Return (NBIX)                }                If (LEqual (^^LPCB.EC0.GBTT (Zero), 0xFF))                {                    Return (NBIX)                }                _BIF ()                Store (DerefOf (Index (PBIF, Zero)), Index (BIXT, One))                Store (DerefOf (Index (PBIF, One)), Index (BIXT, 0x02))                Store (DerefOf (Index (PBIF, 0x02)), Index (BIXT, 0x03))                Store (DerefOf (Index (PBIF, 0x03)), Index (BIXT, 0x04))                Store (DerefOf (Index (PBIF, 0x04)), Index (BIXT, 0x05))                Store (DerefOf (Index (PBIF, 0x05)), Index (BIXT, 0x06))                Store (DerefOf (Index (PBIF, 0x06)), Index (BIXT, 0x07))                Store (DerefOf (Index (PBIF, 0x07)), Index (BIXT, 0x0E))                Store (DerefOf (Index (PBIF, 0x08)), Index (BIXT, 0x0F))                Store (DerefOf (Index (PBIF, 0x09)), Index (BIXT, 0x10))                Store (DerefOf (Index (PBIF, 0x0A)), Index (BIXT, 0x11))                Store (DerefOf (Index (PBIF, 0x0B)), Index (BIXT, 0x12))                Store (DerefOf (Index (PBIF, 0x0C)), Index (BIXT, 0x13))                If (LEqual (DerefOf (Index (BIXT, One)), One))                {                    Store (Zero, Index (BIXT, One))                    Store (DerefOf (Index (BIXT, 0x05)), Local0)                    Multiply (DerefOf (Index (BIXT, 0x02)), Local0, Index (BIXT, 0x02))                    Multiply (DerefOf (Index (BIXT, 0x03)), Local0, Index (BIXT, 0x03))                    Multiply (DerefOf (Index (BIXT, 0x06)), Local0, Index (BIXT, 0x06))                    Multiply (DerefOf (Index (BIXT, 0x07)), Local0, Index (BIXT, 0x07))                    Multiply (DerefOf (Index (BIXT, 0x0E)), Local0, Index (BIXT, 0x0E))                    Multiply (DerefOf (Index (BIXT, 0x0F)), Local0, Index (BIXT, 0x0F))                    Divide (DerefOf (Index (BIXT, 0x02)), 0x03E8, Local0, Index (BIXT, 0x02))                    Divide (DerefOf (Index (BIXT, 0x03)), 0x03E8, Local0, Index (BIXT, 0x03))                    Divide (DerefOf (Index (BIXT, 0x06)), 0x03E8, Local0, Index (BIXT, 0x06))                    Divide (DerefOf (Index (BIXT, 0x07)), 0x03E8, Local0, Index (BIXT, 0x07))                    Divide (DerefOf (Index (BIXT, 0x0E)), 0x03E8, Local0, Index (BIXT, 0x0E))                    Divide (DerefOf (Index (BIXT, 0x0F)), 0x03E8, Local0, Index (BIXT, 0x0F))                }                Store (B1B2(^^LPCB.EC0.XC30,^^LPCB.EC0.XC31), Index (BIXT, 0x08))                Store (0x0001869F, Index (BIXT, 0x09))                Return (BIXT)            }    }    }    Scope (_SB.PCI0.LPCB.EC0)    {        Method (BIFA, 0, NotSerialized)        {            If (ECAV ())            {                If (BSLF)                {                    Store (B1B2(B1S0,B1S1), Local0)                }                Else                {                    Store (B1B2(B0S0,B0S1), Local0)                }            }            Else            {                Store (Ones, Local0)            }            Return (Local0)        }    }    Method (B1B2, 2, NotSerialized) { Return (Or (Arg0, ShiftLeft (Arg1, 8))) }    // added methods (group 2)    Scope (_SB.PCI0.LPCB.EC0)    {        Scope (EC0)        {            Method (RDBA, 0, Serialized)            {                Name (TEMP, Buffer(0x20) { })                Store (BA00, Index(TEMP, 0x00))                Store (BA01, Index(TEMP, 0x01))                Store (BA02, Index(TEMP, 0x02))                Store (BA03, Index(TEMP, 0x03))                Store (BA04, Index(TEMP, 0x04))                Store (BA05, Index(TEMP, 0x05))                Store (BA06, Index(TEMP, 0x06))                Store (BA07, Index(TEMP, 0x07))                Store (BA08, Index(TEMP, 0x08))                Store (BA09, Index(TEMP, 0x09))                Store (BA0A, Index(TEMP, 0x0A))                Store (BA0B, Index(TEMP, 0x0B))                Store (BA0C, Index(TEMP, 0x0C))                Store (BA0D, Index(TEMP, 0x0D))                Store (BA0E, Index(TEMP, 0x0E))                Store (BA0F, Index(TEMP, 0x0F))                Store (BA10, Index(TEMP, 0x10))                Store (BA11, Index(TEMP, 0x11))                Store (BA12, Index(TEMP, 0x12))                Store (BA13, Index(TEMP, 0x13))                Store (BA14, Index(TEMP, 0x14))                Store (BA15, Index(TEMP, 0x15))                Store (BA16, Index(TEMP, 0x16))                Store (BA17, Index(TEMP, 0x17))                Store (BA18, Index(TEMP, 0x18))                Store (BA19, Index(TEMP, 0x19))                Store (BA1A, Index(TEMP, 0x1A))                Store (BA1B, Index(TEMP, 0x1B))                Store (BA1C, Index(TEMP, 0x1C))                Store (BA1D, Index(TEMP, 0x1D))                Store (BA1E, Index(TEMP, 0x1E))                Store (BA1F, Index(TEMP, 0x1F))                Return (TEMP)            }            Method (WRBA, 1, Serialized)            {                Name (TEMP, Buffer(0x20) { })                Store (Arg0, TEMP)                Store (DerefOf(Index(TEMP, 0x00)), BA00)                Store (DerefOf(Index(TEMP, 0x01)), BA01)                Store (DerefOf(Index(TEMP, 0x02)), BA02)                Store (DerefOf(Index(TEMP, 0x03)), BA03)                Store (DerefOf(Index(TEMP, 0x04)), BA04)                Store (DerefOf(Index(TEMP, 0x05)), BA05)                Store (DerefOf(Index(TEMP, 0x06)), BA06)                Store (DerefOf(Index(TEMP, 0x07)), BA07)                Store (DerefOf(Index(TEMP, 0x08)), BA08)                Store (DerefOf(Index(TEMP, 0x09)), BA09)                Store (DerefOf(Index(TEMP, 0x0A)), BA0A)                Store (DerefOf(Index(TEMP, 0x0B)), BA0B)                Store (DerefOf(Index(TEMP, 0x0C)), BA0C)                Store (DerefOf(Index(TEMP, 0x0D)), BA0D)                Store (DerefOf(Index(TEMP, 0x0E)), BA0E)                Store (DerefOf(Index(TEMP, 0x0F)), BA0F)                Store (DerefOf(Index(TEMP, 0x10)), BA10)                Store (DerefOf(Index(TEMP, 0x11)), BA11)                Store (DerefOf(Index(TEMP, 0x12)), BA12)                Store (DerefOf(Index(TEMP, 0x13)), BA13)                Store (DerefOf(Index(TEMP, 0x14)), BA14)                Store (DerefOf(Index(TEMP, 0x15)), BA15)                Store (DerefOf(Index(TEMP, 0x16)), BA16)                Store (DerefOf(Index(TEMP, 0x17)), BA17)                Store (DerefOf(Index(TEMP, 0x18)), BA18)                Store (DerefOf(Index(TEMP, 0x19)), BA19)                Store (DerefOf(Index(TEMP, 0x1A)), BA1A)                Store (DerefOf(Index(TEMP, 0x1B)), BA1B)                Store (DerefOf(Index(TEMP, 0x1C)), BA1C)                Store (DerefOf(Index(TEMP, 0x1D)), BA1D)                Store (DerefOf(Index(TEMP, 0x1E)), BA1E)                Store (DerefOf(Index(TEMP, 0x1F)), BA1F)            }            Method (RDBB, 0, Serialized)            {                Name (TEMP, Buffer(0x20) { })                Store (BB00, Index(TEMP, 0x00))                Store (BB01, Index(TEMP, 0x01))                Store (BB02, Index(TEMP, 0x02))                Store (BB03, Index(TEMP, 0x03))                Store (BB04, Index(TEMP, 0x04))                Store (BB05, Index(TEMP, 0x05))                Store (BB06, Index(TEMP, 0x06))                Store (BB07, Index(TEMP, 0x07))                Store (BB08, Index(TEMP, 0x08))                Store (BB09, Index(TEMP, 0x09))                Store (BB0A, Index(TEMP, 0x0A))                Store (BB0B, Index(TEMP, 0x0B))                Store (BB0C, Index(TEMP, 0x0C))                Store (BB0D, Index(TEMP, 0x0D))                Store (BB0E, Index(TEMP, 0x0E))                Store (BB0F, Index(TEMP, 0x0F))                Store (BB10, Index(TEMP, 0x10))                Store (BB11, Index(TEMP, 0x11))                Store (BB12, Index(TEMP, 0x12))                Store (BB13, Index(TEMP, 0x13))                Store (BB14, Index(TEMP, 0x14))                Store (BB15, Index(TEMP, 0x15))                Store (BB16, Index(TEMP, 0x16))                Store (BB17, Index(TEMP, 0x17))                Store (BB18, Index(TEMP, 0x18))                Store (BB19, Index(TEMP, 0x19))                Store (BB1A, Index(TEMP, 0x1A))                Store (BB1B, Index(TEMP, 0x1B))                Store (BB1C, Index(TEMP, 0x1C))                Store (BB1D, Index(TEMP, 0x1D))                Store (BB1E, Index(TEMP, 0x1E))                Store (BB1F, Index(TEMP, 0x1F))                Return (TEMP)            }            Method (WRBB, 1, Serialized)            {                Name (TEMP, Buffer(0x20) { })                Store (Arg0, TEMP)                Store (DerefOf(Index(TEMP, 0x00)), BB00)                Store (DerefOf(Index(TEMP, 0x01)), BB01)                Store (DerefOf(Index(TEMP, 0x02)), BB02)                Store (DerefOf(Index(TEMP, 0x03)), BB03)                Store (DerefOf(Index(TEMP, 0x04)), BB04)                Store (DerefOf(Index(TEMP, 0x05)), BB05)                Store (DerefOf(Index(TEMP, 0x06)), BB06)                Store (DerefOf(Index(TEMP, 0x07)), BB07)                Store (DerefOf(Index(TEMP, 0x08)), BB08)                Store (DerefOf(Index(TEMP, 0x09)), BB09)                Store (DerefOf(Index(TEMP, 0x0A)), BB0A)                Store (DerefOf(Index(TEMP, 0x0B)), BB0B)                Store (DerefOf(Index(TEMP, 0x0C)), BB0C)                Store (DerefOf(Index(TEMP, 0x0D)), BB0D)                Store (DerefOf(Index(TEMP, 0x0E)), BB0E)                Store (DerefOf(Index(TEMP, 0x0F)), BB0F)                Store (DerefOf(Index(TEMP, 0x10)), BB10)                Store (DerefOf(Index(TEMP, 0x11)), BB11)                Store (DerefOf(Index(TEMP, 0x12)), BB12)                Store (DerefOf(Index(TEMP, 0x13)), BB13)                Store (DerefOf(Index(TEMP, 0x14)), BB14)                Store (DerefOf(Index(TEMP, 0x15)), BB15)                Store (DerefOf(Index(TEMP, 0x16)), BB16)                Store (DerefOf(Index(TEMP, 0x17)), BB17)                Store (DerefOf(Index(TEMP, 0x18)), BB18)                Store (DerefOf(Index(TEMP, 0x19)), BB19)                Store (DerefOf(Index(TEMP, 0x1A)), BB1A)                Store (DerefOf(Index(TEMP, 0x1B)), BB1B)                Store (DerefOf(Index(TEMP, 0x1C)), BB1C)                Store (DerefOf(Index(TEMP, 0x1D)), BB1D)                Store (DerefOf(Index(TEMP, 0x1E)), BB1E)                Store (DerefOf(Index(TEMP, 0x1F)), BB1F)            }        }    }            }</code></pre><p>Notice how FBST and _BIX were added to scope _SB.PCI0.BAT0, but BIFA was added to _SB.PCI0.LPCB.EC0. It is important to inject all methods into their original scope.</p><p>Now, we add SMBR, SMBW, ECSB, and TACH:</p><pre><code>DefinitionBlock("", "SSDT", 2, "hack", "batt", 0){    // patched methods    Scope (_SB.PCI0)    {        Scope (BAT0)        {            Method (FBST, 4, NotSerialized)            {                And (Arg1, 0xFFFF, Local1)                Store (Zero, Local0)                If (^^LPCB.EC0.ACAP ())                {                    Store (One, Local0)                }                If (Local0)                {                    If (CHGS (Zero)){    Store (0x02, Local0)}Else{    Store (Zero, Local0)}                }                Else                {                    Store (One, Local0)                }                If (BLLO)                {                    ShiftLeft (One, 0x02, Local2)                    Or (Local0, Local2, Local0)                }                If (And (^^LPCB.EC0.EB0S, 0x08))                {                    ShiftLeft (One, 0x02, Local2)                    Or (Local0, Local2, Local0)                }                If (LGreaterEqual (Local1, 0x8000))                {                    Subtract (0xFFFF, Local1, Local1)                }                Store (Arg2, Local2)                If (LEqual (PUNT, Zero))                {                    Multiply (Local1, ^^LPCB.EC0.B0DV, Local1)                    Multiply (Local2, 0x0A, Local2)                }                And (Local0, 0x02, Local3)                If (LNot (Local3))                {                    Subtract (LFCC, Local2, Local3)                    Divide (LFCC, 0xC8, Local4, Local5)                    If (LLess (Local3, Local5))                    {                        Store (LFCC, Local2)                    }                }                Else                {                    Divide (LFCC, 0xC8, Local4, Local5)                    Subtract (LFCC, Local5, Local4)                    If (LGreater (Local2, Local4))                    {                        Store (Local4, Local2)                    }                }                If (LNot (^^LPCB.EC0.ACAP ()))                {                    Divide (Local2, MBLF, Local3, Local4)                    If (LLess (Local1, Local4))                    {                        Store (Local4, Local1)                    }                }                Store (Local0, Index (PBST, Zero))                Store (Local1, Index (PBST, One))                Store (Local2, Index (PBST, 0x02))                Store (Arg3, Index (PBST, 0x03))            }            Method (_BIX, 0, NotSerialized)  // _BIX: Battery Information Extended            {                If (LNot (^^LPCB.EC0.BATP (Zero)))                {                    Return (NBIX)                }                If (LEqual (^^LPCB.EC0.GBTT (Zero), 0xFF))                {                    Return (NBIX)                }                _BIF ()                Store (DerefOf (Index (PBIF, Zero)), Index (BIXT, One))                Store (DerefOf (Index (PBIF, One)), Index (BIXT, 0x02))                Store (DerefOf (Index (PBIF, 0x02)), Index (BIXT, 0x03))                Store (DerefOf (Index (PBIF, 0x03)), Index (BIXT, 0x04))                Store (DerefOf (Index (PBIF, 0x04)), Index (BIXT, 0x05))                Store (DerefOf (Index (PBIF, 0x05)), Index (BIXT, 0x06))                Store (DerefOf (Index (PBIF, 0x06)), Index (BIXT, 0x07))                Store (DerefOf (Index (PBIF, 0x07)), Index (BIXT, 0x0E))                Store (DerefOf (Index (PBIF, 0x08)), Index (BIXT, 0x0F))                Store (DerefOf (Index (PBIF, 0x09)), Index (BIXT, 0x10))                Store (DerefOf (Index (PBIF, 0x0A)), Index (BIXT, 0x11))                Store (DerefOf (Index (PBIF, 0x0B)), Index (BIXT, 0x12))                Store (DerefOf (Index (PBIF, 0x0C)), Index (BIXT, 0x13))                If (LEqual (DerefOf (Index (BIXT, One)), One))                {                    Store (Zero, Index (BIXT, One))                    Store (DerefOf (Index (BIXT, 0x05)), Local0)                    Multiply (DerefOf (Index (BIXT, 0x02)), Local0, Index (BIXT, 0x02))                    Multiply (DerefOf (Index (BIXT, 0x03)), Local0, Index (BIXT, 0x03))                    Multiply (DerefOf (Index (BIXT, 0x06)), Local0, Index (BIXT, 0x06))                    Multiply (DerefOf (Index (BIXT, 0x07)), Local0, Index (BIXT, 0x07))                    Multiply (DerefOf (Index (BIXT, 0x0E)), Local0, Index (BIXT, 0x0E))                    Multiply (DerefOf (Index (BIXT, 0x0F)), Local0, Index (BIXT, 0x0F))                    Divide (DerefOf (Index (BIXT, 0x02)), 0x03E8, Local0, Index (BIXT, 0x02))                    Divide (DerefOf (Index (BIXT, 0x03)), 0x03E8, Local0, Index (BIXT, 0x03))                    Divide (DerefOf (Index (BIXT, 0x06)), 0x03E8, Local0, Index (BIXT, 0x06))                    Divide (DerefOf (Index (BIXT, 0x07)), 0x03E8, Local0, Index (BIXT, 0x07))                    Divide (DerefOf (Index (BIXT, 0x0E)), 0x03E8, Local0, Index (BIXT, 0x0E))                    Divide (DerefOf (Index (BIXT, 0x0F)), 0x03E8, Local0, Index (BIXT, 0x0F))                }                Store (B1B2(^^LPCB.EC0.XC30,^^LPCB.EC0.XC31), Index (BIXT, 0x08))                Store (0x0001869F, Index (BIXT, 0x09))                Return (BIXT)            }    }    }    Scope (_SB.PCI0.LPCB.EC0)    {        Method (BIFA, 0, NotSerialized)        {            If (ECAV ())            {                If (BSLF)                {                    Store (B1B2(B1S0,B1S1), Local0)                }                Else                {                    Store (B1B2(B0S0,B0S1), Local0)                }            }            Else            {                Store (Ones, Local0)            }            Return (Local0)        }        Method (SMBR, 3, Serialized)        {            Store (Package (0x03)                {                    0x07,                    Zero,                    Zero                }, Local0)            If (LNot (ECAV ()))            {                Return (Local0)            }            If (LNotEqual (Arg0, RDBL))            {                If (LNotEqual (Arg0, RDWD))                {                    If (LNotEqual (Arg0, RDBT))                    {                        If (LNotEqual (Arg0, RCBT))                        {                            If (LNotEqual (Arg0, RDQK))                            {                                Return (Local0)                            }                        }                    }                }            }            Acquire (MUEC, 0xFFFF)            Store (PRTC, Local1)            Store (Zero, Local2)            While (LNotEqual (Local1, Zero))            {                Stall (0x0A)                Increment (Local2)                If (LGreater (Local2, 0x03E8))                {                    Store (SBBY, Index (Local0, Zero))                    Store (Zero, Local1)                }                Else                {                    Store (PRTC, Local1)                }            }            If (LLessEqual (Local2, 0x03E8))            {                ShiftLeft (Arg1, One, Local3)                Or (Local3, One, Local3)                Store (Local3, ADDR)                If (LNotEqual (Arg0, RDQK))                {                    If (LNotEqual (Arg0, RCBT))                    {                        Store (Arg2, CMDB)                    }                }                WRBA(Zero)                Store (Arg0, PRTC)                Store (SWTC (Arg0), Index (Local0, Zero))                If (LEqual (DerefOf (Index (Local0, Zero)), Zero))                {                    If (LEqual (Arg0, RDBL))                    {                        Store (BCNT, Index (Local0, One))                        Store (RDBA(), Index (Local0, 0x02))                    }                    If (LEqual (Arg0, RDWD))                    {                        Store (0x02, Index (Local0, One))                        Store (B1B2(T2B0,T2B1), Index (Local0, 0x02))                    }                    If (LEqual (Arg0, RDBT))                    {                        Store (One, Index (Local0, One))                        Store (DAT0, Index (Local0, 0x02))                    }                    If (LEqual (Arg0, RCBT))                    {                        Store (One, Index (Local0, One))                        Store (DAT0, Index (Local0, 0x02))                    }                }            }            Release (MUEC)            Return (Local0)        }        Method (SMBW, 5, Serialized)        {            Store (Package (0x01)                {                    0x07                }, Local0)            If (LNot (ECAV ()))            {                Return (Local0)            }            If (LNotEqual (Arg0, WRBL))            {                If (LNotEqual (Arg0, WRWD))                {                    If (LNotEqual (Arg0, WRBT))                    {                        If (LNotEqual (Arg0, SDBT))                        {                            If (LNotEqual (Arg0, WRQK))                            {                                Return (Local0)                            }                        }                    }                }            }            Acquire (MUEC, 0xFFFF)            Store (PRTC, Local1)            Store (Zero, Local2)            While (LNotEqual (Local1, Zero))            {                Stall (0x0A)                Increment (Local2)                If (LGreater (Local2, 0x03E8))                {                    Store (SBBY, Index (Local0, Zero))                    Store (Zero, Local1)                }                Else                {                    Store (PRTC, Local1)                }            }            If (LLessEqual (Local2, 0x03E8))            {                WRBA(Zero)                ShiftLeft (Arg1, One, Local3)                Store (Local3, ADDR)                If (LNotEqual (Arg0, WRQK))                {                    If (LNotEqual (Arg0, SDBT))                    {                        Store (Arg2, CMDB)                    }                }                If (LEqual (Arg0, WRBL))                {                    Store (Arg3, BCNT)                    WRBA(Arg4)                }                If (LEqual (Arg0, WRWD))                {                    Store(Arg4,T2B0) Store(ShiftRight(Arg4,8),T2B1)                }                If (LEqual (Arg0, WRBT))                {                    Store (Arg4, DAT0)                }                If (LEqual (Arg0, SDBT))                {                    Store (Arg4, DAT0)                }                Store (Arg0, PRTC)                Store (SWTC (Arg0), Index (Local0, Zero))            }            Release (MUEC)            Return (Local0)        }        Method (ECSB, 7, NotSerialized)        {            Store (Package (0x05)                {                    0x11,                    Zero,                    Zero,                    Zero,                    Buffer (0x20){}                }, Local1)            If (LGreater (Arg0, One))            {                Return (Local1)            }            If (ECAV ())            {                Acquire (MUEC, 0xFFFF)                If (LEqual (Arg0, Zero))                {                    Store (PRTC, Local0)                }                Else                {                    Store (PRT2, Local0)                }                Store (Zero, Local2)                While (LNotEqual (Local0, Zero))                {                    Stall (0x0A)                    Increment (Local2)                    If (LGreater (Local2, 0x03E8))                    {                        Store (SBBY, Index (Local1, Zero))                        Store (Zero, Local0)                    }                    ElseIf (LEqual (Arg0, Zero))                    {                        Store (PRTC, Local0)                    }                    Else                    {                        Store (PRT2, Local0)                    }                }                If (LLessEqual (Local2, 0x03E8))                {                    If (LEqual (Arg0, Zero))                    {                        Store (Arg2, ADDR)                        Store (Arg3, CMDB)                        If (LOr (LEqual (Arg1, 0x0A), LEqual (Arg1, 0x0B)))                        {                            Store (DerefOf (Index (Arg6, Zero)), BCNT)                            WRBA(DerefOf (Index (Arg6, One)))                        }                        Else                        {                            Store (Arg4, DAT0)                            Store (Arg5, DAT1)                        }                        Store (Arg1, PRTC)                    }                    Else                    {                        Store (Arg2, ADD2)                        Store (Arg3, CMD2)                        If (LOr (LEqual (Arg1, 0x0A), LEqual (Arg1, 0x0B)))                        {                            Store (DerefOf (Index (Arg6, Zero)), BCN2)                            WRBB(DerefOf (Index (Arg6, One)))                        }                        Else                        {                            Store (Arg4, DA20)                            Store (Arg5, DA21)                        }                        Store (Arg1, PRT2)                    }                    Store (0x7F, Local0)                    If (LEqual (Arg0, Zero))                    {                        While (PRTC)                        {                            Sleep (One)                            Decrement (Local0)                        }                    }                    Else                    {                        While (PRT2)                        {                            Sleep (One)                            Decrement (Local0)                        }                    }                    If (Local0)                    {                        If (LEqual (Arg0, Zero))                        {                            Store (SSTS, Local0)                            Store (DAT0, Index (Local1, One))                            Store (DAT1, Index (Local1, 0x02))                            Store (BCNT, Index (Local1, 0x03))                            Store (RDBA(), Index (Local1, 0x04))                        }                        Else                        {                            Store (SST2, Local0)                            Store (DA20, Index (Local1, One))                            Store (DA21, Index (Local1, 0x02))                            Store (BCN2, Index (Local1, 0x03))                            Store (RDBB(), Index (Local1, 0x04))                        }                        And (Local0, 0x1F, Local0)                        If (Local0)                        {                            Add (Local0, 0x10, Local0)                        }                        Store (Local0, Index (Local1, Zero))                    }                    Else                    {                        Store (0x10, Index (Local1, Zero))                    }                }                Release (MUEC)            }            Return (Local1)        }        Method (TACH, 1, Serialized)        {            If (ECAV ())            {                Switch (Arg0)                {                    Case (Zero)                    {                        Store (B1B2(TH00,TH01), Local0)                        Break                    }                    Case (One)                    {                        Store (B1B2(TH10,TH11), Local0)                        Break                    }                    Default                    {                        Return (Ones)                    }                }                Multiply (Local0, 0x02, Local0)                If (LNotEqual (Local0, Zero))                {                    Divide (0x0041CDB4, Local0, Local1, Local0)                    Return (Local0)                }                Else                {                    Return (Ones)                }            }            Else            {                Return (Ones)            }        }        }    Method (B1B2, 2, NotSerialized) { Return (Or (Arg0, ShiftLeft (Arg1, 8))) }    // added methods (group 2)    Scope (_SB.PCI0.LPCB)    {        Scope (EC0)        {            Method (RDBA, 0, Serialized)            {                Name (TEMP, Buffer(0x20) { })                Store (BA00, Index(TEMP, 0x00))                Store (BA01, Index(TEMP, 0x01))                Store (BA02, Index(TEMP, 0x02))                Store (BA03, Index(TEMP, 0x03))                Store (BA04, Index(TEMP, 0x04))                Store (BA05, Index(TEMP, 0x05))                Store (BA06, Index(TEMP, 0x06))                Store (BA07, Index(TEMP, 0x07))                Store (BA08, Index(TEMP, 0x08))                Store (BA09, Index(TEMP, 0x09))                Store (BA0A, Index(TEMP, 0x0A))                Store (BA0B, Index(TEMP, 0x0B))                Store (BA0C, Index(TEMP, 0x0C))                Store (BA0D, Index(TEMP, 0x0D))                Store (BA0E, Index(TEMP, 0x0E))                Store (BA0F, Index(TEMP, 0x0F))                Store (BA10, Index(TEMP, 0x10))                Store (BA11, Index(TEMP, 0x11))                Store (BA12, Index(TEMP, 0x12))                Store (BA13, Index(TEMP, 0x13))                Store (BA14, Index(TEMP, 0x14))                Store (BA15, Index(TEMP, 0x15))                Store (BA16, Index(TEMP, 0x16))                Store (BA17, Index(TEMP, 0x17))                Store (BA18, Index(TEMP, 0x18))                Store (BA19, Index(TEMP, 0x19))                Store (BA1A, Index(TEMP, 0x1A))                Store (BA1B, Index(TEMP, 0x1B))                Store (BA1C, Index(TEMP, 0x1C))                Store (BA1D, Index(TEMP, 0x1D))                Store (BA1E, Index(TEMP, 0x1E))                Store (BA1F, Index(TEMP, 0x1F))                Return (TEMP)            }            Method (WRBA, 1, Serialized)            {                Name (TEMP, Buffer(0x20) { })                Store (Arg0, TEMP)                Store (DerefOf(Index(TEMP, 0x00)), BA00)                Store (DerefOf(Index(TEMP, 0x01)), BA01)                Store (DerefOf(Index(TEMP, 0x02)), BA02)                Store (DerefOf(Index(TEMP, 0x03)), BA03)                Store (DerefOf(Index(TEMP, 0x04)), BA04)                Store (DerefOf(Index(TEMP, 0x05)), BA05)                Store (DerefOf(Index(TEMP, 0x06)), BA06)                Store (DerefOf(Index(TEMP, 0x07)), BA07)                Store (DerefOf(Index(TEMP, 0x08)), BA08)                Store (DerefOf(Index(TEMP, 0x09)), BA09)                Store (DerefOf(Index(TEMP, 0x0A)), BA0A)                Store (DerefOf(Index(TEMP, 0x0B)), BA0B)                Store (DerefOf(Index(TEMP, 0x0C)), BA0C)                Store (DerefOf(Index(TEMP, 0x0D)), BA0D)                Store (DerefOf(Index(TEMP, 0x0E)), BA0E)                Store (DerefOf(Index(TEMP, 0x0F)), BA0F)                Store (DerefOf(Index(TEMP, 0x10)), BA10)                Store (DerefOf(Index(TEMP, 0x11)), BA11)                Store (DerefOf(Index(TEMP, 0x12)), BA12)                Store (DerefOf(Index(TEMP, 0x13)), BA13)                Store (DerefOf(Index(TEMP, 0x14)), BA14)                Store (DerefOf(Index(TEMP, 0x15)), BA15)                Store (DerefOf(Index(TEMP, 0x16)), BA16)                Store (DerefOf(Index(TEMP, 0x17)), BA17)                Store (DerefOf(Index(TEMP, 0x18)), BA18)                Store (DerefOf(Index(TEMP, 0x19)), BA19)                Store (DerefOf(Index(TEMP, 0x1A)), BA1A)                Store (DerefOf(Index(TEMP, 0x1B)), BA1B)                Store (DerefOf(Index(TEMP, 0x1C)), BA1C)                Store (DerefOf(Index(TEMP, 0x1D)), BA1D)                Store (DerefOf(Index(TEMP, 0x1E)), BA1E)                Store (DerefOf(Index(TEMP, 0x1F)), BA1F)            }            Method (RDBB, 0, Serialized)            {                Name (TEMP, Buffer(0x20) { })                Store (BB00, Index(TEMP, 0x00))                Store (BB01, Index(TEMP, 0x01))                Store (BB02, Index(TEMP, 0x02))                Store (BB03, Index(TEMP, 0x03))                Store (BB04, Index(TEMP, 0x04))                Store (BB05, Index(TEMP, 0x05))                Store (BB06, Index(TEMP, 0x06))                Store (BB07, Index(TEMP, 0x07))                Store (BB08, Index(TEMP, 0x08))                Store (BB09, Index(TEMP, 0x09))                Store (BB0A, Index(TEMP, 0x0A))                Store (BB0B, Index(TEMP, 0x0B))                Store (BB0C, Index(TEMP, 0x0C))                Store (BB0D, Index(TEMP, 0x0D))                Store (BB0E, Index(TEMP, 0x0E))                Store (BB0F, Index(TEMP, 0x0F))                Store (BB10, Index(TEMP, 0x10))                Store (BB11, Index(TEMP, 0x11))                Store (BB12, Index(TEMP, 0x12))                Store (BB13, Index(TEMP, 0x13))                Store (BB14, Index(TEMP, 0x14))                Store (BB15, Index(TEMP, 0x15))                Store (BB16, Index(TEMP, 0x16))                Store (BB17, Index(TEMP, 0x17))                Store (BB18, Index(TEMP, 0x18))                Store (BB19, Index(TEMP, 0x19))                Store (BB1A, Index(TEMP, 0x1A))                Store (BB1B, Index(TEMP, 0x1B))                Store (BB1C, Index(TEMP, 0x1C))                Store (BB1D, Index(TEMP, 0x1D))                Store (BB1E, Index(TEMP, 0x1E))                Store (BB1F, Index(TEMP, 0x1F))                Return (TEMP)            }            Method (WRBB, 1, Serialized)            {                Name (TEMP, Buffer(0x20) { })                Store (Arg0, TEMP)                Store (DerefOf(Index(TEMP, 0x00)), BB00)                Store (DerefOf(Index(TEMP, 0x01)), BB01)                Store (DerefOf(Index(TEMP, 0x02)), BB02)                Store (DerefOf(Index(TEMP, 0x03)), BB03)                Store (DerefOf(Index(TEMP, 0x04)), BB04)                Store (DerefOf(Index(TEMP, 0x05)), BB05)                Store (DerefOf(Index(TEMP, 0x06)), BB06)                Store (DerefOf(Index(TEMP, 0x07)), BB07)                Store (DerefOf(Index(TEMP, 0x08)), BB08)                Store (DerefOf(Index(TEMP, 0x09)), BB09)                Store (DerefOf(Index(TEMP, 0x0A)), BB0A)                Store (DerefOf(Index(TEMP, 0x0B)), BB0B)                Store (DerefOf(Index(TEMP, 0x0C)), BB0C)                Store (DerefOf(Index(TEMP, 0x0D)), BB0D)                Store (DerefOf(Index(TEMP, 0x0E)), BB0E)                Store (DerefOf(Index(TEMP, 0x0F)), BB0F)                Store (DerefOf(Index(TEMP, 0x10)), BB10)                Store (DerefOf(Index(TEMP, 0x11)), BB11)                Store (DerefOf(Index(TEMP, 0x12)), BB12)                Store (DerefOf(Index(TEMP, 0x13)), BB13)                Store (DerefOf(Index(TEMP, 0x14)), BB14)                Store (DerefOf(Index(TEMP, 0x15)), BB15)                Store (DerefOf(Index(TEMP, 0x16)), BB16)                Store (DerefOf(Index(TEMP, 0x17)), BB17)                Store (DerefOf(Index(TEMP, 0x18)), BB18)                Store (DerefOf(Index(TEMP, 0x19)), BB19)                Store (DerefOf(Index(TEMP, 0x1A)), BB1A)                Store (DerefOf(Index(TEMP, 0x1B)), BB1B)                Store (DerefOf(Index(TEMP, 0x1C)), BB1C)                Store (DerefOf(Index(TEMP, 0x1D)), BB1D)                Store (DerefOf(Index(TEMP, 0x1E)), BB1E)                Store (DerefOf(Index(TEMP, 0x1F)), BB1F)            }        }    }}</code></pre><p>With all the nodes expanded in MaciASL, our work looks like this:<br><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypvtw1v2ej30r10hr41s.jpg" alt=""></p><h3 id="Resolving-errors"><a href="#Resolving-errors" class="headerlink" title="Resolving errors"></a>Resolving errors</h3><p>Now we need to start resolving errors by using External or defining the patched EC fields as necessary.<br>We can use the compiler to help.</p><p>Clicking Compile will show the first error: â€œ3, 6085, Object not found or not accessible from scope (_SB.PCI0)â€<br>It is at this line:</p><pre><code>Scope (_SB.PCI0)</code></pre><p>The compiler is indicating that _SB.PCI0 is not declared, so you canâ€™t use it in a Scope operator.</p><p>We need to declare it with External, as the scope is actually defined in another file (DSDT.aml):<br>Add it to the top of the file:</p><pre><code>DefinitionBlock("", "SSDT", 2, "hack", "batt", 0){    External(_SB.PCI0, DeviceObj)    Scope (_SB.PCI0)    {...</code></pre><p>Now the next error is at â€œScope(BAT0)â€, so, again:</p><pre><code>DefinitionBlock("", "SSDT", 2, "hack", "batt", 0){    External(_SB.PCI0, DeviceObj)    External(_SB.PCI0.BAT0, DeviceObj)    Scope (_SB.PCI0)    {        Scope (BAT0)        {...</code></pre><p>The next error is â€œ13, 6085, Object not found or not accessible from scope (^^LPCB.EC0.ACAP)â€<br>We can tell from the code referencing ACAP that it is a method:</p><pre><code>If (^^LPCB.EC0.ACAP ())</code></pre><p>Note: Method calls are indicated by the â€œ()â€ (in this case, an empty parameter list).</p><p>So, we know we can add an External as MethodObj:</p><pre><code>DefinitionBlock("", "SSDT", 2, "hack", "batt", 0){    External(_SB.PCI0, DeviceObj)    External(_SB.PCI0.BAT0, DeviceObj)    External(_SB.PCI0.LPCB.EC0.ACAP, MethodObj)...}</code></pre><p>Note: The path ^^LPCB.EC0.ACAP is equivalent to _SB.PCI0.LPCB.EC0.ACAP because the reference was in scope _SB.PCI0.BAT0.FBST (the path of the FBST method). Each ^ (parent of) operator walks up the current scope by one item, so ^ is _SB.PCI0.BAT0, and ^^ is _SB.PCI0.</p><p>In some cases, you need to look at the DSDT to find the path and/or type of a given identifier. For example, the next error has to do with CHGS. Again, we know it is a method as it is the target of a method call, but for the path, we must refer to the DSDT:<br>Code (Text):</p><pre><code>Scope (\){    Method (CHGS, 1, Serialized)    {        Store (\_SB.PCI0.LPCB.EC0.BCHG (Arg0), Local0)        Return (Local0)    }</code></pre><p>So, it is in the root:</p><pre><code>DefinitionBlock("", "SSDT", 2, "hack", "batt", 0){    External(_SB.PCI0, DeviceObj)    External(_SB.PCI0.BAT0, DeviceObj)    External(_SB.PCI0.LPCB.EC0.ACAP, MethodObj)    External(CHGS, MethodObj)...</code></pre><p>The next undefined symbol, BLLO, is something other than a method:</p><pre><code>If (BLLO){</code></pre><p>Looking in DSDT, we find it is defined with Name (and it happens to be in root scope):</p><pre><code>Name (BLLO, Zero)</code></pre><p>Which makes it an IntObj:</p><pre><code>DefinitionBlock("", "SSDT", 2, "hack", "batt", 0){    External(_SB.PCI0, DeviceObj)    External(_SB.PCI0.BAT0, DeviceObj)    External(_SB.PCI0.LPCB.EC0.ACAP, MethodObj)    External(CHGS, MethodObj)    External(BLLO, IntObj)...</code></pre><p>Fixing all the errors in the FBST method:</p><pre><code>DefinitionBlock("", "SSDT", 2, "hack", "batt", 0){    External(_SB.PCI0, DeviceObj)    External(_SB.PCI0.BAT0, DeviceObj)    External(_SB.PCI0.LPCB.EC0.ACAP, MethodObj)    External(CHGS, MethodObj)    External(BLLO, IntObj)    External(_SB.PCI0.LPCB.EC0.EB0S, FieldUnitObj)    External(_SB.PCI0.BAT0.PUNT, IntObj)    External(_SB.PCI0.LPCB.EC0.B0DV, FieldUnitObj)    External(_SB.PCI0.BAT0.LFCC, IntObj)    External(MBLF, IntObj)    External(_SB.PCI0.BAT0.PBST, PkgObj)...</code></pre><p>And now continue with the same process.</p><p>Eventually, you will have:</p><pre><code>DefinitionBlock("", "SSDT", 2, "hack", "batt", 0){    External(_SB.PCI0, DeviceObj)    External(_SB.PCI0.BAT0, DeviceObj)    External(_SB.PCI0.LPCB.EC0.ACAP, MethodObj)    External(CHGS, MethodObj)    External(BLLO, IntObj)    External(_SB.PCI0.LPCB.EC0.EB0S, FieldUnitObj)    External(_SB.PCI0.BAT0.PUNT, IntObj)    External(_SB.PCI0.LPCB.EC0.B0DV, FieldUnitObj)    External(_SB.PCI0.BAT0.LFCC, IntObj)    External(MBLF, IntObj)    External(_SB.PCI0.BAT0.PBST, PkgObj)    External(_SB.PCI0.LPCB.EC0.BATP, MethodObj)    External(_SB.PCI0.BAT0.NBIX, PkgObj)    External(_SB.PCI0.LPCB.EC0.GBTT, MethodObj)    External(_SB.PCI0.BAT0._BIF, MethodObj)    External(_SB.PCI0.BAT0.PBIF, PkgObj)    External(_SB.PCI0.BAT0.BIXT, PkgObj)...</code></pre><p>And will come to an error with XC30/XC31: â€œ153, 6085, Object not found or not accessible from scope (^^LPCB.EC0.XC30)â€</p><p>This is one of the 16-bit fields that was broken into two.<br>And this is where it is necessary to create the EC overlay.</p><p>To do this, we use another OperationRegion within EC scope, that has a different name than what we find in DSDT:</p><pre><code>External(_SB.PCI0.LPCB, DeviceObj)External(_SB.PCI0.LPCB.EC0, DeviceObj)Scope(_SB.PCI0.LPCB.EC0){    OperationRegion (ERM2, EmbeddedControl, Zero, 0xFF)    Field(ERM2, ByteAcc, NoLock, Preserve)    {    }}</code></pre><p>And from DSDT_patched.dsl, we can get the various patched fields (again refer to the diffmerge).<br>This is the entire set from ECOR in the DSDT_patched.dsl</p><pre><code>Offset (0x04),CMD1,   8,CDT1,   8,CDT2,   8,CDT3,   8,Offset (0x80),Offset (0x81),Offset (0x82),Offset (0x83),EB0R,   8,EB1R,   8,EPWF,   8,Offset (0x87),Offset (0x88),Offset (0x89),Offset (0x8A),HKEN,   1,Offset (0x93),TH00,8,TH01,8,TH10,8,TH11,8,TSTP,   8,Offset (0x9C),CDT4,   8,CDT5,   8,Offset (0xA0),Offset (0xA1),Offset (0xA2),Offset (0xA3),EACT,   8,TH1R,   8,TH1L,   8,TH0R,   8,TH0L,   8,Offset (0xB0),B0PN,   16,Offset (0xB4),Offset (0xB6),Offset (0xB8),Offset (0xBA),Offset (0xBC),Offset (0xBE),B0TM,   16,B0C1,   16,B0C2,   16,XC30,8,XC31,8,B0C4,   16,Offset (0xD0),B1PN,   16,Offset (0xD4),Offset (0xD6),Offset (0xD8),Offset (0xDA),Offset (0xDC),Offset (0xDE),B1TM,   16,B1C1,   16,B1C2,   16,YC30,8,YC31,8,B1C4,   16,Offset (0xF0),Offset (0xF2),Offset (0xF4),B0S0,8,B0S1,8,Offset (0xF8),Offset (0xFA),Offset (0xFC),B1S0,8,B1S1,8</code></pre><p>And if we strip the unpatched identifiers, but keep the offsets correct (very important!):</p><pre><code>Offset (0x93),TH00,8,TH01,8,TH10,8,TH11,8,Offset (0xBE),/*B0TM*/,   16,/*B0C1*/,   16,/*B0C2*/,   16,XC30,8,XC31,8,Offset (0xDE),/*B1TM*/,   16,/*B1C1*/,   16,/*B1C2*/,   16,YC30,8,YC31,8,Offset (0xF4),B0S0,8,B0S1,8,Offset (0xFC),B1S0,8,B1S1,8</code></pre><p>The same thing can be written as follows:</p><pre><code>Offset (0x93),TH00,8,TH01,8,TH10,8,TH11,8,Offset (0xc4),XC30,8,XC31,8,Offset (0xe4),YC30,8,YC31,8,Offset (0xF4),B0S0,8,B0S1,8,Offset (0xFC),B1S0,8,B1S1,8</code></pre><p>So, into our SSDT:</p><pre><code>DefinitionBlock("", "SSDT", 2, "hack", "batt", 0){    External(_SB.PCI0, DeviceObj)    External(_SB.PCI0.BAT0, DeviceObj)    External(_SB.PCI0.LPCB.EC0.ACAP, MethodObj)    External(CHGS, MethodObj)    External(BLLO, IntObj)    External(_SB.PCI0.LPCB.EC0.EB0S, FieldUnitObj)    External(_SB.PCI0.BAT0.PUNT, IntObj)    External(_SB.PCI0.LPCB.EC0.B0DV, FieldUnitObj)    External(_SB.PCI0.BAT0.LFCC, IntObj)    External(MBLF, IntObj)    External(_SB.PCI0.BAT0.PBST, PkgObj)    External(_SB.PCI0.LPCB.EC0.BATP, MethodObj)    External(_SB.PCI0.BAT0.NBIX, PkgObj)    External(_SB.PCI0.LPCB.EC0.GBTT, MethodObj)    External(_SB.PCI0.BAT0._BIF, MethodObj)    External(_SB.PCI0.BAT0.PBIF, PkgObj)    External(_SB.PCI0.BAT0.BIXT, PkgObj)    External(_SB.PCI0.LPCB, DeviceObj)    External(_SB.PCI0.LPCB.EC0, DeviceObj)    Scope(_SB.PCI0.LPCB.EC0)    {        OperationRegion (ERM2, EmbeddedControl, Zero, 0xFF)        Field(ERM2, ByteAcc, NoLock, Preserve)        {                Offset (0x93),                TH00,8,TH01,8,                TH10,8,TH11,8,                Offset (0xc4),                XC30,8,XC31,8,                Offset (0xe4),                YC30,8,YC31,8,                Offset (0xF4),                B0S0,8,B0S1,8,                Offset (0xFC),                B1S0,8,B1S1,8        }    }</code></pre><p>And then on to fixing more errors, we add some more External:</p><pre><code>DefinitionBlock("", "SSDT", 2, "hack", "batt", 0){    External(_SB.PCI0, DeviceObj)    External(_SB.PCI0.BAT0, DeviceObj)    External(_SB.PCI0.LPCB.EC0.ACAP, MethodObj)    External(CHGS, MethodObj)    External(BLLO, IntObj)    External(_SB.PCI0.LPCB.EC0.EB0S, FieldUnitObj)    External(_SB.PCI0.BAT0.PUNT, IntObj)    External(_SB.PCI0.LPCB.EC0.B0DV, FieldUnitObj)    External(_SB.PCI0.BAT0.LFCC, IntObj)    External(MBLF, IntObj)    External(_SB.PCI0.BAT0.PBST, PkgObj)    External(_SB.PCI0.LPCB.EC0.BATP, MethodObj)    External(_SB.PCI0.BAT0.NBIX, PkgObj)    External(_SB.PCI0.LPCB.EC0.GBTT, MethodObj)    External(_SB.PCI0.BAT0._BIF, MethodObj)    External(_SB.PCI0.BAT0.PBIF, PkgObj)    External(_SB.PCI0.BAT0.BIXT, PkgObj)    External(_SB.PCI0.LPCB.EC0.ECAV, MethodObj)    External(BSLF, IntObj)    External(_SB.PCI0.LPCB.EC0.RDBL, IntObj)    External(_SB.PCI0.LPCB.EC0.RDWD, IntObj)    External(_SB.PCI0.LPCB.EC0.RDBT, IntObj)    External(_SB.PCI0.LPCB.EC0.RCBT, IntObj)    External(_SB.PCI0.LPCB.EC0.RDQK, IntObj)    External(_SB.PCI0.LPCB.EC0.MUEC, MutexObj)    External(_SB.PCI0.LPCB.EC0.PRTC, FieldUnitObj)    External(_SB.PCI0.LPCB.EC0.SBBY, IntObj)    External(_SB.PCI0.LPCB.EC0.ADDR, FieldUnitObj)    External(_SB.PCI0.LPCB.EC0.CMDB, FieldUnitObj)    External(_SB.PCI0.LPCB.EC0.SWTC, MethodObj)    External(_SB.PCI0.LPCB.EC0.BCNT, FieldUnitObj)    External(_SB.PCI0.LPCB, DeviceObj)    External(_SB.PCI0.LPCB.EC0, DeviceObj)    Scope(_SB.PCI0.LPCB.EC0)    {...</code></pre><p>And then we have errors with T2B0 and T2B1. These are again broken down 16-bit EC fields that need to be defined in our EC overlay. In fact, might as well define the rest we know we need (from diffmerge data).</p><p>There is patched data in SMBX:</p><pre><code>OperationRegion (SMBX, EmbeddedControl, 0x18, 0x28)</code></pre><p>So, we create a similar overlay, with a unique name:</p><pre><code>            OperationRegion (RMB1, EmbeddedControl, 0x18, 0x28)            Field (RMB1, ByteAcc, NoLock, Preserve)            {/* Note: disabling these fields (already defined in DSDT, referenced with External if needed,    but keeping the correct offset! (very important!) */*/                PRTC,   8,                SSTS,   5,                    ,   1,                ALFG,   1,                CDFG,   1,                ADDR,   8,                CMDB,   8, */         Offset(4), // the data above is 4 bytes offset from the start of this region!                //BDAT, 256,BA00,8,BA01,8,BA02,8,BA03,8,BA04,8,BA05,8,BA06,8,BA07,8,BA08,8,BA09,8,BA0A,8,BA0B,8,BA0C,8,BA0D,8,BA0E,8,BA0F,8,BA10,8,BA11,8,BA12,8,BA13,8,BA14,8,BA15,8,BA16,8,BA17,8,BA18,8,BA19,8,BA1A,8,BA1B,8,BA1C,8,BA1D,8,BA1E,8,BA1F,8            }</code></pre><p>And similar withe SMB2 region:</p><pre><code>            OperationRegion(RMB2, EmbeddedControl, 0x40, 0x28)            Field (RMB2, ByteAcc, NoLock, Preserve)            {/*                PRT2,   8,                SST2,   5,                    ,   1,                ALF2,   1,                CDF2,   1,                ADD2,   8,                CMD2,   8, */      Offset(4),                //BDA2, 256,BB00,8,BB01,8,BB02,8,BB03,8,BB04,8,BB05,8,BB06,8,BB07,8,BB08,8,BB09,8,BB0A,8,BB0B,8,BB0C,8,BB0D,8,BB0E,8,BB0F,8,BB10,8,BB11,8,BB12,8,BB13,8,BB14,8,BB15,8,BB16,8,BB17,8,BB18,8,BB19,8,BB1A,8,BB1B,8,BB1C,8,BB1D,8,BB1E,8,BB1F,8            }</code></pre><p>And the T2B0 and T2B1 that are in orginal SMBX, but now RMB1:</p><pre><code>Field (RMB1, ByteAcc, NoLock, Preserve){    Offset (0x04),    T2B0,8,T2B1,8}</code></pre><p>And now we have:</p><pre><code>External(_SB.PCI0, DeviceObj)External(_SB.PCI0.BAT0, DeviceObj)External(_SB.PCI0.LPCB.EC0.ACAP, MethodObj)External(CHGS, MethodObj)External(BLLO, IntObj)External(_SB.PCI0.LPCB.EC0.EB0S, FieldUnitObj)External(_SB.PCI0.BAT0.PUNT, IntObj)External(_SB.PCI0.LPCB.EC0.B0DV, FieldUnitObj)External(_SB.PCI0.BAT0.LFCC, IntObj)External(MBLF, IntObj)External(_SB.PCI0.BAT0.PBST, PkgObj)External(_SB.PCI0.LPCB.EC0.BATP, MethodObj)External(_SB.PCI0.BAT0.NBIX, PkgObj)External(_SB.PCI0.LPCB.EC0.GBTT, MethodObj)External(_SB.PCI0.BAT0._BIF, MethodObj)External(_SB.PCI0.BAT0.PBIF, PkgObj)External(_SB.PCI0.BAT0.BIXT, PkgObj)External(_SB.PCI0.LPCB.EC0.ECAV, MethodObj)External(BSLF, IntObj)External(_SB.PCI0.LPCB.EC0.RDBL, IntObj)External(_SB.PCI0.LPCB.EC0.RDWD, IntObj)External(_SB.PCI0.LPCB.EC0.RDBT, IntObj)External(_SB.PCI0.LPCB.EC0.RCBT, IntObj)External(_SB.PCI0.LPCB.EC0.RDQK, IntObj)External(_SB.PCI0.LPCB.EC0.MUEC, MutexObj)External(_SB.PCI0.LPCB.EC0.PRTC, FieldUnitObj)External(_SB.PCI0.LPCB.EC0.SBBY, IntObj)External(_SB.PCI0.LPCB.EC0.ADDR, FieldUnitObj)External(_SB.PCI0.LPCB.EC0.CMDB, FieldUnitObj)External(_SB.PCI0.LPCB.EC0.SWTC, MethodObj)External(_SB.PCI0.LPCB.EC0.BCNT, FieldUnitObj)External(_SB.PCI0.LPCB, DeviceObj)External(_SB.PCI0.LPCB.EC0, DeviceObj)Scope(_SB.PCI0.LPCB.EC0){        OperationRegion (ERM2, EmbeddedControl, Zero, 0xFF)        Field(ERM2, ByteAcc, NoLock, Preserve)        {            Offset (0x93),            TH00,8,TH01,8,            TH10,8,TH11,8,            Offset (0xc4),            XC30,8,XC31,8,            Offset (0xe4),            YC30,8,YC31,8,            Offset (0xF4),            B0S0,8,B0S1,8,            Offset (0xFC),            B1S0,8,B1S1,8        }        OperationRegion (RMB1, EmbeddedControl, 0x18, 0x28)        Field (RMB1, ByteAcc, NoLock, Preserve)        {/* Note: disabling these fields (already defined in DSDT, referenced with External if needed,    but keeping the correct offset! (very important!) */*/            PRTC,   8,            SSTS,   5,                ,   1,            ALFG,   1,            CDFG,   1,            ADDR,   8,            CMDB,   8, */     Offset(4), // the data above is 4 bytes offset from the start of this region!            //BDAT, 256,            BA00,8,BA01,8,BA02,8,BA03,8,BA04,8,BA05,8,BA06,8,BA07,8,BA08,8,BA09,8,BA0A,8,BA0B,8,BA0C,8,BA0D,8,BA0E,8,BA0F,8,BA10,8,BA11,8,BA12,8,BA13,8,BA14,8,BA15,8,BA16,8,BA17,8,BA18,8,BA19,8,BA1A,8,BA1B,8,BA1C,8,BA1D,8,BA1E,8,BA1F,8        }        OperationRegion(RMB2, EmbeddedControl, 0x40, 0x28)        Field (RMB2, ByteAcc, NoLock, Preserve)        {/*            PRT2,   8,            SST2,   5,                ,   1,            ALF2,   1,            CDF2,   1,            ADD2,   8,            CMD2,   8, */  Offset(4),            //BDA2, 256,BB00,8,BB01,8,BB02,8,BB03,8,BB04,8,BB05,8,BB06,8,BB07,8,BB08,8,BB09,8,BB0A,8,BB0B,8,BB0C,8,BB0D,8,BB0E,8,BB0F,8,BB10,8,BB11,8,BB12,8,BB13,8,BB14,8,BB15,8,BB16,8,BB17,8,BB18,8,BB19,8,BB1A,8,BB1B,8,BB1C,8,BB1D,8,BB1E,8,BB1F,8        }        Field (RMB1, ByteAcc, NoLock, Preserve)        {            Offset (0x04),            T2B0,8,T2B1,8        }}                   </code></pre><p>Then continue on with fixing more errors with External (it ends eventually!), by adding these External declarations:</p><pre><code>External(_SB.PCI0.LPCB.EC0.DAT0, FieldUnitObj)External(_SB.PCI0.LPCB.EC0.WRBL, IntObj)External(_SB.PCI0.LPCB.EC0.WRWD, IntObj)External(_SB.PCI0.LPCB.EC0.WRBT, IntObj)External(_SB.PCI0.LPCB.EC0.SDBT, IntObj)External(_SB.PCI0.LPCB.EC0.WRQK, IntObj)External(_SB.PCI0.LPCB.EC0.PRT2, FieldUnitObj)External(_SB.PCI0.LPCB.EC0.DAT1, FieldUnitObj)External(_SB.PCI0.LPCB.EC0.ADD2, FieldUnitObj)External(_SB.PCI0.LPCB.EC0.CMD2, FieldUnitObj)External(_SB.PCI0.LPCB.EC0.BCN2, FieldUnitObj)External(_SB.PCI0.LPCB.EC0.DA20, FieldUnitObj)External(_SB.PCI0.LPCB.EC0.DA21, FieldUnitObj)External(_SB.PCI0.LPCB.EC0.SSTS, FieldUnitObj)External(_SB.PCI0.LPCB.EC0.SST2, FieldUnitObj)</code></pre><p>Note: With DAT0, donâ€™t be confused at the â€œotherâ€ DAT0 in a different scope!</p><p>At this point, the SSDT compiles without any errors:</p><pre><code>DefinitionBlock("", "SSDT", 2, "hack", "batt", 0){    External(_SB.PCI0, DeviceObj)    External(_SB.PCI0.BAT0, DeviceObj)    External(_SB.PCI0.LPCB.EC0.ACAP, MethodObj)    External(CHGS, MethodObj)    External(BLLO, IntObj)    External(_SB.PCI0.LPCB.EC0.EB0S, FieldUnitObj)    External(_SB.PCI0.BAT0.PUNT, IntObj)    External(_SB.PCI0.LPCB.EC0.B0DV, FieldUnitObj)    External(_SB.PCI0.BAT0.LFCC, IntObj)    External(MBLF, IntObj)    External(_SB.PCI0.BAT0.PBST, PkgObj)    External(_SB.PCI0.LPCB.EC0.BATP, MethodObj)    External(_SB.PCI0.BAT0.NBIX, PkgObj)    External(_SB.PCI0.LPCB.EC0.GBTT, MethodObj)    External(_SB.PCI0.BAT0._BIF, MethodObj)    External(_SB.PCI0.BAT0.PBIF, PkgObj)    External(_SB.PCI0.BAT0.BIXT, PkgObj)    External(_SB.PCI0.LPCB.EC0.ECAV, MethodObj)    External(BSLF, IntObj)    External(_SB.PCI0.LPCB.EC0.RDBL, IntObj)    External(_SB.PCI0.LPCB.EC0.RDWD, IntObj)    External(_SB.PCI0.LPCB.EC0.RDBT, IntObj)    External(_SB.PCI0.LPCB.EC0.RCBT, IntObj)    External(_SB.PCI0.LPCB.EC0.RDQK, IntObj)    External(_SB.PCI0.LPCB.EC0.MUEC, MutexObj)    External(_SB.PCI0.LPCB.EC0.PRTC, FieldUnitObj)    External(_SB.PCI0.LPCB.EC0.SBBY, IntObj)    External(_SB.PCI0.LPCB.EC0.ADDR, FieldUnitObj)    External(_SB.PCI0.LPCB.EC0.CMDB, FieldUnitObj)    External(_SB.PCI0.LPCB.EC0.SWTC, MethodObj)    External(_SB.PCI0.LPCB.EC0.BCNT, FieldUnitObj)    External(_SB.PCI0.LPCB.EC0.DAT0, FieldUnitObj)    External(_SB.PCI0.LPCB.EC0.WRBL, IntObj)    External(_SB.PCI0.LPCB.EC0.WRWD, IntObj)    External(_SB.PCI0.LPCB.EC0.WRBT, IntObj)    External(_SB.PCI0.LPCB.EC0.SDBT, IntObj)    External(_SB.PCI0.LPCB.EC0.WRQK, IntObj)    External(_SB.PCI0.LPCB.EC0.PRT2, FieldUnitObj)    External(_SB.PCI0.LPCB.EC0.DAT1, FieldUnitObj)    External(_SB.PCI0.LPCB.EC0.ADD2, FieldUnitObj)    External(_SB.PCI0.LPCB.EC0.CMD2, FieldUnitObj)    External(_SB.PCI0.LPCB.EC0.BCN2, FieldUnitObj)    External(_SB.PCI0.LPCB.EC0.DA20, FieldUnitObj)    External(_SB.PCI0.LPCB.EC0.DA21, FieldUnitObj)    External(_SB.PCI0.LPCB.EC0.SSTS, FieldUnitObj)    External(_SB.PCI0.LPCB.EC0.SST2, FieldUnitObj)    External(_SB.PCI0.LPCB, DeviceObj)    External(_SB.PCI0.LPCB.EC0, DeviceObj)    Scope(_SB.PCI0.LPCB.EC0)    {            OperationRegion (ERM2, EmbeddedControl, Zero, 0xFF)            Field(ERM2, ByteAcc, NoLock, Preserve)            {                Offset (0x93),                TH00,8,TH01,8,                TH10,8,TH11,8,                Offset (0xc4),                XC30,8,XC31,8,                Offset (0xe4),                YC30,8,YC31,8,                Offset (0xF4),                B0S0,8,B0S1,8,                Offset (0xFC),                B1S0,8,B1S1,8            }            OperationRegion (RMB1, EmbeddedControl, 0x18, 0x28)            Field (RMB1, ByteAcc, NoLock, Preserve)            {/* Note: disabling these fields (already defined in DSDT, referenced with External if needed,    but keeping the correct offset! (very important!) */*/                PRTC,   8,                SSTS,   5,                    ,   1,                ALFG,   1,                CDFG,   1,                ADDR,   8,                CMDB,   8, */         Offset(4), // the data above is 4 bytes offset from the start of this region!                //BDAT, 256,BA00,8,BA01,8,BA02,8,BA03,8,BA04,8,BA05,8,BA06,8,BA07,8,BA08,8,BA09,8,BA0A,8,BA0B,8,BA0C,8,BA0D,8,BA0E,8,BA0F,8,BA10,8,BA11,8,BA12,8,BA13,8,BA14,8,BA15,8,BA16,8,BA17,8,BA18,8,BA19,8,BA1A,8,BA1B,8,BA1C,8,BA1D,8,BA1E,8,BA1F,8            }            OperationRegion(RMB2, EmbeddedControl, 0x40, 0x28)            Field (RMB2, ByteAcc, NoLock, Preserve)            {/*                PRT2,   8,                SST2,   5,                    ,   1,                ALF2,   1,                CDF2,   1,                ADD2,   8,                CMD2,   8, */      Offset(4),                //BDA2, 256,BB00,8,BB01,8,BB02,8,BB03,8,BB04,8,BB05,8,BB06,8,BB07,8,BB08,8,BB09,8,BB0A,8,BB0B,8,BB0C,8,BB0D,8,BB0E,8,BB0F,8,BB10,8,BB11,8,BB12,8,BB13,8,BB14,8,BB15,8,BB16,8,BB17,8,BB18,8,BB19,8,BB1A,8,BB1B,8,BB1C,8,BB1D,8,BB1E,8,BB1F,8             }            Field (RMB1, ByteAcc, NoLock, Preserve)            {                Offset (0x04),                T2B0,8,T2B1,8            }    }    Scope (_SB.PCI0)    {        Scope (BAT0)        {            Method (FBST, 4, NotSerialized)            {                And (Arg1, 0xFFFF, Local1)                Store (Zero, Local0)                If (^^LPCB.EC0.ACAP ())                {                    Store (One, Local0)                }                If (Local0)                {                    If (CHGS (Zero)){    Store (0x02, Local0)}Else{    Store (Zero, Local0)   }                }                Else                {                    Store (One, Local0)                }                If (BLLO)                {                    ShiftLeft (One, 0x02, Local2)                    Or (Local0, Local2, Local0)                }                If (And (^^LPCB.EC0.EB0S, 0x08))                {                    ShiftLeft (One, 0x02, Local2)                    Or (Local0, Local2, Local0)                }                If (LGreaterEqual (Local1, 0x8000))                {                    Subtract (0xFFFF, Local1, Local1)                }                Store (Arg2, Local2)                If (LEqual (PUNT, Zero))                {                    Multiply (Local1, ^^LPCB.EC0.B0DV, Local1)                    Multiply (Local2, 0x0A, Local2)                }                And (Local0, 0x02, Local3)                If (LNot (Local3))                {                    Subtract (LFCC, Local2, Local3)                    Divide (LFCC, 0xC8, Local4, Local5)                    If (LLess (Local3, Local5))                    {                        Store (LFCC, Local2)                    }                }                Else                {                    Divide (LFCC, 0xC8, Local4, Local5)                    Subtract (LFCC, Local5, Local4)                    If (LGreater (Local2, Local4))                    {                        Store (Local4, Local2)                    }                }                If (LNot (^^LPCB.EC0.ACAP ()))                {                    Divide (Local2, MBLF, Local3, Local4)                    If (LLess (Local1, Local4))                    {                        Store (Local4, Local1)                    }                }                Store (Local0, Index (PBST, Zero))                Store (Local1, Index (PBST, One))                Store (Local2, Index (PBST, 0x02))                Store (Arg3, Index (PBST, 0x03))            }            Method (_BIX, 0, NotSerialized)  // _BIX: Battery Information Extended            {                If (LNot (^^LPCB.EC0.BATP (Zero)))                {                    Return (NBIX)                }                If (LEqual (^^LPCB.EC0.GBTT (Zero), 0xFF))                {                    Return (NBIX)                }                _BIF ()                Store (DerefOf (Index (PBIF, Zero)), Index (BIXT, One))                Store (DerefOf (Index (PBIF, One)), Index (BIXT, 0x02))                Store (DerefOf (Index (PBIF, 0x02)), Index (BIXT, 0x03))                Store (DerefOf (Index (PBIF, 0x03)), Index (BIXT, 0x04))                Store (DerefOf (Index (PBIF, 0x04)), Index (BIXT, 0x05))                Store (DerefOf (Index (PBIF, 0x05)), Index (BIXT, 0x06))                Store (DerefOf (Index (PBIF, 0x06)), Index (BIXT, 0x07))                Store (DerefOf (Index (PBIF, 0x07)), Index (BIXT, 0x0E))                Store (DerefOf (Index (PBIF, 0x08)), Index (BIXT, 0x0F))                Store (DerefOf (Index (PBIF, 0x09)), Index (BIXT, 0x10))                Store (DerefOf (Index (PBIF, 0x0A)), Index (BIXT, 0x11))                Store (DerefOf (Index (PBIF, 0x0B)), Index (BIXT, 0x12))                Store (DerefOf (Index (PBIF, 0x0C)), Index (BIXT, 0x13))                If (LEqual (DerefOf (Index (BIXT, One)), One))                {                    Store (Zero, Index (BIXT, One))                    Store (DerefOf (Index (BIXT, 0x05)), Local0)                    Multiply (DerefOf (Index (BIXT, 0x02)), Local0, Index (BIXT, 0x02))                    Multiply (DerefOf (Index (BIXT, 0x03)), Local0, Index (BIXT, 0x03))                    Multiply (DerefOf (Index (BIXT, 0x06)), Local0, Index (BIXT, 0x06))                    Multiply (DerefOf (Index (BIXT, 0x07)), Local0, Index (BIXT, 0x07))                    Multiply (DerefOf (Index (BIXT, 0x0E)), Local0, Index (BIXT, 0x0E))                    Multiply (DerefOf (Index (BIXT, 0x0F)), Local0, Index (BIXT, 0x0F))                    Divide (DerefOf (Index (BIXT, 0x02)), 0x03E8, Local0, Index (BIXT, 0x02))                    Divide (DerefOf (Index (BIXT, 0x03)), 0x03E8, Local0, Index (BIXT, 0x03))                    Divide (DerefOf (Index (BIXT, 0x06)), 0x03E8, Local0, Index (BIXT, 0x06))                    Divide (DerefOf (Index (BIXT, 0x07)), 0x03E8, Local0, Index (BIXT, 0x07))                    Divide (DerefOf (Index (BIXT, 0x0E)), 0x03E8, Local0, Index (BIXT, 0x0E))                    Divide (DerefOf (Index (BIXT, 0x0F)), 0x03E8, Local0, Index (BIXT, 0x0F))                }                Store (B1B2(^^LPCB.EC0.XC30,^^LPCB.EC0.XC31), Index (BIXT, 0x08))                Store (0x0001869F, Index (BIXT, 0x09))                Return (BIXT)            }    }    }    Scope (_SB.PCI0.LPCB.EC0)    {        Method (BIFA, 0, NotSerialized)        {            If (ECAV ())            {                If (BSLF)                {                    Store (B1B2(B1S0,B1S1), Local0)                }                Else                {                    Store (B1B2(B0S0,B0S1), Local0)                }            }            Else            {                Store (Ones, Local0)            }            Return (Local0)        }        Method (SMBR, 3, Serialized)        {            Store (Package (0x03)                {                    0x07,                    Zero,                    Zero                }, Local0)            If (LNot (ECAV ()))            {                Return (Local0)            }            If (LNotEqual (Arg0, RDBL))            {                If (LNotEqual (Arg0, RDWD))                {                    If (LNotEqual (Arg0, RDBT))                    {                        If (LNotEqual (Arg0, RCBT))                        {                            If (LNotEqual (Arg0, RDQK))                            {                                Return (Local0)                            }                        }                    }                }            }            Acquire (MUEC, 0xFFFF)            Store (PRTC, Local1)            Store (Zero, Local2)            While (LNotEqual (Local1, Zero))            {                Stall (0x0A)                Increment (Local2)                If (LGreater (Local2, 0x03E8))                {                    Store (SBBY, Index (Local0, Zero))                    Store (Zero, Local1)                }                Else                {                    Store (PRTC, Local1)                }            }            If (LLessEqual (Local2, 0x03E8))            {                ShiftLeft (Arg1, One, Local3)                Or (Local3, One, Local3)                Store (Local3, ADDR)                If (LNotEqual (Arg0, RDQK))                {                    If (LNotEqual (Arg0, RCBT))                    {                        Store (Arg2, CMDB)                    }                }                WRBA(Zero)                Store (Arg0, PRTC)                Store (SWTC (Arg0), Index (Local0, Zero))                If (LEqual (DerefOf (Index (Local0, Zero)), Zero))                {                    If (LEqual (Arg0, RDBL))                    {                        Store (BCNT, Index (Local0, One))                        Store (RDBA(), Index (Local0, 0x02))                    }                    If (LEqual (Arg0, RDWD))                    {                        Store (0x02, Index (Local0, One))                        Store (B1B2(T2B0,T2B1), Index (Local0, 0x02))                    }                    If (LEqual (Arg0, RDBT))                    {                        Store (One, Index (Local0, One))                        Store (DAT0, Index (Local0, 0x02))                    }                    If (LEqual (Arg0, RCBT))                    {                        Store (One, Index (Local0, One))                        Store (DAT0, Index (Local0, 0x02))                    }                }            }            Release (MUEC)            Return (Local0)        }        Method (SMBW, 5, Serialized)        {            Store (Package (0x01)                {                    0x07                }, Local0)            If (LNot (ECAV ()))            {                Return (Local0)            }            If (LNotEqual (Arg0, WRBL))            {                If (LNotEqual (Arg0, WRWD))                {                    If (LNotEqual (Arg0, WRBT))                    {                        If (LNotEqual (Arg0, SDBT))                        {                            If (LNotEqual (Arg0, WRQK))                            {                                Return (Local0)                            }                        }                    }                }            }            Acquire (MUEC, 0xFFFF)            Store (PRTC, Local1)            Store (Zero, Local2)            While (LNotEqual (Local1, Zero))            {                Stall (0x0A)                Increment (Local2)                If (LGreater (Local2, 0x03E8))                {                    Store (SBBY, Index (Local0, Zero))                    Store (Zero, Local1)                }                Else                {                    Store (PRTC, Local1)                }            }            If (LLessEqual (Local2, 0x03E8))            {                WRBA(Zero)                ShiftLeft (Arg1, One, Local3)                Store (Local3, ADDR)                If (LNotEqual (Arg0, WRQK))                {                    If (LNotEqual (Arg0, SDBT))                    {                        Store (Arg2, CMDB)                    }                }                If (LEqual (Arg0, WRBL))                {                    Store (Arg3, BCNT)                    WRBA(Arg4)                }                If (LEqual (Arg0, WRWD))                {                    Store(Arg4,T2B0) Store(ShiftRight(Arg4,8),T2B1)                }                If (LEqual (Arg0, WRBT))                {                    Store (Arg4, DAT0)                }                If (LEqual (Arg0, SDBT))                {                    Store (Arg4, DAT0)                }                Store (Arg0, PRTC)                Store (SWTC (Arg0), Index (Local0, Zero))            }            Release (MUEC)            Return (Local0)        }        Method (ECSB, 7, NotSerialized)        {            Store (Package (0x05)                {                    0x11,                    Zero,                    Zero,                    Zero,                    Buffer (0x20){}                }, Local1)            If (LGreater (Arg0, One))            {                Return (Local1)            }            If (ECAV ())            {                Acquire (MUEC, 0xFFFF)                If (LEqual (Arg0, Zero))                {                    Store (PRTC, Local0)                }                Else                {                    Store (PRT2, Local0)                }                Store (Zero, Local2)                While (LNotEqual (Local0, Zero))                {                    Stall (0x0A)                    Increment (Local2)                    If (LGreater (Local2, 0x03E8))                    {                        Store (SBBY, Index (Local1, Zero))                        Store (Zero, Local0)                    }                    ElseIf (LEqual (Arg0, Zero))                    {                        Store (PRTC, Local0)                    }                    Else                    {                        Store (PRT2, Local0)                    }                }                If (LLessEqual (Local2, 0x03E8))                {                    If (LEqual (Arg0, Zero))                    {                        Store (Arg2, ADDR)                        Store (Arg3, CMDB)                        If (LOr (LEqual (Arg1, 0x0A), LEqual (Arg1, 0x0B)))                        {                            Store (DerefOf (Index (Arg6, Zero)), BCNT)                            WRBA(DerefOf (Index (Arg6, One)))                        }                        Else                        {                            Store (Arg4, DAT0)                            Store (Arg5, DAT1)                        }                        Store (Arg1, PRTC)                    }                    Else                    {                        Store (Arg2, ADD2)                        Store (Arg3, CMD2)                        If (LOr (LEqual (Arg1, 0x0A), LEqual (Arg1, 0x0B)))                        {                            Store (DerefOf (Index (Arg6, Zero)), BCN2)                            WRBB(DerefOf (Index (Arg6, One)))                        }                        Else                        {                            Store (Arg4, DA20)                            Store (Arg5, DA21)                        }                        Store (Arg1, PRT2)                    }                    Store (0x7F, Local0)                    If (LEqual (Arg0, Zero))                    {                        While (PRTC)                        {                            Sleep (One)                            Decrement (Local0)                        }                    }                    Else                    {                        While (PRT2)                        {                            Sleep (One)                            Decrement (Local0)                        }                    }                    If (Local0)                    {                        If (LEqual (Arg0, Zero))                        {                            Store (SSTS, Local0)                            Store (DAT0, Index (Local1, One))                            Store (DAT1, Index (Local1, 0x02))                            Store (BCNT, Index (Local1, 0x03))                            Store (RDBA(), Index (Local1, 0x04))                        }                        Else                        {                            Store (SST2, Local0)                            Store (DA20, Index (Local1, One))                            Store (DA21, Index (Local1, 0x02))                            Store (BCN2, Index (Local1, 0x03))                            Store (RDBB(), Index (Local1, 0x04))                        }                        And (Local0, 0x1F, Local0)                        If (Local0)                        {                            Add (Local0, 0x10, Local0)                        }                        Store (Local0, Index (Local1, Zero))                    }                    Else                    {                        Store (0x10, Index (Local1, Zero))                    }                }                Release (MUEC)            }            Return (Local1)        }        Method (TACH, 1, Serialized)        {            If (ECAV ())            {                Switch (Arg0)                {                    Case (Zero)                    {                        Store (B1B2(TH00,TH01), Local0)                        Break                    }                    Case (One)                    {                        Store (B1B2(TH10,TH11), Local0)                        Break                    }                    Default                    {                        Return (Ones)                    }                }                Multiply (Local0, 0x02, Local0)                If (LNotEqual (Local0, Zero))                {                    Divide (0x0041CDB4, Local0, Local1, Local0)                    Return (Local0)                }                Else                {                    Return (Ones)                }            }            Else            {                Return (Ones)            }        }        }    Method (B1B2, 2, NotSerialized) { Return (Or (Arg0, ShiftLeft (Arg1, 8))) }    Scope (_SB.PCI0.LPCB)    {        Scope (EC0)        {            Method (RDBA, 0, Serialized)            {                Name (TEMP, Buffer(0x20) { })                Store (BA00, Index(TEMP, 0x00))                Store (BA01, Index(TEMP, 0x01))                Store (BA02, Index(TEMP, 0x02))                Store (BA03, Index(TEMP, 0x03))                Store (BA04, Index(TEMP, 0x04))                Store (BA05, Index(TEMP, 0x05))                Store (BA06, Index(TEMP, 0x06))                Store (BA07, Index(TEMP, 0x07))                Store (BA08, Index(TEMP, 0x08))                Store (BA09, Index(TEMP, 0x09))                Store (BA0A, Index(TEMP, 0x0A))                Store (BA0B, Index(TEMP, 0x0B))                Store (BA0C, Index(TEMP, 0x0C))                Store (BA0D, Index(TEMP, 0x0D))                Store (BA0E, Index(TEMP, 0x0E))                Store (BA0F, Index(TEMP, 0x0F))                Store (BA10, Index(TEMP, 0x10))                Store (BA11, Index(TEMP, 0x11))                Store (BA12, Index(TEMP, 0x12))                Store (BA13, Index(TEMP, 0x13))                Store (BA14, Index(TEMP, 0x14))                Store (BA15, Index(TEMP, 0x15))                Store (BA16, Index(TEMP, 0x16))                Store (BA17, Index(TEMP, 0x17))                Store (BA18, Index(TEMP, 0x18))                Store (BA19, Index(TEMP, 0x19))                Store (BA1A, Index(TEMP, 0x1A))                Store (BA1B, Index(TEMP, 0x1B))                Store (BA1C, Index(TEMP, 0x1C))                Store (BA1D, Index(TEMP, 0x1D))                Store (BA1E, Index(TEMP, 0x1E))                Store (BA1F, Index(TEMP, 0x1F))                Return (TEMP)            }            Method (WRBA, 1, Serialized)            {                Name (TEMP, Buffer(0x20) { })                Store (Arg0, TEMP)                Store (DerefOf(Index(TEMP, 0x00)), BA00)                Store (DerefOf(Index(TEMP, 0x01)), BA01)                Store (DerefOf(Index(TEMP, 0x02)), BA02)                Store (DerefOf(Index(TEMP, 0x03)), BA03)                Store (DerefOf(Index(TEMP, 0x04)), BA04)                Store (DerefOf(Index(TEMP, 0x05)), BA05)                Store (DerefOf(Index(TEMP, 0x06)), BA06)                Store (DerefOf(Index(TEMP, 0x07)), BA07)                Store (DerefOf(Index(TEMP, 0x08)), BA08)                Store (DerefOf(Index(TEMP, 0x09)), BA09)                Store (DerefOf(Index(TEMP, 0x0A)), BA0A)                Store (DerefOf(Index(TEMP, 0x0B)), BA0B)                Store (DerefOf(Index(TEMP, 0x0C)), BA0C)                Store (DerefOf(Index(TEMP, 0x0D)), BA0D)                Store (DerefOf(Index(TEMP, 0x0E)), BA0E)                Store (DerefOf(Index(TEMP, 0x0F)), BA0F)                Store (DerefOf(Index(TEMP, 0x10)), BA10)                Store (DerefOf(Index(TEMP, 0x11)), BA11)                Store (DerefOf(Index(TEMP, 0x12)), BA12)                Store (DerefOf(Index(TEMP, 0x13)), BA13)                Store (DerefOf(Index(TEMP, 0x14)), BA14)                Store (DerefOf(Index(TEMP, 0x15)), BA15)                Store (DerefOf(Index(TEMP, 0x16)), BA16)                Store (DerefOf(Index(TEMP, 0x17)), BA17)                Store (DerefOf(Index(TEMP, 0x18)), BA18)                Store (DerefOf(Index(TEMP, 0x19)), BA19)                Store (DerefOf(Index(TEMP, 0x1A)), BA1A)                Store (DerefOf(Index(TEMP, 0x1B)), BA1B)                Store (DerefOf(Index(TEMP, 0x1C)), BA1C)                Store (DerefOf(Index(TEMP, 0x1D)), BA1D)                Store (DerefOf(Index(TEMP, 0x1E)), BA1E)                Store (DerefOf(Index(TEMP, 0x1F)), BA1F)            }            Method (RDBB, 0, Serialized)            {                Name (TEMP, Buffer(0x20) { })                Store (BB00, Index(TEMP, 0x00))                Store (BB01, Index(TEMP, 0x01))                Store (BB02, Index(TEMP, 0x02))                Store (BB03, Index(TEMP, 0x03))                Store (BB04, Index(TEMP, 0x04))                Store (BB05, Index(TEMP, 0x05))                Store (BB06, Index(TEMP, 0x06))                Store (BB07, Index(TEMP, 0x07))                Store (BB08, Index(TEMP, 0x08))                Store (BB09, Index(TEMP, 0x09))                Store (BB0A, Index(TEMP, 0x0A))                Store (BB0B, Index(TEMP, 0x0B))                Store (BB0C, Index(TEMP, 0x0C))                Store (BB0D, Index(TEMP, 0x0D))                Store (BB0E, Index(TEMP, 0x0E))                Store (BB0F, Index(TEMP, 0x0F))                Store (BB10, Index(TEMP, 0x10))                Store (BB11, Index(TEMP, 0x11))                Store (BB12, Index(TEMP, 0x12))                Store (BB13, Index(TEMP, 0x13))                Store (BB14, Index(TEMP, 0x14))                Store (BB15, Index(TEMP, 0x15))                Store (BB16, Index(TEMP, 0x16))                Store (BB17, Index(TEMP, 0x17))                Store (BB18, Index(TEMP, 0x18))                Store (BB19, Index(TEMP, 0x19))                Store (BB1A, Index(TEMP, 0x1A))                Store (BB1B, Index(TEMP, 0x1B))                Store (BB1C, Index(TEMP, 0x1C))                Store (BB1D, Index(TEMP, 0x1D))                Store (BB1E, Index(TEMP, 0x1E))                Store (BB1F, Index(TEMP, 0x1F))                Return (TEMP)            }            Method (WRBB, 1, Serialized)            {                Name (TEMP, Buffer(0x20) { })                Store (Arg0, TEMP)                Store (DerefOf(Index(TEMP, 0x00)), BB00)                Store (DerefOf(Index(TEMP, 0x01)), BB01)                Store (DerefOf(Index(TEMP, 0x02)), BB02)                Store (DerefOf(Index(TEMP, 0x03)), BB03)                Store (DerefOf(Index(TEMP, 0x04)), BB04)                Store (DerefOf(Index(TEMP, 0x05)), BB05)                Store (DerefOf(Index(TEMP, 0x06)), BB06)                Store (DerefOf(Index(TEMP, 0x07)), BB07)                Store (DerefOf(Index(TEMP, 0x08)), BB08)                Store (DerefOf(Index(TEMP, 0x09)), BB09)                Store (DerefOf(Index(TEMP, 0x0A)), BB0A)                Store (DerefOf(Index(TEMP, 0x0B)), BB0B)                Store (DerefOf(Index(TEMP, 0x0C)), BB0C)                Store (DerefOf(Index(TEMP, 0x0D)), BB0D)                Store (DerefOf(Index(TEMP, 0x0E)), BB0E)                Store (DerefOf(Index(TEMP, 0x0F)), BB0F)                Store (DerefOf(Index(TEMP, 0x10)), BB10)                Store (DerefOf(Index(TEMP, 0x11)), BB11)                Store (DerefOf(Index(TEMP, 0x12)), BB12)                Store (DerefOf(Index(TEMP, 0x13)), BB13)                Store (DerefOf(Index(TEMP, 0x14)), BB14)                Store (DerefOf(Index(TEMP, 0x15)), BB15)                Store (DerefOf(Index(TEMP, 0x16)), BB16)                Store (DerefOf(Index(TEMP, 0x17)), BB17)                Store (DerefOf(Index(TEMP, 0x18)), BB18)                Store (DerefOf(Index(TEMP, 0x19)), BB19)                Store (DerefOf(Index(TEMP, 0x1A)), BB1A)                Store (DerefOf(Index(TEMP, 0x1B)), BB1B)                Store (DerefOf(Index(TEMP, 0x1C)), BB1C)                Store (DerefOf(Index(TEMP, 0x1D)), BB1D)                Store (DerefOf(Index(TEMP, 0x1E)), BB1E)                Store (DerefOf(Index(TEMP, 0x1F)), BB1F)            }        }    }}//EOF   </code></pre><p>The resulting file can be saved as AML (suggested name: SSDT-BATT.aml), and placed in ACPI/patched.</p><p>But you canâ€™t expect battery status to work with native DSDT yet!</p><h3 id="Renaming-existing-methods"><a href="#Renaming-existing-methods" class="headerlink" title="Renaming existing methods"></a>Renaming existing methods</h3><p>For now, there are duplicate methods in DSDT and this SSDT-BATT.aml. For each method in DSDT that the SSDT-BATT.aml version will replace, we must rename the method in DSDT to something else, which will allow the SSDT version to override.</p><p>Just as in post #1, this part follows the â€œRename/Replaceâ€ pattern.<br>The methods that need replacements are FBST, _BIX, BIFA, SMBR, SMBW, ECSB, and TACH.</p><p>For this step, it is useful to create a mixed bytecode listing for the native DSDT.aml.<br>It can be created with: â€œiasl -l -dl DSDT.amlâ€, which creates a mixed listing in DSDT.dsl</p><p>For the FBST method:</p><pre><code>Method (FBST, 4, NotSerialized){    And (Arg1, 0xFFFF, Local1)    Store (Zero, Local0)FF74: 14 43 12 46 42 53 54 04 7B 69 0B FF FF 61 70 00  // .C.FBST.{i...ap.FF84: 60</code></pre><p>A potential rename patch (FBST-&gt;XBST):</p><pre><code>Find: &lt;46 42 53 54 04&gt;Replace: &lt;58 42 53 54 04&gt;</code></pre><p>It is a good idea to verify that there is only one match for the Find hex data by searching for it in a hex editor such as Hex Fiend. Because the patch should ONLY apply to the method definition, not other code that may be present in the DSDT (or native SSDTs).</p><p>The target name you choose must be unique within the scope that the method resides. Creating a duplicate method will cause kernel panic. Changing the first letter to â€˜Xâ€™ is usually ok, but no guarantee.</p><p>Patches for the rest of the methods:</p><pre><code>_BIX-&gt;XBIX:Find: &lt;5F 42 49 58 00&gt;Replace: &lt;58 42 49 58 00&gt;</code></pre><pre><code>BIFA-&gt;XIFA:Find: &lt;42 49 46 41 00&gt;Replace: &lt;58 49 46 41 00&gt;</code></pre><pre><code>SMBR-&gt;XMBR:Find: &lt;53 4D 42 52 0B&gt;Replace: &lt;58 4D 42 52 0B&gt;</code></pre><pre><code>SMBW-&gt;XMBW:Find: &lt;53 4D 42 57 0D&gt;Replace: &lt;58 4D 42 57 0D&gt;</code></pre><pre><code>ECSB-&gt;XCSB:Find: &lt;45 43 53 42 07&gt;Replace: &lt;58 43 53 42 07&gt;</code></pre><pre><code>TACH-&gt;XACH:Find: &lt;54 41 43 48 09&gt;Replace: &lt;58 41 43 48 09&gt;</code></pre><p>After adding those patches to config.plist/ACPI/DSDT/Patches, the methods in native DSDT will be renamed by Clover. And as a result of the renaming, the patched methods defined in SSDT-BATT.aml will override.</p><h3 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h3><p>Hotpatching for battery status is one of the most complex hotpatch tasks possible. The process of writing all the â€˜Externalâ€™ refernences is tedious and boring.</p><p>It will take some time (several hours into the text youâ€™re reading here). Do not rush it.</p><h2 id="Disabling-discrete-switched-GPU-with-Hotpatch"><a href="#Disabling-discrete-switched-GPU-with-Hotpatch" class="headerlink" title="Disabling discrete/switched GPU with Hotpatch"></a>Disabling discrete/switched GPU with Hotpatch</h2><p>This third post is dedicated to hotpatching required for disabling the discrete GPU in a switched dual-GPU laptop, using the same example ACPI fils as the static patch guide.</p><p><a href="https://www.tonymacx86.com/threads/guide-disabling-discrete-graphics-in-dual-gpu-laptops.163772/" target="_blank" rel="noopener">https://www.tonymacx86.com/threads/guide-disabling-discrete-graphics-in-dual-gpu-laptops.163772/</a></p><p>You should download the ACPI/origin files that are attached to that guide, so you can follow along.</p><p>As in the static patch guide, the goal is relatively simple: call the _OFF method (from an _INI method) for the discrete GPU during ACPI initialization. But the details make it more complex due to the fact that _OFF can contain EC related code which needs to be executed in _REG instead of _INI.</p><h3 id="Building-the-replacement-INI-OFF-REG-methods"><a href="#Building-the-replacement-INI-OFF-REG-methods" class="headerlink" title="Building the replacement _INI/_OFF/_REG methods"></a>Building the replacement _INI/_OFF/_REG methods</h3><p>In the example, the target _INI method is in SSDT-7, _OFF is in SSDT-8. The path of the discrete device is _SB.PCI0.RP05.PEGP. In the example files, _OFF contains EC related code that must be moved to _REG. To complete this patching process, we need to replace _INI, _OFF, and _REG, therefore each will need to be renamed to XINI, XOFF, and XREG</p><p>Note: The methods you need to patch may in fact be different. It all depends on the code within the _OFF path. For example, with other ACPI sets, it happens that SGOF (may be some other name) has EC related code that must be moved to _REG. In that case, you would need to use rename/replace for the SGOF, and perhaps not the _OFF method. Analyze your existing code carefully.</p><p>The Clover config.plist patches will be worked out later. For now, lets look at the SSDT for the replacement methods.</p><p>The SSDT will consist of the patched methods:</p><pre><code>DefinitionBlock("", "SSDT", 2, "hack", "D-GPU", 0){    External(_SB.PCI0.RP05.PEGP, DeviceObj)    External(_SB.PCI0.RP05.PEGP.XINI, MethodObj)    External(_SB.PCI0.RP05.PEGP.XOFF, MethodObj)    External(_SB.PCI0.RP05.PEGP.XINI, MethodObj)    External(_SB.PCI0.LPCB.EC0, DeviceObj)    External(_SB.PCI0.LPCB.EC0.XREG, MethodObj)    External(_SB.PCI0.LPCB.EC0.SPIN, MethodObj)    Scope(_SB.PCI0.RP05.PEGP)    {        Method(_INI)        {            XINI() // call original _INI, now renamed XINI            _OFF() // call (patched) _OFF        }        Method(_OFF, 0, Serialized)        {            If (LEqual (CTXT, Zero))            {                /* \_SB.PCI0.LPCB.EC0.SPIN (0x96, Zero) */                If (LNotEqual (GPRF, One))                {                    Store (VGAR, VGAB)                }                Store (One, CTXT)            }            SGOF ()        }    }    Scope(_SB.PCI0.LPCB.EC0)    {        Method(_REG, 2)        {            XREG(Arg0, Arg1) // call original _REG, now renamed XREG            If (3 == Arg0 &amp;&amp; 1 == Arg1) // EC ready?            {                \_SB.PCI0.LPCB.EC0.SPIN (0x96, Zero) // code that was removed from _OFF            }        }    }</code></pre><p>At this point, the code wonâ€™t compile, as some of the symbols referenced in _OFF are not available.<br>Just like the battery patching guide, we must add the appropriate External declarations.</p><p>Use the compiler errors to determine which symbols you need to find, then add the appropriate External declartions. In the example case:</p><pre><code>External(_SB.PCI0.RP05.PEGP.CTXT, IntObj)External(_SB.PCI0.RP05.PEGP.GPRF, IntObj)External(_SB.PCI0.RP05.PEGP.VGAR, FieldUnitObj)External(_SB.PCI0.RP05.PEGP.VGAB, BuffObj)External(_SB.PCI0.RP05.PEGP.SGOF, MethodObj)</code></pre><p>The resulting SSDT:</p><pre><code>DefinitionBlock("", "SSDT", 2, "hack", "D-GPU", 0){    External(_SB.PCI0.RP05.PEGP, DeviceObj)    External(_SB.PCI0.RP05.PEGP.XINI, MethodObj)    External(_SB.PCI0.RP05.PEGP.XOFF, MethodObj)    External(_SB.PCI0.RP05.PEGP.XINI, MethodObj)    External(_SB.PCI0.LPCB.EC0, DeviceObj)    External(_SB.PCI0.LPCB.EC0.XREG, MethodObj)    External(_SB.PCI0.LPCB.EC0.SPIN, MethodObj)    External(_SB.PCI0.RP05.PEGP.CTXT, IntObj)    External(_SB.PCI0.RP05.PEGP.GPRF, IntObj)    External(_SB.PCI0.RP05.PEGP.VGAR, FieldUnitObj)    External(_SB.PCI0.RP05.PEGP.VGAB, BuffObj)    External(_SB.PCI0.RP05.PEGP.SGOF, MethodObj)    Scope(_SB.PCI0.RP05.PEGP)    {        Method(_INI)        {            XINI() // call original _INI, now renamed XINI            _OFF() // call (patched) _OFF        }        Method(_OFF, 0, Serialized)        {            If (LEqual (CTXT, Zero))            {                /* \_SB.PCI0.LPCB.EC0.SPIN (0x96, Zero) */                If (LNotEqual (GPRF, One))                {                    Store (VGAR, VGAB)                }                Store (One, CTXT)            }            SGOF ()        }    }    Scope(_SB.PCI0.LPCB.EC0)    {        Method(_REG, 2)        {            XREG(Arg0, Arg1) // call original _REG, now renamed XREG            If (3 == Arg0 &amp;&amp; 1 == Arg1) // EC ready?            {                \_SB.PCI0.LPCB.EC0.SPIN (0x96, Zero) // code that was removed from _OFF            }        }    }}</code></pre><p>Now it compiles without error, but there is one warning: â€œ39, 3079, _REG has no corresponding Operation Regionâ€. And this warning is important. The _REG will not be called unless we add a dummy EC OperationRegion.</p><p>We can add it:</p><pre><code>...Scope(_SB.PCI0.LPCB.EC0){    OperationRegion(RME3, EmbeddedControl, 0x00, 0xFF)    Method(_REG, 2)    {...</code></pre><p>Resulting complete SSDT:</p><pre><code>External(_SB.PCI0.RP05.PEGP, DeviceObj)External(_SB.PCI0.RP05.PEGP.XINI, MethodObj)External(_SB.PCI0.RP05.PEGP.XOFF, MethodObj)External(_SB.PCI0.RP05.PEGP.XINI, MethodObj)External(_SB.PCI0.LPCB.EC0, DeviceObj)External(_SB.PCI0.LPCB.EC0.XREG, MethodObj)External(_SB.PCI0.LPCB.EC0.SPIN, MethodObj)External(_SB.PCI0.RP05.PEGP.CTXT, IntObj)External(_SB.PCI0.RP05.PEGP.GPRF, IntObj)External(_SB.PCI0.RP05.PEGP.VGAR, FieldUnitObj)External(_SB.PCI0.RP05.PEGP.VGAB, BuffObj)External(_SB.PCI0.RP05.PEGP.SGOF, MethodObj)Scope(_SB.PCI0.RP05.PEGP){    Method(_INI)    {        XINI() // call original _INI, now renamed XINI        _OFF() // call (patched) _OFF    }    Method(_OFF, 0, Serialized)    {        If (LEqual (CTXT, Zero))        {            /* \_SB.PCI0.LPCB.EC0.SPIN (0x96, Zero) */            If (LNotEqual (GPRF, One))            {                Store (VGAR, VGAB)            }            Store (One, CTXT)        }        SGOF ()    }}Scope(_SB.PCI0.LPCB.EC0){    OperationRegion(RME3, EmbeddedControl, 0x00, 0xFF)    Method(_REG, 2)    {        XREG(Arg0, Arg1) // call original _REG, now renamed XREG        If (3 == Arg0 &amp;&amp; 1 == Arg1) // EC ready?        {            \_SB.PCI0.LPCB.EC0.SPIN (0x96, Zero) // code that was removed from _OFF        }    }}</code></pre><p>At this point, you can save the SSDT (suggestion: SSDT-DGPU.aml).<br>It is ready to go to ACPI/patched.</p><p>But we still need to rename the original methods in native ACPI.</p><h3 id="Renaming-the-methods"><a href="#Renaming-the-methods" class="headerlink" title="Renaming the methods"></a>Renaming the methods</h3><p>As mentioned earlier, the following methods need renaming:<br>_SB.PCI0.RP05.PEGP._INI -&gt; XINI<br>_SB.PCI0.RP05.PEGP._OFF -&gt; XOFF<br>_SB.PCI0.LPCB.EC0._REG -&gt; XREG</p><p>To determine the binary patches needed, we need a mixed listing of DSDT.aml, SSDT-7.aml, and SSDT-8.aml.<br>Create with:</p><pre><code>iasl -dl -l DSDT.aml SSDT-7.aml SSDT-8.aml</code></pre><p>The resulting mixed listing is in DSDT.dsl, SSDT-7.dsl, and SSDT-8.dsl.</p><p>Here is the mixed listing for _REG in DSDT.dsl:<br>Code (Text):</p><pre><code>        Method (_REG, 2, NotSerialized)  // _REG: Region Availability        {D2B8: 14 12 5F 52 45 47 02                             // .._REG.            If (LEqual (Arg0, 0x03))            {D2BF: A0 0B 93 68 0A 03                                // ...h..                Store (Arg1, ECFL)                }            }        }    }D2C5: 70 69 45 43 46 4C</code></pre><p>The patch used should rename only this _REG, not other _REG methods in the ACPI set. We can rename it by grabbing the name/header plus a few bytes from the code.</p><p>This pattern grabs enough bytes to be unique for sure:</p><pre><code>Find: &lt;5F 52 45 47 02 A0 0B 93 68 0A 03 70 69 45 43 46 4C&gt;Replace: &lt;58 52 45 47 02 A0 0B 93 68 0A 03 70 69 45 43 46 4C&gt;</code></pre><p>And the mixed listing for the target _INI in SSDT-7.dsl:</p><pre><code>        Method (_INI, 0, NotSerialized)  // _INI: Initialize        {03D1: 14 1F 5F 49 4E 49 00                             // .._INI.            Store (Zero, \_SB.PCI0.RP05.PEGP._ADR)        }03D8: 70 00 5C 2F 05 5F 53 42 5F 50 43 49 30 52 50 30  // p.\/._SB_PCI0RP003E8: 35 50 45 47 50 5F 41 44 52                       // 5PEGP_ADR</code></pre><p>â€‹            </p><p>Resulting patchâ€¦</p><pre><code>Find: &lt;5F 49 4E 49 00 70 00 5C 2F 05 5F 53 42 5F 50 43 49 30 52 50 30 35 50 45 47 50&gt;Replace: &lt;58 49 4E 49 00 70 00 5C 2F 05 5F 53 42 5F 50 43 49 30 52 50 30 35 50 45 47 50&gt;</code></pre><p>And the _OFF in SSDT-8.dsl:</p><pre><code>    Method (_OFF, 0, Serialized)  // _OFF: Power Off    {032B: 14 45 04 5F 4F 46 46 08                          // .E._OFF.        If (LEqual (CTXT, Zero))        {        \_SB.PCI0.LPCB.EC0.SPIN (0x96, Zero)0333: A0 39 93 43 54 58 54 00 5C 2F 05 5F 53 42 5F 50  // .9.CTXT.\/._SB_P0343: 43 49 30 4C 50 43 42 45 43 30 5F 53 50 49 4E 0A  // CI0LPCBEC0_SPIN.0353: 96 00</code></pre><p> The patchâ€¦</p><pre><code>Find: &lt;5F 4F 46 46 08 A0 39 93 43 54 58 54&gt;Replace: &lt;58 4F 46 46 08 A0 39 93 43 54 58 54&gt;</code></pre><p>Note: Each of these patches could probably be reduced, but you would need to check carefully in all native DSDT and SSDTs for the Find pattern as you donâ€™t want to match on any methods but the target methods. Because _REG, _INI and _OFF are very common names for methods in other scopes, we need to be careful.</p><h3 id="A-simple-example"><a href="#A-simple-example" class="headerlink" title="A simple example"></a>A simple example</h3><p>The files for the ASUS mentioned above were complex due to the need to patch _OFF, _INI, and _REG.</p><p>But letâ€™s take a look at an example that is much simpler. The files are for an Asus K550VX-DM406T, and they are attached to this post. Please download them so you can follow along.</p><p>When we look at the _OFF method in SSDT-14, there is no EC related code. And it calls PGOF, but the PGOF method, defined in SSDT-3, also has no EC related code:</p><pre><code>Method (_OFF, 0, Serialized)  // _OFF: Power Off{    If (LEqual (CTXT, Zero))    {        If (LNotEqual (GPRF, One))        {            Store (VGAR, VGAB)        }        Store (One, CTXT)    }    PGOF (Zero)}</code></pre><p>This means _OFF can be called directly from an _INI.</p><p>If you look at all the _INI methods in the ACPI set, you will find there is no _INI at the path of _OFF (_SB.PCI0.PEG0.PEGP). Which means we can simply add an SSDT that has an _INI at the correct path, and that _INI simply calls _OFF.</p><p>It is a one-liner method:</p><pre><code>DefinitionBlock("", "SSDT", 2, "hack", "DGPU", 0){    External(_SB.PCI0.PEG0.PEGP._OFF, MethodObj)    Method(_SB.PCI0.PEG0.PEGP._INI) { _OFF() }}</code></pre><p>Just as mentioned in the main discrete disable guide (static patch), sometimes you need to call _PS3 instead of _OFF. It is a trial and error process to determine which is best.</p><p>Same code as above, but calling _PS3:</p><pre><code>DefinitionBlock("", "SSDT", 2, "hack", "DGPU", 0){    External(_SB.PCI0.PEG0.PEGP._PS3, MethodObj)    Method(_SB.PCI0.PEG0.PEGP._INI) { _PS3() }}</code></pre><p>Save it as SSDT-DGPU.aml and the Nvidia should be disabled.</p><p>The simple example turned not so simple</p><p>Although the method mentioned above will usually work in this scenario (even with other laptops that present the same scenario: no EC access in _OFF path, no existing _INI at the path), this specific laptop needed additional patching in order to turn off the dedicated Nvidia fan.</p><p>A little investigation was needed. As we can see by looking at the _OFF code, it calls PGOF(Zero) to do most of the work. And if we search for other examples of PGOF being called with Arg0==Zero, we find this code in SSDT-3.dsl:</p><pre><code>ElseIf (LAnd (LGreater (OSYS, 0x07D9), PEGS ())){    FAOF ()    PGOF (Zero)...</code></pre><p>Note the call to FAOF. Could that be for â€œFAN OFFâ€? Seems likely.</p><p>And look, we have FAOF and FAON in SSDT-3:</p><pre><code>Method (FAON, 0, Serialized){    \_SB.PCI0.LPCB.EC0.WRAM (0x052B, 0x9E)    \_SB.PCI0.LPCB.EC0.WRAM (0x0520, 0x8B)    Store (\_SB.PCI0.LPCB.EC0.RRAM (0x0521), Local0)    And (Local0, 0xCF, Local0)    Or (Local0, 0x20, Local0)    \_SB.PCI0.LPCB.EC0.WRAM (0x0521, Local0)}Method (FAOF, 0, Serialized){    Store (\_SB.PCI0.LPCB.EC0.RRAM (0x0521), Local0)    And (Local0, 0xCF, Local0)    \_SB.PCI0.LPCB.EC0.WRAM (0x0521, Local0)    \_SB.PCI0.LPCB.EC0.WRAM (0x0520, 0x89)    \_SB.PCI0.LPCB.EC0.WRAM (0x03A4, Zero)    \_SB.PCI0.LPCB.EC0.WRAM (0x03A5, Zero)}</code></pre><p>And you can see it does a bunch of EC manipulations. Typically the EC controls the system fans, so this seems to confirm these methods are for â€œFAN ONâ€, and â€œFAN OFFâ€.</p><p>Since these methods manipulate the EC, we cannot call FAOF without the EC being ready. To do that, we need to patch _REG.</p><p>So, adding the necessary code to our SSDT:</p><pre><code>DefinitionBlock("", "SSDT", 2, "hack", "DGPU", 0){    External(_SB.PCI0.PEG0.PEGP._OFF, MethodObj)    Method(_SB.PCI0.PEG0.PEGP._INI) { _OFF() }    External(_SB.PCI0.LPCB.EC0, DeviceObj)    External(_SB.PCI0.LPCB.EC0.XREG, MethodObj)    External(_SB.PCI0.PEG0.FAOF, MethodObj)    Scope(_SB.PCI0.LPCB.EC0)    {        OperationRegion(RME3, EmbeddedControl, 0x00, 0xFF)        Method(_REG, 2)        {            XREG(Arg0, Arg1) // call original _REG, now renamed XREG            If (3 == Arg0 &amp;&amp; 1 == Arg1) // EC ready?            {                 \_SB.PCI0.PEG0.FAOF() // turn dedicated Nvidia fan off            }        }    }}</code></pre><p>And the patch we need to rename _REG to XREG (again, based on a mixed listing of DSDT.aml):</p><pre><code>Find: &lt;5F 52 45 47 02 A0 0B 93 68 0A 03&gt;Replace: &lt;58 52 45 47 02 A0 0B 93 68 0A 03&gt;</code></pre><p>With the patch in config.plist, EC0._REG is renamed XREG. The eventual call to _REG by the system lands in our modified _REG, which, in turn, calls the original _REG (renamed to XREG) and calls FAOF to turn the fan off.</p><h3 id="Conclusion-1"><a href="#Conclusion-1" class="headerlink" title="Conclusion"></a>Conclusion</h3><p>Hotpatching discrete GPU disable code is a bit simpler than battery status, but involves similar concepts.</p><h2 id="Credits"><a href="#Credits" class="headerlink" title="Credits"></a>Credits</h2><p><a href="https://github.com/RehabMan/OS-X-Clover-Laptop-Config" target="_blank" rel="noopener">https://github.com/RehabMan/OS-X-Clover-Laptop-Config</a><br><a href="https://www.tonymacx86.com/threads/guide-using-clover-to-hotpatch-acpi.200137/" target="_blank" rel="noopener">https://www.tonymacx86.com/threads/guide-using-clover-to-hotpatch-acpi.200137/</a></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Hackintosh </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hacintosh </tag>
            
            <tag> hotpatch </tag>
            
            <tag> ACPI </tag>
            
            <tag> SSDT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ASUS-X455LD-i5-4210u</title>
      <link href="/posts/d2bf02d2/"/>
      <url>/posts/d2bf02d2/</url>
      
        <content type="html"><![CDATA[<h2 id="Install-macOS-High-Sierra-on-ASUS-X455LD-i5-4210u"><a href="#Install-macOS-High-Sierra-on-ASUS-X455LD-i5-4210u" class="headerlink" title="Install macOS High Sierra on ASUS X455LD i5 4210u"></a>Install macOS High Sierra on ASUS X455LD i5 4210u</h2><a id="more"></a><h3 id="Laptop-Configuration"><a href="#Laptop-Configuration" class="headerlink" title="Laptop Configuration"></a>Laptop Configuration</h3><pre class="line-numbers language-properties"><code class="language-properties"><span class="token attr-name">Computer</span> <span class="token attr-value">model              Asus F455LD Notebook</span><span class="token attr-name">CPU</span> <span class="token attr-value">                        Intel Core i5-4210u</span><span class="token attr-name">Operate</span> <span class="token attr-value">System              Windows10 Education 64bit + macOS High Sierra 17B25c</span><span class="token attr-name">                            +</span> <span class="token attr-value">Windows7 Ultimate + ElementaryOS base on Ubuntu 16.04</span><span class="token attr-name">Main</span> <span class="token attr-value">board                  Asus X455LD Intel Haswell-ULT - Lynx Point-LP</span><span class="token attr-name">Discret</span> <span class="token attr-value">egraphics           Nvidia GeForce 820M 2G </span><span class="token attr-name">Integrated</span> <span class="token attr-value">graphics         HD4400</span><span class="token attr-name">Audio</span> <span class="token attr-value">                      Realtek @ Intel Lynx Point-LP  High Definition Audio (CX20751)</span><span class="token attr-name">Ethernet</span> <span class="token attr-value">                   Realtek RTL8168/8111/8112 Gigabit Ethernet Controller / Asus</span><span class="token attr-name">Wireless</span> <span class="token attr-value">network adapter    Atheros AR956X</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Working"><a href="#Working" class="headerlink" title="Working"></a>Working</h3><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/ASUS-F455LD-i5-4210u/Screens/Backlight-Controller.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/ASUS-F455LD-i5-4210u/Screens/Full-Power-Manager-1.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/ASUS-F455LD-i5-4210u/Screens/Full-Power-Manager-2.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/ASUS-F455LD-i5-4210u/Screens/SmartTouchPad-1.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/ASUS-F455LD-i5-4210u/Screens/SmartTouchPad-2.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/ASUS-F455LD-i5-4210u/Screens/SmartTouchPad-3.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/ASUS-F455LD-i5-4210u/Screens/FakeMouse.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/ASUS-F455LD-i5-4210u/Screens/Audio-Insert-Headphone.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/ASUS-F455LD-i5-4210u/Screens/Audio-Remove-Headphone.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/ASUS-F455LD-i5-4210u/Screens/Bluetooth.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/ASUS-F455LD-i5-4210u/Screens/Ethernet.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/ASUS-F455LD-i5-4210u/Screens/Wireless.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/ASUS-F455LD-i5-4210u/Screens/Graphics.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/ASUS-F455LD-i5-4210u/Screens/USB.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/ASUS-F455LD-i5-4210u/Screens/Bettery.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/ASUS-F455LD-i5-4210u/Screens/PCI-List.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/ASUS-F455LD-i5-4210u/Screens/Brightness-Control.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/ASUS-F455LD-i5-4210u/Screens/Audio-Control-1.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/ASUS-F455LD-i5-4210u/Screens/Audio-Control-2.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/ASUS-F455LD-i5-4210u/Screens/About.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/ASUS-F455LD-i5-4210u/Screens/Display-Built-In.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/ASUS-F455LD-i5-4210u/Screens/HDMI-Audio-1.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/ASUS-F455LD-i5-4210u/Screens/HDMI-Audio-2.png" alt=""></p><h3 id="Notes"><a href="#Notes" class="headerlink" title="Notes"></a>Notes</h3><h4 id="About-ALCPlugFix"><a href="#About-ALCPlugFix" class="headerlink" title="About ALCPlugFix"></a>About <code>ALCPlugFix</code></h4><p>Firstlyï¼ŒUnzip <code>ALCPlugFix</code> to your desktop after you have installed Hackintoshã€‚<br>Secondlyï¼Œopen terminalï¼š</p><pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">cd</span> ~/Desktop/ALCPlugFix/alc_fix$ <span class="token function">chmod</span> +x install.sh$ ./install.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>The script can fix your audio with good input and switchã€‚</p><h4 id="About-ä¸€é”®å¼€å¯HIDPIå¹¶æ³¨å…¥EDID"><a href="#About-ä¸€é”®å¼€å¯HIDPIå¹¶æ³¨å…¥EDID" class="headerlink" title="About ä¸€é”®å¼€å¯HIDPIå¹¶æ³¨å…¥EDID"></a>About <code>ä¸€é”®å¼€å¯HIDPIå¹¶æ³¨å…¥EDID</code></h4><p>Just double click <code>åŒå‡».command</code>ï¼Œand input your passwordã€‚</p><p>Then it can working as Macintoshã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypv9f7dyhj317c0yktmd.jpg" alt=""></p><h3 id="Clover-EFI-bootloader"><a href="#Clover-EFI-bootloader" class="headerlink" title="Clover EFI bootloader"></a>Clover EFI bootloader</h3><p><a href="https://github.com/athlonreg/ASUS-F455LD-i5-4210u/releases" target="_blank" rel="noopener">ASUS-F455LD-i5-4210u</a></p><h3 id="Finally"><a href="#Finally" class="headerlink" title="Finally"></a>Finally</h3><p>Please respect the authorâ€™s work and please indicate the address of the original post if you want reprint the repo!</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Hackintosh </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hacintosh </tag>
            
            <tag> X455LD </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å›æº¯æ³•æ±‚å­é›†å’Œé—®é¢˜</title>
      <link href="/posts/6ad2b36d/"/>
      <url>/posts/6ad2b36d/</url>
      
        <content type="html"><![CDATA[<h3 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h3><p>å­é›†å’Œé—®é¢˜çš„ä¸€ä¸ªå®ä¾‹ä¸º&lt;S,t&gt;ã€‚å…¶ä¸­ï¼ŒS={x<sub>1</sub>,x<sub>2</sub>,x<sub>3</sub>,â€¦,x<sub>n</sub>}æ˜¯ä¸€ä¸ªæ­£æ•´æ•°çš„é›†åˆï¼Œcæ˜¯ä¸€ä¸ªæ­£æ•´æ•°ã€‚å­é›†å’Œé—®é¢˜åˆ¤å®šæ˜¯å¦å­˜åœ¨Sçš„ä¸€ä¸ªå­é›†S<sub>1</sub>ï¼Œä½¿å¾— S<sub>1</sub>ä¸­çš„æ‰€æœ‰å…ƒç´ ä¹‹å’Œç­‰äºcã€‚<br>è¯•è®¾è®¡ä¸€ä¸ªè§£å­é›†å’Œé—®é¢˜çš„å›æº¯æ³•ã€‚</p><h3 id="è¾“å…¥"><a href="#è¾“å…¥" class="headerlink" title="è¾“å…¥"></a>è¾“å…¥</h3><p>ç¬¬1è¡Œæœ‰2ä¸ªæ­£æ•´æ•°nå’Œcï¼Œnè¡¨ç¤ºSçš„å¤§å°ï¼Œcæ˜¯å­é›†å’Œçš„ç›®æ ‡å€¼ã€‚æ¥ä¸‹æ¥çš„1è¡Œä¸­ï¼Œæœ‰nä¸ªæ­£æ•´æ•°ï¼Œè¡¨ç¤ºé›†åˆSä¸­çš„å…ƒç´ ã€‚</p><h3 id="è¾“å‡º"><a href="#è¾“å‡º" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h3><p>è¾“å‡ºå­é›†å’Œé—®é¢˜çš„è§£ã€‚å½“é—®é¢˜æ— è§£æ—¶ï¼Œè¾“å‡º<code>No solution!</code>ã€‚</p><h3 id="æ ·ä¾‹è¾“å…¥"><a href="#æ ·ä¾‹è¾“å…¥" class="headerlink" title="æ ·ä¾‹è¾“å…¥"></a>æ ·ä¾‹è¾“å…¥</h3><pre><code>5 102 2 6 5 4</code></pre><h3 id="æ ·ä¾‹è¾“å‡º"><a href="#æ ·ä¾‹è¾“å‡º" class="headerlink" title="æ ·ä¾‹è¾“å‡º"></a>æ ·ä¾‹è¾“å‡º</h3><pre><code>2 2 6</code></pre><h3 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h3><pre class="line-numbers language-c"><code class="language-c"><span class="token comment" spellcheck="true">//</span><span class="token comment" spellcheck="true">//  main.c</span><span class="token comment" spellcheck="true">//  subset-sum</span><span class="token comment" spellcheck="true">//</span><span class="token comment" spellcheck="true">//  Created by Canvas on 2018/12/31.</span><span class="token comment" spellcheck="true">//  Copyright Â© 2018 Canvas. All rights reserved.</span><span class="token comment" spellcheck="true">//</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">define</span> n 5</span><span class="token macro property">#<span class="token directive keyword">define</span> c 10</span><span class="token keyword">int</span> array<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">int</span> a<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">int</span> sum<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">int</span> flag<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">traceback</span><span class="token punctuation">(</span><span class="token keyword">int</span> t<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>t<span class="token operator">==</span>n<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>sum<span class="token operator">==</span>c<span class="token punctuation">)</span><span class="token punctuation">{</span>            flag<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%3d"</span><span class="token punctuation">,</span>array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span><span class="token punctuation">{</span>        sum<span class="token operator">+</span><span class="token operator">=</span>array<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">;</span>        a<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token function">traceback</span><span class="token punctuation">(</span>t<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        a<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>        sum<span class="token operator">-</span><span class="token operator">=</span>array<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token function">traceback</span><span class="token punctuation">(</span>t<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">traceback</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>flag<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"No Solutions!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç»“æœè¾“å‡º"><a href="#ç»“æœè¾“å‡º" class="headerlink" title="ç»“æœè¾“å‡º"></a>ç»“æœè¾“å‡º</h3><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypyog7y2mj32c01fewuq.jpg" alt=""></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å­é›†å’Œé—®é¢˜ </tag>
            
            <tag> å›æº¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¬”è®°æœ¬åŸç‰ˆé»‘è‹¹æœå®‰è£…æ•™ç¨‹</title>
      <link href="/posts/85d795c7/"/>
      <url>/posts/85d795c7/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>Cloveræ”¯æŒä¸¤ç§å¯åŠ¨æ–¹å¼ï¼Œå¯åŠ¨è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ul><li><p>åŸºäº<code>BIOS</code>çš„ç”µè„‘ï¼ˆè€å¼ä¸»æ¿ï¼‰<br>BIOS -&gt; MBR -&gt; PBR -&gt; boot -&gt; CLOVERX64.efi -&gt; OSLoader</p></li><li><p>åŸºäº<code>UEFI</code>çš„ç”µè„‘ï¼ˆæ–°å¼ä¸»æ¿ï¼‰<br>UEFI -&gt; CLOVERX64.efi -&gt; OSLoader</p></li></ul><p>å¯¹äºæ”¯æŒ<code>UEFI</code>çš„æœºå™¨ï¼Œæˆ‘ä»¬é€šå¸¸ç”¨<code>CLOVER</code>å¼•å¯¼åŸç‰ˆå®‰è£…ï¼Œè¿™ç§æ–¹å¼æœ€å¤§çš„ä¼˜ç‚¹å°±æ˜¯æœ‰æ¢å¤åˆ†åŒºå¯ä»¥æ­£å¸¸å‡çº§ï¼Œå½“ç„¶å‰æè¦æŠŠå¼•å¯¼åšå¥½ã€‚</p><h3 id="å‰æœŸçŸ¥è¯†å‚¨å¤‡"><a href="#å‰æœŸçŸ¥è¯†å‚¨å¤‡" class="headerlink" title="å‰æœŸçŸ¥è¯†å‚¨å¤‡"></a>å‰æœŸçŸ¥è¯†å‚¨å¤‡</h3><h4 id="CLOVERçš„ç›®å½•ç»“æ„"><a href="#CLOVERçš„ç›®å½•ç»“æ„" class="headerlink" title="CLOVERçš„ç›®å½•ç»“æ„"></a><code>CLOVER</code>çš„ç›®å½•ç»“æ„</h4><p><code>CLOVER</code>æ­£å¸¸å·¥ä½œéœ€è¦çš„å®Œæ•´ç›®å½•åŒ…æ‹¬<code>config.plist</code>ã€<code>CLOVERX64.efi</code>ä¸¤ä¸ªæ–‡ä»¶ä»¥åŠ<code>ACPI</code>ã€<code>drivers64UEFI</code>ã€<code>kexts</code>ã€å’Œ<code>themes</code>å‡ ä¸ªç›®å½•ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypx6z6l1uj31d00ug7cf.jpg" alt=""></p><p>å…¶ä¸­ï¼Œ<code>config.plist</code>æ˜¯æœ€æ ¸å¿ƒçš„æ–‡ä»¶â€”-é…ç½®æ–‡ä»¶ï¼Œ<code>CLOVER</code>æ‰€å®ç°çš„å¤šæ•°åŠŸèƒ½éƒ½æ˜¯é€šè¿‡è¿™ä¸ªæ–‡ä»¶è¿›è¡Œé…ç½®çš„ï¼Œå¯¹å…¶è¿›è¡Œé…ç½®ä¿®æ”¹çš„æœ€å¥½ç”¨çš„å·¥å…·å°±æ˜¯<code>Clover Configurator</code>ï¼Œä¸»é¡µé¢å¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypx78r5udj32201804gw.jpg" alt=""></p><p>è¯¦ç»†çš„é…ç½®æ–¹æ³•ä¸‹é¢ä¼šæœ‰ä»‹ç»ã€‚</p><p>å¦å¤–ä¸€ä¸ªæ–‡ä»¶æ˜¯<code>CLOVERX64.efi</code>ï¼Œè¿™ä¸ªæ–‡ä»¶ç”¨ä»¥å¯åŠ¨<code>CLOVER</code>å¼•å¯¼ï¼Œé€šè¿‡<code>EasyUEFI</code>æˆ–è€…<code>BIOS</code>å¯¹å¯åŠ¨é¡¹è¿›è¡Œæ·»åŠ æ“ä½œæ—¶ï¼Œå°±æ˜¯æŒ‡å‘çš„è¿™ä¸ªæ–‡ä»¶ã€‚</p><p><code>ACPI</code>æ˜¯ç”¨ä»¥å­˜æ”¾æœºå™¨<code>ACPI</code>è¡¨å•çš„ï¼Œå…¨ç§°æ˜¯â€é«˜çº§é…ç½®å’Œç”µæºç®¡ç†æ¥å£â€<code>(Advanced Configuration and Power Interface)</code>ï¼Œå…¶å­ç›®å½•ç”±<code>origin</code>ã€<code>patched</code>ã€<code>WINDOWS</code>æ„æˆï¼Œå…¶ä¸­<code>origin</code>ç”¨ä»¥ä¿å­˜é€šè¿‡åœ¨<code>CLOVER</code>å¼•å¯¼ç•Œé¢æŒ‰<code>F4</code>æˆ–<code>Fn F4</code>æå–çš„åŸå§‹è¡¨å•ï¼Œæ­¤ç›®å½•çš„æ‰€æœ‰è¡¨æ–‡ä»¶æ˜¯ä¸åŠ è½½çš„ï¼Œéœ€è¦å¯¹å…¶è¿›è¡Œç¼–è¯‘å¾—åˆ°<code>.dsl</code>æ–‡ä»¶ï¼Œç„¶åå¯¹å…¶è¿›è¡Œä¿®æ”¹æ‹é”™ï¼Œæœ€åä¿å­˜æˆ<code>.aml</code>æ–‡ä»¶ä¿å­˜è‡³<code>patched</code>ç›®å½•æ‰ä¼šåœ¨å¯åŠ¨æ—¶åŠ è½½ï¼Œè€Œ<code>WINDOWS</code>ç›®å½•åˆ™å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚åœ¨é»‘æœä¸­ï¼Œæˆ‘ä»¬ç”¨åˆ°çš„è¡¨å•æ–‡ä»¶åªæœ‰<code>SSDT</code>å’Œ<code>DSDT</code>ï¼Œå…¶ä¸­<code>DSDT</code>ä¸»è¦æ˜¯å¯¹å„ç§è®¾å¤‡çš„æè¿°ï¼Œè€Œ<code>SSDT</code>åˆ™ä¸»è¦æ˜¯ç”¨ä»¥å®ç°æŸä¸ªåŠŸèƒ½ã€‚</p><p><code>drivers64UEFI</code>æ˜¯ç”±å„ç§<code>EFI</code>é©±åŠ¨ç»„æˆï¼Œåœ¨ç¬”è®°æœ¬é»‘æœéœ€è¦ç”¨åˆ°çš„æœ‰<code>FSInject-64.efi</code>ã€<code>HFSPlus-64.efi</code>ã€<code>OsxAptioFixDrv-64.efi</code>ã€<code>APFS.efi</code>ä»¥åŠ<code>OsxFatBinaryDrv-64.efi</code>ï¼Œåœ¨æ–°ç‰ˆ<code>CLOVER</code>ä¸­åªéœ€è¦<code>FSInject-64.efi</code>ã€<code>HFSPlus-64.efi</code>ã€<code>OsxAptioFixDrv-64.efi</code>ã€ä»¥åŠ<code>APFS.efi</code></p><p><code>kexts</code>ä¸»è¦ç”¨äºå­˜å‚¨å„ç§é©±åŠ¨(<code>OS X</code>ç§°ä¸ºå†…æ ¸æ‰©å±•)</p><p><code>themes</code>ç”¨ä»¥å­˜å‚¨<code>CLOVER</code>å¼•å¯¼ç•Œé¢çš„ä¸»é¢˜</p><h4 id="æ ¹æ®æœºå™¨é…ç½®å®šåˆ¶kext"><a href="#æ ¹æ®æœºå™¨é…ç½®å®šåˆ¶kext" class="headerlink" title="æ ¹æ®æœºå™¨é…ç½®å®šåˆ¶kext"></a>æ ¹æ®æœºå™¨é…ç½®å®šåˆ¶<code>kext</code></h4><p><code>kext</code>åœ¨<code>EFI</code>çš„é…ç½®ä¸­æ˜¯ç›¸å½“é‡è¦çš„ï¼Œå¥½çš„<code>kext</code>é…ç½®å¯ä»¥å¼¥è¡¥<code>config</code>çš„ä¸è¶³ï¼Œä¸å¥½çš„<code>kext</code>é…ç½®ä¹Ÿä¼šè®©æœ¬åº”å®Œç¾çš„<code>config</code>å‘æŒ¥ä¸å‡ºä½œç”¨ã€‚</p><p><code>FakeSMC.kext</code>:<code>FakeSMC</code>æ˜¯ç°ä»Šçš„â¿Šé»‘è‹¹æœè¿‡ç¨‹ä¸­å”¯â¼€ä¸€çš„â€å¿…è¦æ€§â€å†…æ ¸æ‰©å±•ç¨‹åºã€‚å¯¹äºâ¿Šé»‘è‹¹æœæœ‰ç€â½†ä¸ä¼¦æ¯”çš„é‡è¦æ€§ï¼Œä½†æ˜¯å¾ˆå¤šâ¼ˆå¹¶ä¸çŸ¥é“<code>FakeSMC</code>ä¸ºä»€ä¹ˆé‡è¦ï¼Œåªæ˜¯çŸ¥é“å¿…é¡»æœ‰å®ƒæ‰â¾è¡Œï¼Œã€‚ç®€â½½è€Œâ¾”è¨€ä¹‹å°±æ˜¯: <code>FakeSMC</code>æ˜¯â½¤ç”¨äºå°†<code>PC</code>ä¸»æ¿ä¸Šçš„å„ç§æ§åˆ¶èŠ¯â½šç‰‡ä¼ªè£…æˆMacç‹¬æœ‰çš„ç¡¬ä»¶æ§åˆ¶èŠ¯ç‰‡<code>SMC</code>ä»¥éª—è¿‡ç³»ç»Ÿä»â½½è€Œæ˜¯ç³»ç»Ÿæ­£å¸¸å¯åŠ¨çš„â¼€ä¸€ä¸ªå†…æ ¸æ‰©å±•(å…¶å®å¾ˆå¤æ‚,è¿™â¾¥é‡Œä¸å¤šè¯´äº†)ã€‚åœ¨ç³»ç»Ÿå¯åŠ¨çš„é˜¶æ®µï¼Œ<code>FakeSMC</code>è´Ÿè´£å‘ŠçŸ¥ç³»ç»Ÿæœ‰å…³ä¸»æ¿ä¸Š<code>SMC</code>èŠ¯â½šç‰‡(ä¼ªè£…å‡ºæ¥çš„)çš„å„ç§åŠ å¯†ä¿¡æ¯ï¼Œæ¬ºéª—ç³»ç»Ÿã€‚ä¹Ÿå°±æ˜¯è¯´å‘¢ï¼Œæ— è®ºä½ ç¬”è®°æœ¬æ˜¯ä»€ä¹ˆé…ç½®ï¼Œæ­¤é©±åŠ¨æ˜¯å¿…é¡»çš„ã€‚</p><p><code>ApplePS2SmartTouchPad.kext</code>ã€<code>VoodooI2C.kext</code>å’Œ<code>VoodooPS2Controller.kext</code>:æ­¤é©±åŠ¨ç”¨ä»¥é©±åŠ¨é”®ç›˜é¼ æ ‡ä»¥åŠè§¦æ‘¸æ¿ï¼Œä¸¤è€…é€‰æ‹©ä¸€ä¸ªå³å¯ï¼Œä¸¤è€…åŒºåˆ«å°±æ˜¯é€‚ç”¨çš„ç±»å‹ä¸ä¸€æ ·ï¼Œæœ‰<code>PS/2</code>ã€<code>Synaptics</code>ã€<code>alps</code>ã€<code>i2c</code>ç­‰ç­‰ï¼Œå…¶ä¸­<code>Synaptics</code>ã€<code>alps</code>ç”¨<code>ApplePS2SmartTouchPad.kext</code>é€‚é…æ€§å¥½ä¸€äº›ï¼Œ<code>VoodooI2C.kext</code>æ¯”è¾ƒéº»çƒ¦ï¼Œä»…é€‚ç”¨äº<code>i2c</code>è§¦æ‘¸æ¿ã€‚å…·ä½“æ€ä¹ˆç¡®å®šèµ°çš„æ€»çº¿ç±»å‹ï¼Œå¤§å®¶å‚è€ƒç™¾åº¦å°±å¥½äº†ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°ã€‚</p><p><code>FakePCIID.kext</code>:è¿™ä¸ªkextçš„ç›®çš„æ˜¯ä¸<code>IOPCIDevice</code>è®¾å¤‡å»ºç«‹è¿æ¥ï¼Œä»¥ä¾¿å½“å¦ä¸€ä¸ªé©±åŠ¨ç¨‹åºè¿æ¥åˆ°åŒä¸€è®¾å¤‡æ—¶ï¼Œå®ƒå¯ä»¥æä¾›å¤‡ç”¨çš„<code>PCI ID</code>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœç”¨åˆ°<code>Fake-PCI-ID</code>ä¸­çš„å…¶ä»–ä»»ä½•<code>kext</code>çš„è¯ï¼Œæ­¤é©±åŠ¨éƒ½æ˜¯å¿…è¦çš„ã€‚</p><p><code>FakePCIID_Intel_HD_Graphics.kext</code>:æ­¤é©±åŠ¨ä¸»è¦ç”¨äºæ ¸æ˜¾<code>HD4200 HD4400 HD4600 P4600</code>ã€<code>Iris 540 Iris 550 Iris Pro 580</code>ã€<code>HD510 HD515 HD520 HD530 P530</code>ï¼ˆå¤šæ•°530ä¸éœ€è¦è¿™ä¸ªï¼‰ã€<code>P4000</code>ã€<code>P6300 - 162a</code>ã€<code>UHD620 KabyLake-R</code>ã€<code>UHD630 CoffeeLake</code>ã€‚</p><p><code>FakePCIID_Intel_HDMI_Audio.kext</code>:å…¶ç›®çš„æ˜¯ä¸ºä¸æ”¯æŒçš„<code>HDAU</code>æä¾›æ”¯æŒ(é€šå¸¸ç§°ä¸º<code>B0D3</code>ï¼Œä½†éœ€è¦å°†å…¶é‡å‘½åä¸º<code>HDAU</code>ï¼Œä»¥æ»¡è¶³<code>Apple</code>çš„æœŸæœ›å€¼)åœ¨<code>Haswell</code>ä»¥ä¸Šçš„ç³»ç»Ÿä¸­æä¾›<code>HDMI-audio</code>çš„è®¾å¤‡ã€‚</p><p><code>FakePCIID_BCM57XX_as_BCM57765.kext</code>:è¿™ä¸ª<code>kext</code>å°†ä¸ä¼—å¤šä¸å—æ”¯æŒçš„<code>BCM57XX</code>ä»¥å¤ªç½‘è®¾å¤‡å»ºç«‹è¿æ¥ï¼Œä»¥ä½¿æœ¬æœºé©±åŠ¨ç¨‹åºä¸ºå…¼å®¹çš„æ›´å¹¿æ³›çš„<code>BCM</code>ä»¥å¤ªç½‘èŠ¯ç‰‡ç»„å·¥ä½œã€‚</p><p><code>FakePCIID_Intel_GbX.kext</code>:è¿™ä¸ª<code>kext</code>å°†ä¸ä¸€äº›<code>Intel</code>ä»¥å¤ªç½‘è®¾å¤‡å»ºç«‹è¿æ¥ï¼Œä»¥ä½¿åŸºäº<code>Intel</code>èŠ¯ç‰‡ç»„çš„é©±åŠ¨ç¨‹åºå·¥ä½œã€‚</p><p><code>FakePCIID_XHCIMux.kext</code>:å°†ä¼šè¿æ¥åˆ°8086:1e31, 8086:9c31, 8086:9cb1, 8086:9c31, 8086:8cb1è¿™ä¸ªæ³¨å…¥å™¨æ˜¯æ­£å¸¸çš„<code>FakePCIID</code>ä»»åŠ¡çš„ä¸€éƒ¨åˆ†ã€‚å®ƒå®é™…ä¸Šå¹¶æ²¡æœ‰ä¼ªé€ ä»»ä½•<code>PCI id</code>ã€‚ç›¸åï¼Œå®ƒå°†æŸäº›å€¼å¼ºåŠ äº<code>Intel XHCI USB3</code>æ§åˆ¶å™¨ä¸Šçš„<code>XUSB2PR</code> (PCIé…ç½®åç§»<code>0xD0</code>)ã€‚å…¶æ•ˆæœæ˜¯å°†ä»»ä½•<code>USB2</code>è®¾å¤‡ä¸<code>XHC</code>ç«¯å£ä¸Šçš„<code>USB2</code>å¼•è„šè¿æ¥åˆ°<code>EHC1</code>ã€‚æ¢å¥è¯è¯´ï¼Œä½¿ç”¨USB2é©±åŠ¨è€Œä¸æ˜¯<code>USB3</code>é©±åŠ¨ç¨‹åº(<code>AppleUSBEHCI vs AppleUSBXHCI</code>)å¤„ç†<code>USB2</code>è®¾å¤‡ã€‚</p><p><code>FakePCIID_AR9280_as_AR946x</code>:è¿™æ˜¯<code>FakePCIID.kext</code>çš„ç‰¹æ®Šåº”ç”¨ï¼Œæ˜¯åœ¨ä¸€ä¸ª<code>AR9280</code>è¢«é‡æ–°å‘½åä¸ºå…¶ä»–è®¾å¤‡çš„æƒ…å†µä¸‹ä½¿ç”¨çš„ã€‚ä¾‹å¦‚ï¼Œåœ¨è”æƒ³<code>u430</code>ä¸­ï¼Œå°†ä¸€ä¸ª<code>AR9280</code>ä½œä¸º<code>AR946x</code>é‡æ–°å‘½åæ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œå› ä¸ºè¯¥è®¾å¤‡å¯ä»¥è¢«<code>BIOS</code>ç™½åå•æ‰€å…è®¸ï¼Œè€Œ<code>AR9280</code>ä¸æ˜¯ã€‚é€šè¿‡ä½¿ç”¨<code>FakePCIID</code>ï¼Œæˆ‘ä»¬å¯ä»¥å°†<code>PCI id</code>é‡æ–°æ˜ å°„å›<code>AR9280</code> (168c:002a)ï¼Œå³ä½¿è¯¥è®¾å¤‡æœ¬èº«æŠ¥å‘Šçš„æ˜¯168c:0034ã€‚</p><p><code>FakePCIID_Broadcom_WiFi.kext</code>:è¿™ä¸ª<code>kext</code>å°†è¿æ¥åˆ°14e4:43b1, 14e4:4357, 14e4:4331, 14e4:4353, 14e4:432b, 14e4 . 432b, 14e4:43a3ï¼Œæˆ–14e4:43a0ã€‚ä»¥åŠ106b:4e, 14e4:4312, 14e4:4313, 14e4:4318, 14e4:431a, 14e4:4320, 14e4:4324, 14e4:4324, 14e4:4328, 14e4:432dã€‚<br>æœ€åˆæ˜¯ä¸º<code>BCM94352Z</code>åˆ›å»ºçš„ï¼Œè¿™ä¸ªç‰¹æ®Šçš„FakePCIIDåº”ç”¨ç¨‹åºã€‚åœ¨ä½¿ç”¨å¤šç§æ”¯æŒçš„Broadcom WiFiè®¾å¤‡æ—¶ï¼Œkextè¢«ç”¨æ¥æ¨¡æ‹ŸçœŸæ­£çš„<code>Apple Airport</code>(è‹¹æœæ— çº¿ç½‘å¡)ã€‚</p><p><code>ACPIBatteryManager.kext</code>:ç”¨ä»¥ä½¿ç¬”è®°æœ¬æ­£ç¡®æ˜¾ç¤ºç”µé‡ï¼Œä½†é€šå¸¸éœ€è¦é…åˆ<code>DSDT</code>çš„<code>patch</code>æ‰èƒ½å‘æŒ¥ä½œç”¨ã€‚</p><p><code>VoodooHDA.kext</code>:ä¸‡èƒ½å£°å¡é©±åŠ¨ï¼Œç”¨ä»¥ç¦ç”¨<code>AppleHDA</code>æ¥é©±åŠ¨å£°å¡ã€‚</p><p><code>AppleALC.kext</code>:é€šè¿‡å¯¹<code>AppleHDA</code>çš„åŠ¨æ€<code>patch</code>å®ç°å¯¹<code>AppleHDA</code>çš„å®Œæ•´åŠ è½½ã€‚</p><p><code>Lilu.kext</code>:ä¸€ä¸ªå¼€æ”¾æºç çš„å†…æ ¸æ‰©å±•ï¼Œä¸ºmacOSç³»ç»Ÿæä¾›äº†ä¸€ä¸ªä»»æ„çš„kextã€åº“å’Œç¨‹åºè¡¥ä¸çš„å¹³å°ã€‚</p><p><code>IntelGraphicsDVMTFixup.kext</code>:ä¿®å¤å› <code>BIOS</code>æ˜¾å­˜åˆ†é…ä¸è¶³é€ æˆçš„<code>KP</code>ã€‚å»ºè®®<code>broadwell+</code>å¹³å°ä½¿ç”¨ã€‚</p><p><code>IntelGraphicsFixup.kext</code>:åŠ¨æ€ä¿®å¤æ ¸æ˜¾çš„å„ç§é—®é¢˜(ä¾‹å¦‚è…¾è®¯è§†é¢‘æ­»æœºï¼Œå¼€æœºäºŒé˜¶æ®µèŠ±å±ç­‰)ï¼Œå»ºè®®<code>Haswell+</code>å¹³å°ä½¿ç”¨ã€‚</p><p><code>CoreDisplayFixup.kext</code>:ä¸ºä¸å—æ”¯æŒçš„4Kæœºå™¨(é<code>Iris</code>)å¼€å¯é«˜åˆ†è¾¨ç‡æ”¯æŒã€‚</p><p><code>AzulPatcher4600.kext</code>:é’ˆå¯¹<code>HD4600</code>çš„é¢å¤–ä¿®å¤ï¼Œä»…æ¨è<code>HD4600</code>ä½¿ç”¨ã€‚</p><p><code>HibernationFixup.kext</code>:ä¿®å¤ç¡çœ ï¼Œä»¥æ”¯æŒæŸäº›æœºå™¨åœ¨3å’Œ28ä¼‘çœ æ¨¡å¼ä¸‹çš„æ­£å¸¸ä¼‘çœ ã€‚</p><p><code>NvidiaGraphicsFixup.kext</code>:ä¿®å¤æŸäº›nå¡çš„é»‘å±ã€‚</p><p><code>WhateverGreen.kext</code>:ç”¨ä»¥é©±åŠ¨Aå¡ã€‚</p><p><code>RealtekRTL8111.kext</code>:ç”¨ä»¥é©±åŠ¨<code>RealtekRTL8111.kext</code>ä»¥å¤ªç½‘å¡è®¾å¤‡ã€‚</p><p><code>AppleIGB.kext</code>ã€<code>IntelMausiEthernet.kext</code>:ç”¨ä»¥é©±åŠ¨<code>Intel</code>æ¿è½½ç½‘å¡è®¾å¤‡ã€‚</p><h4 id="æ ¹æ®æœºå™¨é…ç½®å®šåˆ¶config"><a href="#æ ¹æ®æœºå™¨é…ç½®å®šåˆ¶config" class="headerlink" title="æ ¹æ®æœºå™¨é…ç½®å®šåˆ¶config"></a>æ ¹æ®æœºå™¨é…ç½®å®šåˆ¶<code>config</code></h4><p>Clover å¯ä»¥æ ¹æ®ç¡¬ä»¶è¿›è¡Œè‡ªåŠ¨é…ç½®ï¼Œä½†æ˜¯è‡ªåŠ¨é…ç½®ç»„ä»¶å¹¶ä¸æ€»æ˜¯å®Œç¾çš„ã€‚è¿™ä¹Ÿæ˜¯ä¿ç•™ç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰é…ç½®çš„åŸå› ã€‚ç”¨æˆ·å¯ä»¥ä¿®æ”¹é…ç½®æ–‡ä»¶config.plistä¸­çš„é…ç½®å‚æ•°ï¼Œæˆ–è€…åŸºäºGUIçš„é…ç½®ç•Œé¢è¿›è¡Œä¿®æ”¹é…ç½®ã€‚é…ç½®æ–‡ä»¶æ˜¯åŸºäºXMLçš„ï¼Œå¯ä»¥ä»¥æ–‡æœ¬æ–‡ä»¶æ¥å¤„ç†ã€‚å®ƒå¯ä»¥ç”¨çº¯æ–‡æœ¬ç¼–è¾‘å™¨è¿›è¡Œç¼–è¾‘ï¼Œä¹Ÿå¯ä»¥ç”¨plistç¼–è¾‘å™¨è¿›è¡Œç¼–è¾‘ï¼Œå¦‚PlistEditã€‚é…ç½®æ–‡ä»¶ (config.plist) å¿…é¡»æ”¾åœ¨EFI/CLOVERç›®å½•ä¸‹ã€‚</p><p>è¿™é‡Œéµå¾ªä¸€ä¸ªåŸåˆ™ï¼Œå°½å¯èƒ½ç®€å•çš„è®¾ç½®<code>config</code>ï¼Œä¸çŸ¥é“å…·ä½“ä½œç”¨çš„å°±è®©ä»–ç©ºç€å¥½äº†ï¼Œå¦‚æœä½ ä¸çŸ¥é“å‚æ•°çš„éœ€æ±‚å€¼æ˜¯ä»€ä¹ˆï¼Œå°±ä»é…ç½®æ–‡ä»¶ä¸­æ’é™¤ï¼ä¸è¦ç”¨æ²¡æœ‰å€¼çš„å‚æ•°ã€‚</p><p>æ­£æ‰€è°“å‰äººç§æ ‘ï¼Œåäººä¹˜å‡‰ï¼Œå¾ˆå¤šé»‘æœçš„çƒ­å¿ƒæœ‹å‹å·²ç»ä¸ºæˆ‘ä»¬åšå¥½äº†æ•™ç¨‹ï¼Œè¿™é‡Œæˆ‘ç›´æ¥æ‹¿æ¥ç”¨äº†ã€‚</p><ul><li><p>ACPI-1<br><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/121626u0o5h11990kh1r33.png" alt=""></p></li><li><p>ACPI-2</p><p><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/121629ijh2l2jdalnhra2n.png" alt=""></p></li><li><p>BOOT<br><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/121658p0frjvu3sjz9z37r.png" alt=""></p></li><li><p>CPU<br><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/121728lnyrccjxneyetxvv.png" alt=""></p></li><li><p>Device<br><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/121744z1nnvyp70cbssk0y.png" alt=""></p></li><li><p>Disable Drivers<br><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/121801fyyuyzdzdxkc1wxc.png" alt=""></p></li><li><p>GUI<br><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/121819ba3c3r9mouvarrtm.png" alt=""></p></li><li><p>Graphics<br><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/121831o2lsqlapp37a6l2z.png" alt=""></p></li><li><p>Kernel and Kext Patches<br><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/121846xlpkzayr3jlct65t.png" alt=""></p></li><li><p>Rt Variables<br><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/121920n772424sgkim24p0.png" alt=""></p></li><li><p>SMBIOS<br><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/121933fj4gpa5jpjj1aacp.png" alt=""></p></li><li><p>System Parameters<br><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/121945e61wtermr920qyar.png" alt=""></p></li></ul><p>ä¸æ•¢ä¸‹æ‰‹çš„æ²¡å…³ç³»ï¼Œæˆ‘ç»™ä¸€ä¸ªæœ€ç®€å•çš„æ¨¡æ¿ï¼Œå…¨æŒ‰è¿™ä¸ªæ¥å°±è¶³å¯ä»¥è£…ä¸Šæœ€å¸¸è§çš„ã€‚<br><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/122340gw8bz7ku2ubjw7vz.png" alt=""></p><p><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/122356absls8lhbxbxbxee.png" alt=""></p><p><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/122406pv9aybc2a2jrizk9.jpg" alt=""></p><p><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/122419njauccpvj2uybb91.jpg" alt=""></p><p><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/122434wsbghgcdn6scghcd.jpg" alt=""></p><p><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/122446qq8c4ppsewgqhvmj.jpg" alt=""></p><p><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/122459v7oogbi4oapbn4di.jpg" alt=""></p><p><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/122509pqz23ch3sw39yorz.jpg" alt=""></p><p><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/122525z5v2224w32275wjz.jpg" alt=""></p><p><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/122537avefcll6efmm0ecl.jpg" alt=""></p><p><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/122549oxl774dd7uvt8kgg.jpg" alt=""></p><p>æ•¢ä¸‹æ‰‹äº†ï¼Œæ²¡æœ‰<code>Mac</code>ç¯å¢ƒï¼Ÿæ²¡å…³ç³»ï¼Œé€ä½ ä»¬åœ¨çº¿ç¼–è¾‘å™¨ï¼Œç‚¹è¿™é‡Œ<a href="http://cloudclovereditor.altervista.org/cce/index.php" target="_blank" rel="noopener">ä¼ é€é—¨</a>ã€‚é‡Œé¢ç›®å‰åŠ å…¥äº†ä¸€äº›å¸¸è§çš„é…ç½®ï¼Œå¸®ä½ å®Œæˆä¸€éƒ¨åˆ†å·¥ä½œã€‚</p><h4 id="äº†è§£drivers64UEFIå„ä¸ª-EFIæ–‡ä»¶çš„ä½œç”¨ï¼Œç²¾ç®€å¼•å¯¼"><a href="#äº†è§£drivers64UEFIå„ä¸ª-EFIæ–‡ä»¶çš„ä½œç”¨ï¼Œç²¾ç®€å¼•å¯¼" class="headerlink" title="äº†è§£drivers64UEFIå„ä¸ª.EFIæ–‡ä»¶çš„ä½œç”¨ï¼Œç²¾ç®€å¼•å¯¼"></a>äº†è§£<code>drivers64UEFI</code>å„ä¸ª<code>.EFI</code>æ–‡ä»¶çš„ä½œç”¨ï¼Œç²¾ç®€å¼•å¯¼</h4><p><code>BIOS</code>å¯åŠ¨è¿‡ç¨‹ä¸­è¦ç”¨åˆ°<code>drivers32</code>æˆ–<code>drivers64</code>ç›®å½•ï¼Œ<code>UEFI</code>å¯åŠ¨è¿‡ç¨‹ä¸­åˆ™ä½¿ç”¨<code>drivers64UEFI</code>ç›®å½•ã€‚å®ƒä»¬çš„å†…å®¹ä¼šæ ¹æ®é…ç½®å’Œ<code>BIOSç‰ˆæœ¬</code>è€Œæœ‰æ‰€ä¸åŒã€‚</p><p>å¿…é¡»è¦æçš„ä¸€ç‚¹æ˜¯è¿™äº›é©±åŠ¨ç¨‹åºåªåœ¨<code>bootloader</code>è¿è¡Œæ—¶æœ‰æ•ˆï¼Œä¸ä¼šå½±å“æœ€ç»ˆå¯åŠ¨çš„æ“ä½œç³»ç»Ÿã€‚</p><p>è‡³äºåˆ°åº•è¦ä½¿ç”¨å“ªäº›é©±åŠ¨ç¨‹åºç”±ç”¨æˆ·æ¥å†³å®šã€‚</p><ul><li>NTFS.efi</li></ul><p><code>NTFS</code>æ–‡ä»¶ç³»ç»Ÿé©±åŠ¨ç¨‹åºã€‚ç”¨äºå¯åŠ¨<code>Windows EFI</code>ç³»ç»Ÿã€‚</p><ul><li><p>HFSPlus.efi<br><code>HFS+</code>æ–‡ä»¶ç³»ç»Ÿé©±åŠ¨ç¨‹åºã€‚è¿™ä¸ªé©±åŠ¨å¯¹äº<code>10.13</code>ä¹‹å‰çš„ç³»ç»Ÿç‰ˆæœ¬æ¥å¯åŠ¨<code>Mac OS X</code>æ˜¯å¿…é¡»çš„ã€‚</p></li><li><p>APFS.efi<br><code>APFS</code>æ–‡ä»¶ç³»ç»Ÿé©±åŠ¨ç¨‹åºã€‚è¿™ä¸ªé©±åŠ¨å¯¹äºåœ¨<code>10.13</code>çš„ç³»ç»Ÿç‰ˆæœ¬é€šè¿‡<code>APFS</code>è£…çš„é»‘æœæ¥å¯åŠ¨<code>Mac OS X</code>æ˜¯å¿…é¡»çš„ã€‚</p></li><li><p>VBoxHFS.efi<br><code>HFSPlus.efi</code>çš„æ›¿ä»£å“ï¼Œæ€§èƒ½è¦å·®ä¸€ç‚¹ã€‚</p></li><li><p>VBoxExt2.efi<br><code>EXT2/3</code>æ–‡ä»¶ç³»ç»Ÿé©±åŠ¨ã€‚ç”¨äºå¯åŠ¨<code>Linux EFI</code>ç³»ç»Ÿã€‚</p></li><li><p>VBoxExt4.efi<br><code>EXT4</code>æ–‡ä»¶ç³»ç»Ÿé©±åŠ¨ã€‚ç”¨äºå¯åŠ¨<code>Linux EFI</code>ç³»ç»Ÿã€‚</p></li><li><p>FSInject.efi<br>æ§åˆ¶æ–‡ä»¶ç³»ç»Ÿæ³¨å…¥<code>kext</code>åˆ°ç³»ç»Ÿçš„å¯èƒ½æ€§ã€‚</p></li><li><p>PartitionDxe.efi<br>å·²ç»å­˜åœ¨äºåœ¨<code>CloverEFI</code>å’Œ<code>UEFI</code>ä¸­ï¼Œä½†æ²¡æœ‰ä¸º<code>Apple</code>åˆ†åŒºä¼˜åŒ–ï¼Œä¹Ÿæ²¡æœ‰ä¸º<code>GPT/MBR</code>ä¼˜åŒ–ã€‚</p></li><li><p>OsxFatBinaryDrv.efi<br>å…è®¸åŠ è½½<code>FAT</code>æ¨¡å—æ¯”å¦‚<code>boot.efi</code>ã€‚</p></li><li><p>OsxAptioFixDrv.efi<br>ä¿®å¤<code>AMI Aptio EFI</code>å†…å­˜æ˜ å°„ã€‚å¦‚æœæ²¡æœ‰å°±ä¸èƒ½å¯åŠ¨<code>OS X</code>ã€‚</p></li><li><p>OswLowMemFix.efi<br>æ˜¯<code>OsxAptioFixDrv</code>çš„ç®€åŒ–ç‰ˆã€‚ä¸¤ä¸ªä¸èƒ½åŒæ—¶ä½¿ç”¨ã€‚</p></li><li><p>DataHubDxe.efi<br>å·²ç»å­˜åœ¨äºåœ¨<code>CloverUEFI</code>ä¸­ã€‚å»ºè®®è¿˜æ˜¯ä½¿ç”¨å®ƒï¼Œä¸ä¼šäº§ç”Ÿå†²çªã€‚</p></li><li><p>CsmVideoDxe.efi<br>æ¯”<code>UEFI</code>é‡Œæä¾›æ›´å¤šåˆ†è¾¨ç‡çš„æ˜¾å¡é©±åŠ¨ã€‚</p></li></ul><p>çœ‹äº†è¿™ä¹ˆå¤šï¼Œåƒä¸‡ä¸è¦å´©æºƒï¼Œæˆ‘å‘Šè¯‰å¤§å®¶ä¸€ä¸ªç»éªŒï¼Œä¸€èˆ¬<code>Drivers64UEFI</code>ç›®å½•åªéœ€è¦ä¸‹é¢å‡ ä¸ª<code>.EFI</code>é©±åŠ¨å°±å¤Ÿäº†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypxgosqdqj31d00ug461.jpg" alt=""></p><h4 id="è¿›æ”»ACPIï¼Œå®Œç¾é»‘è‹¹æœ-è¿›é˜¶ç¯‡"><a href="#è¿›æ”»ACPIï¼Œå®Œç¾é»‘è‹¹æœ-è¿›é˜¶ç¯‡" class="headerlink" title="è¿›æ”»ACPIï¼Œå®Œç¾é»‘è‹¹æœ(è¿›é˜¶ç¯‡)"></a>è¿›æ”»<code>ACPI</code>ï¼Œå®Œç¾é»‘è‹¹æœ(è¿›é˜¶ç¯‡)</h4><p>è®ºå›è´¡çŒ®ä¼šå‘˜<a href="http://i.pcbeta.com/space-uid-3322572.html" target="_blank" rel="noopener">daxuexinsheng</a>å·²ç»ç¿»è¯‘äº†<code>RehabMan</code>çš„<code>DSDT</code>æ•™ç¨‹ï¼Œå¯ä»¥è¯´æ˜¯éå¸¸è¯¦ç»†ï¼Œå¯ä»¥ç›´æ¥å‚è€ƒ:<a href="http://i.pcbeta.com/space-uid-3322572.html" target="_blank" rel="noopener">ä½¿ç”¨è¡¥ä¸ä¿®æ”¹DSDT/SSDT</a>ï¼Œä»¥åŠ<a href="https://www.tonymacx86.com/threads/guide-patching-laptop-dsdt-ssdts.152573/" target="_blank" rel="noopener">RehabMançš„åŸè´´</a>ã€‚</p><p>å¦‚æœä½ å–œæ¬¢<code>hotpatch</code>ï¼Œå¯ä»¥å‚è€ƒæˆ‘çš„ç¿»è¯‘å¸–<a href="https://blog.iamzhl.top/Clover-ACPI-hotpatch.html" target="_blank" rel="noopener">Clover-ACPI-hotpatch</a>ï¼Œä¸è¿‡ç”±äºæˆ‘å¤ªæ‡’è¿˜æ²¡ç¿»è¯‘å®Œå“ˆå“ˆã€‚å½“ç„¶è¿˜æ˜¯æ¨è<a href="https://www.tonymacx86.com/threads/guide-using-clover-to-hotpatch-acpi.200137/" target="_blank" rel="noopener">RehabMançš„åŸè´´</a>ã€‚</p><h3 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h3><ul><li>é›†æˆ<code>CLOVER</code>çš„åŸç‰ˆé•œåƒ<blockquote><p>é“¾æ¥:<a href="https://pan.baidu.com/s/1gfTmRj9" target="_blank" rel="noopener">https://pan.baidu.com/s/1gfTmRj9</a>  å¯†ç :s3dv</p></blockquote></li><li><code>Transmac</code><blockquote><p>é“¾æ¥:<a href="https://pan.baidu.com/s/1oAn79Zc" target="_blank" rel="noopener">https://pan.baidu.com/s/1oAn79Zc</a>  å¯†ç :yafn</p></blockquote></li><li><code>easyUEFI</code><blockquote><p>é“¾æ¥:<a href="https://pan.baidu.com/s/1nwqbnMp" target="_blank" rel="noopener">https://pan.baidu.com/s/1nwqbnMp</a>  å¯†ç :gxoc</p></blockquote></li><li><code>Clover Configurator</code>å››å¶è‰åŠ©æ‰‹<blockquote><p>é“¾æ¥:<a href="https://pan.baidu.com/s/1ht2wFQW" target="_blank" rel="noopener">https://pan.baidu.com/s/1ht2wFQW</a>  å¯†ç :tbce</p></blockquote></li><li><code>DiskGenius</code><blockquote><p>é“¾æ¥:<a href="https://pan.baidu.com/s/1cVyULo" target="_blank" rel="noopener">https://pan.baidu.com/s/1cVyULo</a>  å¯†ç :pfrm</p></blockquote></li><li>é²å¤§å¸ˆ/<code>AIDA64</code>(æ¨è)/ä¹Ÿå¯ä»¥ç”¨è®¾å¤‡ç®¡ç†å™¨<blockquote><p>è‡ªè¡Œåº¦å¨˜</p></blockquote></li></ul><h3 id="å®‰è£…æ­¥éª¤"><a href="#å®‰è£…æ­¥éª¤" class="headerlink" title="å®‰è£…æ­¥éª¤"></a>å®‰è£…æ­¥éª¤</h3><h4 id="åˆ©ç”¨Transmacå°†åŸç‰ˆé•œåƒå†™å…¥uç›˜"><a href="#åˆ©ç”¨Transmacå°†åŸç‰ˆé•œåƒå†™å…¥uç›˜" class="headerlink" title="åˆ©ç”¨Transmacå°†åŸç‰ˆé•œåƒå†™å…¥uç›˜"></a>åˆ©ç”¨<code>Transmac</code>å°†åŸç‰ˆé•œåƒå†™å…¥uç›˜</h4><p>æ‰“å¼€<code>TransMac</code>,å³é”®é€‰æ‹©æ¬²åˆ¶ä½œçš„<code>USB</code>ç›˜ç¬¦ï¼Œé€‰æ‹©Restore with Disk Image,é€‰æ‹©ä¸‹è½½å¥½çš„dmgæ–‡ä»¶,ä¼šå¼¹å‡ºçª—å£,æç¤ºå°†è¦æ ¼å¼åŒ–USBç£ç›˜,ç‚¹å‡»OKæŒ‰é’®ç»§ç»­ï¼Œè€å¿ƒç­‰å¾…å†™ç›˜çš„å®Œæˆã€‚å†™å…¥å®Œæˆï¼Œè‹¥å¼¹å‡ºå¯¹è¯æ¡†æç¤ºå°†å…¶æ ¼å¼åŒ–ï¼Œç‚¹å‡»å–æ¶ˆã€‚</p><p><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/123110fb0rhybrbj5nndjt.png" alt=""></p><p><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/123127oztcc33jllj2l0li.png" alt=""></p><p><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/123137nl7xl0340ublz66b.png" alt=""></p><p><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/123147b69lwm99q5p6jd5q.png" alt=""></p><h4 id="åˆ©ç”¨é²å¤§å¸ˆç­‰è½¯ä»¶æŸ¥çœ‹è‡ªå·±æœºå™¨çš„é…ç½®ä¿¡æ¯ï¼Œæ¥å®šåˆ¶configå’Œéœ€è¦ç”¨çš„kext"><a href="#åˆ©ç”¨é²å¤§å¸ˆç­‰è½¯ä»¶æŸ¥çœ‹è‡ªå·±æœºå™¨çš„é…ç½®ä¿¡æ¯ï¼Œæ¥å®šåˆ¶configå’Œéœ€è¦ç”¨çš„kext" class="headerlink" title="åˆ©ç”¨é²å¤§å¸ˆç­‰è½¯ä»¶æŸ¥çœ‹è‡ªå·±æœºå™¨çš„é…ç½®ä¿¡æ¯ï¼Œæ¥å®šåˆ¶configå’Œéœ€è¦ç”¨çš„kext"></a>åˆ©ç”¨é²å¤§å¸ˆç­‰è½¯ä»¶æŸ¥çœ‹è‡ªå·±æœºå™¨çš„é…ç½®ä¿¡æ¯ï¼Œæ¥å®šåˆ¶<code>config</code>å’Œéœ€è¦ç”¨çš„<code>kext</code></h4><p>è¿™ä¸€æ­¥æƒ³å¿…ä¸ç”¨æˆ‘å¤šè¯´ï¼Œå¤§å®¶åˆ©ç”¨é²å¤§å¸ˆæˆ–è€…<code>AIDA64</code>çœ‹ä¸€ä¸‹è‡ªå·±é…ç½®å¥½äº†ã€‚æœ‰ä¸€ç‚¹æç¤ºï¼Œå°½é‡åœ¨å®‰è£…è¿‡ç¨‹ä¸­ä¸è€ƒè™‘å„ç§<code>kext</code>ï¼Œå°½é‡ç”¨å°‘çš„é©±åŠ¨å»å®‰è£…ï¼Œå®‰è£…å®Œæˆåå†å®Œå–„é©±åŠ¨ï¼Œè¿™æ ·å¯ä»¥å‡å°‘è®¸å¤šå®‰è£…ä¸­çš„é”™è¯¯ï¼Œä¹Ÿåˆ©äºæ’é”™ï¼Œä½†éœ€è¦æ³¨æ„çš„å¿…å¤‡çš„é©±åŠ¨ä¸€å®šè¦æ”¾ï¼Œä¾‹å¦‚<code>FakeSMC.kext</code>ã€è¿˜æœ‰å°±æ˜¯é”®ç›˜é©±åŠ¨ã€‚å½“ç„¶è€é¸Ÿæ— æ‰€è°“äº†ï¼Œç›´æ¥æŠŠéœ€è¦ç”¨åˆ°çš„éƒ½æ”¾ä¸Šå°±<code>OK</code>äº†ã€‚ä»¥æˆ‘è‡ªå·±æœºå™¨ä¸ºä¾‹ï¼Œé…ç½®å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-properties"><code class="language-properties"><span class="token attr-name">ä¸»æ¿</span> <span class="token attr-value">      Asus X455LD Intel Haswell-ULT - Lynx Point-LP</span><span class="token attr-name">ç‹¬ç«‹æ˜¾å¡</span> <span class="token attr-value">   Nvidia GeForce 820M 2G </span><span class="token attr-name">æ ¸å¿ƒæ˜¾å¡</span> <span class="token attr-value">   HD4400</span><span class="token attr-name">å£°å¡</span> <span class="token attr-value">       Realtek @ Intel Lynx Point-LP  High Definition Audio (CX20751)</span><span class="token attr-name">ä»¥å¤ªç½‘å¡</span> <span class="token attr-value">   Realtek RTL8168/8111/8112 Gigabit Ethernet Controller / Asus</span><span class="token attr-name">æ— çº¿ç½‘å¡</span> <span class="token attr-value">   Atheros AR956X</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æŒ‰ç…§ä¸Šé¢çš„é©±åŠ¨ç®€è¦è¯´æ˜ï¼Œæˆ‘ä»¥å¤ªç½‘å¡æ˜¯<code>RTL8111</code>ï¼Œé‚£ä¹ˆéœ€è¦<code>RTL8111.kext</code>ã€æ ¸å¿ƒæ˜¾å¡æ˜¯<code>HD4400</code>ï¼Œå°±éœ€è¦<code>FakePCIID.kext</code>ã€<code>FakePCIID_Intel_HD_Graphics.kext</code>ï¼Œå£°å¡æ¯”è¾ƒéº»çƒ¦ï¼Œæš‚æ—¶ä¸è€ƒè™‘ï¼Œæ— çº¿ç½‘å¡æ˜¯<code>Atheros AR956X</code>ï¼Œé‚£ä¹ˆæˆ‘éœ€è¦<code>ATH9KFixup.kext</code>ï¼Œåˆè¦ä¾èµ–<code>Lilu.kext</code>ï¼Œæ‰€ä»¥éœ€è¦<code>Lilu.kext</code>ï¼Œå››ä»£ä½å‹æœºå™¨ï¼Œæˆ‘éœ€è¦<code>IntelGraphicsFixup.kext</code>æ¥è§£å†³è…¾è®¯è§†é¢‘æ­»æœºçš„é—®é¢˜ï¼Œæ‰€ä»¥æ”¾ä¸Šè¿™ä¸ªã€‚æš‚æ—¶åªè€ƒè™‘è¿™äº›é©±åŠ¨å§ï¼Œä¸‹é¢å°±è¿›å…¥å®‰è£…é˜¶æ®µã€‚</p><h4 id="é‡å¯åˆ©ç”¨Uç›˜å¯åŠ¨é€‰æ‹©å®‰è£…ç›˜"><a href="#é‡å¯åˆ©ç”¨Uç›˜å¯åŠ¨é€‰æ‹©å®‰è£…ç›˜" class="headerlink" title="é‡å¯åˆ©ç”¨Uç›˜å¯åŠ¨é€‰æ‹©å®‰è£…ç›˜"></a>é‡å¯åˆ©ç”¨<code>U</code>ç›˜å¯åŠ¨é€‰æ‹©å®‰è£…ç›˜</h4><p>å¼€æœºæŒ‰<code>esc</code>é”®è¿›å…¥å¯åŠ¨é¡¹åˆ—è¡¨ï¼Œä¸åŒå‚å•†çƒ­é”®ä¸åŒï¼Œå‚è€ƒä¸‹å›¾ï¼š<br><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/123342i0kax4jeex4kxl1l.jpg" alt=""></p><p>é€‰æ‹©<code>U</code>ç›˜è¿›å…¥ï¼Œè¿™é‡Œå°±ä¸ä»‹ç»å¤ªå¤šäº†ï¼Œå¤§å®¶ç©é»‘æœçš„æƒ³å¿…å¯¹<code>BIOS</code>ä¸ä¼šé™Œç”Ÿï¼Œä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯éœ€è¦å°†<code>BIOS</code>ä¸­çš„å®‰å…¨å¯åŠ¨å…³æ‰ã€‚</p><p>æ¥ä¸‹æ¥å°±ä¼šè¿›å…¥<code>CLOVER</code>å¼•å¯¼ç•Œé¢<br><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/123436r9uzbziauaazi77d.png" alt=""></p><p>é€šè¿‡é”®ç›˜æ–¹å‘é”®é€‰ä¸­<code>Boot OS X Install from ***</code>ï¼Œ<code>***</code>ä»£è¡¨ä½ çš„é•œåƒåå­—ï¼Œç„¶åå›è½¦ã€‚<br><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/123450nxolxguuoyojuxh8.png" alt=""></p><p>ç­‰å¾…è¿›å…¥å®‰è£…ç•Œé¢ã€‚<br><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/123541p0mrznyycz33j0q7.png" alt=""></p><p>è¿™é‡Œé€‰æ‹©è‡ªå·±æ“…é•¿çš„è¯­è¨€å¥½å•¦ã€‚</p><h4 id="ç£ç›˜å·¥å…·åˆ†åŒº"><a href="#ç£ç›˜å·¥å…·åˆ†åŒº" class="headerlink" title="ç£ç›˜å·¥å…·åˆ†åŒº"></a>ç£ç›˜å·¥å…·åˆ†åŒº</h4><p>é€‰æ‹©ç£ç›˜å·¥å…·ï¼Œå¹¶ç»§ç»­<br><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/123624he2v5r5joo5jfyvy.png" alt=""></p><p>é€‰æ‹©<code>æ˜¾ç¤ºæ‰€æœ‰è®¾å¤‡</code><br><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/123636dl8z3jh7px38h3i2.png" alt=""></p><p>é€‰æ‹©SSD Media,ç‚¹å‡»æŠ¹æ‰æŒ‰é’®,é€‰æ‹©é»˜è®¤çš„<code>Mac OS</code>æ‰©å±•(æ—¥å¿—å‹)ï¼Œåœ¨<code>10.13</code>ä¸­å¦‚æœè£…åœ¨<code>SSD</code>ä¸Šï¼Œä¹Ÿå¯ä»¥é€‰æ‹©<code>APFS</code>,å°†åç§°ä¿®æ”¹ä¸º<code>Macintosh HD</code>ï¼ˆåå­—éšæ„å•¦ï¼Œè‡ªå·±å–œæ¬¢å°±å¥½ï¼Œä½†è¦æ˜¯è‹±æ–‡ï¼‰,ç‚¹å‡»æŠ¹æ‰æŒ‰é’®ï¼ŒæŠ¹æ‰å®Œæˆåï¼Œç‚¹å‡»å®ŒæˆæŒ‰é’®ã€‚<br><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/123750eo7bfz0bp2gfqq72.png" alt=""></p><p>ç„¶åé€€å‡ºç£ç›˜å·¥å…·ï¼Œåˆ°è¿™é‡Œï¼Œç£ç›˜å·¥å…·çš„åŠ¨ä½œå°±å·²ç»ç»“æŸäº†ã€‚</p><h4 id="é€€å‡ºç£ç›˜å·¥å…·ï¼Œé€‰æ‹©å®‰è£…macosé€‰ä¸­åˆšæ‰æŠ¹æ‰çš„åˆ†åŒºå¼€å§‹å®‰è£…"><a href="#é€€å‡ºç£ç›˜å·¥å…·ï¼Œé€‰æ‹©å®‰è£…macosé€‰ä¸­åˆšæ‰æŠ¹æ‰çš„åˆ†åŒºå¼€å§‹å®‰è£…" class="headerlink" title="é€€å‡ºç£ç›˜å·¥å…·ï¼Œé€‰æ‹©å®‰è£…macosé€‰ä¸­åˆšæ‰æŠ¹æ‰çš„åˆ†åŒºå¼€å§‹å®‰è£…"></a>é€€å‡ºç£ç›˜å·¥å…·ï¼Œé€‰æ‹©å®‰è£…<code>macos</code>é€‰ä¸­åˆšæ‰æŠ¹æ‰çš„åˆ†åŒºå¼€å§‹å®‰è£…</h4><p>é€‰æ‹©å®‰è£…<code>macOS</code>ï¼Œå¹¶ç»§ç»­<br><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/123826uoc40cd7vzodvx5k.png" alt=""></p><p>æ¥ä¸‹æ¥æŒ‰ç…§æç¤ºä¸€æ­¥ä¸€æ­¥æ¥å°±å¥½äº†ï¼Œæœ‰ä¸€æ­¥éœ€è¦æ³¨æ„çš„å°±æ˜¯é€‰æ‹©å®‰è£…åˆ†åŒºæ—¶ï¼Œé€‰æ‹©è‡ªå·±ä¹‹å‰æŠ¹æ‰çš„é‚£ä¸ªåˆ†åŒºã€‚<br><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/123849xx77k7nn5xr373s6.png" alt=""></p><p>æ¥ä¸‹æ¥é™é™ç­‰å¾…ï¼Œä¼šæœ‰ä¸€æ¬¡è‡ªåŠ¨é‡å¯ï¼Œä¾ç„¶ç”¨<code>U</code>ç›˜å¯åŠ¨ï¼Œæ³¨æ„è¿™æ¬¡ä¼šåœ¨å¼•å¯¼ç•Œé¢å¤šå‡ºä¸€ä¸ªå›¾æ ‡ï¼Œé€‰æ‹©é™¤ç¬¬ä¸€æ¬¡é€‰çš„å›¾æ ‡å¤–çš„å¦ä¸€ä¸ªå›¾æ ‡ã€‚ç„¶åç»§ç»­ç­‰å¾…<br><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/123922tprp9szr9yv9vsgm.png" alt=""></p><p>ç³»ç»Ÿå®‰è£…å®Œæˆå,é‡å¯è¿›å…¥ç³»ç»Ÿè®¾ç½®å‘å¯¼ï¼Œæ¥ä¸‹æ¥æ ¹æ®ä¸‹é¢çš„å›¾ä¸€æ­¥ä¸€æ­¥è®¾ç½®å°±å¥½äº†<br><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/124016wh77dawhgh4e7dz7.png" alt=""></p><p><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/124102txilt1lltrrr7sll.png" alt=""></p><p><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/124134f93ibz7lqgi2qm79.png" alt=""></p><p>è¿™é‡Œé€‰æ‹©ç°åœ¨ä¸ä¼ è¾“ä»»ä½•ä¿¡æ¯<br><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/124209s8fjumefqmf77leu.png" alt=""></p><p><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/124311dfzzq5282vvf8q7q.png" alt=""></p><p><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/124345dxbdfiiti3ip3jtb.png" alt=""></p><p><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/124355klcgmlp7f97f4cuz.png" alt=""></p><p><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/124417aiqch1qpt28ccc1x.png" alt=""></p><p><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/124442lamc6vwc66vvvivc.png" alt=""></p><p>è¿™é‡Œæ³¨æ„ï¼Œä¸€å®šä¸è¦é€‰æ‹©åŠ å¯†ï¼ï¼ï¼<br><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/124453pjo4ulfrvju45d5j.png" alt=""></p><p><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/124530rarc5swiqq2r21ip.png" alt=""></p><p><img src="http://bbs.pcbeta.com/data/attachment/forum/201803/26/124541y2dcnv2d4nzfnilf.png" alt=""></p><h3 id="è½¬ç§»CLOVERåˆ°ç¡¬ç›˜ESPï¼Œæ‘†è„±Uç›˜å¼•å¯¼"><a href="#è½¬ç§»CLOVERåˆ°ç¡¬ç›˜ESPï¼Œæ‘†è„±Uç›˜å¼•å¯¼" class="headerlink" title="è½¬ç§»CLOVERåˆ°ç¡¬ç›˜ESPï¼Œæ‘†è„±Uç›˜å¼•å¯¼"></a>è½¬ç§»<code>CLOVER</code>åˆ°ç¡¬ç›˜<code>ESP</code>ï¼Œæ‘†è„±<code>U</code>ç›˜å¼•å¯¼</h3><p>è¿™é‡Œç”¨åˆ°å‰æœŸå‡†å¤‡çš„<code>EasyUEFI</code>ï¼Œåœ¨<code>Windows</code>ä¸‹å®‰è£…æ‰“å¼€æ­¤è½¯ä»¶ï¼Œæ·»åŠ <code>CLOVER</code>å¯åŠ¨é¡¹ï¼Œå¹¶ç½®é¡¶ã€‚å…·ä½“æ“ä½œå‚è€ƒï¼š<a href="http://bbs.pcbeta.com/viewthread-1683571-1-1.html" target="_blank" rel="noopener">é»‘è‹¹æœå®‰è£…ä»0å¼€å§‹â€”-cloverä¼˜ç›˜å¼•å¯¼æ”¹ç¡¬ç›˜å¼•å¯¼ç¯‡</a></p><h3 id="åæœŸçš„é©±åŠ¨å®‰è£…ä»¥åŠä¼˜åŒ–"><a href="#åæœŸçš„é©±åŠ¨å®‰è£…ä»¥åŠä¼˜åŒ–" class="headerlink" title="åæœŸçš„é©±åŠ¨å®‰è£…ä»¥åŠä¼˜åŒ–"></a>åæœŸçš„é©±åŠ¨å®‰è£…ä»¥åŠä¼˜åŒ–</h3><h4 id="å±è”½æ— ç”¨çš„ç‹¬æ˜¾é™ä½æ¸©åº¦"><a href="#å±è”½æ— ç”¨çš„ç‹¬æ˜¾é™ä½æ¸©åº¦" class="headerlink" title="å±è”½æ— ç”¨çš„ç‹¬æ˜¾é™ä½æ¸©åº¦"></a>å±è”½æ— ç”¨çš„ç‹¬æ˜¾é™ä½æ¸©åº¦</h4><p>å‚è€ƒæˆ‘ä¹‹å‰çš„å¸–å­ï¼š<a href="https://blog.iamzhl.top/Disable-the-discrete-GPU-in-laptop.html" target="_blank" rel="noopener">Disable the discrete GPU in laptop</a></p><h4 id="æ‘†è„±ä¸‡èƒ½å£°å¡ï¼Œåˆ©ç”¨AppleALCåŠ è½½åŸç”Ÿå£°å¡"><a href="#æ‘†è„±ä¸‡èƒ½å£°å¡ï¼Œåˆ©ç”¨AppleALCåŠ è½½åŸç”Ÿå£°å¡" class="headerlink" title="æ‘†è„±ä¸‡èƒ½å£°å¡ï¼Œåˆ©ç”¨AppleALCåŠ è½½åŸç”Ÿå£°å¡"></a>æ‘†è„±ä¸‡èƒ½å£°å¡ï¼Œåˆ©ç”¨<code>AppleALC</code>åŠ è½½åŸç”Ÿå£°å¡</h4><p>å‚è€ƒæˆ‘ä¹‹å‰çš„å¸–å­ï¼š<a href="https://blog.iamzhl.top/Driver-audio-for-hackintosh.html" target="_blank" rel="noopener">Driver-audio-for-hackintosh</a><br>è¿˜æœ‰è¿™ä¸ªå¸–å­ï¼š<a href="http://bbs.pcbeta.com/forum.php?mod=viewthread&amp;tid=1763452&amp;highlight=AppleALC" target="_blank" rel="noopener">è‡ªå·±åŠ¨æ‰‹ç”¨ä¸ŠAppleALCï¼Œä½¿ç”¨åŸç”ŸAppleHDA</a></p><h4 id="é€šè¿‡å¯¹DSDTæ‰“è¡¥ä¸å®Œå–„ç”µæ± æ˜¾ç¤º"><a href="#é€šè¿‡å¯¹DSDTæ‰“è¡¥ä¸å®Œå–„ç”µæ± æ˜¾ç¤º" class="headerlink" title="é€šè¿‡å¯¹DSDTæ‰“è¡¥ä¸å®Œå–„ç”µæ± æ˜¾ç¤º"></a>é€šè¿‡å¯¹<code>DSDT</code>æ‰“è¡¥ä¸å®Œå–„ç”µæ± æ˜¾ç¤º</h4><p>å‚è€ƒ<code>pcbeta</code><a href="http://bbs.pcbeta.com/viewthread-1595139-1-1.html" target="_blank" rel="noopener">daxuexinshengçš„å¸–å­</a><br><code>tonymacx86</code><a href="https://www.tonymacx86.com/threads/guide-how-to-patch-dsdt-for-working-battery-status.116102/" target="_blank" rel="noopener">RehabMançš„å¸–å­</a></p><h4 id="åŠ è½½x86å®ç°å˜é¢‘å’ŒåŸç”Ÿç”µæºç®¡ç†ï¼Œå®Œå–„èŠ‚èƒ½å™¨ä¿¡æ¯"><a href="#åŠ è½½x86å®ç°å˜é¢‘å’ŒåŸç”Ÿç”µæºç®¡ç†ï¼Œå®Œå–„èŠ‚èƒ½å™¨ä¿¡æ¯" class="headerlink" title="åŠ è½½x86å®ç°å˜é¢‘å’ŒåŸç”Ÿç”µæºç®¡ç†ï¼Œå®Œå–„èŠ‚èƒ½å™¨ä¿¡æ¯"></a>åŠ è½½<code>x86</code>å®ç°å˜é¢‘å’ŒåŸç”Ÿç”µæºç®¡ç†ï¼Œå®Œå–„èŠ‚èƒ½å™¨ä¿¡æ¯</h4><ul><li>å¯¹äº<code>Haswell</code>ä»¥åŠ<code>Broadwell</code>å¹³å°ï¼Œåˆ©ç”¨<code>ssdtPRGen</code>ç”Ÿæˆ<code>SSDT</code>ï¼Œåœ¨<code>config</code>ä¸­<code>drop</code>æ‰<code>CpuPm</code>å’Œ<code>Cpu0Ist</code>ä¸¤ä¸ªè¡¨ï¼Œå¹¶åˆ©ç”¨<code>FakeSMC</code>æˆ–<code>DSDT</code>æˆ–<code>hotpatch</code>åŠ è½½<code>AppleLPC</code></li><li>å¯¹äº<code>Skylake</code>åŠä»¥ä¸Šå¹³å°ï¼Œé€‰æ‹©æ”¯æŒ<code>HWP</code>çš„åˆé€‚çš„æœºå‹ï¼Œå¹¶å‹¾é€‰<code>HWPEnable</code>ã€‚</li></ul><h4 id="æ³¨å…¥HiDPIå’Œæ˜¾ç¤ºå™¨ä¿¡æ¯å®Œå–„å”¤é†’åçš„èŠ±å±ã€é—ªå±ã€æ’•è£‚å±é—®é¢˜"><a href="#æ³¨å…¥HiDPIå’Œæ˜¾ç¤ºå™¨ä¿¡æ¯å®Œå–„å”¤é†’åçš„èŠ±å±ã€é—ªå±ã€æ’•è£‚å±é—®é¢˜" class="headerlink" title="æ³¨å…¥HiDPIå’Œæ˜¾ç¤ºå™¨ä¿¡æ¯å®Œå–„å”¤é†’åçš„èŠ±å±ã€é—ªå±ã€æ’•è£‚å±é—®é¢˜"></a>æ³¨å…¥<code>HiDPI</code>å’Œæ˜¾ç¤ºå™¨ä¿¡æ¯å®Œå–„å”¤é†’åçš„èŠ±å±ã€é—ªå±ã€æ’•è£‚å±é—®é¢˜</h4><p>å‚è€ƒï¼š<a href="http://bbs.pcbeta.com/forum.php?mod=viewthread&amp;tid=1722308&amp;highlight=HIDPI" target="_blank" rel="noopener">macOS Sierra 10.12ä¸‹ å¼€å¯HiDPI å‚»ç“œå¼å¼€å¯æ•™ç¨‹</a></p><h3 id="å†™åœ¨æœ€å"><a href="#å†™åœ¨æœ€å" class="headerlink" title="å†™åœ¨æœ€å"></a>å†™åœ¨æœ€å</h3><p>æœ¬å¸–å¤šå¤„å¼•ç”¨ç°æˆå¸–å­ï¼Œåªæ˜¯å°†æ•´ä¸ªæµç¨‹åšä¸ªé™ˆè¿°ï¼Œæ„åœ¨æ•´ç†æ€è·¯ï¼Œä»¥ä¾¿å¤§å®¶æ›´å¥½åœ°ç†è§£å®è·µã€‚æœ¬äººæ°´å¹³æœ‰é™ï¼Œå¸–å­ä¸­çš„ä¸æ­£ç¡®ä¹‹å¤„å¸Œæœ›å¤§å®¶ç§¯ææ‰¹è¯„æŒ‡å‡ºï¼Œä¸€èµ·å®Œå–„ã€‚</p><p>æ¥¼ä¸»çœŸçš„æ˜¯æ‡’åˆ°èœ•çš®(æ‰‹åŠ¨æ»‘ç¨½å“ˆå“ˆ)å¸–å­ä¸­å›¾ç‰‡å¾ˆå¤šæ˜¯å‡ºè‡ªé»‘æœå°å…µçš„åšå®¢ï¼š<a href="https://blog.daliansky.net/MacOS-installation-tutorial-XiaoMi-Pro-installation-process-records.html" target="_blank" rel="noopener">macOSå®‰è£…æ•™ç¨‹å…¼å°ç±³Proå®‰è£…è¿‡ç¨‹è®°å½•</a>ã€‚</p><p>æ„Ÿè°¢å„ä½é»‘æœå‰è¾ˆçš„å¥½å¸–å­ï¼Œå¼•ç”¨å¤ªå¤šï¼Œæ–‡ä¸­ä¹Ÿæœ‰è¯´æ˜ï¼Œå°±ä¸ä¸€ä¸€åˆ—å‡ºäº†ã€‚</p><p>å¾…ç»­â€¦â€¦</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Hackintosh </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hacintosh </tag>
            
            <tag> é»‘è‹¹æœ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ©ç”¨ AppleALC é©±åŠ¨å£°å¡</title>
      <link href="/posts/b2394bf1/"/>
      <url>/posts/b2394bf1/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote><p>åœ¨<code>vit9696</code>æ¨å‡º<code>AppleALC</code>åï¼Œç»è¿‡è¶Šæ¥è¶Šå¤šäººä»¿å†’å£°å¡å¾—åˆ°çš„æ•°æ®çš„æäº¤æ•´ç†ï¼Œ<code>AppleALC</code>çš„æ•°æ®è¶Šæ¥è¶Šé›†ä¸­ï¼Œä¹Ÿä½¿å£°å¡é©±åŠ¨å˜å¾—è¶Šæ¥è¶Šç®€å•ã€‚</p><p>æœ¬æ–‡æä¾›ä½¿ç”¨<code>AppleALC</code>é©±åŠ¨å£°å¡çš„æ€è·¯ä»¥åŠå¸¸è§é”™è¯¯å’Œé©±åŠ¨åçš„é—®é¢˜è¿›è¡Œä¿®å¤ã€‚</p></blockquote><h2 id="å‰æœŸå‡†å¤‡"><a href="#å‰æœŸå‡†å¤‡" class="headerlink" title="å‰æœŸå‡†å¤‡"></a>å‰æœŸå‡†å¤‡</h2><ul><li><p>éœ€è¦ä¸‹è½½<code>Xcode</code></p><blockquote><p>åœ¨<code>AppleStore</code>ä¸‹è½½</p></blockquote></li><li><p>ä¸‹è½½<code>AppleALC</code></p><blockquote><p>é€šè¿‡ç»ˆç«¯æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œä¼šä¸‹è½½åˆ°ä½ çš„ç”¨æˆ·æ ¹ç›®å½•</p></blockquote></li></ul><pre><code>$ git clone https://github.com/vit9696/AppleALC</code></pre><ul><li>ä¸‹è½½<code>Lilu</code><blockquote><p>åœ¨ä¸‹é¢çš„ç½‘å€ä¸‹è½½<code>DEBUG</code>å’Œ<code>RELEASE</code></p></blockquote></li></ul><pre><code>https://github.com/vit9696/Lilu/releases</code></pre><ul><li>æå–<code>Codec</code><blockquote><p>è¿™ä¸€æ­¥éœ€è¦ç”¨åˆ°<code>Linux</code>ç¯å¢ƒï¼Œé¦–å…ˆä¸‹è½½<code>Ubuntu</code>é•œåƒï¼Œæˆ‘ä¸ªäººæä¾›ä¸€ä¸ª</p></blockquote></li></ul><pre><code>é“¾æ¥:http://pan.baidu.com/s/1i47I0jN  å¯†ç :de4v</code></pre><blockquote><p>å½“ç„¶ä¹Ÿå¯ä»¥å»å®˜ç½‘ä¸‹è½½ï¼Œä¸‹è½½å¥½é•œåƒä¹‹åï¼Œå°†<code>U</code>ç›˜æ ¼å¼åŒ–ä¸º<code>Fat32</code>ï¼Œç„¶åå°†é•œåƒè§£å‹åˆ°<code>U</code>ç›˜ï¼Œé‡å¯ä»¥<code>U</code>ç›˜å¯åŠ¨ï¼Œé€‰æ‹©è¯•ç”¨è¿›å…¥<code>Ubuntu</code>ç³»ç»Ÿç•Œé¢ï¼Œæ‰“å¼€ç»ˆç«¯è¾“å…¥</p></blockquote><pre><code>$ cat /proc/asound/card0/codec#0 &gt; ~/Desktop/Codec.txt</code></pre><blockquote><p>æ‰§è¡Œå®Œåä¼šå°†<code>Codec.txt</code>æå–åˆ°æ¡Œé¢ï¼Œå°†å…¶ä¿å­˜åˆ°<code>U</code>ç›˜</p></blockquote><p><strong>PS: ä¸€èˆ¬æ¥è¯´æå–çš„<code>Codec</code>ä¼šæœ‰<code>10k</code>å·¦å³å¤§å°ï¼Œå¦‚æœå¤§å°ä¸å¤Ÿï¼Œå¾ˆæœ‰å¯èƒ½æå–é”™è¯¯ï¼Œå¯ä»¥å°è¯•ä»¥ä¸‹å‘½ä»¤</strong></p><pre><code>$ cat /proc/asound/card0/codec#1 &gt; ~/Desktop/Codec.txt</code></pre><blockquote><p>æˆ–è€…</p></blockquote><pre><code>$ cat /proc/asound/card0/codec#2 &gt; ~/Desktop/Codec.txt</code></pre><blockquote><p>æˆ–è€…</p></blockquote><pre><code>$ cat /proc/asound/card1/codec#0 &gt; ~/Desktop/Codec.txt</code></pre><h2 id="Codec-txtçš„æ•°æ®æ•´ç†"><a href="#Codec-txtçš„æ•°æ®æ•´ç†" class="headerlink" title="Codec.txtçš„æ•°æ®æ•´ç†"></a><code>Codec.txt</code>çš„æ•°æ®æ•´ç†</h2><ul><li>è®°å½•<code>Address</code>å’Œ<code>Vendor Id</code>å€¼</li></ul><blockquote><p><code>Codec.txt</code>å¼€å¤´éƒ¨åˆ†</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fy0rlxkhmkj31qc1f6awh.jpg" alt=""></p><ul><li>æå–èŠ‚ç‚¹ä¿¡æ¯</li></ul><blockquote><p>æœç´¢<code>Pin Default</code>è®°å½•<code>Node</code>å’ŒèŠ‚ç‚¹æè¿°ï¼Œä»¥æˆ‘çš„ä¸ºä¾‹</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fy0rp1h1zqj31qc1f6tu9.jpg" alt=""></p><p><strong>PS: N/AèŠ‚ç‚¹æ— æ•ˆæ— éœ€æ•´ç†</strong></p><ul><li>è®°å½•<code>HP Out at Ext Left</code>èŠ‚ç‚¹çš„<code>tag</code>å’Œ<code>enable</code>å€¼</li></ul><blockquote><p>PS: Unsolicited Responseçš„è®¾å®šæ˜¯ä¸ºäº†è§£å†³è€³æœºå’Œå¤–æ”¾åˆ‡æ¢çš„é—®é¢˜ã€‚<br>éœ€è®¾å®š HP Out at Ext æ‰€åœ¨çš„èŠ‚ç‚¹ï¼Œå¹¶ä¸”èŠ‚ç‚¹ä¿¡æ¯ä¸­æœ‰Unsolicited: tag=xx, enabled=1 è¿™ä¸€è¡Œã€‚<br>è®¾å®šå‘½ä»¤ä¸ºAddress+NodeID+708+&lt;è®¾å®šå€¼&gt;</p><p>è®¾å®šå€¼æ˜¯8ä½çš„ä¸€ä¸ªäºŒè¿›åˆ¶æ•°ï¼Œè®°ä½œa7 a6 a5 a4 a3 a2 a1 a0ï¼Œæ¨ç®—å‡ºæ­¤äºŒè¿›åˆ¶æ•°ä¹‹åï¼Œå››å››æ‹†åˆ†è½¬æ¢ä¸º2ä½çš„åè¿›åˆ¶æ•°åŠ 1å³ä¸ºæ­¤è®¾å®šå€¼</p><p>a7è¡¨ç¤ºenabledã€‚<br>a6=0ï¼Œæ²¡å…·ä½“åº”ç”¨ï¼Œä¸ç”¨ç®¡ã€‚<br>a5~a0ï¼Œå­˜æ”¾tagã€‚**</p></blockquote><ul><li>è®°å½•<code>Mic at Ext</code>èŠ‚ç‚¹çš„<code>Pin-ctls</code>å€¼</li></ul><blockquote><p>PS: Pin Control Widgetçš„è®¾å®šæ˜¯ä¸ºäº†è§£å†³è€³æœºæ‚éŸ³çš„ã€‚</p><p>éœ€è¦è®¾å®šçš„æ˜¯ Mic at Ext  æ‰€åœ¨çš„èŠ‚ç‚¹ï¼Œè®¾å®šçš„å€¼å¯ä»¥ä»codec dumpä¸­è¯»å–ã€‚</p><p>è®¾å®šå‘½ä»¤æ˜¯ Address+NodeID+707+Pin-ctlså€¼ã€‚</p></blockquote><blockquote><p>æ•´ç†å®Œåï¼Œä¼šå¾—åˆ°å¦‚ä¸‹æ‰€ç¤ºçš„æ•°æ®é›†åˆ</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fy0ruzqsv0j31qc1f6h0k.jpg" alt=""></p><p><strong>PS: å¸¸è§çš„èŠ‚ç‚¹è®¾å¤‡æè¿°å¦‚ä¸‹ï¼š</strong></p><blockquote><p><code>Mic at Ext</code>â€“çº¿è·¯è¾“å…¥(è€³éº¦)</p><p><code>Mic at In</code>â€“å†…å»ºè¾“å…¥</p><p><code>HP Out</code>â€“è€³æœºæ‰¬å£°å™¨</p><p><code>Speaker</code>â€“å†…å»ºæ‰¬å£°å™¨(å¤–æ”¾)</p></blockquote><p align="center"><b>è‡³æ­¤ï¼ŒCodec æ•°æ®çš„æ•´ç†åˆ°æ­¤ç»“æŸ</b></p><h2 id="AppleALCä¸­æ•°æ®çš„ç­›é€‰"><a href="#AppleALCä¸­æ•°æ®çš„ç­›é€‰" class="headerlink" title="AppleALCä¸­æ•°æ®çš„ç­›é€‰"></a><code>AppleALC</code>ä¸­æ•°æ®çš„ç­›é€‰</h2><blockquote><p>ä¾æ¬¡æ‰“å¼€ä¸‹è½½çš„<code>AppleALC</code>æºç é‡Œé¢<code>/AppleALC/Resources/PinConfigs.kext/Contents</code>ä¸‹çš„<code>Info.plist</code></p><p>æœç´¢ä¹‹å‰è®°å½•çš„<code>CodecID</code></p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fy0rr0c3j7j31i21fc1bi.jpg" alt=""></p><blockquote><p>è®°å½•æœç´¢åˆ°çš„æ‰€æœ‰çš„<code>ID</code>ä¸­çš„<code>configdata</code>ï¼Œå¦‚ä¸‹æ•´ç†</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fy0rtddnoij31qc1f6tn4.jpg" alt=""></p><blockquote><p>æ¯ä¸€è¡Œçš„æ¯ä¸€ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä»£è¡¨<code>Address</code>å€¼</p></blockquote><blockquote><p>æ¯ä¸€è¡Œçš„ç¬¬ä¸‰ä¸²å€’æ•°ç¬¬äºŒä¸ªå­—ç¬¦ä»£è¡¨è¿™ä¸ªèŠ‚ç‚¹çš„è®¾å¤‡æè¿°ï¼Œå…·ä½“å¯¹åº”å…³ç³»å¦‚ä¸‹</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fy0rsd7nz6j30u00zagt5.jpg" alt=""></p><blockquote><p>æ ¹æ®ä¸Šå›¾è®¾å¤‡å¯¹åº”å…³ç³»å’Œ<code>Address</code>å€¼æ’é™¤æ‰æ— æ•ˆçš„<code>ID</code>æ•°æ®</p></blockquote><h2 id="å¼€å·¥"><a href="#å¼€å·¥" class="headerlink" title="å¼€å·¥"></a>å¼€å·¥</h2><ul><li>å°†ä¸‹è½½çš„<code>Debug</code>çš„<code>Lilu.kext</code>æ”¾è¿› AppleALC æºç æ ¹ç›®å½•ï¼›</li><li>åˆ é™¤<code>/AppleALC/Resources</code>ä¸­å¤šä½™æ–‡ä»¶å¤¹ï¼Œåªç•™ä¸‹ä½ çš„å£°å¡å‹å·æ–‡ä»¶å¤¹ã€<code>Pinconfigs.kext</code>ä»¥åŠå››ä¸ª<code>plist</code>æ–‡ä»¶ï¼Œä»¥<code>cx20751</code>è¿™ä¸ªå£°å¡ä¸ºä¾‹å‰©ä¸‹å¦‚ä¸‹æ–‡ä»¶</li></ul><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fy0rwbp9r0j31js11i12t.jpg" alt=""></p><ul><li>ç„¶åæ‰“å¼€è®¡ç®—å™¨ï¼Œæ˜¾ç¤ºä¸ºç¼–ç¨‹å™¨</li></ul><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fy0rwzv78dj30sc0wmdm0.jpg" alt=""></p><ul><li>æ‰“å¼€ä½ æ•´ç†çš„<code>Codec</code>ï¼Œæ‰¾åˆ°<code>Vendor Id</code>ï¼Œæ‹·è´åé¢çš„å­—ç¬¦ä¸²ï¼Œåœ¨è®¡ç®—å™¨é€‰ä¸­åå…­è¿›åˆ¶ï¼Œç²˜è´´è¿™ä¸ªå­—ç¬¦ä¸²</li></ul><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fy0rxl8nrzj30sc0wmgqq.jpg" alt=""></p><ul><li>ç„¶åé€‰ä¸­åè¿›åˆ¶ï¼Œå°±æ¢è½¬æ¢æˆåè¿›åˆ¶å½¢å¼</li></ul><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fy0rxs4ee3j30sc0wmdl1.jpg" alt=""></p><ul><li>æ‹·è´è¿™ä¸ªåè¿›åˆ¶æ•°ï¼Œæ‰“å¼€<code>/AppleALC/Resources/CX20751_2/Info.plist</code>(æ­¤å¤„çš„<code>CX20751_2</code>éœ€è¦æ¢æˆä½ çš„å£°å¡å‹å·)ï¼ŒæŠŠ<code>codecid</code>æ¢æˆåˆšæ‰æ‹·è´çš„åè¿›åˆ¶æ•°</li></ul><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fy0rzb85g2j31i21fcam3.jpg" alt=""></p><ul><li><p>ä¿å­˜é€€å‡ºï¼Œå³é”®<code>PinConfigs.kext</code>æ˜¾ç¤ºåŒ…å†…å®¹ï¼Œæ‰“å¼€é‡Œé¢çš„<code>Info.plist</code>ï¼Œæœç´¢åˆšæ‰æ‹·è´çš„åè¿›åˆ¶æ•°ï¼Œè®°ä¸‹<code>LayoutID</code>æ•°æ®ï¼Œæœ‰å‡ ä¸ªè®°å‡ ä¸ªï¼Œéƒ½è®°ä¸‹æ¥ï¼Œç„¶åå°†<code>IOKitPersonalities-&gt;HDA Hardware Config Resource-&gt;HDAConfigDefault</code>ä¸­çš„å…¶ä»–å‹å·åˆ é™¤ï¼Œ(ä¸ºé¿å…å‡ºé”™ï¼Œè¿™é‡Œçš„åˆ é™¤å¯ä»¥ä¸æ“ä½œï¼Œåˆ é™¤åªæ˜¯ä¸ºäº†ç²¾ç®€åšå‡ºæ¥çš„<code>AppleALC</code>)ï¼Œä¿å­˜é€€å‡ºã€‚</p></li><li><p>ç„¶ååŒå‡»æ‰“å¼€ AppleALC ä¸­çš„å·¥ç¨‹æ–‡ä»¶ï¼š</p></li></ul><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fy0s19qdobj32cg1fau0r.jpg" alt=""></p><ul><li>æŒ‰å›¾ç¤ºæ“ä½œ</li></ul><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fy0s1lqb2zj32gy1fa1kx.jpg" alt=""></p><ul><li>ç‚¹å‡»å³é¢çš„<code>Distribute Content</code> </li></ul><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fy0s2jqwz6j320w18q7h5.jpg" alt=""></p><ul><li>next </li></ul><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fy0s2qqvltj320w18qnaw.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fy0s3cxnnhj320w18qaoa.jpg" alt=""></p><ul><li><code>Export As</code>å¡«ä¸Šæ¡Œé¢ï¼Œç‚¹<code>export</code>å°±ç”Ÿæˆ<code>AppleALC</code>åœ¨æ¡Œé¢ä¸Šäº†ï¼Œä¸€å±‚ä¸€å±‚æ‰“å¼€å®ƒï¼Œå°†å…¶ä¸­çš„<code>AppleALC.kext</code>æ”¾åˆ°<code>clover</code>é©±åŠ¨ç›®å½•ï¼Œæ³¨æ„ä¹‹å‰ä¸‹è½½çš„<code>Release</code>çš„<code>Lilu</code>ä¹Ÿè¦æ”¾åˆ°<code>clover</code>é©±åŠ¨ç›®å½•ï¼Œæœ€åä¸è¦å¿˜äº†æ³¨å…¥<code>LayoutID</code>ï¼š</li></ul><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fy0s69hvhfj31rg1fi4fa.jpg" alt=""></p><ul><li>å¦‚æœé‡å¯åä½ çš„å£°å¡ä¸èƒ½é©±åŠ¨ï¼Œæˆ–è€…å·²é©±åŠ¨ä½†æ˜¯æ²¡æœ‰è¾“å…¥æˆ–è¾“å‡ºï¼Œè¿™æ—¶å¾ˆæœ‰å¯èƒ½æ˜¯è¯¥<code>LayoutID</code>å¯¹åº”çš„<code>configdata</code>æ•°æ®æœ‰é”™è¯¯ï¼Œè¿™æ—¶å°±æŒ¨ä¸ªå°è¯•åˆšæ‰è®°å½•çš„æ‰€æœ‰<code>ID</code>ã€‚</li></ul><p align="center"><b>è‡³æ­¤ï¼Œ AppleALC é©±åŠ¨å£°å¡éƒ¨åˆ†ç»“æŸã€‚</b></p><h2 id="å…³äºè§£å†³è€³æœºä¸å†…å»ºè¾“å…¥çš„åˆ‡æ¢"><a href="#å…³äºè§£å†³è€³æœºä¸å†…å»ºè¾“å…¥çš„åˆ‡æ¢" class="headerlink" title="å…³äºè§£å†³è€³æœºä¸å†…å»ºè¾“å…¥çš„åˆ‡æ¢"></a>å…³äºè§£å†³è€³æœºä¸å†…å»ºè¾“å…¥çš„åˆ‡æ¢</h2><blockquote><p>å¦‚æœé©±åŠ¨å·¥ä½œå®Œæˆåï¼Œå£°å¡å¯ä»¥å·¥ä½œï¼Œä½†ä¸èƒ½è‡ªåŠ¨åˆ‡æ¢ï¼Œè¯·æ¥ç€å¾€ä¸‹çœ‹</p></blockquote><ul><li>æ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥ </li></ul><pre><code>git clone https://github.com/goodwin/ALCPlugFix </code></pre><ul><li>å›è½¦å°±å°†<code>ALCPlugFix</code>ä¸‹è½½åˆ°äº†ä½ çš„ç”¨æˆ·ç›®å½•ï¼Œæ‰“å¼€æ­¤ç›®å½•ä¸­çš„<code>ALCPlugFix</code>ä¸­çš„<code>main.m</code>ä¸‹æ‹‰åˆ°æœ€ä¸‹æ–¹ï¼Œæ³¨æ„è¿™ä¸€éƒ¨åˆ†ï¼š</li></ul><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fy0s84o8vij31qc1f6twi.jpg" alt=""></p><ul><li>ä¸‹è½½<a href="https://github.com/RehabMan/EAPD-Codec-Commander.git" target="_blank" rel="noopener"><code>CodecCommander</code></a></li></ul><pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">git</span> clone https://github.com/athlonreg/ALCPlugFix.git$ <span class="token function">git</span> clone https://github.com/RehabMan/EAPD-Codec-Commander.git$ <span class="token function">cp</span> ALCPlugFix/alc_fix/hda-verb /usr/local/bin/$ <span class="token function">cd</span> EAPD-Codec-Commander$ ./widget_dump.sh <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>å›è½¦</li></ul><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fy0swd71qcj31p818kank.jpg" alt=""></p><ul><li>æ‰¾åˆ°<code>nid = 0x19</code>å’Œ<code>nid = 0x1a</code>ï¼Œè¿™é‡Œæˆ‘çš„<code>19</code>ä¸º <code>line in</code>ï¼Œ<code>1a</code>ä¸º<code>mic in</code>ï¼Œè®°å½•ä¸‹æœ€åä¸¤ä½ï¼Œæˆ‘çš„æ˜¯<code>04</code>å’Œ<code>24</code>å°±è¿™ä¹ˆæ”¹</li></ul><p><strong>PS: è¿™é‡Œéœ€è¦è®¾å®šçš„èŠ‚ç‚¹æ•°æ®åˆ†åˆ«æ˜¯<code>line in</code>å’Œ<code>mic in</code>ï¼Œå…¶ä»–èŠ‚ç‚¹æ— æ•ˆï¼Œæ€æƒ³å°±æ˜¯æ•è·ç³»ç»Ÿåœ¨ä¸æ’è€³æœºæ—¶ç”±äºå…¶è¾“å…¥è¾“å‡ºæ­£å¸¸çš„è¿™ä¸¤ä¸ªèŠ‚ç‚¹çš„è¾“å‡ºå€¼ï¼Œç„¶åå°±å¯ä»¥çŸ¥é“æ’è€³æœºæ­£å¸¸åº”è¯¥è¾“å‡ºçš„å€¼ï¼Œè¿›è€Œåˆ©ç”¨<code>AppleALC</code>å®ˆæŠ¤è¿›ç¨‹åŠ¨æ€å®ˆæŠ¤ã€‚å¦‚æœå‡ºç°æ’è€³æœºæ­£å¸¸ï¼Œä¸æ’æ— æ•ˆçš„æƒ…å†µï¼Œè¯·æŒ‰ç…§è¿™ä¸ªæ€è·¯åè¿‡æ¥æ“ä½œï¼Œæ€æƒ³éƒ½æ˜¯ä¸€æ ·çš„ã€‚å…¶ä¸­å›¾ä¸Šçš„é«˜äº®å¤„æœ€ä¸Šé¢ä¸€éƒ¨åˆ†æ˜¯é»˜è®¤æƒ…å†µï¼Œä¸­é—´æ˜¯è€³æœºç§»é™¤ï¼Œæœ€ä¸‹é¢æ˜¯è€³æœºæ’å…¥ï¼Œè¯·ç»“åˆè‡ªèº«ä½¿ç”¨æƒ…å†µåˆç†è®¾å®š</strong></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fy0syo8oezj31qc1f6qqy.jpg" alt=""></p><ul><li><p>ä¿å­˜é€€å‡ºï¼ŒåŒå‡»æŒ‰ç…§<code>AppleALC</code>çš„ç¼–è¯‘æ–¹æ³•ç¼–è¯‘è¿™ä¸ª</p></li><li><p>ç„¶åå°†ç”Ÿæˆçš„<code>ALCPlugFix</code>æ›¿æ¢<code>alc_fix</code>ä¸­çš„<code>ALCPlugFix</code>ï¼Œç»ˆç«¯<code>cd</code>åˆ°<code>alc_fix</code>ç›®å½•ï¼Œæ‰§è¡Œ </p></li></ul><pre><code>$ ./install.sh</code></pre><ul><li>è€³æœºå°±å¯ä»¥è‡ªåŠ¨åˆ‡æ¢äº†ï¼Œä¸‰èŠ‚ç‚¹çš„æœ‹å‹è¿æ°”å¥½çš„è¯æ‚éŸ³åº”è¯¥ä¹Ÿè§£å†³äº†ï¼Œè¿™æ—¶æ’å…¥è€³æœºåœ¨æ‰§è¡Œ </li></ul><pre><code>$ ./widget_dump.sh </code></pre><ul><li>å°±å¯ä»¥å‘ç°ä¹‹å‰çš„<code>19</code>å’Œ<code>1a</code>åé¢çš„æ•°æ®åè¿‡æ¥äº†(æˆ‘è¿™é‡Œæ˜¯ä¿®å¤å¥½çš„ï¼Œå°±ä¸å†æ¼”ç¤ºäº†ã€‚ã€‚ã€‚)</li></ul><blockquote><p>å…¶å®è¿™é‡Œçš„æ•°æ®å°±æ˜¯ä¾¦æµ‹è€³æœºæ’æ‹”çŠ¶æ€ï¼Œå‘ç³»ç»Ÿå‘é€ç›¸å…³æŒ‡ä»¤æ¥åšåˆ°åˆ‡æ¢æ­£å¸¸</p><p>éœ€è¦è®¾å®šçš„å°±æ˜¯ä¸¤ä¸ªèŠ‚ç‚¹<code>Mic at Ext</code>(æœ‰æ—¶æ˜¯<code>Line In</code>)å’Œ<code>Mic at In</code></p><p><code>Mic at Ext</code>(æœ‰æ—¶æ˜¯<code>Line In</code>)è¡¨ç¤ºçº¿è·¯è¾“å…¥ï¼Œå³<code>è€³éº¦</code>ï¼Œå¤šä¸º<code>0x19</code>èŠ‚ç‚¹</p><p><code>Mic at In</code>ä¸ºå†…å»ºè¾“å…¥</p></blockquote><ul><li>å¦‚æœä¸è¡Œé‡å¯ä¸€æ¬¡åº”è¯¥å°±å¥½äº†ã€‚</li></ul><p align="center"><b>è‡³æ­¤ï¼Œè§£å†³è€³æœºä¸å†…å»ºè¾“å…¥çš„åˆ‡æ¢éƒ¨åˆ†ç»“æŸã€‚</b></p><h2 id="å…³äºå”¤é†’æ— å£°"><a href="#å…³äºå”¤é†’æ— å£°" class="headerlink" title="å…³äºå”¤é†’æ— å£°"></a>å…³äºå”¤é†’æ— å£°</h2><blockquote><p>å¯ä»¥å…ˆå°è¯•ä¸‹é¢ä¸¤ä¸ªé©±åŠ¨</p><p><a href="https://github.com/RehabMan/EAPD-Codec-Commander" target="_blank" rel="noopener">CodecCommander</a><br><a href="http://pan.baidu.com/s/1nuTUVS9" target="_blank" rel="noopener">EAPDFix</a> æå–å¯†ç :<code>w4yr</code></p></blockquote><p><strong>PS: å…³äº<code>CodecCommander</code>ï¼Œå¯ä»¥<a href="https://github.com/RehabMan/EAPD-Codec-Commander/blob/master/README.md" target="_blank" rel="noopener">ç‚¹å‡»è¿™é‡Œ</a>å‚è€ƒ<code>RehabMan</code>çš„è¯´æ˜</strong></p><blockquote><p>å¦å¤–å››å¶è‰åŠ©æ‰‹ä¸­ä¹Ÿæä¾›äº†ç›¸å…³é€‰é¡¹(<code>ResetHDA</code>å’Œ<code>dartweak</code>)ï¼Œä½†æ˜¯æœ¬äººæ²¡æœ‰äº²è‡ªå°è¯•ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œå°è¯•è¿™äº›ç»„åˆï¼š</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fy0stj21kcj3220180dvi.jpg" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fy0st47xc9j32201801a0.jpg" alt=""></p><p align="center"><b>æœ¬äººå¯¹å”¤é†’æ— å£°ç ”ç©¶ä¸å¤šï¼Œè‡³æ­¤ï¼Œè§£å†³è€³æœºä¸å†…å»ºè¾“å…¥çš„åˆ‡æ¢éƒ¨åˆ†ç»“æŸï¼Œæ¬¢è¿è¡¥å……ã€‚</b></p><h2 id="å…³äºä¸‡èƒ½å£°å¡"><a href="#å…³äºä¸‡èƒ½å£°å¡" class="headerlink" title="å…³äºä¸‡èƒ½å£°å¡"></a>å…³äºä¸‡èƒ½å£°å¡</h2><blockquote><p>å¾ˆå¤šäººä¸å–œæ¬¢ä¸‡èƒ½å£°å¡ï¼Œè¯´ä¸‡èƒ½æœ‰æ‚éŸ³(ä½†æ˜¯<code>æœ‰ä¸€äº›äººçš„AppleALC</code>ä¹Ÿå¯èƒ½æœ‰æ‚éŸ³)ï¼Œç”šè‡³è¯´ç”¨ä¸‡èƒ½å£°å¡æ˜¯ä¸å®Œç¾çš„è¡¨ç°ï¼Œå…¶å®æˆ‘è®¤ä¸ºä¸ç„¶ï¼Œä¸‡èƒ½æ˜¯ä¸€ç§å¾ˆå¥½çš„æ¸ é“ï¼Œæœ‰ä¸å°‘äººç”¨ä¸‡èƒ½å£°å¡ï¼Œä»–ä»¬çš„åˆ‡æ¢ã€è¾“å…¥ç”šè‡³<code>HDMI</code>éƒ½èƒ½å¾ˆå¥½çš„è¾“å‡ºï¼Œè€Œä¸”æ‚éŸ³ä¹Ÿæ˜¯å¯ä»¥å‡å°çš„ã€‚</p><p>è¿™é‡Œæˆ‘ç»™å‡ºå®˜æ–¹çš„é¡¹ç›®åœ°å€ï¼Œæœ‰å…´è¶£çš„å¯ä»¥è¯•ä¸€ä¸‹</p><p><a href="https://sourceforge.net/projects/voodoohda/" target="_blank" rel="noopener">https://sourceforge.net/projects/voodoohda/</a></p></blockquote><p><strong>PS: éœ€è¦æ³¨æ„çš„æ˜¯æœ‰äººç”¨çš„æ˜¯<code>VoodooHDA.pkg</code>å®‰è£…çš„ï¼Œè¿™ç§æƒ…å†µéœ€è¦å°†<code>AppleHDADisabler.kext</code>æ”¾åˆ°<code>Clover</code>çš„é©±åŠ¨ç›®å½•æ¥ç¦ç”¨<code>AppleHDA</code>ï¼Œå¦åˆ™å¾ˆæœ‰å¯èƒ½ä¼šé€ æˆ<code>KP</code>äº”æœï¼Œæ‰€ä»¥æˆ‘å»ºè®®ç›´æ¥ç”¨<code>kext</code>ï¼Œè®©<code>Clover</code>æ³¨å…¥å™¨æ³¨å…¥å³å¯ã€‚</strong></p><h2 id="å…³äºå®Œæ•´ä»¿å†’"><a href="#å…³äºå®Œæ•´ä»¿å†’" class="headerlink" title="å…³äºå®Œæ•´ä»¿å†’"></a>å…³äºå®Œæ•´ä»¿å†’</h2><h3 id="å‰è¨€-1"><a href="#å‰è¨€-1" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><blockquote><p>å£°å¡å‹å·ä¼—å¤šï¼Œè™½ç„¶<code>AppleALC</code>è®©æ•°æ®æ›´é›†ä¸­äº†ï¼Œä½†è¿˜æ˜¯æœ‰äº›å£°å¡ä¸åœ¨ç›®å‰çš„<code>AppleALC</code>æ”¯æŒçš„åˆ—è¡¨é‡Œé¢ï¼Œå¯¹äºè¿™ç§æƒ…å†µæ¥è¯´ï¼Œæˆ‘ä»¬åªèƒ½å®Œæ•´åˆ¶ä½œä»¿å†’å£°å¡ã€‚</p><p>æ¥ä¸‹æ¥ä»¥æˆ‘çš„<code>CX20751</code>ä¸ºä¾‹ç®€è¿°ä»¿å†’å£°å¡åˆ¶ä½œè¿‡ç¨‹ã€‚</p></blockquote><h3 id="å®Œæ•´åˆ¶ä½œä»¿å†’å£°å¡æ€è·¯"><a href="#å®Œæ•´åˆ¶ä½œä»¿å†’å£°å¡æ€è·¯" class="headerlink" title="å®Œæ•´åˆ¶ä½œä»¿å†’å£°å¡æ€è·¯"></a>å®Œæ•´åˆ¶ä½œä»¿å†’å£°å¡æ€è·¯</h3><ul><li>æ•´ç†<code>Codec</code>ï¼Œæå–æ‰€æœ‰æœ‰æ•ˆ<code>Node</code>å€¼</li><li>å°†æ•´ç†å‡ºçš„æ‰€æœ‰<code>Node</code>çš„<code>Pin Default</code>å€¼è¿›è¡Œè½¬æ¢å¾—å‡ºéœ€è¦çš„å€¼</li><li>æ ¹æ®æŸäº›è§„å¾‹æˆ–è€…è§„åˆ™å¾—å‡º<code>ConfigData</code></li><li><code>PathMap</code>çš„è·å–å’Œæ•´ç†</li></ul><h3 id="çŸ¥è¯†æ™®åŠ"><a href="#çŸ¥è¯†æ™®åŠ" class="headerlink" title="çŸ¥è¯†æ™®åŠ"></a>çŸ¥è¯†æ™®åŠ</h3><blockquote><p>æ¯ä¸€ä¸ª<code>Node</code>çš„<code>ConfigData</code>å€¼éƒ½æ˜¯ç”±å››ä¸ªå…«ä½çš„å­—ç¬¦ä¸²ç»„æˆï¼Œè¿™å››ä¸ªä¸²çš„æœ€åä¸¤ä½åˆ†åˆ«æ˜¯ä¸€ä¸ªå…«ä½çš„è®¾å®šå€¼çš„1 2ã€3 4ã€5 6ã€7 8ä½ï¼Œè¿™å››ä¸ªå…«ä½çš„å­—ç¬¦ä¸²çš„è®¾å®šè§„åˆ™åˆ†åˆ«æ˜¯æ˜¯<code>Address+Node+71C+1 2ä½è®¾å®šå€¼</code>ã€<code>Address+Node+71D+3 4ä½è®¾å®šå€¼</code>ã€<code>Address+Node+71E+5 6ä½è®¾å®šå€¼</code>ã€<code>Address+Node+71F+7 8ä½è®¾å®šå€¼</code>ã€‚</p><p>è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œæœ‰ä¸¤ä¸ªä¸åŒçš„å…«ä½è¢«æåŠï¼Œå…¶ä¸­ä¸€ä¸ªå…«ä½(è¿™å…«ä½æ¯ä¸€ä½éƒ½æœ‰ç‰¹å®šçš„å«ä¹‰ï¼Œä¹Ÿæ˜¯ä»¿å†’æˆåŠŸæœ€å…³é”®çš„åœ°æ–¹ï¼Œåœ¨åé¢æˆ‘ç§°ä¹‹ä¸ºè®¾å®šå€¼)æ˜¯è¢«å‡åˆ†å››ä»½ä»è€Œæ”¾åˆ°<code>ConfigData</code>çš„å„ä¸ªèŠ‚ç‚¹æ‰€å¯¹åº”çš„å››ä¸ªä¸²çš„ä¸ƒå…«ä½</p><p>è€Œè¿™ä¸ªå…«ä½çš„è®¾å®šå€¼æ¯ä¸€ä½çš„å«ä¹‰å¦‚ä¸‹ï¼š</p></blockquote><ul><li>ç¬¬ä¸€ä½ï¼šä»£è¡¨èŠ‚ç‚¹è®¾å®šå€¼(Address)ï¼Œä¸€èˆ¬ä¸éœ€è¦æ”¹å˜ï¼›</li><li>ç¬¬äºŒä½ï¼šåŒç»„è£…ç½®çš„ä¼˜å…ˆé¡ºåºï¼Œä¸€èˆ¬ä¸º 0~3ï¼Œä¸å¯å‡ºç°å­—æ¯ï¼›</li><li>ç¬¬ä¸‰ä½ï¼šæ’å£é¢œè‰²ï¼Œç¬”è®°æœ¬å¿½ç•¥ï¼Œä¸ä½œå¤„ç†ï¼›</li><li>ç¬¬å››ä½ï¼šæ’å­”ä¾¦æµ‹ï¼Œ0ä¸ºå¼€å¯(å¤–è®¾åŸºæœ¬ä¸º0)ï¼Œ1ä¸ºå…³é—­(å†…å»ºåŸºæœ¬ä¸º1)ï¼›</li><li>ç¬¬äº”ä½ï¼šè£…ç½®ç±»å‹ï¼Œç¬”è®°æœ¬å¿½ç•¥ï¼›</li><li>ç¬¬å…­ä½ï¼šè¿æ¥ç±»å‹ï¼Œåœ†å£ä¸º1ï¼Œå†…æ¥ä¸º0ï¼ŒåŸºæœ¬å¯ä»¥å¿½ç•¥ï¼›</li><li>ç¬¬ä¸ƒä½ï¼šä»£è¡¨æ˜¯å¦æœ‰æ’å­”åŠæ’å­”ä½ç½®0=å¤–æ¥ï¼Œ9=å†…å»ºï¼Œè€³æœºæ‰¬å£°å™¨å’Œè€³éº¦å‡ä¸ºå¤–æ¥ï¼›</li><li>ç¬¬å…«ä½ï¼šä»£è¡¨æ’å­”æ‰€åœ¨ä½ç½®ï¼Œ0=å†…å»ºï¼Œ1=å¤–æ¥ï¼›</li></ul><h3 id="å¼€å§‹"><a href="#å¼€å§‹" class="headerlink" title="å¼€å§‹"></a>å¼€å§‹</h3><h4 id="æ•´ç†Codecï¼Œæå–æ‰€æœ‰æœ‰æ•ˆNodeå€¼"><a href="#æ•´ç†Codecï¼Œæå–æ‰€æœ‰æœ‰æ•ˆNodeå€¼" class="headerlink" title="æ•´ç†Codecï¼Œæå–æ‰€æœ‰æœ‰æ•ˆNodeå€¼"></a>æ•´ç†<code>Codec</code>ï¼Œæå–æ‰€æœ‰æœ‰æ•ˆ<code>Node</code>å€¼</h4><blockquote><p>ä¸ä¸Šé¢åˆ©ç”¨<code>AppleALC</code>çš„æ€è·¯ä¸åŒï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦æå–çš„æ•°æ®æœ‰è®¾å¤‡æè¿°ã€<code>Node</code>å€¼å’Œ<code>Pin Default</code>å€¼ã€‚å…·ä½“æå–æ–¹æ³•ä¸Šæ–‡å·²æœ‰è¯´æ˜ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ï¼Œä¸‹é¢æ˜¯æˆ‘çš„<code>CX20751</code>æå–çš„æ•°æ®ï¼š</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fy0t2suhufj31qc1f64ef.jpg" alt=""></p><h4 id="å°†æ•´ç†å‡ºçš„æ‰€æœ‰Nodeçš„Pin-Defaultå€¼è¿›è¡Œè½¬æ¢ä¿®æ­£å¾—å‡ºéœ€è¦çš„è®¾å®šå€¼"><a href="#å°†æ•´ç†å‡ºçš„æ‰€æœ‰Nodeçš„Pin-Defaultå€¼è¿›è¡Œè½¬æ¢ä¿®æ­£å¾—å‡ºéœ€è¦çš„è®¾å®šå€¼" class="headerlink" title="å°†æ•´ç†å‡ºçš„æ‰€æœ‰Nodeçš„Pin Defaultå€¼è¿›è¡Œè½¬æ¢ä¿®æ­£å¾—å‡ºéœ€è¦çš„è®¾å®šå€¼"></a>å°†æ•´ç†å‡ºçš„æ‰€æœ‰<code>Node</code>çš„<code>Pin Default</code>å€¼è¿›è¡Œè½¬æ¢ä¿®æ­£å¾—å‡ºéœ€è¦çš„è®¾å®šå€¼</h4><ul><li>å¯¹äº<code>Pin Default</code>å€¼ï¼Œæˆ‘ä»¬çš„å¤„ç†æ–¹æ³•ä¸ºå…«ä½å››åˆ†ã€äºŒäºŒé€†ç½®ï¼Œä¾‹å¦‚<code>0x16</code>èŠ‚ç‚¹ï¼Œé¦–å…ˆå¾—å‡º<code>40 10 21 03</code>ï¼ŒåŒç†å¾—å‡ºï¼š</li></ul><pre><code>0x16: 40 10 21 030x17: 10 01 17 900x19: 30 10 A1 030x1a: 20 01 A7 95</code></pre><blockquote><p>æ ¹æ®å…«ä½è®¾å®šå€¼çš„è§„åˆ™æè¿°ï¼Œå¯¹ä¸Šé¢å¾—å‡ºçš„è®¾å®šå€¼è¿›è¡Œä¿®æ­£ã€‚</p><p>æ‹¿<code>0x16</code>ä¸ºä¾‹ï¼Œè¿™æ˜¯ä¸€ä¸ªè€³æœºæ‰¬å£°å™¨èŠ‚ç‚¹ã€‚</p><p>ç¬¬1ã€2ã€3ä½æ²¡ä»€ä¹ˆå¥½è¯´çš„ä¿æŒä¸å˜ï¼›<br>ç¬¬4ä½æ’å­”ä¾¦æµ‹ï¼Œè€³æœºè®¾å¤‡å±äºå¤–æ¥è®¾å¤‡ï¼Œæ‰€ä»¥åº”å½“æ˜¯0ï¼Œè¿™é‡Œæ˜¯0ä¸ç”¨åŠ¨ï¼›<br>ç¬¬5ä½è£…ç½®ç±»å‹ç¬”è®°æœ¬å¿½ç•¥ï¼›<br>ç¬¬6ä½è¿æ¥ç±»å‹ï¼Œæ’å£ä¸ºåœ†å£ï¼Œæ‰€ä»¥æ˜¯1ï¼Œè¿™é‡Œæ˜¯1ï¼Œä¿æŒä¸å˜ï¼›<br>ç¬¬7ä½ä»£è¡¨æ˜¯å¦æœ‰æ’å­”ï¼Œè€³æœºæ˜¯å¤–æ¥è®¾å¤‡ï¼Œæ‰€ä»¥æ˜¯0ï¼Œè¿™é‡Œæ˜¯0ï¼Œä¿æŒä¸å˜ï¼›<br>ç¬¬8ä½æ’å­”æ‰€åœ¨ä½ç½®ï¼Œè€³æœºæ˜¯å¤–æ¥è®¾å¤‡ï¼Œæ‰€ä»¥æ˜¯1ï¼›</p><p>å…¶ä»–<code>Node</code>èŠ‚ç‚¹ä¹Ÿæ˜¯å¦‚æ­¤è®¾å®šï¼›</p><p>ä¿®æ­£åçš„æ•°æ®å¦‚ä¸‹ï¼š</p></blockquote><pre><code>0x16: 40 10 21 010x17: 10 01 17 900x19: 30 10 81 010x1a: 20 01 A0 90</code></pre><h4 id="æ ¹æ®è§„å¾‹æˆ–è€…è§„åˆ™å¾—å‡ºConfigData"><a href="#æ ¹æ®è§„å¾‹æˆ–è€…è§„åˆ™å¾—å‡ºConfigData" class="headerlink" title="æ ¹æ®è§„å¾‹æˆ–è€…è§„åˆ™å¾—å‡ºConfigData"></a>æ ¹æ®è§„å¾‹æˆ–è€…è§„åˆ™å¾—å‡º<code>ConfigData</code></h4><blockquote><p>æ ¹æ®ä¸Šé¢å¾—å‡ºçš„è®¾å®šå€¼ï¼Œæˆ‘å¯ä»¥å¾—å‡ºä»¥ä¸‹<code>ConfigData</code>å€¼ï¼š</p></blockquote><pre><code>01671C40 01671D10 01671E21 01671F0101771C10 01771D01 01771E17 01771F9001971C30 01971D10 01971E81 01971F0101a71C20 01a71D01 01a71EA0 01a71F90</code></pre><p><strong>PS: æœç´¢ä¸€ä¸‹codecé‡Œé¢æœ‰æ²¡æœ‰<code>EAPD</code>è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œæœ‰çš„è¯å°±åœ¨<code>ConfigData</code>çš„æœ€åé¢åŠ ä¸Šä¸€ä¸²<code>01470C02</code>è¿™ç»„æ•°å­—ã€‚</strong></p><h4 id="PathMapçš„è·å–å’Œæ•´ç†"><a href="#PathMapçš„è·å–å’Œæ•´ç†" class="headerlink" title="PathMapçš„è·å–å’Œæ•´ç†"></a><code>PathMap</code>çš„è·å–å’Œæ•´ç†</h4><blockquote><p>åœ¨å£°å¡ä»¿å†’çš„è¿‡ç¨‹ä¸­è¿™ä¸€æ­¥æ˜¯æœ€éº»çƒ¦çš„ã€‚æœ‰å‡ ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹ã€‚</p><p>å¯¹äºå£°éŸ³èŠ‚ç‚¹æ¥è¯´ï¼ŒèŠ‚ç‚¹è·¯å¾„çš„æ¨æ–­éµå¾ªä¸€ä¸ªè§„å¾‹ï¼š</p><p>è¾“å…¥æ˜¯ä»åå¾€å‰æ¨æ–­èŠ‚ç‚¹ï¼Œè¾“å‡ºæ˜¯ä»å‰å¾€åæ¨ã€‚</p></blockquote><ul><li>é¦–å…ˆåˆ©ç”¨<code>codecgraph</code>å¾—åˆ°è·¯å¾„å›¾ï¼Œè¯¥æ“ä½œéœ€è¦å®‰è£…<code>graphviz</code>ï¼Œè¿™é‡Œæˆ‘æ¨èåˆ©ç”¨ç»ˆç«¯<code>npm install graphviz</code>å®‰è£…å³å¯ï¼Œç„¶åæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ä¸‹è½½<code>codecgraph</code></li></ul><pre><code>$ git clone https://github.com/athlonreg/codecgraph.git </code></pre><ul><li>è¿™æ ·å°±ä¸‹è½½åˆ°äº†ä½ çš„ç”¨æˆ·æ ¹ç›®å½•ï¼Œå°†ä½ çš„<code>Codec.txt</code>æ‹·è´åˆ°ä¸‹è½½çš„<code>codecgraph</code>ç›®å½•ä¸‹ï¼Œç„¶å</li></ul><pre><code>$ cd codecgraph$ ./codecgraph Codec.txt</code></pre><ul><li>å°±åœ¨<code>codecgraph</code>ç›®å½•ä¸‹ç”Ÿæˆäº†ä½ çš„å£°å¡è·¯å¾„å›¾ï¼Œæ ¼å¼ä¸º<code>svg</code>ï¼Œç”¨<code>safari</code>å³å¯æ‰“å¼€ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥è½¬æ¢ä¸ºå…¶ä»–æ ¼å¼ï¼Œä¾‹å¦‚æˆ‘çš„</li></ul><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fy0t3vra4yj31u60f2n07.jpg" alt=""></p><ul><li>å¯ä»¥çœ‹åˆ°<code>0x16</code>èŠ‚ç‚¹åªè¿æ¥äº†<code>0x10</code>ï¼Œ<code>HP Out</code>ä¸ºè¾“å‡ºï¼Œä»å‰å¾€åæ¨ï¼Œè½¬æ¢ä¸ºåè¿›åˆ¶å¾—åˆ°<code>0x22 -&gt; 0x16</code>;</li><li><code>0x17</code>èŠ‚ç‚¹åªè¿æ¥äº†<code>0x11</code>ï¼Œ<code>Speaker</code>ä¸ºè¾“å‡ºï¼Œä»å‰å¾€åæ¨ï¼Œè½¬æ¢ä¸ºåè¿›åˆ¶å¾—åˆ°<code>0x23 -&gt; 0x17</code>;</li><li><code>0x19</code>èŠ‚ç‚¹åªè¿æ¥äº†<code>0x14</code>ï¼Œ<code>Mic at Int</code>ä¸ºè¾“å…¥ï¼Œä»åå¾€å‰æ¨ï¼Œè½¬æ¢ä¸ºåè¿›åˆ¶å¾—åˆ°<code>0x20 -&gt; 0x25</code>;</li><li><code>0x1a</code>èŠ‚ç‚¹åªè¿æ¥äº†<code>0x13</code>ï¼Œ<code>Mic at Ext</code>ä¸ºè¾“å…¥ï¼Œä»åå¾€å‰æ¨ï¼Œè½¬æ¢ä¸ºåè¿›åˆ¶å¾—åˆ°<code>0x19 -&gt; 0x26</code>;</li></ul><blockquote><p>æ•´ç†å¾—åˆ°è·¯å¾„å¦‚ä¸‹ï¼š</p></blockquote><table><thead><tr><th>è®¾å¤‡åç§°</th><th>æœ‰æ•ˆèŠ‚ç‚¹</th><th>è·¯å¾„</th></tr></thead><tbody><tr><td>HP Out</td><td>0x16</td><td>0x22-&gt;0x16</td></tr><tr><td>Speaker Out</td><td>0x17</td><td>0x23-&gt;0x17</td></tr><tr><td>Mic In</td><td>0x1a</td><td>0x26&lt;-0x19  0x26&lt;-0x20</td></tr><tr><td>Line In</td><td>0x19</td><td>0x25&lt;-0x20  0x26&lt;-0x19</td></tr></tbody></table><p><strong>PS: æˆ‘çš„å£°å¡æ¯”è¾ƒå¥‡è‘©ï¼Œå¯¹äºå¤šæ•°å£°å¡æ¥è¯´ï¼Œè¾“å…¥ä¸€èˆ¬ä¸º<code>0x8 -&gt; 0x35 -&gt; 0x18</code>ï¼Œè¾“å‡ºä¸€èˆ¬ä¸º<code>0x33 -&gt; 0x13 -&gt; 0x3</code></strong></p><h2 id="AppleHDA-ä¿®æ”¹"><a href="#AppleHDA-ä¿®æ”¹" class="headerlink" title="AppleHDA ä¿®æ”¹"></a>AppleHDA ä¿®æ”¹</h2><h2 id="Credit"><a href="#Credit" class="headerlink" title="Credit"></a>Credit</h2><p><a href="https://github.com/vit9696" target="_blank" rel="noopener">vit9696</a><br><a href="https://github.com/goodwin/ALCPlugFix" target="_blank" rel="noopener">goodwin</a><br><a href="https://github.com/RehabMan" target="_blank" rel="noopener">RehabMan</a><br><a href="https://github.com/Dolnor/EAPD-Codec-Commander" target="_blank" rel="noopener">Dolnor</a><br><a href="https://github.com/daliansky" target="_blank" rel="noopener">daliansky</a><br><a href="https://sourceforge.net/projects/voodoohda/" target="_blank" rel="noopener">VoodooHDA</a></p><h2 id="å†™åœ¨æœ€å"><a href="#å†™åœ¨æœ€å" class="headerlink" title="å†™åœ¨æœ€å"></a>å†™åœ¨æœ€å</h2><blockquote><p>ç å­—ä¸æ˜“ï¼Œå¦‚æœè§‰å¾—æ–‡ç« ä¸é”™ï¼Œæ¬¢è¿æ‰“èµï¼Œä½ ä»¬çš„æ”¯æŒæ˜¯æˆ‘æœ€å¤§çš„åŠ¨åŠ›ã€‚</p></blockquote><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Hackintosh </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hacintosh </tag>
            
            <tag> é»‘è‹¹æœ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å®ç° MAC åŸç”Ÿè¯»å†™ NTFS åˆ†åŒº</title>
      <link href="/posts/ff227bd8/"/>
      <url>/posts/ff227bd8/</url>
      
        <content type="html"><![CDATA[<h3 id="å®ç°-MAC-åŸç”Ÿè¯»å†™-NTFS-åˆ†åŒº"><a href="#å®ç°-MAC-åŸç”Ÿè¯»å†™-NTFS-åˆ†åŒº" class="headerlink" title="å®ç° MAC åŸç”Ÿè¯»å†™ NTFS åˆ†åŒº"></a>å®ç° MAC åŸç”Ÿè¯»å†™ NTFS åˆ†åŒº</h3><blockquote><p>æ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥å‘½ä»¤</p></blockquote><pre><code>$ diskutil list</code></pre><blockquote><p>è¾“å…¥å‘½ä»¤</p></blockquote><pre><code>$ sudo vim /etc/fstab</code></pre><blockquote><p>ç¼–è¾‘å†…å®¹å¦‚ä¸‹</p></blockquote><pre><code>LABEL=Win\040Ntfs\040Drive none ntfs rw,auto,nobrowse</code></pre><blockquote><p>æ³¨æ„</p></blockquote><p>**<code>Win\040Ntfs\040Drive</code> è¿™ä¸²å­—ç¬¦ä¸­<code>\040</code>ä»£è¡¨ç©ºæ ¼ï¼Œ<code>Win\040Ntfs\040Drive</code> è¿™ä¸€ä¸²å‡ºç°åœ¨<code>diskutil list</code>é‚£ä¸ªå±å¹•é‡Œé¢</p><blockquote><p>æœ€åä¸€æ­¥</p></blockquote><pre><code>$ sudo ln -s /Volumes ~/Desktop/Volumes</code></pre><h3 id="Credit"><a href="#Credit" class="headerlink" title="Credit"></a>Credit</h3><blockquote><p>è½¬è‡ª<a href="https://www.waitsun.com" target="_blank" rel="noopener">çˆ±æƒ…å®ˆæœ›è€…</a></p><p>è½¬è½½è¯·æ³¨æ˜<a href="https://www.waitsun.com/aboutus/help" target="_blank" rel="noopener">åŸå¸–åœ°å€</a></p></blockquote><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Hackintosh </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hacintosh </tag>
            
            <tag> é»‘è‹¹æœ </tag>
            
            <tag> NTFS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MAC å¸¸ç”¨å¿«æ·é”®æ•´ç†</title>
      <link href="/posts/3ef173e7/"/>
      <url>/posts/3ef173e7/</url>
      
        <content type="html"><![CDATA[<h2 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h2><blockquote><p>è‹¹æœ Mac ç³»ç»Ÿå¸¸ç”¨å¿«æ·é”®æœ‰å¾ˆå¤šï¼Œä½†æ˜¯å¾ˆå¤šç«¥é‹å¯¹äºè¿™äº› Mac å¿«æ·é”®éƒ½ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œä»Šå¤©å°ç¼–ä¸ºå¤§å®¶æ•´ç†äº†ä¸€ä»½ Mac ç³»ç»Ÿå¸¸ç”¨å¿«æ·é”®å¤§å…¨ï¼Œå¤§å®¶å¿«æ”¶è—èµ·æ¥å§!å¹³æ—¶åœ¨ä½¿ç”¨ Mac ç³»ç»Ÿçš„æ—¶å€™å¯ä»¥æé«˜ä¸å°‘å·¥ä½œæ•ˆç‡å“¦!</p><p>æœ¬æ–‡è½¬è‡ª <a href="http://xclient.info/a/36952668-9577-8ec9-4412-111ae375fde7.html?_=905734269077aa284ba54b095a93d187" target="_blank" rel="noopener">Xclient.info</a>ï¼Œè½¬è½½è¯·æ³¨æ˜åŸå‡ºå¤„</p></blockquote><h2 id="å°æ™®åŠ"><a href="#å°æ™®åŠ" class="headerlink" title="å°æ™®åŠ"></a>å°æ™®åŠ</h2><ul><li><p>Macä¸­ä¸»è¦æœ‰å››ä¸ªä¿®é¥°é”®ï¼Œåˆ†åˆ«æ˜¯ Commandï¼ŒControlï¼ŒOption å’Œ Shiftã€‚</p></li><li><p>è¿™å››ä¸ªé”®åˆ†åˆ«æœ‰è‡ªå·±çš„å›¾æ¡ˆï¼Œä»–ä»¬ç»å¸¸å‡ºç°åœ¨Macåº”ç”¨ç¨‹åºä¸­çš„èœå•æ é‡Œï¼Œæ–¹ä¾¿ä½ éšæ—¶å­¦ä¹ æ–°çš„å¿«æ·é”®ã€‚</p></li></ul><blockquote><p>å¦‚ä¸‹</p></blockquote><p><img src="https://img.xclient.info/attachment/2015/10/bf74de6b-c1f0-7323-74a7-4042c0e566c1.jpg" alt=""></p><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><h3 id="é€šç”¨å¿«æ·é”®"><a href="#é€šç”¨å¿«æ·é”®" class="headerlink" title="é€šç”¨å¿«æ·é”®"></a>é€šç”¨å¿«æ·é”®</h3><blockquote><p>Command æ˜¯ Mac é‡Œæœ€é‡è¦çš„ä¿®é¥°é”®ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ç›¸å½“äº Windows ä¸‹çš„ Ctrlï¼Œé»‘æœé€šå¸¸æ˜¯ Alt é”®ã€‚</p></blockquote><ul><li>Command + Z æ’¤é”€ã€‚</li><li>Command + X å‰ªåˆ‡ã€‚</li><li>Command + C æ‹·è´(Copy)ã€‚</li><li>Command + V ç²˜è´´ã€‚</li><li>Command + A å…¨é€‰(All)ã€‚</li><li>Command + S ä¿å­˜(Save)ã€‚</li><li>Command + F æŸ¥æ‰¾(Find)ã€‚</li></ul><p><img src="https://img.xclient.info/attachment/2015/10/51515ea4-d36d-622b-a164-2c3fcef60b1c.jpg" alt=""></p><h3 id="ç³»ç»Ÿå¿«æ·é”®"><a href="#ç³»ç»Ÿå¿«æ·é”®" class="headerlink" title="ç³»ç»Ÿå¿«æ·é”®"></a>ç³»ç»Ÿå¿«æ·é”®</h3><ul><li>Option å¼€æœºåç«‹å³æŒ‰ä¸‹ï¼Œå°†æ˜¾ç¤ºå¯åŠ¨ç®¡ç†å™¨ã€‚</li><li>Command + R å¼€æœºåç«‹å³æŒ‰ä¸‹ï¼Œå¯æ‰“å¼€OS X çš„æ¢å¤åŠŸèƒ½ã€‚</li><li>Command + Option + P + R å¼€æœºåç«‹å³æŒ‰ä¸‹ï¼Œé‡ç½® NVRAMã€‚æœ‰äº›æ—¶å€™ç”µè„‘ä¼šå‡ºç°äº›å°é—®é¢˜ï¼Œé‡ç½® NVRAM æ˜¯ä½ é™¤äº†é‡æ–°å¯åŠ¨ï¼Œå°è¯•ä¿®å¤çš„ç¬¬ä¸€é€‰æ‹©ã€‚</li><li>Command + Option + Control + Power é€€å‡ºæ‰€æœ‰åº”ç”¨ç¨‹åºï¼Œå…è®¸ä½ è¿›è¡Œæ–‡ç¨¿å‚¨å­˜ï¼Œç„¶åå…³æœºã€‚</li><li>æŒ‰ä½ Power æŒ‰é’® 5 ç§’ å¼ºåˆ¶ Mac å…³æœºã€‚</li></ul><p><img src="https://img.xclient.info/attachment/2015/10/30c4390a-db0d-061b-cc0d-9fe08bc335a3.jpg" alt=""></p><h3 id="æˆªå›¾"><a href="#æˆªå›¾" class="headerlink" title="æˆªå›¾"></a>æˆªå›¾</h3><ul><li>Command + Shift + 3 æˆªå–å…¨éƒ¨å±å¹•åˆ°æ–‡ä»¶ã€‚</li><li>Command + Shift + Control + 3 æˆªå–å…¨éƒ¨å±å¹•åˆ°å‰ªè´´æ¿ã€‚</li><li>Command + Shift + 4 æˆªå–æ‰€é€‰å±å¹•åŒºåŸŸåˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œæˆ–æŒ‰ç©ºæ ¼é”®ä»…æ•æ‰ä¸€ä¸ªçª—å£ã€‚</li><li>Command + Shift + Control + 4 æˆªå–æ‰€é€‰å±å¹•åŒºåŸŸåˆ°å‰ªè´´æ¿ï¼Œæˆ–æŒ‰ç©ºæ ¼é”®ä»…æ•æ‰ä¸€ä¸ªçª—å£ã€‚</li></ul><p><img src="https://img.xclient.info/attachment/2015/10/87180b21-818c-1007-835a-e3e5a810b3b0.jpg" alt=""></p><h3 id="æ–‡ä»¶ç®¡ç†å™¨"><a href="#æ–‡ä»¶ç®¡ç†å™¨" class="headerlink" title="æ–‡ä»¶ç®¡ç†å™¨"></a>æ–‡ä»¶ç®¡ç†å™¨</h3><ul><li>Command + Shift + N (New) æ–°å»ºæ–‡ä»¶å¤¹ã€‚</li><li>Command + Shift + G (Go) è°ƒå‡ºçª—å£ï¼Œå¯è¾“å…¥ç»å¯¹è·¯å¾„ç›´è¾¾æ–‡ä»¶å¤¹ã€‚</li><li>return è¿™ä¸ªå…¶å®ä¸ç®—å¿«æ·é”®ï¼Œç‚¹å‡»æ–‡ä»¶ï¼ŒæŒ‰ä¸‹å¯é‡å‘½åæ–‡ä»¶ã€‚</li><li>Command + O æ‰“å¼€æ‰€é€‰é¡¹ã€‚åœ¨ Mac é‡Œæ‰“å¼€æ–‡ä»¶ä¸åƒ Windows é‡Œç›´æ¥æŒ‰ Enterã€‚</li><li>Command + Option + V ä½œç”¨ç›¸å½“äºWindowsé‡Œçš„æ–‡ä»¶å‰ªåˆ‡ã€‚åœ¨å…¶å®ƒä½ç½®ä¸Šå¯¹æ–‡ä»¶å¤åˆ¶(Command-C)ï¼Œåœ¨ç›®çš„ä½ç½®æŒ‰ä¸‹è¿™ä¸ªå¿«æ·é”®ï¼Œæ–‡ä»¶å°†è¢«å‰ªåˆ‡åˆ°æ­¤ä½ç½®ã€‚</li><li>Command + â†‘ æ‰“å¼€åŒ…å«å½“å‰æ–‡ä»¶å¤¹çš„æ–‡ä»¶å¤¹ï¼Œç›¸å½“äº Windows é‡Œçš„â€œå‘ä¸Šâ€ã€‚</li><li>Command + Delete å°†æ–‡ä»¶ç§»è‡³åºŸçº¸ç¯“ã€‚</li><li>Command + Shift + Delete æ¸…å€’åºŸçº¸ç¯“ã€‚</li><li>Space å¿«é€ŸæŸ¥çœ‹é€‰ä¸­çš„æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯é¢„è§ˆåŠŸèƒ½ã€‚</li></ul><p><img src="https://img.xclient.info/attachment/2015/10/b50cb298-346f-4273-032f-e6f2860ed578.jpg" alt=""></p><h3 id="åˆ‡æ¢"><a href="#åˆ‡æ¢" class="headerlink" title="åˆ‡æ¢"></a>åˆ‡æ¢</h3><ul><li>Command + Tab åœ¨åº”ç”¨ç¨‹åºé—´åˆ‡æ¢ã€‚</li><li>Command + Shift + Tab åœ¨åº”ç”¨ç¨‹åºé—´åˆ‡æ¢(åå‘)ã€‚</li><li>Command + ~ åœ¨å„åº”ç”¨ä¸­çš„çª—å£é—´åˆ‡æ¢ã€‚</li></ul><p><img src="https://img.xclient.info/attachment/2015/10/6e814e0a-a4c1-33a1-6123-929094eedfc2.jpg" alt=""></p><h3 id="æµè§ˆå™¨"><a href="#æµè§ˆå™¨" class="headerlink" title="æµè§ˆå™¨"></a>æµè§ˆå™¨</h3><ul><li>Command + L å…‰æ ‡ç›´æ¥è·³è‡³åœ°å€æ ã€‚</li><li>Control + Tab è½¬å‘ä¸‹ä¸€ä¸ªæ ‡ç­¾é¡µã€‚</li><li>Control + Shift + Tab è½¬å‘ä¸Šä¸€ä¸ªæ ‡ç­¾é¡µã€‚</li><li>Command + â€˜+â€™æˆ–â€™=â€™ æ”¾å¤§é¡µé¢ã€‚</li><li>Command + â€˜-â€˜ ç¼©å°é¡µé¢ã€‚</li></ul><p><img src="https://img.xclient.info/attachment/2015/10/f1878a65-814d-44c7-f32b-c2a6e4f625d6.jpg" alt=""></p><h3 id="åº”ç”¨ç¨‹åºä¸­"><a href="#åº”ç”¨ç¨‹åºä¸­" class="headerlink" title="åº”ç”¨ç¨‹åºä¸­"></a>åº”ç”¨ç¨‹åºä¸­</h3><ul><li>Command + H éšè—(Hide)å½“å‰æ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºçª—å£ã€‚</li><li>Command + Option + H éšè—(Hide)å…¶ä»–åº”ç”¨ç¨‹åºçª—å£ã€‚</li><li>Command + Q é€€å‡º(Quit)æœ€å‰é¢çš„åº”ç”¨ç¨‹åºã€‚</li><li>Command + Shift + Z é‡åšï¼Œä¹Ÿå°±æ˜¯æ’¤é”€çš„é€†å‘æ“ä½œã€‚</li><li>Command + Tab åœ¨æ‰“å¼€çš„åº”ç”¨ç¨‹åºåˆ—è¡¨ä¸­è½¬åˆ°ä¸‹ä¸€ä¸ªæœ€è¿‘ä½¿ç”¨çš„åº”ç”¨ç¨‹åºï¼Œç›¸å½“äº Windows ä¸­(Alt+Tab)ã€‚</li><li>Command + Option + esc æ‰“å¼€â€œå¼ºåˆ¶é€€å‡ºâ€çª—å£ï¼Œå¦‚æœæœ‰åº”ç”¨ç¨‹åºæ— å“åº”ï¼Œå¯åœ¨çª—å£åˆ—è¡¨ä¸­é€‰æ‹©å¼ºåˆ¶é€€å‡ºã€‚</li></ul><h3 id="æ–‡æœ¬å¤„ç†"><a href="#æ–‡æœ¬å¤„ç†" class="headerlink" title="æ–‡æœ¬å¤„ç†"></a>æ–‡æœ¬å¤„ç†</h3><ul><li>Command + B åˆ‡æ¢æ‰€é€‰æ–‡å­—ç²—ä½“(Bold)æ˜¾ç¤ºã€‚</li><li>fn + Delete ç›¸å½“äº PC å…¨å°ºå¯¸é”®ç›˜ä¸Šçš„ Deleteï¼Œä¹Ÿå°±æ˜¯å‘ååˆ é™¤ã€‚</li><li>fn + â†‘ å‘ä¸Šæ»šåŠ¨ä¸€é¡µ(Page Up)ã€‚</li><li>fn + â†“ å‘ä¸‹æ»šåŠ¨ä¸€é¡µ(Page Down)ã€‚</li><li>fn + â† æ»šåŠ¨è‡³æ–‡ç¨¿å¼€å¤´(Home)ã€‚</li><li>fn + â†’ æ»šåŠ¨è‡³æ–‡ç¨¿æœ«å°¾(End)ã€‚</li><li>Command + â†’ å°†å…‰æ ‡ç§»è‡³å½“å‰è¡Œçš„è¡Œå°¾ã€‚</li><li>Command + â† å°†å…‰æ ‡ç§»è‡³å½“å‰è¡Œçš„è¡Œé¦–ã€‚</li><li>Command + â†“ å°†å…‰æ ‡ç§»è‡³æ–‡ç¨¿æœ«å°¾ã€‚</li><li>Command + â†‘ å°†å…‰æ ‡ç§»è‡³æ–‡ç¨¿å¼€å¤´ã€‚</li><li>Option + â†’ å°†å…‰æ ‡ç§»è‡³ä¸‹ä¸€ä¸ªå•è¯çš„æœ«å°¾ã€‚</li><li>Option + â† å°†å…‰æ ‡ç§»è‡³ä¸Šä¸€ä¸ªå•è¯çš„å¼€å¤´ã€‚</li><li>Control + A ç§»è‡³è¡Œæˆ–æ®µè½çš„å¼€å¤´ã€‚</li></ul><h3 id="æ›´å¤šå¿«æ·é”®"><a href="#æ›´å¤šå¿«æ·é”®" class="headerlink" title="æ›´å¤šå¿«æ·é”®"></a>æ›´å¤šå¿«æ·é”®</h3><p>å¦‚æœä½ è¿˜æƒ³å­¦ä¹ æ›´å¤šå¿«æ·é”®ï¼Œè¯·ç‚¹å‡»è¿™é‡ŒæŸ¥çœ‹<a href="https://support.apple.com/zh-cn/HT201236" target="_blank" rel="noopener">è‹¹æœå®˜æ–¹çš„å¿«æ·é”®å¸®åŠ©æ–‡æ¡£</a>ã€‚</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Hackintosh </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿«æ·é”® </tag>
            
            <tag> Mac </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hotpatch å±è”½ç‹¬æ˜¾</title>
      <link href="/posts/fbb0a12f/"/>
      <url>/posts/fbb0a12f/</url>
      
        <content type="html"><![CDATA[<h2 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h2><p>æœ€è¿‘æˆ‘æ ¹æ® RehabMan çš„ hotpatch æ·»åŠ äº†ä¸€äº›è·¯å¾„åšäº†ä¸€ä¸ªå±è”½ç‹¬æ˜¾å¾— hotpatch æ¥å±è”½ç‹¬æ˜¾è§£å†³ä¸€äº›å‡çº§ 10.13 åå› ä¸º nv_disable å‚æ•°å¤±æ•ˆè€Œå¡åœ¨ Window Server Service only ran for 0 seconds çš„é”™è¯¯ï¼Œå‘ç°æœ‰äº›æˆåŠŸï¼Œæœ‰äº›å¤±è´¥ã€‚äºæ˜¯æŠŠæˆ‘ç¢ç£¨åˆ°çš„ä¸€ç§æ–¹æ³•åˆ†äº«ç»™å¤§å®¶ï¼å¸Œæœ›è¯¥å¸–å­èƒ½å¸®åŠ©åˆ°å„ä½ï¼</p><blockquote><p>æ„Ÿè°¢ï¼š</p></blockquote><ul><li><p>PCBETA (è¿œæ™¯è®ºå›) <a href="http://bbs.pcbeta.com/viewthread-1760319-1-5.html" target="_blank" rel="noopener">yearjinheng ç‰ˆä¸»çš„å¸–å­</a></p></li><li><p>tonymacx86.com <a href="https://www.tonymacx86.com/threads/fix-window-server-service-only-ran-for-0-seconds-with-dual-gpu.233092/" target="_blank" rel="noopener">Rehabman çš„å¸–å­</a></p></li><li><p>è½¬è½½è¯·æ³¨æ˜ <a href="https://blog.iamzhl.top/2017/10/04/%E5%B1%8F%E8%94%BD%E7%8B%AC%E6%98%BE/" target="_blank" rel="noopener">åŸè´´åœ°å€</a></p></li></ul><blockquote><p>å±è”½ç‹¬æ˜¾æ–¹æ³•ä¸ä¸€ï¼š</p></blockquote><ul><li>ç¬¬ä¸€ç§ï¼šç›´æ¥åœ¨ DSDT SSDT ä¸Šåšä¿®æ”¹</li><li>ç¬¬äºŒç§ï¼šæ‰‹åŠ¨åˆ¶ä½œä¸€ä¸ªé€‚åˆè‡ªå·±æœºå™¨çš„ hotpatch å±è”½ç‹¬æ˜¾è¾¾åˆ°å±è”½ç‹¬æ˜¾çš„ä½œç”¨</li></ul><h2 id="å¼€å·¥"><a href="#å¼€å·¥" class="headerlink" title="å¼€å·¥"></a>å¼€å·¥</h2><blockquote><p>æœ¬å¸–ä¸»è¦é‡‡ç”¨ç¬¬äºŒç§æ–¹æ³•ï¼Œå¤§è‡´æ€è·¯å¦‚ä¸‹ï¼š</p></blockquote><ul><li>æå– ACPI åŸå§‹è¡¨å•</li><li>åç¼–è¯‘è¿™äº›æ–‡ä»¶</li><li>æœç´¢ä¸€ä¸ªåä¸º _OFF çš„æ–¹æ³•</li><li>æ£€æŸ¥æ–‡ä»¶çš„ç»“æœä»¥ç¡®å®š _OFF çš„è·¯å¾„</li><li>ä¿®æ”¹ RehabMan çš„ hotpatch åŠ å…¥è‡ªå·±çš„è·¯å¾„</li></ul><h3 id="æå–-ACPI-åŸå§‹è¡¨å•å¹¶æå–-OFF-è·¯å¾„"><a href="#æå–-ACPI-åŸå§‹è¡¨å•å¹¶æå–-OFF-è·¯å¾„" class="headerlink" title="æå– ACPI åŸå§‹è¡¨å•å¹¶æå– _OFF è·¯å¾„"></a>æå– ACPI åŸå§‹è¡¨å•å¹¶æå– _OFF è·¯å¾„</h3><ul><li>æ‰“å¼€ç”µè„‘è¿›å…¥å››å¶è‰å¼•å¯¼ç•Œé¢ï¼ŒæŒ‰ä¸‹ F4 æˆ–è€… FN+F4 å³å¯æå–åŸå§‹è¡¨å•åˆ° /EFI/CLOVER/ACPI/origin ï¼Œç„¶åè¿›å…¥ MAC å°† origin æ‹·è´åˆ°æ¡Œé¢åˆ æ‰é™¤ SSDT DSDT ä¹‹å¤–çš„æ‰€æœ‰ aml æ–‡ä»¶ï¼Œæ‰“å¼€ç»ˆç«¯ï¼š</li></ul><pre><code>$ cd ~/Desktop/origin $ iasl -da -dl *.aml $ rm *.aml $ grep -l Method.*_OFF *.dsl</code></pre><ul><li>ä»¥æˆ‘ä¿®æ”¹çš„ä¸€ä¸ªæœºå™¨ä¸ºä¾‹ï¼Œä¸Šä¸€æ¡å‘½ä»¤å¾—åˆ°çš„ç»“æœå¦‚ä¸‹</li></ul><pre><code>DSDT.dslSSDT-7.dslSSDT-8.dslSSDT-9.dsl</code></pre><ul><li>ä¾æ¬¡æ‰“å¼€è¿™å››ä¸ªè¡¨å•æœç´¢ _OFF ï¼Œæ‰¾åˆ°ä¸€ä¸ªç±»ä¼¼äºä¸‹é¢è¿™ä¸ªå‡½æ•°ï¼š</li></ul><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypwailo2hj31ee16kwuq.jpg" alt=""></p><ul><li>å›¾ç‰‡å·¦ä¸‹è§’çš„è·¯å¾„å°±æ˜¯æˆ‘ä»¬æœ€ç»ˆæ‰€éœ€è¦çš„: </li></ul><pre><code>_SB.PCI0.RP05.PEGP</code></pre><h3 id="ä¿®æ”¹-RehabMan-çš„-hotpatch-æ·»åŠ è¿™ä¸ªè·¯å¾„"><a href="#ä¿®æ”¹-RehabMan-çš„-hotpatch-æ·»åŠ è¿™ä¸ªè·¯å¾„" class="headerlink" title="ä¿®æ”¹ RehabMan çš„ hotpatch æ·»åŠ è¿™ä¸ªè·¯å¾„"></a>ä¿®æ”¹ RehabMan çš„ hotpatch æ·»åŠ è¿™ä¸ªè·¯å¾„</h3><ul><li>é¦–å…ˆå» RehanMan çš„ GitHub ä¸‹è½½ hotpatch åŒ…</li></ul><pre><code>https://github.com/RehabMan/OS-X-Clover-Laptop-Config.git</code></pre><ul><li>æˆ‘ä»¬åªéœ€è¦ SSDT-Disable_DGPU è¿™ä¸ªæ–‡ä»¶ï¼Œç¼–è¯‘æˆ aml æ–‡ä»¶</li></ul><pre><code>$ iasl SSDT-Disable_DGPU.dsl </code></pre><ul><li>æ‰“å¼€ç¼–è¯‘åå¾—åˆ°çš„ aml æ–‡ä»¶</li></ul><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypw7fmi6oj31t017iaoe.jpg" alt=""></p><ul><li>æŒ‰ç…§è¿™ä¸ªæ ¼å¼ä¿®æ”¹ä¸ºè‡ªå·±çš„è·¯å¾„</li></ul><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypw8t1hp2j31t017inbi.jpg" alt=""></p><ul><li>ä¿å­˜æ”¾åˆ° /EFI/CLOVER/ACPI/patched </li></ul><h3 id="ä¸€ä¸ªæ³¨æ„ç‚¹"><a href="#ä¸€ä¸ªæ³¨æ„ç‚¹" class="headerlink" title="ä¸€ä¸ªæ³¨æ„ç‚¹"></a>ä¸€ä¸ªæ³¨æ„ç‚¹</h3><ul><li>å¦‚æœåœ¨ Config.plist ä¸­ä½¿ç”¨äº† SortedOrder (é€šå¸¸ Clover å®‰è£…åé»˜è®¤æ²¡æœ‰è®¾ç½®)ï¼Œéœ€è¦åœ¨å…¶å†…æ·»åŠ  SSDT-Disable_DGPU.aml è¿™ä¸€é¡¹ã€‚å› ä¸ºå¦‚æœæŒ‡å®šäº† SortedOrder ï¼Œåˆ™ Clover åªåŠ è½½å…¶ä¸­æŒ‡å®šçš„ SSDT ã€‚å¦‚æœæ²¡æœ‰å‡ºç°åœ¨åˆ—è¡¨ä¸­,å³ä½¿åœ¨ ACPI/patched ä¸­ï¼Œå®ƒä¹Ÿä¸ä¼šåŠ è½½ã€‚</li></ul><h2 id="å®Œå·¥"><a href="#å®Œå·¥" class="headerlink" title="å®Œå·¥"></a>å®Œå·¥</h2><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Hackintosh </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é»‘è‹¹æœ </tag>
            
            <tag> Hackintosh </tag>
            
            <tag> Window Server Service only ran for 0 seconds </tag>
            
            <tag> Disable DGPU </tag>
            
            <tag> å±è”½ç‹¬æ˜¾ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è­¦åŒª110é—®é¢˜</title>
      <link href="/posts/ae09b6b0/"/>
      <url>/posts/ae09b6b0/</url>
      
        <content type="html"><![CDATA[<h1 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h1><p>â€‹    åŒªè­¦è¯·æ‹¨110,å³ä½¿æ‰‹æœºæ¬ è´¹ä¹Ÿå¯æ‹¨é€šï¼</p><p>â€‹    ä¸ºäº†ä¿éšœç¤¾ä¼šç§©åºï¼Œä¿æŠ¤äººæ°‘ç¾¤ä¼—ç”Ÿå‘½è´¢äº§å®‰å…¨ï¼Œè­¦å¯Ÿå”å”éœ€è¦ä¸ç½ªçŠ¯æ–—æ™ºæ–—å‹‡ï¼Œå› è€Œéœ€è¦ç»å¸¸æ€§åœ°è¿›è¡Œä½“åŠ›è®­ç»ƒå’Œæ™ºåŠ›è®­ç»ƒï¼</p><p>   æŸæ‰¹è­¦å¯Ÿå”å”æ­£åœ¨è¿›è¡Œæ™ºåŠ›è®­ç»ƒï¼š</p><pre><code>12 3 4 5 6 7 8 9 =110;</code></pre><p>â€‹    è¯·çœ‹ä¸Šè¾¹çš„ç®—å¼ï¼Œä¸ºäº†ä½¿ç­‰å¼æˆç«‹ï¼Œéœ€è¦åœ¨æ•°å­—é—´å¡«å…¥åŠ å·æˆ–è€…å‡å·ï¼ˆå¯ä»¥ä¸å¡«ï¼Œä½†ä¸èƒ½å¡«å…¥å…¶å®ƒç¬¦å·ï¼‰ã€‚ä¹‹é—´æ²¡æœ‰å¡«å…¥ç¬¦å·çš„æ•°å­—ç»„åˆæˆä¸€ä¸ªæ•°ï¼Œä¾‹å¦‚ï¼š12+34+56+7-8+9 å°±æ˜¯ä¸€ç§åˆæ ¼çš„å¡«æ³•ï¼›123+4+5+67-89 æ˜¯å¦ä¸€ä¸ªå¯èƒ½çš„ç­”æ¡ˆã€‚</p><p>â€‹    è¯·ä½ åˆ©ç”¨è®¡ç®—æœºçš„ä¼˜åŠ¿ï¼Œå¸®åŠ©è­¦å¯Ÿå”å”å¿«é€Ÿæ‰¾åˆ°æ‰€æœ‰ç­”æ¡ˆã€‚</p><pre><code>   æ¯ä¸ªç­”æ¡ˆå ä¸€è¡Œã€‚å½¢å¦‚ï¼š</code></pre><ul><li><p>12+34+56+7-8+9</p></li><li><p>123+4+5+67-89</p></li></ul><h1 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h1><p>1ã€ä¸€å…±ä¹ä¸ªæ•°å­—ï¼Œå…«ä¸ªæ“ä½œç¬¦ï¼›<br>2ã€æ¯ä¸ªæ“ä½œç¬¦æœ‰ä¸‰ç§æƒ…å†µï¼Œå³ç•™ç©ºã€åŠ æˆ–è€…å‡ï¼Œåˆ†åˆ«ç”¨0ã€1å’Œ2è¡¨ç¤ºï¼›<br>3ã€å…±æœ‰ 3^8 ç§æƒ…å†µï¼Œéå†æ¯ç§æƒ…å†µåˆ¤æ–­è¾“å‡ºï¼›<br>4ã€éœ€è¦æ³¨æ„çš„æ˜¯ç•™ç©ºå’Œâ€™+â€™ã€â€™-â€˜éœ€è¦åˆ†å¼€å¤„ç†ï¼Œå› ä¸ºç•™ç©ºä¹‹åéœ€è¦å°†å…¶å‰åçš„æ•°æ®è¿åœ¨ä¸€èµ·ã€‚<br>5ã€ä»¥12+34+56+7-8+9ä¸ºä¾‹ï¼Œç»™å’Œsumèµ‹åˆå€¼ä¸º0ï¼Œç¬¬ä¸€æ¬¡å¾ªç¯æ“ä½œç¬¦ä¸ºç•™ç©ºï¼Œéœ€è¦å…ˆåŠ ä¸Šç¬¬ä¸€ä½çš„1ï¼Œç„¶åè¿›è¡Œè¿™ä¸€æ¬¡è¿ç®—ï¼Œå³1x10+2ï¼Œç„¶åä¸‹ä¸€æ¬¡å¾ªç¯æ“ä½œç¬¦ä¸º+ï¼Œéœ€è¦è®¡ç®—çš„å°±æ˜¯12+3ï¼ŒåŒç†åœ¨3ã€4ä¹‹é—´çš„ç©ºéœ€è¦è®¡ç®—çš„æ˜¯3x10+4ï¼Œè€Œä¸æ˜¯ï¼ˆ12+3ï¼‰x10+4ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªä¸´æ—¶å˜é‡æ¥è®°å½•ä¸Šæ¬¡çš„æ“ä½œæ•°ï¼Œè¿˜éœ€è¦ä¸€ä¸ªå˜é‡æ¥è®°å½•ä¸Šæ¬¡çš„æ“ä½œç¬¦å°†ä¸Šæ¬¡çš„ç»“æœè¿›è¡Œç»Ÿè®¡å¤„ç†ï¼ŒåŸå› å°±åœ¨äºæˆ‘ä»¬æ— æ³•ç¡®å®šä¸‹æ¬¡çš„æ“ä½œç¬¦æ˜¯ä¸æ˜¯ç•™ç©ºã€‚<br>6ã€ç”±äºæˆ‘ä»¬åœ¨ç»Ÿè®¡å’Œæ—¶ï¼Œåªæœ‰åœ¨ä¸‹ä¸€æ¬¡å¾ªç¯æ‰èƒ½å¤„ç†æœ€åä¸€ä¸ªæ“ä½œæ•°ï¼Œæ‰€ä»¥éœ€è¦å°†9æœ€åå•ç‹¬å¤„ç†ã€‚ </p><h1 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h1><pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span> </span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;math.h></span> </span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> sum<span class="token punctuation">;</span>     <span class="token keyword">int</span> temp<span class="token punctuation">;</span>     <span class="token keyword">int</span> oper<span class="token punctuation">,</span>lastoper<span class="token punctuation">;</span>      <span class="token keyword">int</span> number<span class="token punctuation">;</span>     <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>      <span class="token punctuation">{</span>          sum<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>         temp<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>         lastoper<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>          number<span class="token operator">=</span>i<span class="token punctuation">;</span>          <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span><span class="token number">8</span><span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>          <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">//æ“ä½œå…«æ¬¡ </span>            oper<span class="token operator">=</span>number<span class="token operator">%</span><span class="token number">3</span><span class="token punctuation">;</span>             number<span class="token operator">=</span>number<span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">;</span>              <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>oper<span class="token punctuation">)</span>                 temp<span class="token operator">=</span>temp<span class="token operator">*</span><span class="token number">10</span><span class="token operator">+</span>a<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//ç•™ç©ºå•ç‹¬å¤„ç† </span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>oper<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">//å½“å‰æ“ä½œç¬¦ </span>                <span class="token keyword">if</span><span class="token punctuation">(</span>lastoper<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//å‰ä¸€æ¬¡æ“ä½œç¬¦ </span>                    sum<span class="token operator">=</span>sum<span class="token operator">+</span>temp<span class="token punctuation">;</span>                     temp<span class="token operator">=</span>a<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                  <span class="token keyword">if</span><span class="token punctuation">(</span>lastoper<span class="token operator">==</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                    sum<span class="token operator">=</span>sum<span class="token operator">-</span>temp<span class="token punctuation">;</span>                     temp<span class="token operator">=</span>a<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                  lastoper<span class="token operator">=</span>oper<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//æ›´æ–°ä¸Šæ¬¡æ“ä½œç¬¦ </span>            <span class="token punctuation">}</span>              <span class="token keyword">if</span><span class="token punctuation">(</span>oper<span class="token operator">==</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                  <span class="token keyword">if</span><span class="token punctuation">(</span>lastoper<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                    sum<span class="token operator">=</span>sum<span class="token operator">+</span>temp<span class="token punctuation">;</span>                     temp<span class="token operator">=</span>a<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                  <span class="token keyword">if</span><span class="token punctuation">(</span>lastoper<span class="token operator">==</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                    sum<span class="token operator">=</span>sum<span class="token operator">-</span>temp<span class="token punctuation">;</span>                     temp<span class="token operator">=</span>a<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                  lastoper<span class="token operator">=</span>oper<span class="token punctuation">;</span>              <span class="token punctuation">}</span>          <span class="token punctuation">}</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>lastoper<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>     <span class="token comment" spellcheck="true">//ç¬¬ä¹æ¬¡æ“ä½œå•ç‹¬å¤„ç† </span>            sum<span class="token operator">=</span>sum<span class="token operator">+</span>temp<span class="token punctuation">;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>lastoper<span class="token operator">==</span><span class="token number">2</span><span class="token punctuation">)</span>             sum<span class="token operator">=</span>sum<span class="token operator">-</span>temp<span class="token punctuation">;</span>             <span class="token keyword">if</span><span class="token punctuation">(</span>sum<span class="token operator">==</span><span class="token number">110</span><span class="token punctuation">)</span>          <span class="token punctuation">{</span>              number<span class="token operator">=</span>i<span class="token punctuation">;</span>              <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span><span class="token number">8</span><span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>              <span class="token punctuation">{</span>                  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span>a<span class="token punctuation">[</span>j<span class="token number">-1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  oper<span class="token operator">=</span>number<span class="token operator">%</span><span class="token number">3</span><span class="token punctuation">;</span>                 number<span class="token operator">=</span>number<span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">;</span>                  <span class="token keyword">if</span><span class="token punctuation">(</span>oper<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>                     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"+"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token keyword">if</span><span class="token punctuation">(</span>oper<span class="token operator">==</span><span class="token number">2</span><span class="token punctuation">)</span>                     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">else</span>                    <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>                         <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"9\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>      <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="è¿è¡Œç»“æœ"><a href="#è¿è¡Œç»“æœ" class="headerlink" title="è¿è¡Œç»“æœ"></a>è¿è¡Œç»“æœ</h1><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/006dLY5Ily1fypyfpkfu0j32701f6ne8.jpg" alt=""></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> Cè¯­è¨€ </tag>
            
            <tag> è­¦åŒª110 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä»·ç‰Œç¿»è½¬é—®é¢˜</title>
      <link href="/posts/32c79cbc/"/>
      <url>/posts/32c79cbc/</url>
      
        <content type="html"><![CDATA[<h2 id="ä»·ç‰Œç¿»è½¬é—®é¢˜"><a href="#ä»·ç‰Œç¿»è½¬é—®é¢˜" class="headerlink" title="ä»·ç‰Œç¿»è½¬é—®é¢˜"></a>ä»·ç‰Œç¿»è½¬é—®é¢˜</h2><a id="more"></a><h1 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h1><p>â€‹    å°æçš„åº—é‡Œä¸“å–å…¶å®ƒåº—ä¸­ä¸‹æ¶çš„æ ·å“ç”µè§†æœºï¼Œå¯ç§°ä¸ºï¼šæ ·å“ç”µè§†ä¸“å–åº—ã€‚<br>â€‹    å…¶æ ‡ä»·éƒ½æ˜¯4ä½æ•°å­—ï¼ˆå³åƒå…ƒä¸ç­‰ï¼‰ã€‚<br>â€‹    å°æä¸ºäº†æ ‡ä»·æ¸…æ™°ã€æ–¹ä¾¿ï¼Œä½¿ç”¨äº†é¢„åˆ¶çš„ç±»ä¼¼æ•°ç ç®¡çš„æ ‡ä»·ç­¾ï¼Œåªè¦ç”¨é¢œè‰²ç¬”æ¶‚æ•°å­—å°±å¯ä»¥äº†ã€‚<br>â€‹    è¿™ç§ä»·ç‰Œæœ‰ä¸ªç‰¹ç‚¹ï¼Œå¯¹ä¸€äº›æ•°å­—ï¼Œå€’è¿‡æ¥çœ‹ä¹Ÿæ˜¯åˆç†çš„æ•°å­—ã€‚å¦‚ï¼š1 2 5 6 8 9 0 éƒ½å¯ä»¥ã€‚è¿™æ ·ä¸€æ¥ï¼Œå¦‚æœç‰Œå­æŒ‚å€’äº†ï¼Œæœ‰å¯èƒ½å®Œå…¨å˜æˆäº†å¦ä¸€ä¸ªä»·æ ¼ï¼Œæ¯”å¦‚ï¼š1958 å€’ç€æŒ‚å°±æ˜¯ï¼š8561ï¼Œå·®äº†å‡ åƒå…ƒå•Š!!<br>â€‹    å½“ç„¶ï¼Œå¤šæ•°æƒ…å†µä¸èƒ½å€’è¯»ï¼Œæ¯”å¦‚ï¼Œ1110 å°±ä¸èƒ½å€’è¿‡æ¥ï¼Œå› ä¸º0ä¸èƒ½ä½œä¸ºå¼€å§‹æ•°å­—ã€‚</p><p>â€‹    æœ‰ä¸€å¤©ï¼Œæ‚²å‰§ç»ˆäºå‘ç”Ÿäº†ã€‚æŸä¸ªåº—å‘˜ä¸å°å¿ƒæŠŠåº—é‡Œçš„æŸä¸¤ä¸ªä»·æ ¼ç‰Œç»™æŒ‚å€’äº†ã€‚å¹¶ä¸”è¿™ä¸¤ä¸ªä»·æ ¼ç‰Œçš„ç”µè§†æœºéƒ½å–å‡ºå»äº†!åº†å¹¸çš„æ˜¯ä»·æ ¼å‡ºå…¥ä¸å¤§ï¼Œå…¶ä¸­ä¸€ä¸ªä»·ç‰Œèµ”äº†2ç™¾å¤šï¼Œå¦ä¸€ä¸ªä»·ç‰Œå´èµšäº†8ç™¾å¤šï¼Œç»¼åˆèµ·æ¥ï¼Œåè€Œå¤šèµšäº†558å…ƒã€‚</p><h1 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h1><p>1ã€å·²çŸ¥æ˜¯ä¸€ä¸ªå››ä½æ•°ï¼Œé‚£ä¹ˆå…±æœ‰1001-9999ç§æƒ…å†µï¼›<br>2ã€ä¸€ä¸ªæ•°é¢ å€’ä¹‹åï¼Œæ•°å­—é¡ºåºé¢ å€’å¹¶ä¸”æ¯ä¸ªæ•°å­—é¢ å€’ï¼Œä¾‹å¦‚1269é¢ å€’ä¹‹åå°±æ˜¯6921ï¼›<br>3ã€0ä¸èƒ½æ˜¯ç¬¬ä¸€ä½ä¹Ÿä¸èƒ½æ˜¯æœ€åä¸€ä½ã€‚</p><h1 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h1><pre class="line-numbers language-c"><code class="language-c"><span class="token comment" spellcheck="true">//</span><span class="token comment" spellcheck="true">//  main.c</span><span class="token comment" spellcheck="true">//  rollover-price-tag</span><span class="token comment" spellcheck="true">//</span><span class="token comment" spellcheck="true">//  Created by Canvas on 2018/12/31.</span><span class="token comment" spellcheck="true">//  Copyright Â© 2018 Canvas. All rights reserved.</span><span class="token comment" spellcheck="true">//</span><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;math.h></span></span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">inverse</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//æ±‚ä¸€ä¸ªæ•°é¢ å€’ä¹‹åçš„ç»“æœ</span>    <span class="token keyword">int</span> b<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> arr<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">4</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a<span class="token operator">/</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">9</span><span class="token punctuation">)</span>            b<span class="token operator">+</span><span class="token operator">=</span><span class="token number">6</span><span class="token operator">*</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">6</span><span class="token punctuation">)</span>            b<span class="token operator">+</span><span class="token operator">=</span><span class="token number">9</span><span class="token operator">*</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            b<span class="token operator">+</span><span class="token operator">=</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> b<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">;</span>    <span class="token keyword">int</span> k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>l<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> temp<span class="token punctuation">;</span>    <span class="token keyword">int</span> flag<span class="token punctuation">;</span>    <span class="token keyword">int</span> up<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span>down<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//åˆ†åˆ«å­˜æ”¾èµšé’±å’Œèµ”é’±çš„ä»·ç‰Œ</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1001</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">10000</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        temp<span class="token operator">=</span>i<span class="token punctuation">;</span>        flag<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">4</span><span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            array<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>temp<span class="token operator">/</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">-</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>array<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">3</span><span class="token operator">||</span>array<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">4</span><span class="token operator">||</span>array<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//åˆ†å‰²æ•°å­—æ’é™¤ä¸èƒ½ç¿»è½¬çš„æ•°å­—</span>                flag<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">0</span> <span class="token operator">||</span> array<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//0ä¸èƒ½ä½äºç¬¬ä¸€ä½å’Œæœ€åä¸€ä½</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">inverse</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span>i<span class="token operator">></span><span class="token number">800</span><span class="token operator">&amp;&amp;</span><span class="token function">inverse</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span>i<span class="token operator">&lt;</span><span class="token number">900</span><span class="token punctuation">)</span>                up<span class="token punctuation">[</span>k<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>i<span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token function">inverse</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">></span><span class="token number">200</span><span class="token operator">&amp;&amp;</span>i<span class="token operator">-</span><span class="token function">inverse</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">300</span><span class="token punctuation">)</span>                down<span class="token punctuation">[</span>l<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>i<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">50</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//ä¾æ¬¡è¾“å‡ºèµšé’±çš„åŸä»·ï¼Œé¢ å€’ä»·ã€èµšçš„é’±ã€èµ”é’±çš„åŸä»·ã€é¢ å€’ä»·ã€èµ”çš„é’±</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">50</span><span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">inverse</span><span class="token punctuation">(</span>up<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-</span>up<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">(</span>down<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">-</span><span class="token function">inverse</span><span class="token punctuation">(</span>down<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">558</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\t%d\t%d\t"</span><span class="token punctuation">,</span>up<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token function">inverse</span><span class="token punctuation">(</span>up<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">inverse</span><span class="token punctuation">(</span>up<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-</span>up<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\t%d\t%d\n"</span><span class="token punctuation">,</span>down<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token function">inverse</span><span class="token punctuation">(</span>down<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>down<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">-</span><span class="token function">inverse</span><span class="token punctuation">(</span>down<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿è¡Œç»“æœï¼š</p><p>![image-20181231154932718](/Users/canvas/Library/Application Support/typora-user-images/image-20181231154932718.png)</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> Cè¯­è¨€ </tag>
            
            <tag> ä»·ç‰Œç¿»è½¬ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ´¾é£æ•¢æ­»é˜Ÿé—®é¢˜</title>
      <link href="/posts/73edbbae/"/>
      <url>/posts/73edbbae/</url>
      
        <content type="html"><![CDATA[<h1 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h1><p>â€‹    Gå°†å†›æœ‰ä¸€æ”¯è®­ç»ƒæœ‰ç´ çš„å†›é˜Ÿï¼Œè¿™ä¸ªå†›é˜Ÿé™¤å¼€Gå°†å†›å¤–ï¼Œæ¯åå£«å…µéƒ½æœ‰ä¸€ä¸ªç›´æ¥ä¸Šçº§ï¼ˆå¯èƒ½æ˜¯å…¶ä»–å£«å…µï¼Œä¹Ÿå¯èƒ½æ˜¯Gå°†å†›ï¼‰ã€‚ç°åœ¨Gå°†å†›å°†æ¥å—ä¸€ä¸ªç‰¹åˆ«çš„ä»»åŠ¡ï¼Œéœ€è¦æ´¾é£ä¸€éƒ¨åˆ†å£«å…µï¼ˆè‡³å°‘ä¸€ä¸ªï¼‰ç»„æˆä¸€ä¸ªæ•¢æ­»é˜Ÿï¼Œä¸ºäº†å¢åŠ æ•¢æ­»é˜Ÿé˜Ÿå‘˜çš„ç‹¬ç«‹æ€§ï¼Œè¦æ±‚å¦‚æœä¸€åå£«å…µåœ¨æ•¢æ­»é˜Ÿä¸­ï¼Œä»–çš„ç›´æ¥ä¸Šçº§ä¸èƒ½åœ¨æ•¢æ­»é˜Ÿä¸­ã€‚<br>â€‹    è¯·é—®ï¼ŒGå°†å†›æœ‰å¤šå°‘ç§æ´¾å‡ºæ•¢æ­»é˜Ÿçš„æ–¹æ³•ã€‚æ³¨æ„ï¼ŒGå°†å†›ä¹Ÿå¯ä»¥ä½œä¸ºä¸€ä¸ªå£«å…µè¿›å…¥æ•¢æ­»é˜Ÿã€‚</p><p>â€‹    è¾“å…¥æ ¼å¼:<br>â€‹    è¾“å…¥çš„ç¬¬ä¸€è¡ŒåŒ…å«ä¸€ä¸ªæ•´æ•°nï¼Œè¡¨ç¤ºåŒ…æ‹¬Gå°†å†›åœ¨å†…çš„å†›é˜Ÿçš„äººæ•°ã€‚å†›é˜Ÿçš„å£«å…µä»1è‡³nç¼–å·ï¼ŒGå°†å†›ç¼–å·ä¸º1ã€‚<br>æ¥ä¸‹æ¥n-1ä¸ªæ•°ï¼Œåˆ†åˆ«è¡¨ç¤ºç¼–å·ä¸º2, 3, â€¦, nçš„å£«å…µçš„ç›´æ¥ä¸Šçº§ç¼–å·ï¼Œç¼–å·içš„å£«å…µçš„ç›´æ¥ä¸Šçº§çš„ç¼–å·å°äºiã€‚<br>â€‹    è¾“å‡ºæ ¼å¼:<br>â€‹    è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ´¾å‡ºæ•¢æ­»é˜Ÿçš„æ–¹æ¡ˆæ•°ã€‚ç”±äºæ•°ç›®å¯èƒ½å¾ˆå¤§ï¼Œä½ åªéœ€è¦è¾“å‡ºè¿™ä¸ªæ•°é™¤10007çš„ä½™æ•°å³å¯ã€‚</p><p>â€‹    æ ·ä¾‹è¾“å…¥1:<br>â€‹    3<br>â€‹    1 1</p><p>â€‹    æ ·ä¾‹è¾“å‡º1:<br>â€‹    4</p><p>â€‹    æ ·ä¾‹è¯´æ˜:<br>â€‹    è¿™å››ç§æ–¹å¼åˆ†åˆ«æ˜¯ï¼š</p><ol><li><p>é€‰1ï¼›</p></li><li><p>é€‰2ï¼›</p></li><li><p>é€‰3ï¼›</p></li><li><p>é€‰2, 3ã€‚</p></li></ol><p>  æ ·ä¾‹è¾“å…¥2:<br>  7<br>  1 1 2 2 3 3</p><p>  æ ·ä¾‹è¾“å‡º2:<br>  40</p><p>  æ•°æ®è§„æ¨¡ä¸çº¦å®š</p><ul><li><p>å¯¹äº20%çš„æ•°æ®ï¼Œn â‰¤ 20ï¼›</p></li><li><p>å¯¹äº40%çš„æ•°æ®ï¼Œn â‰¤ 100ï¼›</p></li><li><p>å¯¹äº100%çš„æ•°æ®ï¼Œ1 â‰¤ n â‰¤ 100000ã€‚</p><p>èµ„æºçº¦å®šï¼š</p></li><li><p>å³°å€¼å†…å­˜æ¶ˆè€— &lt; 256M</p></li><li><p>CPUæ¶ˆè€—  &lt; 2000ms</p></li></ul><p>  è¯·ä¸¥æ ¼æŒ‰è¦æ±‚è¾“å‡ºï¼Œä¸è¦ç”»è›‡æ·»è¶³åœ°æ‰“å°ç±»ä¼¼ï¼šâ€œè¯·æ‚¨è¾“å…¥â€¦â€ çš„å¤šä½™å†…å®¹ã€‚</p><p>  æ‰€æœ‰ä»£ç æ”¾åœ¨åŒä¸€ä¸ªæºæ–‡ä»¶ä¸­ï¼Œè°ƒè¯•é€šè¿‡åï¼Œæ‹·è´æäº¤è¯¥æºç ã€‚</p><p>  æ³¨æ„: mainå‡½æ•°éœ€è¦è¿”å›0<br>  æ³¨æ„: åªä½¿ç”¨ANSI C/ANSI C++ æ ‡å‡†ï¼Œä¸è¦è°ƒç”¨ä¾èµ–äºç¼–è¯‘ç¯å¢ƒæˆ–æ“ä½œç³»ç»Ÿçš„ç‰¹æ®Šå‡½æ•°ã€‚<br>  æ³¨æ„: æ‰€æœ‰ä¾èµ–çš„å‡½æ•°å¿…é¡»æ˜ç¡®åœ°åœ¨æºæ–‡ä»¶ä¸­ #include <xxx>ï¼Œ ä¸èƒ½é€šè¿‡å·¥ç¨‹è®¾ç½®è€Œçœç•¥å¸¸ç”¨å¤´æ–‡ä»¶ã€‚</xxx></p><p>  æäº¤æ—¶ï¼Œæ³¨æ„é€‰æ‹©æ‰€æœŸæœ›çš„ç¼–è¯‘å™¨ç±»å‹ã€‚</p><h1 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h1><p>1ã€é¦–å…ˆå°†æ‰€æœ‰å£«å…µç›´å±ä¸Šçº§çš„ç¼–å·æ”¾äºæ•°ç»„aï¼›<br>2ã€æ¯ä¸ªäººæœ‰ä¸¤ç§é€‰æ‹©ï¼Œå»å’Œä¸å»ï¼Œç”¨0å’Œ1è¡¨ç¤ºï¼Œè½¬æ¢ä¸ºäºŒè¿›åˆ¶æ”¾äºæ•°ç»„bï¼›<br>3ã€æœ€ååˆ¤æ–­æ¯ä¸ªå£«å…µæ˜¯ä¸æ˜¯ä¸å…¶ç›´å±ä¸Šçº§åŒæ—¶æ‰§è¡Œä»»åŠ¡ï¼Œè¿›è€Œå¯¹countè¿›è¡Œç»Ÿè®¡ã€‚ </p><h1 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h1><pre class="line-numbers language-c"><code class="language-c"><span class="token comment" spellcheck="true">//</span><span class="token comment" spellcheck="true">//  main.c</span><span class="token comment" spellcheck="true">//  æ´¾é£æ•¢æ­»é˜Ÿé—®é¢˜</span><span class="token comment" spellcheck="true">//</span><span class="token comment" spellcheck="true">//  Created by Canvas on 2018/12/31.</span><span class="token comment" spellcheck="true">//  Copyright Â© 2018 Canvas. All rights reserved.</span><span class="token comment" spellcheck="true">//</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;math.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> number<span class="token punctuation">;</span>    <span class="token keyword">int</span> count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> flag<span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//æ´¾é£çš„äººæ•°</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">;</span>    <span class="token keyword">int</span> temp<span class="token punctuation">;</span>    <span class="token keyword">int</span> a<span class="token punctuation">[</span>number<span class="token punctuation">]</span><span class="token punctuation">,</span>b<span class="token punctuation">[</span>number<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//a</span>    a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//å°†å†›</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>number<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//æ¯ä¸ªäººçš„ç›´å±ä¸Šçº§</span>    <span class="token punctuation">}</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        temp<span class="token operator">=</span>i<span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>number<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//éå†æ‰€æœ‰æƒ…å†µ</span>            b<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>temp<span class="token operator">%</span><span class="token number">2</span><span class="token punctuation">;</span>            temp<span class="token operator">/</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        flag<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>number<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//å°†å†›æ²¡æœ‰ä¸Šçº§ï¼Œä¸ç”¨åˆ¤æ–­</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>b<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>b<span class="token punctuation">[</span>a<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">//åˆ¤æ–­æ˜¯å¦å£«å…µå’Œä¸Šçº§åŒæ—¶æ‰§è¡Œä»»åŠ¡</span>                <span class="token comment" spellcheck="true">//b[j]ä¸ºç¼–å·ä¸ºj+1çš„å£«å…µå»ä¸å»</span>                <span class="token comment" spellcheck="true">//b[a[j]-1]ä¸ºç¼–å·ä¸ºj+1çš„å£«å…µçš„ç›´æ¥ä¸Šçº§å»ä¸å»</span>                flag<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>flag<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>            count<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> Cè¯­è¨€ </tag>
            
            <tag> æ´¾é£æ•¢æ­»é˜Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>macOS å¯ç”¨ä»»ä½•æ¥æº</title>
      <link href="/posts/a318df92/"/>
      <url>/posts/a318df92/</url>
      
        <content type="html"><![CDATA[<h3 id="Allow-apps-downloaded-from-anywhere-on"><a href="#Allow-apps-downloaded-from-anywhere-on" class="headerlink" title="Allow apps downloaded from anywhere on"></a>Allow apps downloaded from anywhere on</h3><p>è®¸å¤šæœ‹å‹å‡çº§åˆ° macOS Sierra ååœ¨â€å®‰å…¨æ€§ä¸éšç§â€ä¸­æ‰¾ä¸åˆ°â€ä»»ä½•æ¥æºâ€é€‰é¡¹ï¼Œè¿™é‡Œæˆ‘æ•™ç»™å¤§å®¶æ€ä¹ˆæ‰“å¼€â€ä»»ä½•æ¥æºâ€ã€‚</p><p>æ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥ä»¥ä¸‹ä»£ç å›è½¦ï¼š</p><pre><code>sudo spctl --master-disable</code></pre><p>ä¼šæç¤ºè¾“å…¥å¯†ç ï¼Œæ ¹æ®æç¤ºè¾“å…¥å¯†ç å›è½¦ä¹‹åå°±å¯ä»¥åœ¨â€å®‰å…¨æ€§ä¸éšç§â€ä¸­æ‰“å¼€â€ä»»ä½•æ¥æºâ€é€‰é¡¹äº†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/athlonreg/BlogImages/Images/ee/6b66ba441c2c99506a691fd28b23ff.jpg" alt=""></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Hackintosh </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hacintosh </tag>
            
            <tag> é»‘è‹¹æœ </tag>
            
            <tag> ç»ˆç«¯ </tag>
            
            <tag> ä»»ä½•æ¥æº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½ç¢³ç”Ÿæ´»ç­”é¢˜é—®é¢˜</title>
      <link href="/posts/8d0bd2f2/"/>
      <url>/posts/8d0bd2f2/</url>
      
        <content type="html"><![CDATA[<h1 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h1><p>æŸç”µè§†å°ä¸¾åŠäº†ä½ç¢³ç”Ÿæ´»å¤§å¥–èµ›ã€‚é¢˜ç›®çš„è®¡åˆ†è§„åˆ™ç›¸å½“å¥‡æ€ªï¼š<br>â€‹<br>1ã€æ¯ä½é€‰æ‰‹éœ€è¦å›ç­”10ä¸ªé—®é¢˜ï¼ˆå…¶ç¼–å·ä¸º1åˆ°10ï¼‰ï¼Œè¶Šåé¢è¶Šæœ‰éš¾åº¦ã€‚ç­”å¯¹çš„ï¼Œå½“å‰åˆ†æ•°ç¿»å€ï¼›ç­”é”™äº†åˆ™æ‰£æ‰ä¸é¢˜å·ç›¸åŒçš„åˆ†æ•°ï¼ˆé€‰æ‰‹å¿…é¡»å›ç­”é—®é¢˜ï¼Œä¸å›ç­”æŒ‰é”™è¯¯å¤„ç†ï¼‰ã€‚<br>â€‹<br>2ã€æ¯ä½é€‰æ‰‹éƒ½æœ‰ä¸€ä¸ªèµ·æ­¥çš„åˆ†æ•°ä¸º10åˆ†ã€‚ æŸè·èƒœé€‰æ‰‹æœ€ç»ˆå¾—åˆ†åˆšå¥½æ˜¯100åˆ†ï¼Œå¦‚æœä¸è®©ä½ çœ‹æ¯”èµ›è¿‡ç¨‹ï¼Œä½ èƒ½æ¨æ–­å‡ºä»–ï¼ˆå¥¹ï¼‰å“ªä¸ªé¢˜ç›®ç­”å¯¹äº†ï¼Œå“ªä¸ªé¢˜ç›®ç­”é”™äº†å—ï¼Ÿ<br>â€‹<br>3ã€å¦‚æœæŠŠç­”å¯¹çš„è®°ä¸º1ï¼Œç­”é”™çš„è®°ä¸º0ï¼Œåˆ™10ä¸ªé¢˜ç›®çš„å›ç­”æƒ…å†µå¯ä»¥ç”¨ä»…å«æœ‰1å’Œ0çš„ä¸²æ¥è¡¨ç¤ºã€‚ä¾‹å¦‚ï¼š0010110011 å°±æ˜¯å¯èƒ½çš„æƒ…å†µã€‚<br>â€‹<br>4ã€ä½ çš„ä»»åŠ¡æ˜¯ç®—å‡ºæ‰€æœ‰å¯èƒ½æƒ…å†µã€‚æ¯ä¸ªç­”æ¡ˆå ä¸€è¡Œã€‚</p><h1 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h1><p>ä¸€å…±åä¸ªé—®é¢˜ï¼Œæ¯ä¸ªé—®é¢˜ä¸¤ç§æƒ…å†µï¼Œè¦ä¹ˆå¯¹è¦ä¹ˆé”™ï¼Œé‚£ä¹ˆç»“æœå°±ä¼šæœ‰ 0000000000 ~ 1111111111 = powï¼ˆ2ï¼Œ10ï¼‰ç§ï¼Œå°±å¯ä»¥ç”¨æš´åŠ›æœç´¢å°†æ‰€æœ‰æƒ…å†µæšä¸¾å‡ºæ¥ç„¶ååˆ¤æ–­ç¬¦åˆè¦æ±‚çš„æƒ…å†µï¼›<br>â€‹<br>åˆ†æ•°çš„æ§åˆ¶å¯ä»¥ç›´æ¥åˆ©ç”¨éå†æ‰€æœ‰æƒ…å†µçš„ for å¾ªç¯åˆ†åˆ«åˆ¤æ–­ä¸¤ç§æƒ…å†µï¼›<br>â€‹<br>å¦‚æœç”¨è¾“å‡º 1 ä»£è¡¨å›ç­”æ­£ç¡®ï¼Œ 0 ä»£è¡¨é”™è¯¯ï¼Œä¸éš¾æƒ³åˆ°ä»»ä½•ä¸€ä¸ªæ­£æ•´æ•°å¯¹ 2 å–ä½™ç»“æœåªæœ‰ 1 å’Œ 0 ä¸¤ç§æƒ…å†µï¼Œ è¾“å‡ºçš„æ—¶å€™ä¹Ÿå°±æˆäº†è¿›åˆ¶è½¬æ¢é—®é¢˜ï¼› </p><h1 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h1><pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span> </span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;math.h></span> </span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">;</span>    <span class="token keyword">int</span> score<span class="token punctuation">,</span>temp<span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        temp<span class="token operator">=</span>i<span class="token punctuation">;</span>        score<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>             <span class="token keyword">if</span><span class="token punctuation">(</span>temp<span class="token operator">%</span><span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>                score<span class="token operator">*</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>            <span class="token keyword">else</span>                score<span class="token operator">-</span><span class="token operator">=</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>             temp<span class="token operator">/</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>score<span class="token operator">==</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                temp<span class="token operator">=</span>i<span class="token punctuation">;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> temp<span class="token operator">%</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                temp<span class="token operator">/</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="è¿è¡Œç»“æœ"><a href="#è¿è¡Œç»“æœ" class="headerlink" title="è¿è¡Œç»“æœ"></a>è¿è¡Œç»“æœ</h1><pre><code>1 0 1 1 0 1 0 0 0 0 0 1 1 1 0 1 0 0 0 0 0 0 1 0 1 1 0 0 1 1 </code></pre><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> ä½ç¢³ç”Ÿæ´»ç­”é¢˜é—®é¢˜ </tag>
            
            <tag> Cè¯­è¨€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>xcode-select å‘½ä»¤è¯¦è§£</title>
      <link href="/posts/d0831756/"/>
      <url>/posts/d0831756/</url>
      
        <content type="html"><![CDATA[<h2 id="Itâ€™s-not-uncommon-developers-to-have-multiple-versions-of-Xcode-installed-For-example-I-typically-have-the-latest-beta-as-well-as-the-most-current-production-release-installed"><a href="#Itâ€™s-not-uncommon-developers-to-have-multiple-versions-of-Xcode-installed-For-example-I-typically-have-the-latest-beta-as-well-as-the-most-current-production-release-installed" class="headerlink" title="Itâ€™s not uncommon developers to have multiple versions of Xcode installed. For example, I typically have the latest beta as well as the most current production release installed."></a>Itâ€™s not uncommon developers to have multiple versions of Xcode installed. For example, I typically have the latest beta as well as the most current production release installed.</h2><p>However, there are times when you may want various tools, such as xcodebuild, to point to a specific Xcode folder. To faciliate this, you can use xcode-select. A common use case is if you use scripts and/or makefiles to build your projects.<br>Once you set the Xcode folder, xcodebuild will be invoked from the folder you specified.<br>The command line options are below:</p><pre><code>xcode-select [-help]xcode-select [-switch xcode_folder_path]xcode-select [-print-path]xcode-select [-version]</code></pre><h2 id="Here-is-how-to-print-the-current-Xcode-path"><a href="#Here-is-how-to-print-the-current-Xcode-path" class="headerlink" title="Here is how to print the current Xcode path:"></a>Here is how to print the current Xcode path:</h2><pre><code>$ xcode-select --print-path/Developer/Applications/Xcode.app</code></pre><p>Line number 2 shows the current version of Xcode that is â€˜active.â€™ If you are accessing xcodebuild or other related tools from a script, â€“print-path is the preferred means to determine the current Xcode location.<br>Use the -switch option to change to another version of Xcode on your system:</p><pre><code>$ sudo xcode-select --switch /Applications/Xcode-beta.app/Contents/Developer</code></pre><p>This changes to the Xcode-beta 9 on my system. Note that root access is required to set the Xcode location, thus I have used sudo to execute the command as root.<br>Printing the path now looks as follows:</p><pre><code>$ xcode-select --print-path/Applications/Xcode-beta.app/Contents/Developer</code></pre><h2 id="To-switch-back-to-Xcode-installed-in-the-Applications-directory"><a href="#To-switch-back-to-Xcode-installed-in-the-Applications-directory" class="headerlink" title="To switch back to Xcode installed in the /Applications directory:"></a>To switch back to Xcode installed in the /Applications directory:</h2><pre><code>$ sudo xcode-select -switch /Applications/Xcode.app/</code></pre><h2 id="You-can-read-more-about-xcode-select-by-view-the-man-page-from-a-terminal"><a href="#You-can-read-more-about-xcode-select-by-view-the-man-page-from-a-terminal" class="headerlink" title="You can read more about xcode-select by view the man page from a terminal:"></a>You can read more about xcode-select by view the man page from a terminal:</h2><pre><code>$ man xcode-select</code></pre><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Hackintosh </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç»ˆç«¯ </tag>
            
            <tag> Mac </tag>
            
            <tag> Xcode </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
